(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"+mXA":function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("wldR"),c=a("2pqd"),u=a("ikHm"),p=a("mF3+"),m=a("J9+s"),g=a("Sb6f"),h=a("LEzx");class f extends h.a{getInitialState(){return{starRating:void 0,step:"rate"}}}var M=f,y=a("LvDl"),v=a.n(y),b=a("NOLh"),S=a("yNyh"),C=a("vl8/"),T=a("gp1y"),k=a("Rd/G"),A=a("VpIZ");function w(e,t,a){if(a){const{templateId:i}=a;return e.some(e=>e.milestone===t&&e.template_id===i)}return e.some(e=>e.milestone===t)}var I=a("Ng05"),P=a("5Nka"),F=a("bkwR"),x=a("QcDD"),E=a("VyA+"),B=a("MeYt"),D=a("Cycz"),O=a("Oy36"),R=a("gyLq"),L=a("d933");const _=Object(m.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class U extends d.a{constructor(...e){super(...e),o()(this,"storeTypes",{csatPopupStore:M}),o()(this,"renderCancel",()=>s()(B.a,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,p.a.closeSmall({width:14,fill:this.theme.mediumTextColor}))),o()(this,"renderStep",()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=x.default.state;let a;if(t){const e=t.getValue();e&&e.initial_use_cases&&(a=v.a.sample(e.initial_use_cases))}return l.a.createElement(l.a.Fragment,null,s()(b.a,{isVisible:"rate"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>s()("div",{style:{paddingBottom:40}},void 0,this.renderIcon(),this.renderFeedbackPrompt(a))}),s()(b.a,{isVisible:"rate"===e||"send"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>s()("div",{style:this.getSlideContainerStyle()},void 0,this.renderStars(a),this.renderInput(),this.renderSendButton())}),s()(b.a,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}))}),o()(this,"renderThanks",()=>s()("div",{},void 0,s()("img",{style:{width:165,height:80},src:P.a.images.feedbackThankYouPng}),s()("div",{style:this.getThanksHeaderStyle()},void 0,s()(m.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})),s()("div",{style:this.getThanksDescriptionStyle()},void 0,s()(m.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"})))),o()(this,"renderIcon",()=>{const{currentBlockStore:e}=x.default.state;if(e){const t=e.getIcon();if(t)return s()(R.a,{justifyContent:"center",alignItems:"center"},void 0,s()(O.a,{icon:t,isEmptyPage:!1,size:32,disabled:!0}))}return s()(R.a,{justifyContent:"center",alignItems:"center"},void 0,p.a.notionLogo({width:32,height:32}))}),o()(this,"renderFeedbackPrompt",e=>{switch(e){case"doc_notes":return s()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",s()(m.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"}));case"project_management":return s()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",s()(m.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"}));case"wiki":return s()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",s()(m.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"}));default:const t=this.shouldRenderAsNPS(e);return s()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",s()(m.FormattedMessage,t?{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"}:{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"}))}}),o()(this,"renderInput",()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return s()(E.a,{capture:!0,onBackspace:v.a.identity,onLeft:v.a.identity,onRight:v.a.identity,onSelectAll:v.a.identity,onRedo:v.a.identity,onUndo:v.a.identity,onCut:v.a.identity,onCopy:v.a.identity,onPaste:v.a.identity,onKeypress:v.a.identity,onDelete:v.a.identity,onTab:v.a.identity},void 0,s()(S.b,{textarea:!0,style:this.getInputContainerStyle(),focus:"send"===e,value:t,placeholder:C.default.formatMessage(_.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}}))}),o()(this,"renderSendButton",()=>s()(I.a,{isLarge:!0,style:this.getButtonStyle(),onClick:this.handleSend},void 0,s()(m.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"}))),o()(this,"renderStars",e=>{const{starRating:t,step:a}=this.stores.csatPopupStore.state,i=({rating:e})=>s()("div",{style:this.getStarStyle(),onMouseEnter:()=>{"rate"===a&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:e})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:e,step:"send"})}},void 0,p.a.star({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=e?0:1}),p.a.starFilled({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=e?1:0})),n=()=>{const a=this.shouldRenderAsNPS(e);switch(t){case 1:return s()(m.FormattedMessage,a?{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}:{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return s()(m.FormattedMessage,a?{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}:{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return s()(m.FormattedMessage,a?{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}:{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return s()(m.FormattedMessage,a?{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}:{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return s()(m.FormattedMessage,a?{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}:{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return s()(m.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return s()("div",{onMouseLeave:()=>{v.a.delay(()=>{"rate"===this.stores.csatPopupStore.state.step&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})},500)},style:this.getStarsContainerStyle()},void 0,s()("div",{style:this.getStarsStyle()},void 0,s()(i,{rating:1}),s()(i,{rating:2}),s()(i,{rating:3}),s()(i,{rating:4}),s()(i,{rating:5})),s()("div",{style:this.getStarLabelStyle()},void 0,s()(n,{})))}),o()(this,"handleCancel",async()=>{const{state:e}=c.a;if(!e.open)return;const{open:t,...a}=e;if(t&&"trigger"===a.type){const{currentSpaceStore:e}=x.default.state;if(!e)return;await F.submitCsatFeedback(this.environment,{spaceId:e.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...a,useCase:"legacy"===a.useCase?void 0:a.useCase})}c.a.setState({...c.a,open:!1})}),o()(this,"handleSend",async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:a}=x.default.state;if(!a||!t)return;const{state:i}=c.a;if(!i.open)return;const{open:s,...n}=i,o="passive"===n.type?await F.submitCsatFeedback(this.environment,{spaceId:a.id,rating:t,additionalFeedback:e,type:n.type,milestone:void 0,templateId:void 0}):await F.submitCsatFeedback(this.environment,{spaceId:a.id,rating:t,additionalFeedback:e,templateId:void 0,...n,useCase:"legacy"===n.useCase?void 0:n.useCase});if("success"!==o.type)throw o.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:"thanks"}),v.a.delay(()=>{c.a.setState({...c.a,open:!1}),v.a.delay(()=>{this.stores.csatPopupStore.reset()},1e3)},2e3)}),o()(this,"flexCenteredStyle",{display:"flex",alignItems:"center",flexDirection:"column"})}willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:a}=this.props;if(e&&t&&a){const i=this.environment;if("CsatMilestoneStore"in i){const s=L.a.withListenerIgnored(()=>function(e,t){const{userSettingsStore:a,blockStore:i,spaceStore:s}=t,n=a.getSettings(),{signup_time:o}=n,{CsatMilestoneStore:r}=e,{data:l}=r.state,d=e=>Math.floor((Date.now()-e)/864e5),c=s.getValue();if(!c||!l)return;const{milestones:u}=l;if(!u)return;if(Math.max(...u.map(e=>e.created_time))>Date.now()-24192e5)return;if(o){const e=d(o),t=v.a.sample(c.initial_use_cases)||"legacy";if(e>=180){if(!w(u,T.b))return{milestone:T.b,useCase:t}}else if(e>=90){if(!w(u,T.e))return{milestone:T.e,useCase:t}}else if(e>=28){if(!w(u,T.c))return{milestone:T.c,useCase:t}}else if(e>=7&&!w(u,T.d))return{milestone:T.d,useCase:t}}const p=i.getValue(),m=p?Object(A.f)(p,"block"):void 0;return p&&m&&Object(k.k)(m)&&d(p.created_time)>=7&&!w(u,T.a,{templateId:m.id})?{milestone:T.a,useCase:"legacy",templateId:m.id}:void 0}(i,{userSettingsStore:e,blockStore:t,spaceStore:a}));if(s){const{milestone:e,useCase:t,templateId:a}=s;v.a.delay(()=>{c.a.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:a})},2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=x.default.state;return t&&t.canRead()?s()(b.a,{isVisible:c.a.state.open,animationStyle:this.getAnimationStyle(c.a.state.open),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),springConfig:this.getSpringConfig(),render:()=>s()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),s()("div",{style:this.getInnerContainerStyle()},void 0,this.renderStep()))}):void 0}shouldRenderAsNPS(e){const t=D.h(this.environment),{state:a}=c.a,i=a.open&&"trigger"===a.type;return"enterprise"===t&&!e&&i}getSpringConfig(){return{scale:{stiffness:58,damping:4.3}}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:g.a.fontWeight.semibold,fontSize:14}}getThanksDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}getButtonStyle(){return{width:"calc(100% - 30px)"}}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:"rate"===e?0:1}}getStarLabelStyle(){return{fontSize:12,color:this.theme.mediumTextColor,paddingTop:4}}getFeedbackPromptStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:g.a.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}getStarStyle(){return{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...this.flexCenteredStyle,position:"absolute",transition:"transform 200ms ease",width:240,transform:"rate"===e?"translateY(120px)":"translateY(0px)"}}getStarsContainerStyle(){return{width:"100%",...this.flexCenteredStyle}}getStarsStyle(){return{display:"flex",cursor:"pointer"}}getContainerStyle(){const{device:e}=this.environment;return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"absolute",bottom:65+e.scrollbarWidth,right:16+e.scrollbarWidth,zIndex:u.g}}getInnerContainerStyle(){return{...this.flexCenteredStyle,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}}t.default=Object(m.injectIntl)(U)},"3eY8":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a("bkwR"),s=a("VkkH"),n=a("S26v"),o=a("tP7q"),r=a("A9TN"),l=a("Wnyi"),d=a("hvW1"),c=a("VBxf"),u=a("y6Dp"),p=a("miBo"),m=a("RqMp"),g=a("J9+s");const h=Object(g.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{defaultMessage:"Asana login",id:"asanaActions.loginWithAsanaPopupModal.title"}});async function f(e){const{environment:t,requestStore:a}=e,g=Object(l.b)(t);let f=Object(o.c)(r.default.domainBaseUrl,{authType:g,userId:t.currentUser.id});f=g.redirectToAuth?f:await Object(l.c)(t,f);const M=await s.a(t,{width:580,height:800,url:f,titleMessage:h.titleMessage});if(!M)return;const y=n.f(M);if(!y.query.code||!y.query.state)return;d.b({message:h.authenticatingWithAsana});const v=await i.authWithAsana(t,{code:y.query.code,encryptedState:y.query.state});"failed"===v.type?(console.error(v.error),c.showError(v),d.a()):(u.p(t,{name:"asana"}),await a.refresh(),p.a.setState({open:!0}),m.a.setState({open:!0}),d.a())}},"64mo":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a("gcR/"),s=a.n(i),n=(a("q1tI"),a("wldR")),o=a("wXH4"),r=a("/6eU");class l extends n.a{renderComponent(){const{render:e}=this.props,{device:t}=this.environment,a=this.props.modalStore.state;return t.isMobile?s()(o.c,{open:a.open,popupType:o.c.PopupType.SlideUp,origin:this.props.origin,onDismiss:this.props.onDismiss,render:e}):s()(r.a,{open:a.open,preventHideChildrenWhileOpening:!0,render:e,onDismiss:this.props.onDismiss})}}},"7ObC":function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("Nxch"),c=a("wldR"),u=a("wXH4"),p=a("J9+s"),m=a("ZmWw"),g=a("pVnL"),h=a.n(g),f=(a("E9XD"),a("MBf9")),M=a("5w/s"),y=a("2Y+N"),v=a("g8hj"),b=a("njgS"),S=a("htWf"),C=a("gbGO"),T=a("ZQ9l"),k=a("j3Jm"),A=a("GZ8e"),w=a("fU6e"),I=a("IdIf"),P=a("mF3+"),F=a("Fco/"),x=a("0CAA"),E=a("nPEg"),B=a("Oy36"),D=a("OxuQ"),O=a("hU3F"),R=a("QkuB"),L=a("g4rC");class _ extends c.a{constructor(...e){super(...e),o()(this,"storeTypes",{hovered:O.a.of(!1),buttonPopupStore:O.a.of(new L.a)})}renderComponent(){const{schema:e,property:t,format:a}=this.props,i=e[t];if(!i)return;const n=this.getPropertyVisibility(i);return s()(R.b,{onMouseEnter:()=>this.stores.hovered.set(!0),onMouseLeave:()=>this.stores.hovered.set(!1),focused:this.stores.hovered.get(),showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:i,format:R.b.DisplayFormat.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.get();e.setState({open:!e.state.open})}},right:s()(w.a,{buttonPopupStore:this.stores.buttonPopupStore.get(),visibility:n,locked:this.props.locked,onSelect:e=>{d.e({environment:this.environment,property:t,visibility:e,format:a,store:this.props.store})},onClose:()=>this.stores.hovered.set(!1),type:"property",propertySchema:i})},t)}getPropertyVisibility(e){const{visibility:t}=this.props;switch(t){case"hide_if_empty":return S.d({propertySchema:e})?"hide_if_empty":"show";default:return t}}}var U=_,j=a("Sb6f"),N=a("d9nj"),Z=a("Cf1b"),W=a("IdSf"),V=a("/YYm");class z extends c.a{constructor(...e){super(...e),o()(this,"storeTypes",{lockStore:Z.a}),o()(this,"handleDraggableDrop",e=>{const t=this.getCollectionPageProperties();if(t){const a=e.map(e=>t.find(t=>t.property===e));d.c({environment:this.environment,properties:a,store:this.props.store})}}),o()(this,"handleToggleLockClick",()=>{const e=S.a();if(!e)return!1;const t=e.getParentBlockStore();t&&(f.createAndCommit(this.environment,e=>{M.e({environment:this.environment,store:t,isLocked:!S.b(),transaction:e})}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))})}renderComponent(){const{device:e}=this.environment;let t;t=e.isMobile?{menuType:C.b.MenuType.Modal,right:s()(E.DoneMenuText,{}),onClickRight:d.a,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:C.b.MenuType.Popup,minWidth:400};const a=this.getNormalizedFormat();return l.a.createElement(C.b,h()({},t,{header:this.renderHeader()}),(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(a),this.renderPropertiesSectionMenuItem(a))}renderLockControls(){return s()("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:"1px solid ".concat(this.theme.regularDividerColor),borderBottom:"1px solid ".concat(this.theme.regularDividerColor),background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6}},void 0,s()("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6}},void 0,this.stores.lockStore.state.justUnlocked?P.a.unlocked({height:12,width:12,fill:this.theme.mediumIconColor}):P.a.locked({height:12,width:12,fill:this.theme.mediumIconColor})),this.stores.lockStore.state.justUnlocked?s()(p.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):s()(p.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),s()(N.a,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:j.a.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick},void 0,this.stores.lockStore.state.justUnlocked?s()(p.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):s()(p.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})))}renderPropertiesSectionMenuItem(e){const t=this.getSchema();if(!t||"page"===this.props.type)return;const a=this.getPageCustomization(e);if(!a)return;const{propertyVisibility:i}=a;if(!i)return;const n=i.reduce((e,t)=>(e[t.property]=t.visibility,e),{});return s()(y.a,{style:{opacity:this.props.locked?.5:1},isTitleUppercase:!0,title:s()(p.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"})},void 0,s()(v.b,{direction:v.a.Vertical,keys:this.getCollectionPageProperties().map(e=>e.property),renderKey:a=>{if("collection"===this.props.type)return s()(U,{schema:t,visibility:n[a],property:a,format:e,store:this.props.store,locked:this.props.locked})},onDrop:this.handleDraggableDrop}))}renderPageSectionsSectionMenuItem(e){const t=this.getPageCustomization(e);if(!t)return;const{pageSectionVisibility:a}=t;return a?s()(y.a,{style:{opacity:this.props.locked?.5:1},title:s()(p.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),isTitleUppercase:!0,topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked},void 0,s()(T.a,{title:s()(p.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:P.a.alias({height:16,width:16,transform:"rotate(180deg)"}),right:s()(w.a,{visibility:a.backlinks,locked:this.props.locked,onSelect:t=>{d.d({environment:this.environment,pageSection:"backlinks",visibility:t,store:this.props.store,format:e})},type:"page"})}),s()(T.a,{title:s()(p.FormattedMessage,{id:"customizePageMenu.pageSections.commentsTitle",defaultMessage:"Page comments"}),icon:P.a.speechBubbleThick({height:16,width:16}),right:s()(w.a,{visibility:a.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{d.d({environment:this.environment,pageSection:"comments",visibility:t,store:this.props.store,format:e})},type:"page"})})):void 0}renderHeader(){if(this.environment.device.isMobile)return;const{store:e}=this.props;if(e){const t=e.getIcon(),a="collection"===this.props.type?this.props.store.getParentBlockStore():void 0,i=t&&s()(B.a,{icon:t,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),n=s()(D.a,{store:e,style:{display:"inline"}}),o=s()(A.a,{prefix:s()(p.FormattedMessage,{id:"customizePageMenu.header.label",defaultMessage:"Page view for "}),viewName:a?l.a.createElement(l.a.Fragment,null,s()(W.a,{onClick:d.a,href:Object(V.a)({store:a,fullyQualified:!1}),inline:!0},void 0,i,n)):l.a.createElement(l.a.Fragment,null,i,n)});return s()(T.a,{style:{...k.e.headingStyle},title:o,right:s()(F.a,{helpButtonContext:"collection_properties_menu",href:Object(x.a)("guides.databaseProperties")})})}}getSchema(){if("collection"!==this.props.type)return this.props.store.getSchema();{const e=this.props.store.getValue();if(e)return b.e(e.schema)}}getNormalizedFormat(){const e=this.props.store.getFormat(),t=this.getSchema();if(!t)return{};return I.l(e,t,void 0,I.a.Collection)}getCollectionPageProperties(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_properties||[]}getPageCustomization(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}}var q=z,H=a("szb2"),G=a("QcDD");class K extends c.a{constructor(...e){super(...e),o()(this,"renderModal",()=>{if(!m.a.state.isOpen)return;const e=S.a(),{currentBlockStore:t}=G.default.state,a=H.c.state.open&&H.c.state.target||t;return e?s()(q,{store:e,type:"collection",intl:this.props.intl,locked:S.b()}):a?s()(q,{store:a,type:"page",intl:this.props.intl,locked:!1}):void 0})}renderComponent(){const{device:e}=this.environment,t=m.a.state;return s()(u.c,{popupType:e.isMobile?u.c.PopupType.SlideUp:u.c.PopupType.Popup,alignmentToOrigin:u.c.Alignment.Center,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>d.a()})}}t.default=Object(p.injectIntl)(K)},"8FJR":function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("PHZn"),c=a("J9+s"),u=a("Zo/l"),p=a("yNyh"),m=a("gbGO"),g=a("WgIs"),h=a("2Y+N"),f=a("mjq6"),M=a("mUbl"),y=a("VhAz"),v=a("bkwR"),b=a("SR/M"),S=a("wXH4"),C=a("zqZm"),T=a("Ggib"),k=a("yQT7");function A(e){const t=Object(d.a)(e=>({container:Object(k.b)(e),cityZipRow:{display:"flex"},verticalDivider:{display:"flex",borderLeft:"1px solid",borderLeftColor:e.groupedFormBorder},zipRow:{display:"flex",flex:2},stateRow:{display:"flex",flex:3}}),[]),a=Object(c.useIntl)();return o()("div",{},void 0,o()("div",{style:t.container},void 0,o()(I,{placeholder:a.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.fullName",defaultMessage:"Full name"}),address:e.address,updateAddressField:e.updateAddressField,addressKey:"name"}),e.shouldShowBusinessName&&o()(I,{placeholder:a.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.businessName",defaultMessage:"Business name (optional)"}),address:e.address,updateAddressField:e.updateAddressField,addressKey:"businessName"}),o()(w,{updateAddressField:e.updateAddressField}),e.address&&Object(C.b)(e.address.country)&&l.a.createElement(l.a.Fragment,null,o()(I,{placeholder:a.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.address",defaultMessage:"Address"}),address:e.address,addressKey:"addressLine1",updateAddressField:e.updateAddressField}),o()(I,{placeholder:a.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.city",defaultMessage:"City"}),addressKey:"city",address:e.address,updateAddressField:e.updateAddressField}),o()("div",{style:t.cityZipRow},void 0,o()("div",{style:t.zipRow},void 0,o()(I,{placeholder:a.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.zipCode",defaultMessage:"Zip code"}),address:e.address,addressKey:"zipCode",updateAddressField:e.updateAddressField})),o()("div",{style:t.verticalDivider}),o()("div",{style:t.stateRow},void 0,o()(I,{placeholder:a.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.state",defaultMessage:"State / Province"}),address:e.address,addressKey:"state",updateAddressField:e.updateAddressField}))))))}function w(e){const t=Object(u.b)(),[a,i]=Object(r.useState)(!1),n=Object(c.useIntl)(),C=Object(d.a)(()=>({input:{background:"none",boxShadow:"none",padding:8}}),[]),[A,w]=l.a.useState(""),[I]=Object(M.a)(async()=>{const e=await v.getAvailableCountries(t,{});return"success"===e.type?e.data.countries:"failed"===e.type?[]:void Object(y.f)(e)},[t]),P=I.value;if(!P)return null;const F=Object(f.b)(A,P,e=>e.name).map((t,a)=>({key:a,render:e=>l.a.createElement(b.a,s()({},e,{title:t.name})),action:()=>{e.updateAddressField("country",t.countryCode);const a=T.a.state;a.open&&T.a.setState({...a,vatApplicable:Boolean(t.vatApplicable)}),w(t.name),i(!1)}}));return o()(k.a,{},void 0,o()(S.c,{popupType:S.c.PopupType.Popup,alignmentToOrigin:S.c.Alignment.End,placementToOrigin:S.c.Placement.Right,originGap:0,open:a,origin:o()(p.b,{value:A,focus:a,placeholder:n.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.country",defaultMessage:"Country or region"}),style:C.input,onChange:t=>{w(t.target.value),e.updateAddressField("country",void 0)},onFocus:()=>{i(!0)}}),onDismiss:()=>{i(!1),w("")},render:()=>o()(m.b,{menuType:m.b.MenuType.Popup,width:"100%"},void 0,o()(g.a,{type:g.a.Type.Vertical,initialFocus:A.length>0?0:void 0,sections:[{key:0,render:e=>l.a.createElement(h.a,s()({},e,{title:o()(c.FormattedMessage,{id:"spaceSubscriptionBillingInfoForm.countryDropdown.title",defaultMessage:"Select a country or region"})})),items:F}]}))}))}function I(e){const t=Object(d.a)(()=>({input:{background:"none",boxShadow:"none",padding:8}}),[]);return o()(k.a,{},void 0,o()(p.b,{value:e.address[e.addressKey],style:t.input,placeholder:e.placeholder,onChange:(a=e.updateAddressField,i=e.addressKey,e=>{a(i,e.target.value)})}));var a,i}},"8evV":function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=a("q1tI"),c=a.n(d),u=a("wldR"),p=a("CZQ9"),m=a("J9+s"),g=a("64mo"),h=a("vJXr"),f=a("IULH"),M=a("Sb6f"),y=a("ovYF"),v=a("oYg8"),b=a("bkwR"),S=a("HTHG"),C=a("q4wu"),T=a("WgIs"),k=a("gbGO"),A=a("2Y+N"),w=a("T4gQ"),I=a("mF3+"),P=a("VBxf");const F=Object(m.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var x=a("vl8/"),E=a("zmp8"),B=a("sSHh"),D=a("0CAA"),O=a("yNyh"),R=a("ZQ9l"),L=a("Z1H8");const _=Object(m.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"}});class U extends u.a{constructor(e){super(e),l()(this,"handleCancel",()=>{Object(y.a)()}),l()(this,"renderContent",()=>{const{device:e}=this.environment;if(!h.a.state.online)return this.renderOffline();const t=p.a.state;return t.open?e.isMobile?this.renderMobileModal(t):this.renderDesktopModal(t):void 0}),l()(this,"onSubmit",async()=>{const e=this.environment,t=p.a.getState();if(!t.open)return;const{additionalInformation:a,reason:i}=t,s=Object(S.c)();if(!i||null==s||!s.id)return void P.showErrorMessage(o()(m.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const n=await(r=Object(C.a)(),Object(b.reportPage)(e,{reason:i,page:s,intercomVisitorId:r,additionalInformation:a}));var r;"failed"===n.type?P.showError(n):(p.a.setState({open:!1}),P.showMessage({message:c.a.createElement(c.a.Fragment,null,o()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},void 0,I.a.thanksShield({width:40}),o()("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"}},void 0,o()(m.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."}))))}))}),l()(this,"modalTitleStyle",{fontSize:16,marginBottom:12,fontWeight:M.a.fontWeight.medium})}renderComponent(){return o()(g.a,{onDismiss:this.handleCancel,render:this.renderContent,requireOnline:!0,modalStore:p.a})}renderOptionButtons(e){const{reason:t}=e;return c.a.createElement(c.a.Fragment,null,o()(v.a,{title:o()(m.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===t,onClick:()=>p.a.setState({...e,reason:"phishing_or_spam"})},"phishing_or_spam"),o()(v.a,{title:x.default.formatMessage(F.inappropriate_content),isSelected:"inappropriate_content"===t,onClick:()=>p.a.setState({...e,reason:"inappropriate_content"})},"inappropriate_content"),o()(v.a,{title:o()(m.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===t,onClick:()=>p.a.setState({...e,reason:"other_content_policy_violation"})},"other_content_policy_violation"))}renderMobileModal(e){if(!e.open)return;const{reason:t}=e,a={menuType:k.a.Modal,title:o()(m.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:o()(m.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return c.a.createElement(k.b,a,o()(T.a,{type:T.a.Type.Vertical,initialFocus:void 0,sections:[{key:"help",render:({children:e,...t})=>c.a.createElement(A.a,t,e),items:[{key:"help",render:()=>o()(R.a,{title:o()(B.a,{title:o()(m.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:Object(D.a)("contentPolicy"),analyticsFrom:"report_page"}),right:c.a.createElement(c.a.Fragment,null),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:({children:e,...t})=>c.a.createElement(A.a,t,e),items:[{key:"options",render:()=>this.renderOptionButtons(e),action:()=>{}},{key:"additionalInfo",render:()=>t&&o()(O.b,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:x.default.formatMessage(_.additionalInformationPlaceholder),onChange:t=>{p.a.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},{key:"actions",render:({children:e,...t})=>c.a.createElement(A.a,s()({isSubmitButton:!0},t),e),items:[{key:"submit",render:e=>{const{onClick:t,...a}=e;return c.a.createElement(w.a,s()({},a,{disabled:!this.canSubmit(),title:o()("div",{style:{color:E.g.red}},void 0,o()(m.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})),onClick:t||this.onSubmit}))},action:this.onSubmit}]}]},"main list"))}canSubmit(){const{state:e}=p.a;if(e.open){const{reason:t}=e;return void 0!==t}return!1}renderDesktopModal(e){if(!e.open)return;const{reason:t}=e;return o()(L.a,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>o()("div",{style:this.getModalWrapStyle()},void 0,o()("div",{style:this.modalTitleStyle},void 0,o()(m.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})),o()("div",{style:{paddingBottom:12}},void 0,o()(B.a,{title:o()(m.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:Object(D.a)("contentPolicy"),analyticsFrom:"report_page"})),o()("div",{},void 0,this.renderOptionButtons(e)),t&&o()(O.b,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:x.default.formatMessage(_.additionalInformationPlaceholder),onChange:t=>{p.a.setState({...e,additionalInformation:t.target.value})}}),o()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18}},void 0,o()(f.a,{isLarge:!0,onClick:this.handleCancel,style:{marginRight:12}},void 0,o()(m.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})),o()(f.a,{isRed:!0,isLarge:!0,onClick:this.onSubmit,disabled:!this.canSubmit(),disabledFeedback:!0},void 0,o()(m.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"}))))})}renderOffline(){return o()("div",{style:this.getOfflineStyle()},void 0,o()(m.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"}))}getModalWrapStyle(){return{width:360,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}getTextAreaStyle(){const{device:e}=this.environment;return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:e.isMobile?16:"10px 12px",height:e.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:e.isMobile?16:14}}}t.default=U},"9f/M":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a("bkwR"),s=a("VkkH"),n=a("S26v"),o=a("tP7q"),r=a("A9TN"),l=a("Wnyi"),d=a("hvW1"),c=a("VBxf"),u=a("y6Dp"),p=a("VcB+"),m=a("RqMp"),g=a("J9+s");const h=Object(g.defineMessages)({authenticatingWithTrello:{id:"trelloActions.authenticatingWithTrello.loadingMessage",defaultMessage:"Authenticating with Trello…"},titleMessage:{defaultMessage:"Trello login",id:"trelloActions.loginPopupModal.title"}});async function f(e){const{environment:t,requestStore:a}=e,g=Object(l.b)(t);let f=Object(o.j)(r.default.domainBaseUrl,{authType:g,userId:t.currentUser.id});f=g.redirectToAuth?f:await Object(l.c)(t,f);const M=await s.a(t,{width:580,height:700,url:f,titleMessage:h.titleMessage});if(!M)return;const y=n.f(M),v=y.query.oauth_token,b=y.query.oauth_verifier;if(!v||!b)return;d.b({message:h.authenticatingWithTrello});const S=await i.authWithTrello(t,{requestToken:v,verifier:b});"failed"===S.type?(console.error(S.error),c.showError(S),d.a()):(u.p(t,{name:"trello"}),await a.refresh(),p.a.setState({open:!0}),m.a.setState({open:!0}),d.a())}},AId3:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a("bkwR"),s=a("zqZm");async function n(e,t){const a=Object(s.a)(t);if("skip"===a)return{valid:!0};if("insufficient_data"===a)return{valid:!1};const n=await Object(i.resolveAddress)(e,{address:{line1:t.addressLine1,city:t.city,zip:t.zipCode,state:t.state,country:t.country}});return"failed"===n.type?{valid:!1}:n.data}},AXyr:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return o}));var i=a("yjqD"),s=a("QmC8");const n=function(e){const t=i.c();return s.a.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise},o=function(e){const t=s.a.state;t.open&&(t.onComplete(e.didConfirm),s.a.reset())}},AfJk:function(e,t,a){"use strict";var i=a("gcR/"),s=a.n(i),n=(a("q1tI"),a("wldR")),o=a("2A6Q"),r=a("aEEb"),l=a("J9+s");class d extends n.a{renderComponent(){return s()(o.a,{},void 0,s()(r.a,{isSmall:!0,style:{textAlign:"center"}},void 0,s()(l.FormattedMessage,{id:"spaceSubscriptionPlans.offlineMessage",defaultMessage:"Please go online to manage your plan."})))}}t.a=d},B0TY:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("wldR"),c=a("QcDD"),u=a("RqMp"),p=a("pVnL"),m=a.n(p),g=a("prF1"),h=a("lCCU"),f=a("SR/M"),M=a("i3uR"),y=a("vJXr"),v=a("MeYt"),b=a("zmp8"),S=a("Sb6f");class C extends d.a{renderComponent(){const{title:e,actionButton:t,onClick:a}=this.props;return s()(v.a,{onClick:a,style:this.getButtonStyle()},void 0,this.renderIcon(),s()("div",{style:{minWidth:0,width:"100%"}},void 0,s()("div",{style:{display:"flex"}},void 0,s()("div",{style:C.titleStyle},void 0,e),s()("div",{style:{marginLeft:"auto"}},void 0,t)),this.renderCaption()))}renderIcon(){const{icon:e,logo:t}=this.props;return t?s()("img",{style:C.imageIconStyle,src:t}):e?s()("div",{style:this.getIconWrapStyle()},void 0,e(this.getIconStyle())):void 0}renderCaption(){const{caption:e}=this.props;if(e)return s()("div",{style:this.getCaptionStyle()},void 0,e)}getButtonStyle(){return{display:"flex",alignItems:this.props.caption?"flex-start":"center",padding:10,paddingRight:8,borderRadius:3,marginBottom:12,cursor:"pointer",boxShadow:this.theme.lightBoxShadow,transition:"background 200ms ease-out",background:this.theme.contentBackground}}getIconWrapStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",width:C.iconSize,height:C.iconSize,borderRadius:3,marginRight:8,color:this.theme.mediumTextColor,background:this.theme.sidebarBackground}}getIconStyle(){return{flexShrink:0,width:C.iconSize,height:C.iconSize}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor,wordBreak:"keep-all",...!this.props.shouldWrapCaption&&{...S.a.textOverflowStyle}}}}o()(C,"iconSize",28),o()(C,"imageIconStyle",{flexShrink:0,width:C.iconSize,height:C.iconSize,borderRadius:3,marginRight:10,background:b.g.white}),o()(C,"titleStyle",{fontSize:16,fontWeight:S.a.fontWeight.medium});var T=C,k=a("wlCD"),A=a("gbGO"),w=a("WgIs"),I=a("Pl3d"),P=a("CSYU"),F=a("2Y+N"),x=a("LeVO"),E=a("wXH4"),B=a("y6Dp"),D=(a("Junv"),a("mKX5")),O=a("yjqD"),R=a("wpmu"),L=a("bkwR"),_=a("N34Z"),U=a("MBf9"),j=a("p+Y9"),N=a("SAEH"),Z=a("hvW1"),W=a("VBxf"),V=a("jZoB"),z=a("miBo"),q=a("VcB+"),H=a("LvDl"),G=a.n(H),K=a("HRSx"),Y=a("udrG"),Q=a("cw0H"),J=a("J9+s"),X=a("vl8/");const $=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],ee=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],te={markdown:ee,csv:["text/plain",".csv"],html:["text/html"],docx:$,gdocs:$,dropbox:$,quip:["text/html",ee],workflowy:["text/plain"],confluence:["application/zip"]};var ae=a("zzAG");const ie=Object(J.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}",description:"'Import' is a noun"}});async function se(e){const{environment:t,spaceStore:a,spaceViewStore:i,notebooks:s,userSettingsStore:n}=e;if(0===s.length)throw new Error("Expected at least one notebook");Z.b({message:ie.importingFromEvernoteMessage,interpolatedValues:{importingCount:s.length}}),Q.a.setState({open:!1});const o=await async function(e){const{environment:t,spaceStore:a,spaceViewStore:i,notebooks:s}=e,n=U.create(t),o=G.a.uniq(G.a.compact(s.map(e=>e.stack))).sort().reverse(),r={};let l=e=>!0;s.length>1&&o.length>0&&(o.forEach(e=>{const o=N.d({environment:t,spaceStore:a,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!1,title:e,transaction:n}),l=o.getContentStore();s.filter(t=>t.stack===e).forEach(e=>{const a=_.b({environment:t,type:Y.a.copyIndicator,inMemoryRecordCache:o.inMemoryRecordCache,transaction:n});V.a({parent:l,append:a,transaction:n}),r[e.guid]=a})}),l=e=>!Boolean(e.stack));return s.filter(l).reverse().forEach(e=>{const s=N.d({environment:t,spaceStore:a,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!0,title:e.title,transaction:n});r[e.guid]=s}),await U.commit({environment:t,transaction:n}),r}({environment:t,spaceStore:a,spaceViewStore:i,notebooks:s}),r=o[s[0].guid];try{return await async function(e){const{environment:t,spaceStore:a,spaceViewStore:i,notebooks:s,waitForNotebook:n,notebookMapping:o,userSettingsStore:r}=e;let l;if(O.b(s,2,async e=>{await Promise.all(e.map(async e=>{const a=o[e.guid];if(!a)throw new Error("Missing notebook page ".concat(e.guid));const i=O.c();a===n&&(l=i),await async function(e){const{environment:t,notebookStore:a,notebook:i,firstCompleted:s}=e,n=L.importEvernote(t,{notebookId:i.guid,blockId:a.id,spaceId:a.pointer.spaceId,timestamp:Date.now(),parentTable:K.a}),{value:o}=await n.next();if(o.error)throw console.error(o.error),U.createAndCommit(t,e=>{const t=a.getParentBlockStore();if(t){const i=t.getContentStore();V.f({parent:i,remove:a,transaction:e})}}),o.error;s.resolve(void 0)}({environment:t,notebookStore:a,notebook:e,firstCompleted:i})}))}),!l)throw new Error("waitForNotebookFirstCompleted not defined.");r.getSettings().created_evernote_getting_started||await N.e({environment:t,type:"evernote",spaceStore:a,spaceViewStore:i,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:r,notebookMapping:o,notebooks:s,spaceStore:a,spaceViewStore:i,userSettingsStore:n}),Z.a(),r}catch(l){throw W.showErrorMessage(X.default.formatMessage(ie.evernoteImportFailed)),Z.a(),l}}var ne=a("mF3+"),oe=a("5Nka"),re=a("zTdN"),le=a("LEzx");class de extends le.a{getInitialState(){return{searchQuery:"",selection:new Set}}}var ce=de,ue=a("dXb3"),pe=a("3DNc"),me=a("mjq6"),ge=a("Ng05"),he=a("ZQ9l"),fe=a("bxQm");class Me extends d.a{renderComponent(){return s()("div",{style:this.getStyle()},void 0,"·")}getStyle(){return{display:"inline-block",textAlign:"center",color:this.props.disabled?this.theme.lightTextColor:this.theme.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}}}var ye=Me,ve=a("aEEb");class be extends d.a{constructor(...e){super(...e),o()(this,"storeTypes",{store:ce}),o()(this,"handleSelectAllClick",()=>{const{sections:e,analyticsName:t}=this.props,{store:a}=this.stores,{selection:i}=a.state;for(const s of e)for(const e of s.items)i.add(e.key);a.emit(),B.oc(this.environment,{name:t})}),o()(this,"handleDeselectAllClick",()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:a}=t.state;a.clear(),t.emit(),B.mc(this.environment,{name:e})}),o()(this,"handleToggleItem",e=>{const{analyticsName:t}=this.props,{store:a}=this.stores,{selection:i}=a.state;i.has(e.key)?(i.delete(e.key),B.pc(this.environment,{name:t})):(i.add(e.key),B.nc(this.environment,{name:t})),a.emit()}),o()(this,"handleImport",()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,a=G.a.flatten(e.map(e=>e.items)),i=[];t.forEach(e=>{const t=a.find(t=>t.key===e);t&&i.push(t)}),this.props.onComplete(i)})}willMount(e){const t=this.stores.store.state.selection,[a]=e.sections;if(a){const[e]=a.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return s()(A.b,{menuType:A.b.MenuType.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350},void 0,this.renderMenuList())}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,a=Boolean(t);return s()(F.a,{isInput:!0,desktopStyle:{paddingBottom:2}},void 0,s()(ue.a,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),s()(he.a,{isTokenTitle:!0,style:{marginTop:2},title:s()("div",{style:{marginLeft:-3}},void 0,s()(fe.a,{onClick:this.handleSelectAllClick,disabled:a,disabledFeedback:!0},void 0,s()(J.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})),s()(ye,{disabled:a}),s()(fe.a,{onClick:this.handleDeselectAllClick,disabled:a,disabledFeedback:!0},void 0,s()(J.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})))}))}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return s()(F.a,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8}},void 0,s()(he.a,{title:s()(ge.a,{disabled:e,onClick:this.handleImport},void 0,s()(J.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"}))}))}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:a}=this.stores,{searchQuery:i,selection:n}=a.state,o=e.map(e=>{const t=Object(me.b)(i,e.items,t=>"".concat(t.name," ").concat(e.name));return{...e,items:t}}).filter(e=>e.items.length>0);if(0===o.length)return s()(F.a,{},void 0,s()(re.a,{title:t}));const r=o.map(t=>({key:t.name,render:a=>l.a.createElement(F.a,m()({},a,{title:e.length>1?t.name:void 0})),items:t.items.map(e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:a=>l.a.createElement(f.a,m()({},a,{title:e.name,icon:s()(pe.a,{checked:n.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&s()(ve.a,{isSmall:!0},void 0,e.count)})),action:t}})}));return s()(w.a,{type:w.a.Type.Vertical,initialFocus:void 0,sections:r})}}var Se=be,Ce=a("9f/M");class Te extends d.a{constructor(...e){super(...e),o()(this,"handleClickImportTrello",()=>{B.E(this.environment,{name:"trello",from:this.props.analyticsFrom})}),o()(this,"handleTrelloAuth",async()=>{await Ce.a({environment:this.environment,requestStore:this.props.requestStore})}),o()(this,"handleRemoveTrello",async()=>{await L.disconnectTrello(this.environment,{}),await this.props.requestStore.refresh(),B.fe(this.environment,{name:"trello"})}),o()(this,"handleImportTrelloComplete",async(e,t)=>{const{boards:a}=e,i=a.filter(e=>Boolean(t.find(t=>t.key===e.id)));B.ic(this.environment,{name:"trello",count:t.length});const s=await async function(e){const{environment:t,boards:a,spaceStore:i,spaceViewStore:s}=e;Z.b({message:ie.importingFromTrelloMessage,interpolatedValues:{importingCount:a.length}}),q.a.setState({open:!1});const n=U.create(t),o=a.map(e=>N.d({environment:t,spaceStore:i,spaceViewStore:s,isPrivate:!0,prepend:!0,loading:!0,title:e.name,transaction:n}));await new Promise(e=>{n.postSubmitCallbacks.push(e),U.commit({environment:t,transaction:n})});try{return await Promise.all(o.map(async(e,i)=>{const s=a[i],{value:n}=await L.importTrello(t,{boardId:s.id,blockId:e.id,spaceId:e.pointer.spaceId}).next();if(n.error)throw n.error})),Z.a(),o[0]}catch(r){throw U.createAndCommit(t,e=>{for(const t of o)V.f({parent:i.getPagesStore(),remove:t,transaction:e})}),W.showErrorMessage(X.default.formatMessage(ie.trelloImportFailed)),Z.a(),new Error(r)}}({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,boards:i});this.props.onComplete(s)})}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:a}=this.props,{account:i,boards:n}=t,o={key:"default",name:a.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:n.map(e=>({key:e.id,name:e.name}))},r={title:"Trello",logo:oe.a.images.import.trelloPng,actionButton:i&&this.props.renderItemActionsButton([{name:a.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>q.a.setState({open:!0})},{name:a.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleTrelloAuth},{name:a.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveTrello}]),onClick:()=>{}};return s()(M.a,{popupType:e.isMobile?M.a.PopupType.SlideUp:M.a.PopupType.Popup,buttonPopupStore:q.a,onClick:this.handleClickImportTrello,render:()=>s()(Se,{searchInputPlaceholder:a.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…",description:"'Board' is a Trello term."}),noSearchResultsPlaceholder:a.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards",description:"'Board' is a Trello term."}),analyticsName:"trello",sections:[o],onComplete:e=>this.handleImportTrelloComplete(t,e)}),renderOrigin:({onClick:e})=>l.a.createElement(T,m()({},r,{onClick:i?e:this.handleTrelloAuth}))})}}var ke=Object(J.injectIntl)(Te),Ae=a("r8MX"),we=a("H4VD"),Ie=a("BJ/B"),Pe=a("0CAA");class Fe extends d.a{constructor(...e){super(...e),o()(this,"handleClickImportEvernote",()=>{B.E(this.environment,{name:"evernote",from:this.props.analyticsFrom})}),o()(this,"handleRemoveEvernote",async()=>{await L.disconnectEvernote(this.environment,{}),await this.props.requestStore.refresh(),B.fe(this.environment,{name:"evernote"})}),o()(this,"handleEvernoteAuth",async()=>{await Ie.a({environment:this.environment,requestStore:this.props.requestStore})}),o()(this,"handleImportEvernoteComplete",async(e,t)=>{const{notebooks:a}=e,i=a.filter(e=>Boolean(t.find(t=>t.key===e.guid)));B.ic(this.environment,{name:"evernote",count:t.length});const s=await se({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore,notebooks:i});this.props.onComplete(s)}),o()(this,"handleEvernoteHelpClick",()=>{we.navigateToExternalURL({environment:this.environment,url:Object(Pe.a)("guides.importEvernote")})})}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:a}=this.props,{userInfo:i,notebooks:n}=t,o=G.a.groupBy(n,e=>e.stack||""),r=Object.keys(o).map(e=>{const t=e||"Top-Level";return{key:t,name:t,items:(o[e]||[]).map(e=>({key:e.guid,name:e.title,count:e.noteCount}))}}),{data:d}=Ae.default.state,c=Boolean(d&&d.credits.find(e=>"import_evernote"===e.type&&e.activated)),u={title:"Evernote",logo:oe.a.images.import.evernotePng,shouldWrapCaption:!i&&!c,caption:i?i.name||i.username||i.email:c?void 0:a.formatMessage({id:"evernoteImportOption.caption.getCredit",defaultMessage:"Get $5 in credit on import"}),actionButton:i?this.props.renderItemActionsButton([{name:a.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:this.handleEvernoteHelpClick},{name:a.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>Q.a.setState({open:!0})},{name:a.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleEvernoteAuth},{name:a.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveEvernote}]):this.props.defaultActionButton,onClick:()=>{}};return s()(M.a,{popupType:e.isMobile?M.a.PopupType.SlideUp:M.a.PopupType.Popup,buttonPopupStore:Q.a,onClick:this.handleClickImportEvernote,render:()=>s()(Se,{searchInputPlaceholder:a.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…",description:"'Notebook' is an Evernote term."}),noSearchResultsPlaceholder:a.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks",description:"'Notebook' is an Evernote term."}),analyticsName:"evernote",sections:r,onComplete:e=>this.handleImportEvernoteComplete(t,e)}),renderOrigin:({onClick:e})=>l.a.createElement(T,m()({},u,{onClick:i?e:this.handleEvernoteAuth}))})}}var xe=Object(J.injectIntl)(Fe),Ee=a("3eY8");class Be extends d.a{constructor(...e){super(...e),o()(this,"handleClickImportAsana",()=>{B.E(this.environment,{name:"asana",from:this.props.analyticsFrom})}),o()(this,"handleAsanaAuth",async()=>{await Ee.a({environment:this.environment,requestStore:this.props.requestStore})}),o()(this,"handleRemoveAsana",async()=>{await L.disconnectAsana(this.environment,{}),await this.props.requestStore.refresh(),B.fe(this.environment,{name:"asana"})}),o()(this,"handleImportAsanaComplete",async(e,t)=>{const a=G.a.flatten(G.a.values(e.projects)).filter(e=>Boolean(t.find(t=>t.key===e.gid.toString())));B.ic(this.environment,{name:"asana",count:t.length});const i=await async function(e){const{environment:t,projects:a,spaceStore:i,spaceViewStore:s}=e;Z.b({message:ie.importingFromAsanaMessage,interpolatedValues:{importingCount:a.length}}),z.a.setState({open:!1});const n=U.create(t),o=a.map(e=>N.d({environment:t,spaceStore:i,spaceViewStore:s,isPrivate:!0,prepend:!0,loading:!0,title:e.name,transaction:n}));await U.commit({environment:t,transaction:n});try{return await Promise.all(o.map(async(e,i)=>{const s=a[i],{value:n}=await L.importAsana(t,{blockId:e.id,spaceId:e.pointer.spaceId,projectId:s.gid}).next();if(n.error)throw n.error})),Z.a(),o[0]}catch(r){throw U.createAndCommit(t,e=>{for(const t of o)V.f({parent:i.getPagesStore(),remove:t,transaction:e})}),W.showErrorMessage(X.default.formatMessage(ie.asanaImportFailed)),Z.a(),new Error(r)}}({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,projects:a});this.props.onComplete(i)})}renderComponent(){const{asanaResult:e,intl:t}=this.props,{account:a,workspaces:i,projects:n}=e,o=i.map(e=>{const t=n[e.gid]||[];return{key:e.gid.toString(),name:e.name,items:t.map(e=>({key:e.gid.toString(),name:e.name}))}}),r={title:"Asana",logo:oe.a.images.import.asanaPng,caption:a&&a,actionButton:a&&this.props.renderItemActionsButton([{name:t.formatMessage({id:"asanaImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>z.a.setState({open:!0})},{name:t.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleAsanaAuth},{name:t.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveAsana}]),onClick:()=>{}},{device:d}=this.environment;return s()(M.a,{popupType:d.isMobile?M.a.PopupType.SlideUp:M.a.PopupType.Popup,buttonPopupStore:z.a,onClick:this.handleClickImportAsana,render:()=>s()(Se,{searchInputPlaceholder:t.formatMessage({id:"asanaImportOption.search.placeholder",defaultMessage:"Search for a project…",description:"'Project' is an Asana term."}),noSearchResultsPlaceholder:t.formatMessage({id:"asanaImportOption.search.noResultsPlaceholder",defaultMessage:"No projects",description:"'Project' is an Asana term."}),analyticsName:"asana",sections:o,onComplete:t=>this.handleImportAsanaComplete(e,t)}),renderOrigin:({onClick:e})=>l.a.createElement(T,m()({},r,{onClick:a?e:this.handleAsanaAuth}))})}}var De=Object(J.injectIntl)(Be);async function Oe(e){const t=await L.getTrelloBoards(e,{});return"success"===t.type?t.data:(console.error(t.error),{boards:[]})}async function Re(e){const t=await L.getAsanaWorkspaces(e,{});if("success"===t.type){const{account:e}=t.data;return e?t.data:{workspaces:[],projects:{}}}return console.error(t.error),{workspaces:[],projects:{}}}async function Le(e){try{const t=await L.getEvernoteNotebooks(e,{});if("success"===t.type){const{notebooks:e,userInfo:a}=t.data;return{notebooks:e,userInfo:a}}return console.error(t.error),{notebooks:[],userInfo:void 0}}catch(t){return console.error(t),{notebooks:[],userInfo:void 0}}}var _e=a("2ZkR");class Ue extends d.a{constructor(...e){super(...e),o()(this,"storeTypes",{trelloRequestStore:P.a,asanaRequestStore:P.a,evernoteRequestStore:P.a}),o()(this,"handleFileUploadClick",async e=>{B.E(this.environment,{name:e,from:this.props.analyticsFrom});const t=await async function(e){const{environment:t,pageStore:a,spaceStore:i,isTeamPage:s,spaceViewStore:n,uploadType:o}=e;let r;try{const e=await j.b({multiple:!0,accept:te[o].join(",")});if(0===e.length)return;const l=1===e.length,d=await new Promise((a,i)=>{j.f({environment:t,files:e,bucket:"temporary",preventLimitFreeFileSize:!0,onBatchStart:()=>{Z.b({message:l?ie.uploadingOneFile:ie.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:e.length,percentComplete:0}})},onBatchProgress:({uploadedFiles:t,progressPercent:a})=>{Z.b({message:l?ie.uploadingOneFile:ie.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:t,totalNumberOfFiles:e.length,percentComplete:a}})},onBatchComplete:t=>{Z.b({message:l?ie.uploadingOneFile:ie.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:e.length,percentComplete:100}}),a(t)},onBatchError:i})});let c,u;if(a&&a.isEmptyPage())e.length>1||a.isInsideCollection()?(c=a.id,u="AppendToBlock"):(c=a.id,u="ReplaceBlock");else{const a=U.create(t),o=X.default.formatMessage(ie.importTitle,{date:Object(D.a)().format("ll")}),l=N.d({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!s,prepend:!s,title:o,transaction:a});r=l,c=l.id,u=e.length>1?"AppendToBlock":"ReplaceBlock";const d=O.c();a.postSubmitCallbacks.push(d.resolve),U.commit({environment:t,transaction:a}),await d.promise}const p=d.map((t,a)=>({fileURL:t,fileName:e[a].name}));let m=0;Z.b({message:l?ie.importingOneFile:ie.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:m,totalNumberOfFiles:e.length}});for(const{fileURL:a,fileName:s}of p){if("confluence"===o){const e=L.importConfluenceExport(t,{fileURL:a,fileName:s,pageId:c,spaceId:i.id});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||Z.b(t.value.status)}}else if("AppendToBlock"===u){const{value:e}=await L.importFile(t,{fileURL:a,fileName:s,importType:u,pageId:c,spaceId:i.id}).next();if(e.error)throw e.error}else if("ReplaceBlock"===u){const{value:e}=await L.importFile(t,{fileURL:a,fileName:s,importType:u,pageId:c,spaceId:i.id}).next();if(e.error)throw e.error}m++,Z.b({message:l?ie.importingOneFile:ie.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:m,totalNumberOfFiles:e.length}})}return Z.a(),R.a.createChildStore(i,{table:K.a,id:c})}catch(l){let e;throw Z.a(),U.createAndCommit(t,e=>{r&&V.f({parent:i.getPagesStore(),remove:r,transaction:e})}),e=l.clientData&&l.clientData.type&&ae.a[l.clientData.type]?X.default.formatMessage(ae.a[l.clientData.type],l.clientData.messageValues):X.default.formatMessage(ie.importFailed),W.showErrorMessage(e),l}}({environment:this.environment,pageStore:this.props.pageStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,uploadType:e});t&&this.props.onComplete(t)})}renderComponent(){if(!y.a.state.online)return s()("div",{style:{...Ue.wrapStyle,fontSize:14,color:this.theme.mediumTextColor}},void 0,s()(J.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."}));const{analyticsFrom:e}=this.props;return this.renderRequests(t=>t?s()("div",{style:Ue.wrapStyle},void 0,this.renderOptions(t)):s()("div",{style:"onboarding"===e?{}:Ue.wrapStyle},void 0,s()(k.a,{})))}renderOptions(e){return s()("div",{style:{display:"flex"}},void 0,s()("div",{style:{...Ue.optionsColumnStyle,marginRight:16}},void 0,this.renderEvernoteImportOption(e.evernoteResult),this.renderTrelloImportOption(e.trelloResult),this.renderAsanaImportOption(e.asanaResult),this.renderConfluenceImportOption()),s()("div",{style:{...Ue.optionsColumnStyle,marginRight:16}},void 0,s()(T,{title:s()(J.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown",description:"Button title for importing plain text and/or Markdown content into Notion"}),icon:ne.a.importText,onClick:()=>this.handleFileUploadClick("markdown")}),s()(T,{title:"CSV",icon:ne.a.importCSV,onClick:()=>this.handleFileUploadClick("csv")}),s()(T,{title:"HTML",icon:ne.a.importHTML,onClick:()=>this.handleFileUploadClick("html")}),s()(T,{title:"Word",logo:oe.a.images.import.wordPng,onClick:()=>this.handleFileUploadClick("docx")})),s()("div",{style:Ue.optionsColumnStyle},void 0,s()(T,{title:"Google Docs",logo:oe.a.images.import.googleDocsPng,actionButton:this.renderHelpButtonToURL(Object(Pe.a)("guides.importGoogleDocs")),onClick:()=>this.handleFileUploadClick("gdocs")}),s()(T,{title:"Dropbox Paper",logo:oe.a.images.import.dropboxPaperPng,actionButton:this.renderHelpButtonToURL(Object(Pe.a)("guides.importDropboxPaper")),onClick:()=>this.handleFileUploadClick("dropbox")}),s()(T,{title:"Quip",logo:oe.a.images.import.quipPng,actionButton:this.renderHelpButtonToURL(Object(Pe.a)("guides.importQuip")),onClick:()=>this.handleFileUploadClick("quip")}),s()(T,{title:"Workflowy",logo:oe.a.images.import.workflowyPng,actionButton:this.renderHelpButtonToURL(Object(Pe.a)("guides.importWorkflowy")),onClick:()=>this.handleFileUploadClick("workflowy")})))}renderRequests(e){return s()(I.a,{request:this.environment,performRequest:Oe,requestStore:this.stores.trelloRequestStore,render:(t,a)=>s()(I.a,{request:this.environment,performRequest:Re,requestStore:this.stores.asanaRequestStore,render:(t,i)=>s()(I.a,{request:this.environment,performRequest:Le,requestStore:this.stores.evernoteRequestStore,render:(t,s)=>e(a&&i&&s?{trelloResult:a,asanaResult:i,evernoteResult:s}:void 0)})})})}renderTrelloImportOption(e){return s()(ke,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderAsanaImportOption(e){return s()(De,{asanaResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.asanaRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportOption(){var e;if(e=this.environment,"on"===_e.default.getGroup(e,"confluence-import"))return s()(T,{title:"Confluence",logo:oe.a.images.import.confluencePng,onClick:()=>this.handleFileUploadClick("confluence"),actionButton:this.renderHelpButtonToURL(Object(Pe.a)("guides.importConfluence"))})}renderEvernoteImportOption(e){return s()(xe,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,defaultActionButton:this.renderHelpButtonToURL(Object(Pe.a)("guides.importEvernote")),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderHelpButtonToURL(e){return s()(x.a,{renderTooltip:()=>s()(J.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),render:t=>l.a.createElement(g.a,m()({external:!0,href:e,style:{marginLeft:"auto"}},t),s()(h.a,{icon:ne.a.help}))})}renderItemActionsButton(e){return s()(M.a,{popupType:E.b.Popup,renderOrigin:e=>l.a.createElement(h.a,m()({icon:ne.a.dots},e)),render:t=>{const a={key:"section",render:e=>l.a.createElement(F.a,e),items:e.map(({name:e,action:a})=>({key:e,render:t=>l.a.createElement(f.a,m()({},t,{title:e})),action:()=>{a(),t.close()}}))};return s()(A.b,{menuType:A.b.MenuType.Popup,width:200},void 0,s()(w.a,{type:w.a.Type.Vertical,initialFocus:void 0,sections:[a]}))}})}}o()(Ue,"wrapStyle",{display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240}),o()(Ue,"optionsColumnStyle",{width:240});var je=Ue,Ne=a("/6eU"),Ze=a("d9nj");class We extends d.a{constructor(...e){super(...e),o()(this,"handleModalDismiss",()=>{u.a.setState({open:!1})}),o()(this,"handleImportComplete",e=>{u.a.setState({open:!1}),we.navigateToBlock({environment:this.environment,store:e})})}renderComponent(){const e=u.a.state;return s()(Ne.a,{open:e.open,innerStyle:We.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>s()(r.Fragment,{},void 0,s()("div",{style:We.modalTopbarWrapStyle},void 0,s()("div",{style:We.modalTopbarHeaderStyle},void 0,s()(J.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})),this.renderHelpButton()),s()("div",{},void 0,this.renderImportOptions(e))),onDismiss:this.handleModalDismiss})}renderHelpButton(){return s()(g.a,{href:Object(Pe.a)("guides.import"),onClick:()=>B.C(this.environment,{from:"import"}),external:!0},void 0,s()(Ze.a,{isSmall:!0,icon:ne.a.help,isGray:!0},void 0,s()(J.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})))}renderImportOptions(e){const{currentBlockStore:t,currentSpaceStore:a,currentSpaceViewStore:i,currentUserSettingsStore:n}=c.default.state;if(t&&a&&i&&n)return s()(je,{pageStore:e.open&&e.pageStore?e.pageStore:t,spaceStore:a,spaceViewStore:i,userSettingsStore:n,analyticsFrom:"modal",onComplete:this.handleImportComplete,readOnlyCreditButton:!1})}}o()(We,"wrapStyle",{padding:"24px 36px 24px",minWidth:300}),o()(We,"modalTopbarWrapStyle",{display:"flex",alignItems:"center",marginTop:8,marginBottom:18}),o()(We,"modalTopbarHeaderStyle",{fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:S.a.fontWeight.bold,marginRight:"auto"});t.default=We},"BJ/B":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a("bkwR"),s=a("VkkH"),n=a("S26v"),o=a("tP7q"),r=a("A9TN"),l=a("Wnyi"),d=a("hvW1"),c=a("VBxf"),u=a("y6Dp"),p=a("cw0H"),m=a("RqMp"),g=a("J9+s");const h=Object(g.defineMessages)({authenticatingWithEvernote:{id:"evernoteActions.authenticatingWithEvernote.loadingMessage",defaultMessage:"Authenticating with Evernote…"},titleMessage:{defaultMessage:"Evernote login",id:"evernoteActions.loginPopupModal.title"}});async function f(e){const{environment:t,requestStore:a}=e,g=Object(l.b)(t);let f=Object(o.d)(r.default.domainBaseUrl,{authType:g,userId:t.currentUser.id});f=g.redirectToAuth?f:await Object(l.c)(t,f);const M=await s.a(t,{width:580,height:700,url:f,titleMessage:h.titleMessage});if(!M)return;const y=n.f(M),v=y.query.oauth_token,b=y.query.oauth_verifier;if(!v||!b)return;d.b({message:h.authenticatingWithEvernote});const S=await i.authWithEvernote(t,{requestToken:v,verifier:b});if("failed"===S.type)return console.error(S.error),c.showError(S),void d.a();u.p(t,{name:"evernote"}),await a.refresh(),p.a.setState({open:!0}),m.a.setState({open:!0}),d.a()}},Cihu:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("q1tI"),o=a.n(n),r=a("6f7s"),l=a("lSNA"),d=a.n(l),c=(a("3bBZ"),a("EZe4")),u=a("wldR"),p=a("uN94");class m extends u.a{constructor(...e){super(...e),d()(this,"handleContextMenu",e=>{const{device:t}=this.environment;t.isAndroid||p.default.isOnboarding||Object(c.d)({event:e,context:c.a.EditorContextMenu,callback:()=>{t.isElectron||this.environment.currentUser.isLoggedIn()&&e.preventDefault()}})}),d()(this,"handleDragStart",e=>{e.preventDefault()})}didMount(){window.addEventListener("contextmenu",this.handleContextMenu),window.addEventListener("dragstart",this.handleDragStart)}willUnmount(){window.removeEventListener("contextmenu",this.handleContextMenu),window.removeEventListener("dragstart",this.handleDragStart)}}var g=m,h=(a("Junv"),a("LvDl")),f=a.n(h),M=a("6rsX"),y=a("qHvo"),v=a("v/t1"),b=a("wpmu"),S=a("HRSx"),C=a("jWHj"),T=a("sjR4"),k=a("kNsY"),A=a("VUg7"),w=a("Ucj+"),I=a("fbat"),P=a("PuL6"),F=a("EmAo"),x=a("szb2"),E=a("dgyx"),B=a("HTHG"),D=a("nZ1u"),O=a("Xjxl"),R=a("XfKI"),L=a("w5u6"),_=a("VpIZ");class U extends u.a{constructor(...e){super(...e),d()(this,"didTouchEnd",!1),d()(this,"lastMouseInfo",void 0),d()(this,"handleWindowMouseMove",e=>{if(this.didTouchEnd)return void(this.didTouchEnd=!1);this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY};const{isDragging:t}=y.b.state;t?this.updateDragState():this.updateHoverState(e.target,e.clientX,e.clientY)}),d()(this,"handleWindowMouseMoveThrottled",f.a.throttle(this.handleWindowMouseMove,60)),d()(this,"handleSelectionChange",()=>{const{isDragging:e}=y.b.state;L.default.afterNextFlush(()=>{this.lastMouseInfo&&!e&&this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)})}),d()(this,"handleSelectionChangeThrottled",f.a.throttle(this.handleSelectionChange,60)),d()(this,"handleWindowKeyEvent",()=>{const{isDragging:e}=y.b.state;e&&this.updateDragState()}),d()(this,"handleWindowTouchEnd",()=>{this.didTouchEnd=!0}),d()(this,"handleWindowScroll",()=>{M.j(),this.clearHoverState()}),d()(this,"handleWindowResize",()=>{M.j(),this.clearHoverState()}),d()(this,"handleGlobalMenuIsOpenChange",()=>{const e=I.a.state,t=B.o.state;e.isOpen&&!e.menuIsOpen&&t&&I.a.reset()}),d()(this,"memoizedCanDragCache",new WeakMap),d()(this,"memoizedCanDrag",e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const a=Object(R.p)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,a),a})}leftRightLeeway(){const{device:e}=this.environment;return e.isMobile?9999:0}didMount(){super.didMount();const{device:e}=this.environment;v.a(window,"mousemove",this.handleWindowMouseMoveThrottled),T.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&v.a(window,"touchend",this.handleWindowTouchEnd),v.a(window,"keydown",this.handleWindowKeyEvent),v.a(window,"keyup",this.handleWindowKeyEvent),y.b.addListener(this.handleWindowMouseMoveThrottled),v.a(window,"scroll",this.handleWindowScroll,!0),v.a(window,"resize",this.handleWindowResize),B.o.addListener(this.handleGlobalMenuIsOpenChange),M.i()}willUnmount(){super.willUnmount();const{device:e}=this.environment;v.b(window,"mousemove",this.handleWindowMouseMoveThrottled),T.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&v.b(window,"touchend",this.handleWindowTouchEnd),v.b(window,"keydown",this.handleWindowKeyEvent),v.b(window,"keyup",this.handleWindowKeyEvent),y.b.removeListener(this.handleWindowMouseMoveThrottled),v.b(window,"scroll",this.handleWindowScroll,!0),v.b(window,"resize",this.handleWindowResize),B.o.removeListener(this.handleGlobalMenuIsOpenChange)}updateDragState(){const e=y.b.state;if(!e.isDragging)return;const{draggedStores:t,currentX:a,currentY:i,offsetX:s,offsetY:n,isNativeDrag:o}=e,r={x:a,y:i},l={x:a-s,y:i-n},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],o);if(d.ontoDropZone)y.b.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)y.b.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],a=f.a.tail(d.horizontalDropZones),i=k.a.findSelectableFromStore(t.store);if(i){const s=i.getContextClosestSelectable();let n;return s&&s.props.store!==t.store&&s.props.shouldShowParentHalo&&(n=s.props.store),void y.b.setState({...e,currentDropZone:t,currentHintDropZones:a,currentParentStore:n})}}y.b.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}clearHoverState(){const e=I.a.state;e.isOpen&&!e.menuIsOpen&&I.a.reset()}updateHoverState(e,t,a){const i=I.a.state;if(!i.isOpen||!i.menuIsOpen){const s=this.findHoverMenuTarget(e,t,a);s?i.isOpen&&s.selectable.props.store===i.currentStore||I.a.setState({isOpen:!0,currentStore:s.selectable.props.store,container:s.container,menuIsOpen:!1}):I.a.reset()}}findNearbyDropZones(e,t,a){const{device:i}=this.environment,s=C.a(),{selectableRectMap:n}=w.a.state,o=n.keys();let r=o.next();const l=k.a.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0,c=[];for(;!r.done;){const t=r.value;r=o.next();const l=n.get(t),u=t.getContextSelectableContainer(),p=t.props.dropzoneMustBeWithinHorizontalBound?0:this.leftRightLeeway();if(i.isMobile&&u!==d)continue;if(!u||u.props.disable)continue;const m=t.getReferencePoint(e);if(l&&e.mousePoint.x>=l.left&&e.mousePoint.x<=l.right&&e.mousePoint.y>=l.top&&e.mousePoint.y<=l.bottom&&this.selectableIsDragging(t)&&!s.option)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};const{mousePoint:g}=e;(a?t.props.canNativeDropOnto:t.props.canDropOnto)&&l&&g.x>=l.left&&g.x<=l.right&&g.y>=l.top&&g.y<=l.bottom&&!this.selectableIsDragging(t)&&this.selectableCanAcceptDrop(t,y.a.Onto)&&c.push({selectable:t,direction:y.a.Onto,left:l.left,top:l.top,width:l.width,height:l.height}),(a?t.props.canNativeDropLeft:t.props.canDropLeft)&&l&&m.y>=l.top&&m.y<=l.bottom&&Math.abs(m.x-l.left)<=U.verticalDropZoneMaxHorizontalOffset&&(s.option||!this.selectableIsDragging(t))&&this.selectableCanAcceptDrop(t,y.a.Left)&&c.push({selectable:t,direction:y.a.Left,left:l.left,top:l.top,width:0,height:l.height}),(a?t.props.canNativeDropRight:t.props.canDropRight)&&l&&m.y>=l.top&&m.y<=l.bottom&&Math.abs(m.x-l.right)<=U.verticalDropZoneMaxHorizontalOffset&&(s.option||!this.selectableIsDragging(t))&&this.selectableCanAcceptDrop(t,y.a.Right)&&c.push({selectable:t,direction:y.a.Right,left:l.right,top:l.top,width:0,height:l.height}),(a?t.props.canNativeDropAbove:t.props.canDropAbove)&&l&&m.x>=l.left-U.verticalDropZoneExtraLeftEdgeOffset-p&&m.x<=l.right+p&&(s.option||!this.selectableIsDragging(t))&&this.selectableCanAcceptDrop(t,y.a.Above)&&c.push({selectable:t,direction:y.a.Above,left:l.left,top:l.top,width:l.width,height:0}),(a?t.props.canNativeDropBelow:t.props.canDropBelow)&&l&&m.x>=l.left-U.verticalDropZoneExtraLeftEdgeOffset-p&&m.x<=l.right+p&&(s.option||!this.selectableIsDragging(t))&&this.selectableCanAcceptDrop(t,y.a.Below)&&c.push({selectable:t,direction:y.a.Below,left:l.left,top:l.bottom,width:l.width,height:0})}const u=c.filter(e=>e.direction===y.a.Above||e.direction===y.a.Below),p=f.a.minBy(u,({selectable:t,top:a})=>Math.abs(a-t.getReferencePoint(e).y));let m=u.filter(({top:e})=>Math.abs(e-(p?p.top:0))<=U.competingHorizontalDropZoneMinDist);if(m.length>1){m=m.filter(({selectable:t,left:a,width:i})=>{const s=t.getReferencePoint(e).x;return s>=a-this.leftRightLeeway()&&s<=a+i+this.leftRightLeeway()}),m=f.a.sortBy(m,({left:e})=>e);let t=0;for(;t<m.length-1;t++){const a=m[t+1],i=a.selectable.getReferencePoint(e).x;if(a.left>i)break}m=m.slice(0,t+1),m.reverse()}const g=f.a.map(m,({selectable:e,direction:t})=>({store:e.props.store,direction:t}));let h;const M=c.filter(e=>e.direction===y.a.Onto),v=f.a.minBy(M,e=>e.height);if(v){u.some(t=>{const a=t.selectable.getReferencePoint(e).y;return Math.abs(t.top-a)<U.competingOntoDropZoneVerticalOffset})||(h={store:v.selectable.props.store,direction:v.direction})}let b;const S=c.filter(e=>e.direction===y.a.Left||e.direction===y.a.Right);let T=f.a.minBy(S,t=>{const a=t.selectable.getReferencePoint(e).x;return Math.abs(t.left-a)});if(T){const e=T,t=S.filter(t=>Math.abs(t.left-e.left)<U.verticalDropZoneAmbiguousDist);t.length>0&&(T=f.a.minBy(t,e=>e.left))}if(T){const e=T;u.some(t=>t.top>=e.top&&t.top+t.height<=e.top+e.height)||(b={store:T.selectable.props.store,direction:T.direction})}return{ontoDropZone:h,verticalDropZone:b,horizontalDropZones:g}}findHoverMenuTarget(e,t,a){if(y.b.state.isDragging||D.a.state.isActive||B.o.state)return;const{selectableRectMap:i}=w.a.state,s=O.a.getMembersByDOMOrder().find(t=>{const a=t.getNode();return Boolean(a&&a.contains(e))}),n=T.default.getCurrentDefaultContainer(),o=s||n;if(!o)return;const r=i.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,s=i.get(e);(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===o&&s&&a>=s.top&&a<=s.bottom&&t>=s.left-U.hoverMaxHorizontalOffset&&t<=s.right&&d.push(e),l=r.next()}const c=f.a.sortBy(d,e=>{const t=i.get(e);return t?-t.left:1/0}),u=c.find(e=>{const t=e.getNode();if(t){if(c.find(a=>{if(a!==e){const e=a.getNode();return Boolean(e&&t.contains(e))}return!1}))return!1}return!0});return u?{selectable:u,container:o}:void 0}selectableIsDragging(e){const t=y.b.state;if(!t.isDragging)return;const{draggedStores:a}=t;for(;e;){if(a.indexOf(e.props.store)>=0)return!0;e=e.getContextClosestSelectable()}return!1}selectableCanAcceptDrop(e,t){if(F.a.state.isOpen&&!x.c.state.open)return!1;if(P.a.state.isOpen)return!1;const a=y.b.state,i=a.isDragging?a.draggedStores:[],s=!!a.isDragging&&a.isNativeDrag,n=e.props.store;let o,r,l=!1,d=!1;if(i.find(e=>{const t=A.a.findOutlinerItemFromStore(e);return!!t&&(o=t.props.type,l=t.props.isTopLevelItem,!0)}),t===y.a.Onto&&"collection"===n.getParentTable()){const e=n.getParentId();if(i.find(t=>Boolean(t instanceof b.a&&"collection"===t.getParentTable()&&t.getParentId()===e)))return!1}const c=Boolean(i.find(e=>e.isCollectionView()));if(c&&"collection"===n.getParentTable()&&t!==y.a.Onto&&"bookmarks"!==o)return!1;if(c&&n.isCollectionView()&&t===y.a.Onto)return!1;if(c&&n.isCollectionView()&&!n.recordStoreParent()&&t!==y.a.Onto)return!1;const u=A.a.findOutlinerItemFromStore(n);if(u&&(r=u.props.type,d=u.props.isTopLevelItem),r&&s)return!1;if("bookmarks"===o&&l&&("bookmarks"!==r||!d||t===y.a.Onto))return!1;if("bookmarks"===r&&d&&t!==y.a.Onto&&("bookmarks"!==o||!l))return!1;if("shared"===r&&"shared"!==o&&t!==y.a.Onto)return!1;if("shared"===o&&"shared"!==r&&i.some(e=>!e.isTopLevel()))return!1;if(r&&d&&t!==y.a.Onto){if(i.find(e=>{const t=e.getType();return Boolean(!t||!S.r[t])}))return!1}const{device:p}=this.environment;if(r&&p.isMobile&&t===y.a.Onto&&d)return!1;if(i.find(e=>Boolean(e instanceof b.a&&e.isInlineCollectionView()))&&(t===y.a.Left||t===y.a.Right))return!1;if(i.some(e=>Boolean(E.a.findCollectionTemplatePickerItemFromStore(e)))!==Boolean(E.a.findCollectionTemplatePickerItemFromStore(n)))return!1;if(t===y.a.Onto&&n&&!Object(R.q)({environment:this.environment,blocks:[n],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(i))return!1;if(i.some(e=>e.isTransclusionType())){if(n.findRecordStoreAncestor(e=>{if(e===n)return!1;const t=e.getValue();return t&&Object(_.J)(t)}).ancestor)return!1}return!0}}d()(U,"verticalDropZoneMaxHorizontalOffset",200),d()(U,"hoverMaxHorizontalOffset",150),d()(U,"competingOntoDropZoneVerticalOffset",7),d()(U,"verticalDropZoneExtraLeftEdgeOffset",14),d()(U,"verticalDropZoneAmbiguousDist",20),d()(U,"competingHorizontalDropZoneMinDist",2);var j=U,N=a("FcJC"),Z=a("QcDD"),W=a("68VB"),V=a("UcZb");class z extends u.a{constructor(...e){super(...e),d()(this,"cachedPageViewRect",void 0),d()(this,"previousMousePosition",void 0),d()(this,"mouseSpeed",1/0),d()(this,"timerId",void 0),d()(this,"setPreviousMousePosition",(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.previousMousePosition=void 0},100)}),d()(this,"handleWindowMouseMove",e=>{Object(c.d)({event:e,context:c.a.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const{sidebarMinTriggerWidth:t,sidebarOpenWidthPercent:a}=z,i=V.c.state,s=V.e.state,n=e.clientX,o=this.cachedPageViewRect.left,r=Math.max(o*a,t);n<r&&!x.c.state.open&&this.mouseSpeed<z.mouseSpeedThreshold&&0!==this.mouseSpeed&&!i&&N.open(),n>s&&n>r&&i&&N.close()}}})}),d()(this,"handleWindowMouseOut",e=>{e.toElement||e.relatedTarget||N.close()}),d()(this,"updatePageViewRectThrottled",f.a.throttle(this.updatePageViewRect,500))}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",this.handleWindowMouseOut)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",this.handleWindowMouseOut)}updatePageViewRect(){const e=this.getPageViewWrapEl();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}getPageViewWrapEl(){const{currentBlockStore:e}=Z.default.state,t=W.a.find(t=>t.props.store===e);if(t){const e=t.getContentWrapEl();if(e)return e}}}d()(z,"sidebarOpenWidthPercent",.38),d()(z,"sidebarMinTriggerWidth",18),d()(z,"mouseSpeedThreshold",5);var q=z,H=(a("E9XD"),a("mcFc")),G=a("bPtJ"),K=a("bkwR"),Y=a("AvkE"),Q=a("A9TN"),J=a("H4VD"),X=a("OUVA"),$=a("bK/N"),ee=a("D2XV"),te=a("Wae9"),ae=a("CpD0"),ie=a("JuT7"),se=a("Ko8Q"),ne=a("J9+s"),oe=a("7TLZ"),re=a("gHFd");class le extends u.a{constructor(...e){super(...e),d()(this,"lastEmitValue",-1),d()(this,"handleNotificationEmit",async(e,t)=>{if(t===this.lastEmitValue)return;this.lastEmitValue=t;const a=await K.getUserNotifications(this.environment,{size:21});if("failed"===a.type)return;const{results:i}=a.data;te.a.setState({results:i}),this.syncInitialBadgeNumber();const s=f.a.union.apply(null,i.map(e=>e.unreceived.notificationIds));for(const n of s)this.displayNotification(n)}),d()(this,"handleNotificationEmitThrottled",f.a.throttle(this.handleNotificationEmit,1e3)),d()(this,"handleNotificationEmitWhenActive",(e,t)=>{ae.a.whenActive(()=>{this.handleNotificationEmitThrottled(e,t)})}),d()(this,"listenerReference",void 0),d()(this,"updateBadgeNumbers",()=>{const{results:e}=te.a.state,{mobileNative:t}=this.environment,a=e.reduce((e,t)=>e+t.unread.mentions,0);t&&t.setBadgeNumber(a),a>0?$.setBadge("".concat(a)):$.setBadge("")}),d()(this,"syncInitialBadgeNumber",f.a.once(this.updateBadgeNumbers))}willMount(){this.startMessageListeners(),te.a.addListener(this.updateBadgeNumbers)}willUnmount(){this.stopMessageListeners(),te.a.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=Z.default.state;if(e){const t=Object(se.f)(e.id);this.listenerReference=ie.a.addListener(t,this.handleNotificationEmitWhenActive,void 0)}}stopMessageListeners(){this.listenerReference&&ie.a.removeListener(this.listenerReference)}async displayNotification(e){const t=Object(G.c)(this.props.rootStore,{table:H.a,id:e});await t.load();const a=t.getValue();if(!a)return;const i=Object(oe.b)(t,a.activity_id,a.space_id);await i.load();const s=i.getValue(),{currentUserStore:n,currentSpaceViewStore:o}=Z.default.state;if(n&&o&&s&&!s.invalid&&!Y.k(s,n.id)&&await $.shouldSendNotification()&&"undefined"!=typeof Notification){await o.load();const e=o.getValue();if(!e)return;if(!Y.l(s))return;if(!e.notify_desktop)return;if(!this.environment.device.isDesktop)return;const a=(0,(await re.deps.desktop.loader()).PushNotification)({activity:s,getRecordValue:t.getRecordValue,userTimeZone:ee.m,intl:this.props.intl});if(!a)return;const{subject:i,body:n}=a;new Notification(i,{body:n,silent:!0}).addEventListener("click",()=>{const e=Y.j({activity:s,getRecordValue:t.getRecordValue,baseUrl:Q.default.domainBaseUrl}),a=Y.f(s),i=Object(X.b)(e,[a,"desktop_push"]);J.navigate({environment:this.environment,url:i})})}}}var de=Object(ne.injectIntl)(le),ce=a("z8HZ");class ue extends u.a{constructor(...e){super(...e),d()(this,"handleOpen",()=>{ce.a.setState({open:!0})}),d()(this,"handleClose",()=>{ce.a.setState({open:!1})})}willMount(){$.inPageSearch.started.addListener(this.handleOpen),$.inPageSearch.stopped.addListener(this.handleClose)}willUnmount(){$.inPageSearch.started.removeListener(this.handleOpen),$.inPageSearch.stopped.removeListener(this.handleClose)}}var pe=ue,me=a("hi+p"),ge=a("VOS9"),he=a("wXH4"),fe=a("y6Dp"),Me=a("2Y+N"),ye=a("dXb3"),ve=a("gbGO"),be=a("VyA+"),Se=a("0hFN"),Ce=a("fwa5"),Te=a("KTXS"),ke=a("nPEg"),Ae=a("0CAA"),we=a("Qc3L");class Ie extends u.a{constructor(...e){super(...e),d()(this,"renderOverlay",()=>{const{device:e}=this.environment,t=Ce.a.state;if(!t.isActive)return;const{originBlockRect:a,actions:i,inputValue:n}=t,r={environment:this.environment,blocks:t.stores,originRect:a},l=t.showInput&&this.renderInputSection(),d=t.stores[0];let c;return c=e.isPhone?{menuType:ve.b.MenuType.Modal,title:s()(ne.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:s()(ke.DoneMenuText,{}),onClickRight:this.handleOverlayBgClick,header:l}:{menuType:ve.b.MenuType.Popup,width:220,header:l},s()(be.a,{capture:!0,onBackspace:f.a.identity},void 0,o.a.createElement(ve.b,c,s()(ge.a,{filter:n,context:r,sections:i,onAccept:this.handleAccept,initialFocus:n?0:void 0}),!n&&this.renderBlockAuthorInfo(),!n&&s()(we.a,{store:d}),!n&&d.isCollectionView()&&this.renderCollectionHelpButton()))}),d()(this,"handleOverlayBgClick",()=>{me.a()}),d()(this,"handleAccept",e=>{const t=Ce.a.state;if(!t.isActive)return;const{stores:a}=T.default.state,{analyticsFrom:i}=t,s=a[0];if(s){const t=s.getValue();t&&fe.q(this.environment,{analyticsName:e.analyticsName,from:i,block_type:t.type})}e.closeParentMenu&&me.a()}),d()(this,"handleInputChange",e=>{Ce.a.state.isActive&&Ce.a.setState({...Ce.a.state,inputValue:e.target.value})})}renderComponent(){const{device:e}=this.environment,t=Ce.a.state;return s()(he.c,{popupType:e.isPhone?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:this.handleOverlayBgClick,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Start,originGap:0,preventScaleTransition:!0,render:this.renderOverlay,preventBlockRenderQueueOnEnter:e.isMobile})}renderBlockAuthorInfo(){const e=Ce.a.state;if(e.isActive&&!(e.stores.length>1))return s()(Se.a,{store:e.stores[0],isPageMoreButton:!1})}renderInputSection(){const{device:e}=this.environment,{intl:t}=this.props,a=Ce.a.state;if(!a.isActive||e.isPhone)return;const{inputValue:i}=a;return s()(Me.a,{isInput:!0},void 0,s()(ye.a,{value:i,onChange:this.handleInputChange,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Filter actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0}))}renderCollectionHelpButton(){return s()(Me.a,{topBorder:!0,disableDesktopPadding:!0},void 0,s()(Te.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:Object(Ae.a)("guides.database"),analyticsFrom:"block_menu"}))}}var Pe=Object(ne.injectIntl)(Ie),Fe=a("yNyh"),xe=a("OYeE"),Ee=a("aEEb");class Be extends u.a{constructor(...e){super(...e),d()(this,"handleOverlayBgClick",e=>{xe.a.setState({...xe.a.state,active:!1,stringValue:""})})}renderComponent(){const{device:e}=this.environment,{active:t,stringValue:a}=xe.a.state,i=window.innerWidth/2-150,n=window.innerHeight/2;return s()(he.c,{popupType:e.isMobileNative?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t,originRect:{top:n,left:i},onDismiss:this.handleOverlayBgClick,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Start,originGap:0,render:()=>s()(be.a,{capture:!0,onEnter:f.a.identity,onCommandEnter:f.a.identity,onCommandShiftEnter:f.a.identity,onCommandSlash:f.a.identity,onDelete:f.a.identity,onBackspace:f.a.identity,onEsc:f.a.identity,onLeft:f.a.identity,onRight:f.a.identity,onUntab:f.a.identity,onTab:f.a.identity,onSelectAll:f.a.identity,onRedo:f.a.identity,onUndo:f.a.identity,onToggleBold:f.a.identity,onToggleItalics:f.a.identity,onToggleStrike:f.a.identity,onToggleCode:f.a.identity,onCut:f.a.identity,onCopy:f.a.identity,onPaste:f.a.identity,onKeypress:f.a.identity},void 0,s()("div",{style:{padding:8,width:300}},void 0,s()(Fe.b,{style:{width:"100%",fontSize:12},value:a,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),s()(Ee.a,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"}},void 0,s()(ne.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"}))))})}}var De=Be,Oe=a("i8i4"),Re=a.n(Oe);class Le extends u.a{didMount(){super.didMount();const e=Re.a.findDOMNode(this);e&&e instanceof Element&&this.props.ghostElement.forEach(({cloned:t},a)=>{e.children[a].appendChild(t)})}renderComponent(){return s()("div",{},void 0,this.props.ghostElement.map(({rect:{left:e,top:t,width:a,height:i}},n)=>s()("div",{style:{position:"absolute",top:t,left:e,width:a,height:i,opacity:this.environment.device.isMobile?.25:.4,pointerEvents:"none"}},n)))}}var _e=Le,Ue=a("fHgN");class je extends u.a{constructor(...e){super(...e),d()(this,"renderGhost",()=>{const e=y.b.state;if(!e.isDragging)return;const t=e.draggedStores.map((t,a)=>s()(_e,{store:t,ghostElement:e.ghostElements[a]},"".concat(a)));return s()("div",{style:this.getGhostStyle()},void 0,t)}),d()(this,"isDragging",this.createComputedStore(()=>y.b.state.isDragging))}renderComponent(){return s()(Ue.a,{open:this.isDragging.state,render:this.renderGhost})}getGhostStyle(){const e=y.b.state;if(!e.isDragging)return;const{startX:t,startY:a,currentX:i,currentY:s}=e,n=s-a;return{position:"absolute",top:0,left:0,transform:"translate3d(".concat(i-t,"px, ").concat(n,"px, 0)")}}}var Ne=je,Ze=a("pVnL"),We=a.n(Ze),Ve=a("M64d"),ze=a("ikHm"),qe=a("NOLh"),He=a("LoBg"),Ge=a("Iece"),Ke=a("Sb6f"),Ye=a("EtGu"),Qe=a("zmp8"),Je=a("d9nj"),Xe=a("T1kp");class $e extends u.a{constructor(...e){super(...e),d()(this,"rootEl",void 0),d()(this,"animatedEl",void 0),d()(this,"renderOverlay",()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:a}=Ye.a.state;if(!a)return;const i=window.innerWidth,n=window.innerHeight,r=n-2*$e.edgePadding;let l=i-2*$e.edgePadding,d=l/a.width*a.height;if(d>r){const e=d/r;d/=e,l/=e}const c=(i-l)/2,u=(n-d)/2,p={translateX:a.left,translateY:a.top,width:a.width,height:a.height},m={translateX:c,translateY:u,width:l,height:d};let g;return t&&(g=t()),Object(Ve.a)(t=>s()(be.a,{capture:e,onEsc:this.handleClose,onEnter:f.a.identity,onSpace:this.handleClose,onCommandEnter:this.handleClose,onCommandShiftEnter:f.a.identity,onCommandSlash:f.a.identity,onUp:f.a.identity,onDown:f.a.identity,onDelete:f.a.identity,onBackspace:f.a.identity,onLeft:f.a.identity,onRight:f.a.identity,onUntab:f.a.identity,onTab:f.a.identity,onSelectAll:f.a.identity,onRedo:f.a.identity,onUndo:f.a.identity,onToggleBold:f.a.identity,onToggleItalics:f.a.identity,onToggleStrike:f.a.identity,onToggleCode:f.a.identity,onCut:f.a.identity,onCopy:f.a.identity,onPaste:f.a.identity,onKeypress:f.a.identity},void 0,s()(He.a,{capture:e},void 0,o.a.createElement("div",We()({onClick:this.handleClose,ref:e=>{this.rootEl=e},style:this.getStyle(e)},t),s()(qe.a,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:.8},render:()=>s()("div",{style:$e.backgroundStyle}),onAnimationEnd:this.handleBackgroundAnimationEnd}),o.a.createElement(qe.a,{ref:e=>{this.animatedEl=e},isVisible:e,enterAnimationStyle:p,exitAnimationStyle:p,animationStyle:m,springConfig:{translateX:$e.springConfig,translateY:$e.springConfig,width:$e.springConfig,height:$e.springConfig},render:()=>s()("div",{style:$e.fullScreenNodeWrapStyle},void 0,g),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}),s()("div",{style:this.getCloseButtonStyle(e)},void 0,s()(Je.a,{onClick:this.handleClose,style:{color:"#fff"}},void 0,s()(ne.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label",description:"Shown in the top right corner when viewing an asset (image, file, etc.) in full screen mode, to close out of full screen mode."})))))))}),d()(this,"handleClose",()=>{Xe.a(),M.e(this.environment)}),d()(this,"handleResize",()=>{const{isOpen:e}=Ye.a.state;e&&this.enqueueForceUpdate()}),d()(this,"handleFrameScrollerUpdate",()=>{this.updateRootElFromScroll()}),d()(this,"handleBackgroundAnimationEnd",()=>{const{isOpen:e}=Ye.a.state;e||Ye.a.setState({...Ye.a.state,backgroundAnimationComplete:!0})}),d()(this,"handleFullscreenNodeAnimationEnd",()=>{const{isOpen:e}=Ye.a.state;e||Ye.a.setState({...Ye.a.state,fullscreenNodeAnimationComplete:!0})})}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize),Ge.a.addListener(this.handleFrameScrollerUpdate)}didMountOrUpdate(){super.didMountOrUpdate(),this.updateRootElFromScroll()}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),Ge.a.removeListener(this.handleFrameScrollerUpdate)}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:a}=Ye.a.state;return s()(Ue.a,{open:e||!t||!a,render:this.renderOverlay})}getRenderedEl(){const e=Re.a.findDOMNode(this.animatedEl);if(e)return e.childNodes[0]}updateRootElFromScroll(){if(this.getRenderedEl()){const{scrollTop:e}=Ge.a.state,{startScrollTop:t}=Ye.a.state,a=e-t;this.rootEl.style.transform="translateY(".concat(-a,"px)")}}getStyle(e){return{zIndex:ze.m,position:"fixed",top:0,left:0,right:0,bottom:0,pointerEvents:e?"auto":"none",cursor:"zoom-out"}}getCloseButtonStyle(e){const{WindowSizeStore:t}=this.environment;return{position:"absolute",top:t.getSafePaddingBottomCSS(16),right:t.getSafePaddingRightCSS(18),display:e?"block":"none",fontWeight:Ke.a.fontWeight.medium}}}d()($e,"edgePadding",32),d()($e,"springConfig",{stiffness:65,damping:10,precision:.001}),d()($e,"fullScreenNodeWrapStyle",{position:"absolute",top:0,left:0,display:"flex"}),d()($e,"backgroundStyle",{position:"absolute",top:0,left:0,right:0,bottom:0,background:Qe.g.black});var et=$e,tt=a("vX3W"),at=a("cgvQ"),it=a("t3i2"),st=a("G4GV"),nt=a("UZfs"),ot=a("APM9"),rt=a("2m/B"),lt=a("LeVO"),dt=a("FIf6"),ct=a("p+Y9"),ut=a("R+Q+"),pt=a("fCO4"),mt=a("T4gQ"),gt=a("mF3+"),ht=a("Cycz"),ft=a("mVDJ"),Mt=a("r8MX"),yt=a("cX/5"),vt=a("MeYt"),bt=a("bxQm"),St=a("prF1"),Ct=a("1y3T"),Tt=a("Pl3d"),kt=a("4HCU"),At=a("wlCD"),wt=a("IYZQ"),It=a("SR/M"),Pt=a("VVDu"),Ft=a("7M94"),xt=a("vl8/"),Et=a("5FB0"),Bt=a("5w/s");const Dt=Object(ne.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});class Ot extends u.a{constructor(...e){super(...e),d()(this,"storeTypes",{embedInputStore:st.a,emojiInputStore:st.a,emojiPickerStore:ft.a,unsplashInputStore:st.a}),d()(this,"renderUnsplashResults",(e,t,a,i)=>i?!a||a&&!a.length?s()(nt.a,{shouldWrapCaption:!0,caption:s()(ne.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):s()(n.Fragment,{},void 0,a.map(t=>this.renderUnsplashImage(e,t)),s()(nt.a,{shouldWrapCaption:!0,caption:s()(ne.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}})):s()("div",{style:this.getLoadingContainerStyle()},void 0,s()(At.a,{}))),d()(this,"renderUnsplashImage",(e,t)=>{const{device:a}=this.environment;return s()("div",{style:{width:a.isMobile?"33%":"25%",padding:3}},t.id,s()(vt.a,{hoveredStyle:{opacity:.85},onClick:()=>this.handleSelectUnsplashImage(e,t)},void 0,s()(rt.a,{src:t.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})),s()(Ee.a,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4}},void 0,s()(ne.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",description:"Caption attributing the author of the Unsplash image",values:{authorName:t.authorName,inlinetextlink:(...e)=>s()(wt.a,{external:!0,href:t.unsplashUrl},void 0,e)}})))}),d()(this,"handleEmbedSubmit",e=>()=>{const t=this.stores.embedInputStore.state.inputValue;t&&e.onChange(t)}),d()(this,"handleSelectUnsplashImage",async(e,t)=>{const a=await Object(Et.b)({environment:this.environment,url:t.downloadUrl,method:"GET",json:!0});"success"===a.type&&e.onChange({url:a.data.url})}),d()(this,"handleSwipeLeft",()=>{if(!yt.a.state.isActive)return;const e=this.getTabs(),t=e.map(e=>e.type).indexOf(yt.a.state.currentTab),a=e[t+1];void 0!==a&&this.handleTabChange(a.type)}),d()(this,"handleSwipeRight",()=>{if(!yt.a.state.isActive)return;const e=this.getTabs(),t=e.map(e=>e.type).indexOf(yt.a.state.currentTab),a=e[t-1];void 0!==a&&this.handleTabChange(a.type)}),d()(this,"handleTabChange",e=>{yt.a.state.isActive&&yt.a.setState({...yt.a.state,currentTab:e})}),d()(this,"handleRandomEmojiClick",()=>{const{device:e}=this.environment,t=this.getTabs().find(e=>e.type===this.props.currentTab);if(t&&"emoji"===t.type){const a=Object(Bt.c)();t.onChange(a,{keepVisible:!e.isMobile})}}),d()(this,"handleEmojiFilterChange",e=>{const{emojiInputStore:t,emojiPickerStore:a}=this.stores;t.setState({...t.state,inputValue:e.currentTarget.value}),a.setState({...a.state,loadEmojiCount:ft.a.emojisPerPage})})}renderComponent(){const{device:e}=this.environment,t=this.renderTabsHeader(),a=this.renderInputHeader(),i=(t||a)&&s()(n.Fragment,{},void 0,t,a);let r;return e.isMobile?r={menuType:ve.b.MenuType.Modal,title:this.props.title,header:i,right:s()(ne.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&s()(ne.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete}:(r={menuType:ve.b.MenuType.Popup,header:i},r.width=this.props.popupWidth||300,r.height=this.props.popupHeight,r.maxHeight=this.props.maxHeight,r.maxWidth=this.props.maxWidth),s()(pt.a,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>o.a.createElement(ve.b,We()({},r,e,{className:Ft.L}),this.renderCurrentTab())})}renderTabsHeader(){const{device:e}=this.environment;if(!(this.getTabs().length<=1)||this.props.onDelete){const t={gallery:s()(ne.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:s()(ne.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:s()(ne.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:s()(ne.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),unsplash:s()(n.Fragment,{},void 0,gt.a.unsplashLogo({width:12,marginRight:4,height:12}),s()("span",{},void 0,"Unsplash")),drive:s()(ne.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"})},a=this.getTabs(),i=a.findIndex(e=>e.type===this.props.currentTab),o=a.map(e=>e.title||t[e.type]),r=a.find(e=>e.type===this.props.currentTab),l=r&&"emoji"!==r.type&&e.isAndroid;return s()(ut.a,{tabs:o,selectedIndex:i,onChange:e=>{const t=a[e];this.handleTabChange(t.type)},right:s()(n.Fragment,{},void 0,r&&"emoji"===r.type&&s()(Je.a,{isGray:!0,icon:gt.a.random,onClick:this.handleRandomEmojiClick},void 0,s()(ne.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"})),this.props.onDelete&&!e.isMobile&&s()(Je.a,{isGray:!0,onClick:this.props.onDelete},void 0,s()(ne.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"}))),style:{...l&&{borderBottom:"none"}}})}}renderInputHeader(){const{device:e}=this.environment,t=this.getTabs().find(e=>e.type===this.props.currentTab),a=!e.isMobile||void 0;if(t&&"emoji"===t.type)return s()("div",{style:{margin:e.isMobile?0:"10px 0"}},void 0,s()(ye.a,{value:this.stores.emojiInputStore.state.inputValue,focusInitial:a,placeholder:xt.default.formatMessage(Dt.filterPlaceholder),showClearButton:!0,left:gt.a.searchThick(this.getSearchIconStyle()),onChange:this.handleEmojiFilterChange,style:{...e.isAndroid&&{borderBottom:"none"}}}))}renderCurrentTab(){const e=this.getTabs().find(e=>e.type===this.props.currentTab);if(!e)return s()(ne.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return this.renderUploadTab(e);case"emoji":return this.renderEmojiTab(e);case"gallery":return this.renderGalleryTab(e);case"unsplash":return this.renderUnsplashTab(e);case"drive":return this.renderGoogleDriveTab(e)}}renderEmojiTab(e){return s()(ot.a,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue,store:this.stores.emojiPickerStore,isCallout:this.props.isCallout})}renderGalleryTab(e){return s()("div",{style:{paddingBottom:8}},void 0,f.a.map(it.a,(t,a)=>s()(Me.a,{title:s()(St.a,{style:{marginLeft:-5},href:t.url,external:!0},void 0,s()(bt.a,{},void 0,xt.default.formatMessage(t.title))),isTitleUppercase:!0,noTextOverflow:!0},a,s()("div",{style:this.getGalleryWrapStyle()},void 0,t.items.map(({coverUrl:t,title:a,subtitle:i,position:n},r)=>s()("div",{style:{width:"25%",padding:3}},r,s()(lt.a,{originGap:0,placement:lt.a.Placement.Bottom,delayThreshold:600,renderTooltip:()=>s()("div",{style:{maxWidth:180,whiteSpace:"normal"}},void 0,s()("span",{style:{color:this.theme.regularInvertedTextColor}},void 0,xt.default.formatMessage(a))," ",s()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,i&&xt.default.formatMessage(i))),render:a=>o.a.createElement(vt.a,We()({hoveredStyle:{opacity:.85}},a,{onClick:()=>{e.onChange({url:t,position:n})}}),s()(Ct.a,{url:t,width:200,isAuthenticated:!1,render:(e,t)=>t&&s()(rt.a,{src:t,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center ".concat(100*(n||0),"%"),borderRadius:3}})}))})))))))}renderUnsplashTab(e){const{device:t}=this.environment;return s()("div",{style:{paddingBottom:8}},void 0,s()(Me.a,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,s()(ye.a,{value:this.stores.unsplashInputStore.state.inputValue,placeholder:xt.default.formatMessage(Dt.unsplashPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onChange:e=>{this.stores.unsplashInputStore.setState({...this.stores.unsplashInputStore.state,inputValue:e.target.value})}})),s()("div",{style:this.getGalleryWrapStyle()},void 0,s()(Tt.a,{request:this.stores.unsplashInputStore.state.inputValue,debounce:kt.b,performRequest:async e=>{const t=await K.searchUnsplashImages(this.environment,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(t,a,i)=>this.renderUnsplashResults(e,t,a,i)})))}renderUploadTab(e){const{data:t}=Mt.default.state;return s()(n.Fragment,{},void 0,e.fileUpload&&s()(Me.a,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,s()(mt.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),focused:!1,onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&s()(nt.a,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||t&&ht.D(t)&&s()("div",{style:{height:8}}),t&&!e.preventUploadLimitFreeFileSize&&!ht.D(t)&&s()(nt.a,{shouldWrapCaption:!0,caption:s()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,s()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,s()(ne.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:ct.a}})),!p.default.isOnboarding.state&&s()(dt.a,{subscriptionTier:ht.j(this.environment)||"team",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))}))}renderMediaCapture(e){if(e.imageUpload||e.videoUpload)return s()(Me.a,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,e.imageUpload&&s()(mt.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Choose an image",id:"mediaPicker.chooseImage.buttonText"}),focused:!1,onClick:()=>this.handleUpload(e,"image/*"),fullWidth:this.props.isSmallWidth}),e.videoUpload&&s()(mt.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),focused:!1,onClick:()=>this.handleUpload(e,"video/*"),fullWidth:this.props.isSmallWidth}))}renderEmbedTab(e){const{device:t}=this.environment;return s()(n.Fragment,{},void 0,s()(Me.a,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,s()(ye.a,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||xt.default.formatMessage(Dt.embedPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})),s()(Me.a,{},void 0,s()(mt.a,{onClick:this.handleEmbedSubmit(e),focused:!1,title:e.buttonText||s()(ne.FormattedMessage,{defaultMessage:"Embed link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})),e.caption&&s()(nt.a,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}}))}renderGoogleDriveTab(e){return s()(Tt.a,{request:this.environment,performRequest:at.b,render:(t,a,i)=>{if(!i)return s()(Me.a,{},void 0,s()(Pt.a,{}));const n=a&&a.accounts?a.accounts:[];return this.renderGoogleDriveAccounts(e,n)}})}renderGoogleDriveAccounts(e,t){return 0===t.length?s()(Me.a,{},void 0,s()(It.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),s()(nt.a,{shouldWrapCaption:!1,caption:s()(ne.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})):s()(n.Fragment,{},void 0,s()(Me.a,{},void 0,t.map((t,a)=>s()(It.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.accountName}}),onClick:()=>e.onSelect(t),focused:!1},t.accountId))),s()(Me.a,{topBorder:!0},void 0,s()(It.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})))}getTabs(){return this.props.tabs}async handleUpload(e,t){const a=await ct.b({multiple:!1,accept:t});a.length&&e.onUpload(a[0])}getLoadingContainerStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:this.theme.regularIconColor}}getGalleryWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:this.theme.popoverBackground,paddingTop:e.isMobile?12:0,paddingBottom:e.isMobile?12:0,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(14):12,paddingRight:e.isMobile?t.getSafePaddingRightCSS(14):12,boxShadow:e.isMobile?"0 1px 0 ".concat(this.theme.regularDividerColor):""}}}var Rt=Ot;class Lt extends u.a{constructor(...e){super(...e),d()(this,"handleCloseOverlay",()=>{tt.a()})}renderComponent(){const{device:e}=this.environment,{state:t}=yt.a;return s()(he.c,{popupType:e.isMobile?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originRect:void 0,originGap:t.isActive?t.originGap:void 0,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,preventScaleTransition:!0,onDismiss:this.handleCloseOverlay,render:()=>{if(t.isActive)return o.a.createElement(Rt,We()({},t,{onCancel:this.handleCloseOverlay}))}})}}var _t=Lt,Ut=a("/mqF"),jt=a("MBf9");class Nt extends u.a{constructor(...e){super(...e),d()(this,"cancelDragTimeout",void 0),d()(this,"handleDragOver",e=>{e.preventDefault(),this.startDrag(e),this.continueDragThrottled(e)}),d()(this,"handleDrop",e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);t.length>0&&jt.createAndCommit(this.environment,e=>{Ut.d({environment:this.environment,files:t,analyticsFrom:"native_drag",transaction:e})})}),d()(this,"startDrag",e=>{Ut.g(this.environment,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&M.e(this.environment)}),d()(this,"continueDrag",e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(this.cancelDrag,this.getCancelDragTimeoutMS()),Ut.e(this.environment,{currentX:e.clientX,currentY:e.clientY})}),d()(this,"continueDragThrottled",f.a.throttle(this.continueDrag,Nt.dragOverThrottleMS)),d()(this,"cancelDrag",()=>{Ut.a(this.environment)})}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}getCancelDragTimeoutMS(){const{device:e}=this.environment;return e.isLinux?2e3:200}}d()(Nt,"dragOverThrottleMS",62.5);var Zt=Nt,Wt=a("X4ZB"),Vt=a("Oy36"),zt=a("fJHT"),qt=a("N34Z"),Ht=a("6BvA"),Gt=a("unoy");class Kt extends u.a{constructor(...e){super(...e),d()(this,"renderPopupContent",()=>s()(Qt,{}))}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:a}=Ht.a.state;return s()(he.c,{popupType:e.isMobile?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:Boolean(t),originRect:a,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,originGap:4,onDismiss:()=>Wt.a(this.environment),render:this.renderPopupContent})}}class Yt extends u.a{constructor(...e){super(...e),d()(this,"handleRecordIconChange",e=>{const{blockStore:t}=Ht.a.state;if(t){const a=t.getIconStore();a&&jt.createAndCommit(this.environment,t=>{qt.d({store:a,value:e,transaction:t})})}})}didMount(){const{blockStore:e}=Ht.a.state;if(!e)return;const t=e.getTitleStore();t&&Gt.k({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=Ht.a.state;if(!t)return;const a=t.getTitleStore();if(!a)return;let i;return i=e.isMobile?{menuType:ve.b.MenuType.ActionSheet}:{menuType:ve.b.MenuType.Popup,width:380},o.a.createElement(ve.b,i,s()("div",{style:this.getWrapStyle()},void 0,this.renderIcon(t),s()(zt.a,{store:a,disabled:!t.canEdit(),onEsc:()=>Wt.a(this.environment),onEnter:()=>Wt.a(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renamePageMenuPopup.input.placeholder"}),style:this.getInputStyle()})))}renderIcon(e){const t={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:"inset 0 0 0 1px ".concat(this.theme.darkDividerColor)};return e.canEdit()?s()(Vt.a,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t,onChange:this.handleRecordIconChange}):s()(Vt.a,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}const Qt=Object(ne.injectIntl)(Yt);var Jt=Kt,Xt=a("Hl/2"),$t=a("I6hv"),ea=a("Gw5o"),ta=a("Cm2F"),aa=a("QTGx"),ia=a("Z1H8");const sa=[$t.a.Open,$t.a.Resolved];class na extends u.a{constructor(...e){super(...e),d()(this,"handleChangeTab",e=>{const t=$t.b.state;t.open&&$t.b.setState({...t,tab:sa[e]})})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:ve.b.MenuType.Modal,title:s()(ne.FormattedMessage,{defaultMessage:"Discussion",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:s()(ke.DoneMenuText,{}),onClickRight:ta.a,whiteBackground:!0}:{menuType:ve.b.MenuType.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:ta.a},s()(He.a,{capture:!0},void 0,s()(ia.a,{capture:!0,render:()=>s()(be.a,{capture:!0,onEsc:ta.a},void 0,o.a.createElement(ve.b,t,this.renderMenuContent()))}))}renderMenuHeader(){const{device:e}=this.environment,t=oe.n(this.props.blockStore).length,a=oe.m(this.props.blockStore).length;return s()(ut.a,{tabs:[s()(ne.FormattedMessage,t?{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:t}}:{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTabEmpty.title"}),s()(ne.FormattedMessage,a?{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:a}}:{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTabEmpty.title"})],selectedIndex:sa.indexOf(this.props.tab),onChange:this.handleChangeTab,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment;if(this.props.tab===$t.a.Open){const t=oe.n(this.props.blockStore);if(t.length){const a=t.map((e,t,a)=>s()(ea.b,{store:e,format:ea.b.Format.Menu,isFirst:0===t,isOnly:1===a.length,discussionLocation:"block_menu",alwaysShowResolve:!0,blockStore:this.props.blockStore,onDismiss:ta.a},e.id)),i=this.props.blockStore.getType(),o=i&&S.q[i];if(e.isMobile&&o){const e=aa.a(this.props.blockStore);return e?s()(n.Fragment,{},void 0,s()("div",{style:{padding:"12px 16px",boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),marginBottom:1}},void 0,s()(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})),a):a}return a}return this.renderEmptyState(s()(ne.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"}))}{const e=oe.m(this.props.blockStore);return e.length?e.map((e,t,a)=>s()(ea.b,{store:e,format:ea.b.Format.Menu,isFirst:0===t,isOnly:1===a.length,discussionLocation:"block_menu",alwaysShowResolve:!0,blockStore:this.props.blockStore,onDismiss:ta.a},e.id)):this.renderEmptyState(s()(ne.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"}))}}renderEmptyState(e){const{device:t}=this.environment;return s()("div",{style:{textAlign:"center",padding:t.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:this.theme.mediumTextColor}},void 0,e)}}var oa=na;class ra extends u.a{constructor(...e){super(...e),d()(this,"renderDiscussionMenu",()=>{if($t.b.state.open)return s()(oa,{rect:$t.b.state.rect,tab:$t.b.state.tab,blockStore:$t.b.state.blockStore})})}renderComponent(){const{device:e}=this.environment,{open:t,rect:a}=$t.b.state;return s()(he.c,{popupType:e.isMobile?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t,originRect:a,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,disableMouseCapture:!0,originGap:4,render:this.renderDiscussionMenu,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:ta.a})}}var la=ra,da=a("VBxf"),ca=a("SeL1"),ua=a("gRnv"),pa=a("74GD"),ma=a("B2+S");class ga extends u.a{constructor(...e){super(...e),d()(this,"renderDiscussionInput",()=>{if(ma.a.state.open){const{blockStore:e,discussionInputStore:t}=ma.a.state;return s()(pa.a,{capture:!0},void 0,s()(ia.a,{capture:!0,render:()=>s()("div",{style:this.getStyle()},void 0,s()(ca.a,{parentStore:e,onCancel:this.handleDismiss,onSubmit:this.handleSubmit,discussionInputStore:t,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1}))}))}}),d()(this,"handleSubmit",()=>{const e=ma.a.state;if(e.open){const t=e.discussionInputStore.state.textStore.getValue();t&&t.length>0&&("inline"===e.type?jt.createAndCommit(this.environment,a=>{ua.c({environment:this.environment,textStore:e.textStore,selection:e.selection,commentTextValue:t,transaction:a})}):"block"===e.type&&jt.createAndCommit(this.environment,a=>{ua.b({environment:this.environment,blockStore:e.blockStore,commentTextValue:t,transaction:a})})),ua.a(this.environment)}}),d()(this,"handleDismiss",()=>{const e=ma.a.state;if(e.open){const t=e.discussionInputStore.state.textStore.getValue();t&&t.length>0?da.showDialog({message:s()(ne.FormattedMessage,{id:"newDiscussionMenu.discardCommentConfirmationDialog.prompt",defaultMessage:"Do you want to discard the comment?"}),showCancel:!0,keepFocus:!0,items:[{label:s()(ne.FormattedMessage,{id:"newDiscussionMenu.discardCommentConfirmationDialog.discardButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>ua.a(this.environment)}]}):ua.a(this.environment)}})}renderComponent(){const{device:e}=this.environment,{open:t,rect:a}=ma.a.state;return s()(he.c,{popupType:e.isMobileNative?he.c.PopupType.SlideUp:he.c.PopupType.Popup,keepFocus:!0,open:t,originRect:a,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,originGap:4,onDismiss:this.handleDismiss,render:this.renderDiscussionInput})}getStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{width:e.isMobileNative?"100%":470,maxWidth:e.isMobileBrowser?"90vw":"100%",paddingTop:8,paddingBottom:e.isAndroid?12:8,paddingLeft:e.isMobileNative?t.getSafePaddingLeftCSS(10):10,paddingRight:e.isMobileNative?t.getSafePaddingRightCSS(10):10}}}var ha=ga,fa=a("qE2X"),Ma=a("SYQx");class ya extends u.a{constructor(...e){super(...e),d()(this,"renderDiscussion",()=>{const{device:e}=this.environment;if(Ma.a.state.open){const{discussionStore:t,discussionInputStore:a,blockStore:i}=Ma.a.state;let n;return n=e.isMobile?{menuType:ve.b.MenuType.Modal,title:s()(ne.FormattedMessage,{defaultMessage:"Discussion",id:"discussion.mobileReplyMenu.title"}),right:s()(ne.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>fa.a(this.environment),whiteBackground:!0}:{menuType:ve.b.MenuType.Popup,width:420,maxWidth:e.isMobileBrowser?"80vw":"100%"},o.a.createElement(ve.b,n,s()(ia.a,{capture:!0,render:()=>s()(ea.b,{store:t,discussionInputStore:a,onDismiss:()=>fa.a(this.environment),format:ea.b.Format.Menu,isFirst:!0,isOnly:!0,discussionLocation:"reply_menu",alwaysShowResolve:!0,blockStore:i})}))}})}renderComponent(){const{device:e}=this.environment,{open:t,rect:a}=Ma.a.state;return s()(he.c,{popupType:e.isMobile?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t,originRect:a,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,originGap:4,onDismiss:()=>fa.a(this.environment),render:this.renderDiscussion})}}var va=ya,ba=(a("SYor"),a("ALSZ")),Sa=a("WgIs"),Ca=a("f0kS"),Ta=a("sbdd"),ka=a("zTdN"),Aa=a("ttM1"),wa=a("wFTq"),Ia=a("9c8K"),Pa=a("cBa6"),Fa=a("awNq"),xa=a("O+wX"),Ea=a("vJXr"),Ba=a("g/Yr"),Da=a("WaiN"),Oa=a("24Pt"),Ra=a("DNgp"),La=a("5/h/"),_a=a("GJWe"),Ua=a("tzmq"),ja=a("daQZ"),Na=a("Ajfl"),Za=a("6nbh"),Wa=(a("B22C"),a("g4rC"));const Va={...Ke.a.textOverflowStyle,fontWeight:Ke.a.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function za(e){const{pageTitle:t}=e;return s()(ne.FormattedMessage,t?{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:s()("span",{style:Va},void 0,t)}}:{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function qa(e){const{pageTitle:t}=e;return s()(ne.FormattedMessage,t?{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:s()("span",{style:Va},void 0,t)}}:{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}u.a;var Ha=a("Pqcg"),Ga=a("5Nka"),Ka=a("uSCg"),Ya=a("/ssM"),Qa=a("G8iD"),Ja=a("CSYU"),Xa=a("+NSf"),$a=a("jVWm");const ei=Object(ne.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),ti=Object(ne.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime",description:"dateTime will be a message representing the date (with or without time) that the user wants to be reminded at, like 'Tomorrow 3pm' or 'Mar 1, 2020'"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title",description:"A label describing that no results have been found."}});class ai extends u.a{constructor(...e){super(...e),d()(this,"storeTypes",{ignoreSelectionAreaStore:Za.a,localPageMentionRequestStore:Ja.a,localCachePageMentionRequestStore:Ja.a}),d()(this,"renderMentionResult",(e,t)=>{const{intl:a}=this.props,i=Da.a.state,n=i.open&&i.insertionType,r={sections:[],nextSectionShouldHaveTopBorder:()=>r.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===n&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder())),r.addSection(this.getDateResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getUserResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getPageResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),("@"===n&&this.filterStore.state||"[["===n)&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder()));const{sections:l}=r;let d,c;if(Ea.a.state.online){const e=i.mentionTypes.user,t=i.mentionTypes.page,s=i.mentionTypes.date;let n="";const o=ei;e&&t&&s?n=a.formatMessage(o.mentionAll):e&&t?n=a.formatMessage(o.mentionPersonPage):e&&s?n=a.formatMessage(o.mentionPersonDate):t&&s?n=a.formatMessage(o.mentionPageDate):e?n=a.formatMessage(o.mentionPerson):s?n=a.formatMessage(o.mentionDate):t&&i&&(n=i.open&&"+"===i.insertionType?a.formatMessage(ei.addPage):a.formatMessage(o.mentionPage)),this.setTemporaryInputData({title:n,icon:this.renderTemporaryInputEmptyIcon(),allowTabCompletion:!1}),d=void 0}else d=s()(ka.a,{title:s()(ne.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===l.length&&(c=s()(Me.a,{},void 0,s()(ka.a,{title:o.a.createElement(ne.FormattedMessage,ti.noResults)})));const{device:u}=this.environment;let p;return p=this.isActionSheet()?{menuType:ve.b.MenuType.ActionSheet,disableBottomPadding:!0}:{menuType:ve.b.MenuType.Popup,width:this.getMenuDesktopWidth(),maxHeight:u.isMobile?"30vh":"40vh",onClickOutside:ba.d},o.a.createElement(ve.b,We()({},p,{header:d}),s()(be.a,{capture:Da.a.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),s()(Sa.a,{type:Sa.a.Type.Vertical,initialFocus:this.getMenuInitialFocus(),sections:l,onEmptyEnter:this.handleCancel}),c)}),d()(this,"handleCreateInAutocompleteQueryChange",e=>{this.updateOpenState({createInQuery:e})}),d()(this,"renderCreateInMenu",()=>{const e=Da.a.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return s()(wa.a,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{ba.b({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:this.handleCreateInAutocompleteQueryChange,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:this.getMenuDesktopWidth(),onCancel:this.handleCreateInCancel})}),d()(this,"handleCreateInStart",()=>{this.updateOpenState({showCreateIn:!0})}),d()(this,"handleCreateInCancel",()=>{this.updateOpenState({showCreateIn:!1,createInQuery:""})}),d()(this,"handleEmptyBackspace",e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.handleCancel()}),d()(this,"handleCancel",()=>{ba.d()}),d()(this,"handleTab",e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const a=Ra.default.state;if("editing"!==a.mode)return;const i=Object($a.a)("MentionMenu",a.multiSelection);if(!i)return;const s=Da.a.state;s.open&&s.textStore===i.store&&jt.createAndCommit(this.environment,e=>{Na.o({environment:this.environment,transaction:e,string:t,store:i.store,selection:i.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})})}),d()(this,"tabCompletionString",void 0),d()(this,"letterCharacterClass",(()=>{try{return/\p{L}/u}catch(e){return/[a-zA-Z]/}})()),d()(this,"inputSelectionsStore",this.createComputedStore(()=>{const e=Da.a.state;if(e.open)return Ia.c(e.textStore,e.oldTextValue,e.insertionType)})),d()(this,"filterStore",this.createComputedStore(()=>{const e=this.inputSelectionsStore.state,t=Da.a.state;if(e&&t.open)return Ia.b(t.textStore,e)})),d()(this,"popupOpenStore",this.createComputedStore(()=>{const e=Da.a.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())})),d()(this,"performUserMentionRequest",async e=>{const t=Da.a.state;if(!t.open)return;const a=t.mentionTypes.user?await this.getUserResults(e):[];return""===e?a.slice(0,2):a.slice(0,20)}),d()(this,"performLocalCachePageMentionRequest",async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=Z.default.state;if(!e)return;return Oa.h({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})}),d()(this,"performLocalPageMentionRequest",e=>{const{localCachePageMentionRequestStore:t}=this.stores,a=t.state.result;if(!a)return;const i=Oa.g({input:e,cache:a});if(!i)return;if(0===i.results.length)return{error:Ya.d.NoResults};const s=B.e();if(!s)return;const n=Oa.n({sort:e.query.sort,unsorted:i.results,batchSize:Qa.b,currentUserId:this.environment.currentUser.id}).results.map(e=>({...e,store:b.a.createChildStore(s,{table:S.a,id:e.id})}));return{value:{total:n.length,results:n}}}),d()(this,"performPageMentionRequest",async e=>{const t=Da.a.state;if(!t.open)return[];const a=t.mentionTypes.page?await this.getPageResults(e):[];return""===e?a.slice(0,2):a.slice(0,20)}),d()(this,"getUserResults",async e=>{if(Ea.a.state.online){return await kt.m({environment:this.environment,query:e,membersOnly:!1})}return[]}),d()(this,"getPageResults",async e=>{if(!Ea.a.state.online)return[];const t=Da.a.state,a=t.open&&Object(oe.p)(t.textStore)&&t.textStore;return await kt.e({nearBlock:a||void 0,environment:this.environment,query:e,source:"mention_menu",limit:20})}),d()(this,"getDateResults",e=>{const t=Da.a.state;if(!t.open)return[];const{intl:a}=this.props,i=t.mentionTypes.reminder;return t.mentionTypes.date?function(e,t,a){if(0===e.length)return f.a.compact([{label:a.formatMessage(ti.autocompleteToday),value:()=>ee.qb(ee.m)},t?void 0:{label:a.formatMessage(ti.autocompleteNextTuesday),value:()=>{const e=ee.rb(ee.m),t=e.clone().day(2);return t.isSameOrBefore(e)&&t.add(1,"week"),t.add(1,"week"),t.hour(15),{type:"datetime",start_date:t.format(ee.lb),start_time:t.format(ee.nb),time_zone:ee.m}}},t?{label:a.formatMessage(ti.autocompleteReminder),value:()=>({type:"datetime",start_date:ee.sb(ee.m).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:ee.w},time_zone:ee.m})}:void 0]);const i=t?Object(Fa.e)(e,a):Object(Fa.d)(e,a);if(i){let e=Object(xa.a)({value:i,date_format:"relative",userTimeZone:ee.m,intl:a,allowRelativeDates:!0});return i.reminder&&(e=a.formatMessage(ti.reminder,{dateTime:e})),[{label:e,value:()=>i}]}return[]}(e,i,a).slice(0,6):[]})}willMountOrUpdate(){const e=Da.a.state,t=this.filterStore.state;if(e.open){var a;const i=Ra.default.state,s="editing"===i.mode?Object($a.a)("MentionMenu",i.multiSelection):void 0,n=(null==s?void 0:s.store)===e.textStore,o=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=o&&"editing"===o.mode&&(null===(a=Object($a.a)("MentionMenu",o.multiSelection))||void 0===a?void 0:a.store)===e.textStore;if(!n&&!r)return void ba.d();const l=n&&(null==s?void 0:s.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void ba.d();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(this.letterCharacterClass))return void ba.d();if(void 0===t)return void ba.d()}}renderComponent(){const{device:e}=this.environment,t=Da.a.state,a=Ba.a.find(e=>e.props.capture),i=this.popupOpenStore.state;let n;if(a&&e.isMobile){const e=a.stores.store.state.rect;e&&(n={height:"calc(100vh - ".concat(e.height,"px)")})}const r=t.open&&t.showCreateIn;return s()(he.c,{popupType:this.isActionSheet()?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:i,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:n,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Start,originGap:8,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,disableDarkOverlayBackground:e.isMobile&&!a,keepFocus:!0,render:()=>e.isMobile?o.a.createElement(o.a.Fragment,null,this.renderMentionSearch(),s()(he.c,{popupType:he.c.PopupType.SlideUp,render:this.renderCreateInMenu,open:r,keepFocus:!0})):r?this.renderCreateInMenu():this.renderMentionSearch()})}renderMentionSearch(){const e=this.getNormalizedFilter(),t=Da.a.state,a=Xa.default.createMetric("rum.mention_menu_ready");return s()(Tt.a,{requestStore:t.userRequestStore,request:e,performRequest:this.performUserMentionRequest,render:i=>s()(Tt.a,{requestStore:t.pageRequestStore,request:e,performRequest:this.performPageMentionRequest,debounce:kt.b,render:t=>s()(Tt.a,{requestStore:this.stores.localCachePageMentionRequestStore,request:Z.default.state.currentSpaceStore&&Z.default.state.currentSpaceStore.id,performRequest:this.performLocalCachePageMentionRequest,render:n=>s()(Tt.a,{requestStore:this.stores.localPageMentionRequestStore,debounce:kt.a,request:{query:{text:e,filters:Ya.f({isDeletedOnly:!1,isNavigableOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:Ya.e.Relevance},limit:5},performRequest:(...e)=>Promise.resolve(this.performLocalPageMentionRequest(...e)),render:e=>this.renderMentionResult(i||t||e,this.getCurrentMentionResults(a))})})})})}getDateResultsMenuSection(e,t){const{dateResults:a}=e;if(0!==a.length)return this.applySectionLimit("date",{key:"date results",render:e=>o.a.createElement(Me.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0})),items:a.map(({label:e,value:t})=>({key:e,render:t=>(t.focused&&this.setTemporaryInputData({title:e,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o.a.createElement(It.a,We()({},t,{title:e}))),action:()=>{jt.createAndCommit(this.environment,e=>{ba.a({environment:this.environment,annotation:["d",{...t(),date_format:"relative"}],transaction:e})})}}))})}renderSpinner(e){return s()(Aa.a,{show:e,showDelay:500,showHold:300,render:e=>s()(At.a,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}renderTemporaryInputEmptyIcon(){const e=Da.a.state;if(e.open)return"+"===e.insertionType?this.renderTemporaryInputAddIcon():s()("span",{style:{width:"1em",display:"inline-block",verticalAlign:"-0.15em",fill:this.theme.mediumIconColor,marginRight:"0.2em"}},void 0,gt.a.searchThick())}renderTemporaryInputAddIcon(){return s()("span",{style:{width:"1em",display:"inline-block",verticalAlign:"-0.15em",fill:this.theme.mediumIconColor,marginRight:"0.2em"}},void 0,gt.a.plus())}renderTemporaryInputPageIcon(e){const t=e.getValue();if(t)return Object(_a.h)({pageValue:t,showEmojiInline:!0,emojiType:Object(Ua.a)(this.environment),baseUrl:Q.default.domainBaseUrl,getRecordValue:e.getRecordValue,isClient:!0,isSafariOrIOS:this.environment.device.isSafari||this.environment.device.isIOS,currentUserId:this.environment.currentUser.id})}renderTemporaryInputAtMentionIcon(){return s()("span",{style:{width:"1em",display:"inline-block",verticalAlign:"-0.15em",fill:this.theme.mediumIconColor,marginRight:"0.2em"}},void 0,gt.a.at())}getUserResultsMenuSection(e,t){const{userResults:a}=e;if(0!==a.length)return this.applySectionLimit("user",{key:"user results",render:e=>o.a.createElement(Me.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0})),items:f.a.compact(a.map(e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:Object(La.e)(this.props.intl,e),icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o.a.createElement(Ca.a,We()({},t,{user:e}))),action:()=>{jt.createAndCommit(this.environment,t=>{ba.a({environment:this.environment,annotation:Object(Pa.o)(e.id),transaction:t})})}})))})}getPageResultsMenuSection(e,t){const{pageResults:a}=e,i=o.a.createElement(o.a.Fragment,null,0===a.length?o.a.createElement(ne.FormattedMessage,ti.noResults):s()(ne.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),this.renderSpinner(Da.a.state.pageRequestStore.state.loading));return this.applySectionLimit("page",{key:"page results",render:e=>o.a.createElement(Me.a,We()({},e,{title:i,topBorder:t,isTitleUppercase:!0})),items:f.a.compact(a.map(e=>{const t=B.e();if(!t)return;const a=b.a.createChildStore(t,{table:S.a,id:e});return{key:e,render:e=>{if(e.focused){const e=a.getValue();if(e){const t=Object(_.j)({table:a.table,value:e,getRecordValue:a.getRecordValue,userTimeZone:ee.m,intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:this.renderTemporaryInputPageIcon(a),allowTabCompletion:!0})}}return o.a.createElement(Ta.a,We()({},e,{store:a}))},action:()=>{jt.createAndCommit(this.environment,t=>{ba.a({environment:this.environment,annotation:["p",e],transaction:t})})}}}))})}getCreatePageMenuSection(e){if(!this.canCreatePage())return;const t=Da.a.state;if(!t.open)return;const{intl:a}=this.props,i=this.getNormalizedFilter(),n="@"===t.insertionType?s()(ne.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>o.a.createElement(Me.a,We()({title:n,isTitleUppercase:!0},t,{topBorder:e})),items:[{key:"add new subpage",action:async()=>{const e=Object(ja.c)(t.textStore);e&&await ba.b({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:e.createInValue,onPageCreated:e=>{e&&""===Pa.ab(e.getTitleValue())&&J.navigateToBlock({environment:this.environment,store:e})}})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===i.length?a.formatMessage(ei.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=t=>o.a.createElement(It.a,We()({},Object(Ka.a)(t||{},e),{icon:gt.a.plus({width:16}),title:s()(qa,{pageTitle:this.getNormalizedFilter()})}));return this.environment.device.isMobile?t():s()(lt.a,{renderTooltip:()=>s()(Ha.a,{imageURL:Ga.a.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:o.a.createElement(ne.FormattedMessage,wa.b.createSubpage)}),placement:lt.a.Placement.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:this.handleCreateInStart,render:e=>{e.focused&&this.setTemporaryInputData({title:0===i.length?a.formatMessage(ei.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=s()(za,{pageTitle:this.getNormalizedFilter()}),n=a=>o.a.createElement(It.a,We()({},Object(Ka.a)(a||{},e),{icon:gt.a.alias({width:16}),title:t}));return this.environment.device.isMobile?n():s()(lt.a,{renderTooltip:()=>s()(Ha.a,{imageURL:Ga.a.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:o.a.createElement(ne.FormattedMessage,wa.b.newPageIn)}),placement:lt.a.Placement.Right,delayThreshold:0,render:e=>n(e)})}}]}}applySectionLimit(e,t){const a=Da.a.state;if(!a.open)return t;if(a.expandSection&&a.expandSection===e)return t;const{items:i}=t,n=this.environment.device.isPhone?3:5;if(i.length<=n)return t;const r=[...i.slice(0,n),{key:"show more",render:e=>o.a.createElement(It.a,We()({},e,{icon:gt.a.dots({width:16,fill:this.theme.mediumTextColor}),title:s()("span",{style:{color:this.theme.mediumTextColor}},void 0,s()(ne.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:i.length-n}}))})),action:()=>{this.updateOpenState({expandSection:e})}}];return{...t,items:r}}updateOpenState(e){const t=Da.a.state;t.open&&Da.a.setState({...t,...e})}getNormalizedFilter(){const e=this.filterStore.state;return e?Da.a.state.open&&"[["===Da.a.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=Da.a.state;if(!t.open)return;if(!e)return void t.temporaryInputData.set(void 0);const{device:a}=this.environment,{title:i,icon:s,allowTabCompletion:n}=e,o=this.filterStore.state||"",r=i.toLowerCase().startsWith(o)?i.slice(o.length):"";this.tabCompletionString=n?r:void 0;const l=a.isFirefox?void 0:s;t.temporaryInputData.set({prefix:t.insertionType,suffix:"[["===t.insertionType&&o.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=Da.a.state,a=t.userRequestStore.state.result||[],i=t.pageRequestStore.state.result||[],s=this.getDateResults(this.getNormalizedFilter());let n=i;const{result:o}=this.stores.localPageMentionRequestStore.state;if(o&&!o.error){const e=o.value.results,t=B.e();n=t?Oa.b({environment:this.environment,isOnline:Ea.a.state.online,results:{local:e,server:i.map(e=>({...e,store:b.a.createChildStore(t,{table:S.a,id:e.id})}))}})||[]:e}const r=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return r&&Xa.default.emit(this.environment,e),{userResults:a,pageResults:n.map(e=>e.id),dateResults:s,ready:r}}canCreatePage(){return!!Da.a.state.mentionTypes.createPage}isActionSheet(){const{device:e}=this.environment;return e.isMobileNative&&!e.isTablet}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}getMenuDesktopWidth(){return 330}}var ii=Object(ne.injectIntl)(ai);var si=a("sQnJ"),ni=a("qxI2"),oi=a("BJyN"),ri=a("GKeo");class li extends u.a{constructor(...e){super(...e),d()(this,"renderMenu",()=>{const{device:e}=this.environment,t=ri.a.state;if(!t.open)return;const a=this.getSections(t),i=this.getFilter(t);let n;return n=e.isMobileNative&&!e.isTablet?{menuType:ve.b.MenuType.ActionSheet}:{menuType:ve.b.MenuType.Popup,width:324,maxHeight:"40vh",onClickOutside:si.d},o.a.createElement(ve.b,n,s()(ge.a,{sections:a,onAccept:this.handleAccept,context:{environment:this.environment,blocks:T.default.state.stores,originRect:t.selectionRect},filter:i,initialFocus:0,onEmptyEnter:this.handleCancel,useLimit:!0}))}),d()(this,"handleCancel",()=>{si.d()}),d()(this,"handleAccept",e=>{const t=T.default.state.stores[0];t&&fe.q(this.environment,{analyticsName:e.analyticsName,from:"slash_menu",block_type:t.getType()}),jt.createAndCommit(this.environment,e=>{si.a({environment:this.environment,transaction:e})})})}willMountOrUpdate(){const e=ri.a.state;if(e.open){const t=Ra.default.state;if("editing"!==t.mode)return!1;const a=Object($a.a)("SlashMenu",t.multiSelection),i=this.getFilter(e),s=Object(ni.b)(this.getSections(e),{blocks:T.default.state.stores,environment:this.environment},i||"");((null==a?void 0:a.store)!==e.textStore||Ia.d(i,!0,s.length))&&si.d()}}renderComponent(){const{device:e}=this.environment,t=ri.a.state;return s()(he.c,{popupType:e.isMobileNative&&!e.isTablet?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu})}getFilter(e){return Ia.a(e.textStore,e.oldTextValue,!e.isAddMenu)}getSections(e){return e.isAddMenu?oi.i:oi.o}}var di=li,ci=a("Wfos"),ui=a("F1uM"),pi=a("udrG"),mi=a("nFzZ"),gi=a("7IvN"),hi=a("tP7q");const fi=Object(ne.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed replit",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"}}),Mi=Object(ne.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),yi={image:xt.default.formatMessage(fi.image),video:xt.default.formatMessage(fi.video),tweet:xt.default.formatMessage(fi.tweet),drive:xt.default.formatMessage(fi.drive),gist:xt.default.formatMessage(fi.gist),figma:xt.default.formatMessage(fi.figma),invision:xt.default.formatMessage(fi.invision),abstract:xt.default.formatMessage(fi.abstract),framer:xt.default.formatMessage(fi.framer),whimsical:xt.default.formatMessage(fi.whimsical),miro:xt.default.formatMessage(fi.miro),sketch:xt.default.formatMessage(fi.sketch),excalidraw:xt.default.formatMessage(fi.excalidraw),replit:xt.default.formatMessage(fi.replit),audio:xt.default.formatMessage(fi.audio),maps:xt.default.formatMessage(fi.maps),loom:xt.default.formatMessage(fi.loom),typeform:xt.default.formatMessage(fi.typeform),codepen:xt.default.formatMessage(fi.codepen),pdf:xt.default.formatMessage(fi.pdf),embed:xt.default.formatMessage(fi.embed)};class vi extends u.a{constructor(...e){super(...e),d()(this,"renderMenu",()=>{const{device:e}=this.environment,t=gi.a.state;if(!t.open)return;const a=this.getSections(t);let i;return i=e.isMobile?{menuType:ve.b.MenuType.ActionSheet}:{menuType:ve.b.MenuType.Popup,width:320,maxHeight:"40vh"},o.a.createElement(ve.b,We()({},i,{className:Ft.z}),s()(Sa.a,{type:Sa.a.Type.Vertical,sections:a,initialFocus:0}))}),d()(this,"handleDismiss",()=>{ci.c()}),d()(this,"handleAccept",e=>{ci.a({environment:this.environment,type:e})})}willMountOrUpdate(){const e=gi.a.state;if(e.open){const t=Ra.default.state,a="editing"===t.mode?Object($a.a)("EmbedMenu",t.multiSelection):void 0;a&&a.store.id===e.textStore.id&&a.selection.endIndex===e.urlSelection.endIndex||ci.c()}}renderComponent(){const{device:e}=this.environment,t=gi.a.state;return s()(he.c,{popupType:e.isMobileNative&&!e.isTablet?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{device:t}=this.environment,{url:a,textStore:i}=e,s=[],n=Object(hi.l)({url:a,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,isMobile:t.isMobile,protocol:Q.default.protocol,currentUrl:window.location.href});if("page"===n.name){const e=b.a.createChildStore(i,{table:S.a,id:n.blockId}),t=n.scrollToBlockId?b.a.createChildStore(i,{table:S.a,id:n.scrollToBlockId}):void 0;s.push({name:xt.default.formatMessage(Mi.createLinkedDatabase),validator:()=>!t&&e.isCollectionView(),type:pi.a.collectionViewPage}),s.push({name:xt.default.formatMessage(Mi.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()),type:"create-transclusion"}),s.push({name:xt.default.formatMessage(Mi.mentionPage),validator:()=>!t,type:"mention-page"}),s.push({name:xt.default.formatMessage(Mi.linkToPage),validator:()=>!t&&!e.isCollectionView(),type:pi.a.page})}const r=mi.j(yi);for(const o of r)"embed"!==o&&s.push({name:yi[o],validator:ui.b[o],type:o});s.push({name:xt.default.formatMessage(Mi.bookmarkMenuItem),validator:ui.i,type:pi.a.bookmark}),s.push({name:yi.embed,validator:ui.b.embed,type:"embed"});return[{key:"embed section",render:e=>o.a.createElement(Me.a,e),items:[{key:"dismiss",render:e=>o.a.createElement(It.a,We()({},e,{title:xt.default.formatMessage(Mi.dismissItem)})),action:this.handleDismiss},...f.a.compact(s.map(({name:e,validator:t,type:i})=>{if(t({url:a,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName})){return{key:"embed ".concat(e),render:t=>o.a.createElement(It.a,We()({},t,{title:e})),action:()=>this.handleAccept(i)}}}))]}]}}var bi=vi,Si=a("RI9y"),Ci=a("ICWk"),Ti=a("i3uR"),ki=a("9hmv"),Ai=a("q8I6"),wi=a("xPzf"),Ii=a("6fCZ"),Pi=a("AjLL"),Fi=a("TDb4"),xi=a("y4kc"),Ei=a("kaWB"),Bi=a("6SEd"),Di=a("NMKT"),Oi=a("vzSY"),Ri=a("0Osm"),Li=a("bk3b"),_i=a("ieCD"),Ui=a("gha2"),ji=a("VcFn"),Ni=a("LEzx");class Zi extends Ni.a{getInitialState(){return{open:!1}}}var Wi=new Zi,Vi=a("5k6+"),zi=a("typy"),qi=a("2bwL"),Hi=a("xstG"),Gi=a("U8Fb");class Ki extends u.a{constructor(...e){super(...e),d()(this,"mouseIsDownExternally",!1),d()(this,"lastRenderState",void 0),d()(this,"renderOverlay",()=>{const{isActive:e}=ji.a.state;return s()(qe.a,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})}),d()(this,"renderAnimated",()=>{const{top:e,left:t}=ji.a.state;return s()("div",{className:Ft.Kb,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"}},void 0,s()("div",{style:{flexShrink:1,width:Math.max(t-Ki.leftOffset,0),minWidth:24}}),Object(Ve.a)(e=>o.a.createElement("div",We()({style:{pointerEvents:"none",padding:12}},e),this.lastRenderState&&this.renderMenu(this.lastRenderState))),s()("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}}))}),d()(this,"updateRichTextState",()=>{const e=ji.a.state;if(_i.a.state.open||Ui.a.state.open)return;if(qi.b.state)return Di.a();const t=Ra.default.state;if("editing"!==t.mode)return Di.a();const a=Object($a.a)("RichTextMenu",t.multiSelection);if(!a)return Di.a();const i=a.store;if(i.table!==S.a&&i.table!==Ei.a&&i.table!==Bi.a)return Di.a();if(!this.environment.currentUser.isLoggedIn()||!i.canComment())return;const s=Si.get();if(!i||B.l())return Di.a();const n=Oi.a.findEditableWithStore(i);if(n&&n.props.disableAnnotation)return Di.a();if(n&&n.props.disabled)return Di.a();const o=n?n.getContextClosestSelectable():void 0,r=o?o.props.store:void 0;if(r&&(r.isLocked()||r.isNavigableAncestorLocked()))return Di.a();if(this.mouseIsDownExternally&&e.blockTarget!==r)return Di.a();let l=!1;if(i.table===S.a){const e=i.getRecordStoreAtRootPath().getValue();e&&(l=Ki.richTextMenuBlockTypesBlacklist[e.type])}if(!i||Ht.a.isActive()||Vi.a.isActive()||Hi.b.isOpen()||l||!s||!this.hasNonCollapsedTextSelection()||Wi.state.open)Di.a();else{let e=0,t=0;const a=Si.getRect(s);if(a&&(e=a.left,t=a.top-Ki.height-25,t<this.getTopbarHeight()))return Di.a();0===Math.abs(ji.a.state.top-t)&&Math.abs(ji.a.state.left-e)<10&&(t=ji.a.state.top,e=ji.a.state.left),ji.a.setState({...ji.a.state,isActive:!0,isAnimatingClosed:!1,top:t,left:e,blockTarget:T.default.state.stores[0]})}}),d()(this,"updateRichTextStateThrottled",f.a.throttle(this.updateRichTextState,200,{leading:!1})),d()(this,"handleAnimationEnd",()=>{ji.a.state.isActive||ji.a.setState({...ji.a.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state}),d()(this,"renderStateStore",this.createComputedStore(()=>{const{isActive:e,blockTarget:t}=ji.a.state,a=Ra.default.state;if(e&&"editing"===a.mode){var i;const e=Ra.default.isEditingComment(),s=Ra.default.isEditingCaption(),n=t&&t.getParentTable()===Bi.a,o=this.pageContext&&this.pageContext.publicEditModeStore.state,r=Object($a.a)("RichTextMenu",a.multiSelection),l=(!o||"edit"===o)&&(null==r||null===(i=r.store)||void 0===i?void 0:i.canEdit()),d=t&&t.getType(),c=d&&Ki.richTextMenuActionsBlacklist[d],u={showTurnInto:Boolean(!e&&!n&&!s&&t&&l),showBold:Boolean(l),showItalic:Boolean(l),showStrikethrough:Boolean(l),showUnderline:Boolean(l),showCode:Boolean(l),showLink:Boolean(l),showHighlight:Boolean(l&&!e),showDiscuss:Boolean(!e&&t&&!n),showEquation:Boolean(l),showMention:Boolean(!e&&t&&!n&&l),showActionButton:Boolean(!e&&!s&&t&&!n),blockTarget:t,isComment:e};if(c&&c.size>0)for(const t of c)u[t]=!1;return u}}))}didMount(){T.default.addListener(this.updateRichTextStateThrottled),Ra.default.addListener(this.updateRichTextStateThrottled),Ge.a.addListener(this.updateRichTextState),Ri.a.addListener(this.updateRichTextState),Li.a.addListener(this.updateRichTextState)}willUnmount(){Ra.default.removeListener(this.updateRichTextStateThrottled),T.default.removeListener(this.updateRichTextStateThrottled),Ge.a.removeListener(this.updateRichTextState),Ri.a.removeListener(this.updateRichTextState),Li.a.removeListener(this.updateRichTextState)}willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=ji.a.state;return s()(Ue.a,{open:e||t,render:this.renderOverlay})}renderMenu(e){const{isActive:t}=ji.a.state;return s()("div",{style:{display:"inline-flex",alignItems:"stretch",height:Ki.height,background:this.theme.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:3,boxShadow:this.theme.mediumBoxShadow,pointerEvents:t?"auto":"none"},onMouseDown:e=>e.preventDefault()},void 0,e.showTurnInto&&e.blockTarget&&this.renderTurnInto(e.blockTarget),e.showLink&&this.renderLinkButton(!0),e.showDiscuss&&e.blockTarget&&this.renderCommentButton(e.blockTarget),s()("div",{style:{display:"flex"}},void 0,e.showBold&&this.renderBoldButton(),e.showItalic&&this.renderItalicButton(),e.showUnderline&&this.renderUnderlineButton(),e.showStrikethrough&&this.renderStrikethroughButton(),e.showCode&&this.renderCodeButton(),e.showEquation&&this.renderEquationButton()),e.showHighlight&&s()(zi.a,{style:this.getBorderRight()}),e.showMention&&this.renderMention(),e.showActionButton&&e.blockTarget&&this.renderActionButton(e.blockTarget))}renderTurnInto(e){let t=s()(ne.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const{intl:a}=this.props,i=e.getType();if(i){const e=Ci.b[i];t=e&&e.displayName||t}return s()(Ti.a,{popupType:Ti.a.PopupType.Popup,buttonPopupStore:Ui.a,originGap:4,renderOrigin:e=>s()(lt.a,{renderTooltip:()=>a.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:a=>o.a.createElement(vt.a,We()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()}},Object(Ka.a)(e,a)),t,gt.a.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}),render:()=>s()(ve.b,{menuType:ve.b.MenuType.Popup},void 0,s()(ge.a,{context:{blocks:[e],environment:this.environment},sections:[oi.t],onAccept:t=>{Di.a(),fe.q(this.environment,{analyticsName:t.analyticsName,from:"rich_text_menu",block_type:e.getType()})}})),onClick:()=>{fe.qe(this.environment,{action:"turn_into"})}})}renderBoldButton(){return s()(ki.a,{type:"b",tooltipLabel:s()(n.Fragment,{},void 0,s()("div",{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})),s()("div",{},void 0,s()(Fi.a,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleBold"})))},void 0,"B")}renderItalicButton(){return s()(ki.a,{type:"i",tooltipLabel:s()(n.Fragment,{},void 0,s()("div",{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})),s()("div",{},void 0,s()(Fi.a,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleItalics"})))},void 0,s()("span",{style:{fontStyle:"italic"}},void 0,"i"))}renderStrikethroughButton(){return s()(ki.a,{type:"s",tooltipLabel:s()(n.Fragment,{},void 0,s()("div",{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})),s()("div",{},void 0,s()(Fi.a,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleStrike"})))},void 0,s()("span",{style:{textDecoration:"line-through"}},void 0,"S"))}renderUnderlineButton(){return s()(ki.a,{type:"_",tooltipLabel:s()(n.Fragment,{},void 0,s()("div",{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})),s()("div",{},void 0,s()(Fi.a,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleUnderline"})))},void 0,s()("span",{style:{textDecoration:"underline"}},void 0,"U"))}renderCodeButton(){return s()(ki.a,{type:"c",style:{padding:"0 6px"},tooltipLabel:s()(n.Fragment,{},void 0,s()("div",{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})),s()("div",{},void 0,s()(Fi.a,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleCode"})))},void 0,gt.a.code({width:15,height:15}))}renderLinkButton(e){const t=this.environment.device.isMobile;return s()(Ai.a,{style:this.getBorderRight()},void 0,e&&gt.a.alias({width:t?18:16,height:t?18:16,marginRight:4,fill:this.theme.regularIconColor}),s()("span",{style:{borderBottom:"1px solid ".concat(this.theme.linkDecorationColor)}},void 0,s()(ne.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})),e&&gt.a.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}renderEquationButton(){return s()(wi.a,{style:this.getBorderRight(),onClick:()=>{fe.qe(this.environment,{action:"e"}),Di.a()}},void 0,gt.a.equation({width:16,height:16}))}renderMention(){return s()(lt.a,{renderTooltip:()=>s()(n.Fragment,{},void 0,s()("div",{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:s()("br",{})}})),s()("div",{style:{color:this.theme.mediumInvertedTextColor}},void 0,"@")),render:e=>o.a.createElement(vt.a,We()({style:{...this.getBorderRight(),padding:"0 8px"}},e,{onClick:()=>{ba.e(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0}),fe.qe(this.environment,{action:"mention"})}}),gt.a.mention({width:14,fill:this.theme.regularTextColor}))})}renderCommentButton(e){return s()(xi.a,{style:this.getBorderRight(),blockStore:e})}renderActionButton(e){return s()(Ii.a,{store:e,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:this.theme.regularTextColor},fadeIn:!1,onClick:()=>{fe.qe(this.environment,{action:"more"})}})}hasNonCollapsedTextSelection(){const e=Si.get();return!!e&&!e.collapsed&&"editing"===Ra.default.state.mode&&!Object(Gi.e)(Ra.default.state.multiSelection)}getTopbarHeight(){const{device:e}=this.environment;return e.isElectronMac?Pi.a.desktopMacHeight:Pi.a.defaultHeight}getBorderRight(){return{boxShadow:"1px 0 0 ".concat(this.theme.regularDividerColor),marginRight:1}}}d()(Ki,"richTextMenuBlockTypesBlacklist",{[pi.a.factory]:!0}),d()(Ki,"richTextMenuActionsBlacklist",{[pi.a.code]:new Set(["showMention","showCode"])}),d()(Ki,"leftOffset",60),d()(Ki,"height",32);var Yi=Object(ne.injectIntl)(Ki),Qi=a("ox2z"),Ji=a("D8Ld"),Xi=a("VpJM");class $i extends u.a{constructor(...e){super(...e),d()(this,"handleContextMenu",(e,t)=>{if(e.preventDefault(),t.misspelledWord){const e=Ra.default.state,a="editing"===e.mode&&Object($a.a)("ElectronContextMenu",e.multiSelection);if(a&&a.selection.startIndex===a.selection.endIndex){const e=Pa.t(a.store.getValue()||[],t.misspelledWord),i=a.selection.startIndex,s=Pa.v(e,i);s&&Gt.n({store:a.store,selection:s})}}Wi.setState({open:!0,menuInfo:t})}),d()(this,"handleDismiss",()=>{Wi.setState({...Wi.state,open:!1})})}willMount(){$.electronApi&&$.electronApi.contextMenu&&$.electronApi.contextMenu.addListener(this.handleContextMenu)}willUnmount(){$.electronApi&&$.electronApi.contextMenu&&$.electronApi.contextMenu.removeListener(this.handleContextMenu)}renderComponent(){const{menuInfo:e,open:t}=Wi.state,{device:a}=this.environment,{x:i,y:n}=this.getClickPosition(e),o={bottom:n,top:n,height:0,left:i,right:i,width:0},r=e?this.getMenuSections(e):[],l=document.activeElement,d=Si.get();let c=null,u=null;(l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement)&&(c=l.selectionStart,u=l.selectionEnd);for(const s of r)for(const e of s.items){const t=e.action;e.action=e=>{l.focus(),l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement?(l.selectionStart=c,l.selectionEnd=u):d&&Si.set(d,a),L.default.afterNextFlush(()=>{t(e)})}}return s()(he.c,{open:t&&r.length>0,popupType:he.c.PopupType.Popup,originRect:o,render:()=>s()(Ji.a,{capture:!0,allowEsc:!0},void 0,s()(ve.b,{menuType:ve.b.MenuType.Popup},void 0,s()(Sa.a,{type:Sa.a.Type.Vertical,sections:r,initialFocus:void 0,onAccept:this.handleDismiss}))),onDismiss:this.handleDismiss,overlayContainerStore:Xi.a})}getClickPosition(e){const t=Object($.getCurrentZoom)();return{x:e?e.x/t:0,y:e?e.y/t:0}}getMenuSections(e){const t=[],a=this.getSpellingCorrectionItems(e);if(a.length>0){const e=t.length>0;t.push({key:"spellingCorrectionItems",items:a,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}const i=this.getDisableSpellCheckItems(e);if(i.length>0){const e=t.length>0;t.push({key:"disableSpellCheckItems",items:i,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}const s=this.getSearchItems(e);if(s.length>0){const e=t.length>0;t.push({key:"searchItems",items:s,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}const n=this.getLinkMenuItems(e);if(n.length>0){const e=t.length>0;t.push({key:"linkMenuItems",items:n,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}const r=this.getImageMenuItems(e);if(r.length>0){const e=t.length>0;t.push({key:"imageMenuItems",items:r,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}const l=this.getTextEditingItems(e);if(l.length>0){const e=t.length>0;t.push({key:"textEditingItems",items:l,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}const d=this.getEnableSpellCheckItem(e);if(d.length>0){const e=t.length>0;t.push({key:"enableSpellCheckItems",items:d,render:t=>o.a.createElement(Me.a,We()({},t,{topBorder:e}))})}return t}getLinkMenuItems(e){const t=[];return e.linkURL&&e.linkURL.length>0&&(e.linkURL.startsWith("mailto:")?t.push({key:"copy-email",action:()=>{$.electronApi&&$.electronApi.copyText&&$.electronApi&&$.electronApi.copyText(e.linkText)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Copy email address",id:"desktop.rightClickMenu.copyEmailAddress"})}))}):t.push({key:"copy-link",action:()=>{$.electronApi&&$.electronApi.copyText&&$.electronApi&&$.electronApi.copyText(e.linkURL)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Copy link",id:"desktop.rightClickMenu.copyLink"})}))}),t.push({key:"open-link",action:()=>{$.electronApi&&$.electronApi.openExternalUrl(e.linkURL)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Open link",id:"desktop.rightClickMenu.openLink"})}))})),t}getImageMenuItems(e){const t=[];return e.hasImageContents&&e.srcURL&&e.srcURL.length>0&&(t.push({key:"copy-image",action:()=>{$.electronApi&&$.electronApi.copyImage&&$.electronApi.copyImage(e.srcURL)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Copy image",id:"desktop.rightClickMenu.copyImage"})}))}),t.push({key:"copy-image-address",action:()=>{$.electronApi&&$.electronApi.copyText&&$.electronApi.copyText(e.srcURL)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Copy image address",id:"desktop.rightClickMenu.copyImageAddress"})}))})),t}isEditing(e){return e.isEditable||e.inputFieldType&&"none"!==e.inputFieldType}hasMisspelling(e){return this.isEditing(e)&&e.misspelledWord&&e.misspelledWord.length>0}getSpellingCorrectionItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,a=[];if(this.hasMisspelling(e)&&t&&t.isEnabled()){const i=t.getCorrections(e);for(const e of i)a.push({key:e,action:()=>{$.electronApi&&$.electronApi.replaceMisspelling&&$.electronApi.replaceMisspelling(e)},render:t=>o.a.createElement(It.a,We()({},t,{title:e}))})}return a}getDisableSpellCheckItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,a=[];return this.hasMisspelling(e)&&t&&t.isEnabled()&&a.push({key:"disable",action:()=>{t.setEnabled(!1)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Disable spell check",id:"desktop.spellcheckMenuItem.disableSpellcheck.title"})}))}),a}getEnableSpellCheckItem(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,a=[];return this.isEditing(e)&&t&&!t.isEnabled()&&a.push({key:"enable",action:()=>{t.setEnabled(!0)},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Enable spell check",id:"desktop.spellcheckMenuItem.enableSpellcheck.title"})}))}),a}getSearchItems(e){const t=[];return e.selectionText&&e.selectionText.length>0&&t.push({key:"google",action:()=>{if($.electronApi){const t="https://www.google.com/search?q=".concat(encodeURIComponent(e.selectionText.trim()));$.electronApi.openExternalUrl(t)}},render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Search with Google",id:"desktop.searchMenuItem.searchWithGoogle.title"})}))}),t}getTextEditingItems(e){const t=[];return this.isEditing(e)&&(e.editFlags.canCut&&t.push({key:"cut",action:()=>{$.electronApi&&$.electronApi.cut&&$.electronApi.cut()},render:e=>o.a.createElement(Qi.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Cut",id:"desktop.textEditingMenuItem.cutAction.title"}),shortcuts:["cut"]}))}),e.editFlags.canCopy&&t.push({key:"copy",action:()=>{$.electronApi&&$.electronApi.copy&&$.electronApi.copy()},render:e=>o.a.createElement(Qi.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Copy",id:"desktop.textEditingMenuItem.copyAction.title"}),shortcuts:["copy"]}))}),e.editFlags.canPaste&&t.push({key:"paste",action:()=>{$.electronApi&&$.electronApi.paste&&$.electronApi.paste()},render:e=>o.a.createElement(Qi.a,We()({},e,{title:s()(ne.FormattedMessage,{defaultMessage:"Paste",id:"desktop.textEditingMenuItem.pasteAction.title"}),shortcuts:["paste"]}))})),t}}var es=$i,ts=a("m8rc"),as=a("du8U");class is extends u.a{constructor(...e){super(...e),d()(this,"handleChangeValue",e=>{if(!e)return void this.removeDateAnnotation();const t=this.getEverythingIWant();if(!t)return;const{date_format:a,time_format:i}=t;this.setDateAnnotationData({date_format:a,time_format:i,...e})}),d()(this,"handleChangeDateFormat",e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:a,time_format:i}=t;this.setDateAnnotationData({date_format:e,time_format:i,...a})}),d()(this,"handleChangeTimeFormat",e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:a,date_format:i}=t;this.setDateAnnotationData({date_format:i,time_format:e,...a})}),d()(this,"setDateAnnotationData",e=>{const t=this.getEverythingIWant();if(!t)return;const{textStore:a,textValue:i,tokenIndex:s,annotations:n}=t,o=i.map((t,a)=>{if(a===s){const a=n.map(t=>Pa.sb(t)?["d",e]:t);return Pa.n(t[0],a)}return t});jt.createAndCommit(this.environment,e=>{qt.d({store:a,value:o,transaction:e})})}),d()(this,"removeDateAnnotation",()=>{const e=this.getEverythingIWant();if(!e)return;const{textStore:t,textValue:a,tokenIndex:i}=e,s=a.filter((e,t)=>t!==i);jt.createAndCommit(this.environment,e=>{qt.d({store:t,value:s,transaction:e})})})}renderComponent(){const{device:e}=this.environment,t=as.a.state;return s()(he.c,{popupType:e.isMobile?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t.open,originRect:t.originRect,onDismiss:ts.a,render:()=>{const e=this.getEverythingIWant();if(!e)return null;const{date_format:a,time_format:i,dateValue:n}=e;return s()(re.DependencyConsumer,{dependency:re.deps.menus},void 0,({DatePropertyMenu:e})=>s()(e,{firstDayOfWeek:B.r.state,value:n,locked:!1,onChangeValue:this.handleChangeValue,dateFormat:a,onChangeDateFormat:this.handleChangeDateFormat,timeFormat:i,onChangeTimeFormat:this.handleChangeTimeFormat,onDismiss:ts.a,disabled:!1,shouldShowReminder:!!t.open&&t.allowReminders}))}})}getEverythingIWant(){const e=as.a.state;if(e.open){const{textStore:t,tokenIndex:a}=e,i=t.getValue();if(i){const e=i[a];if(e){const s=Pa.fb(e),n=Pa.x(s);if(n){const{date_format:o,time_format:r,...l}=Pa.J(n);return{textStore:t,textValue:i,tokenIndex:a,token:e,annotations:s,date_format:o,time_format:r,dateValue:l}}}}}}}var ss=is,ns=a("/6eU"),os=a("bjn0"),rs=a("Etmo"),ls=a("ZQ9l"),ds=a("OxuQ"),cs=a("bFnu");class us extends u.a{constructor(...e){super(...e),d()(this,"storeTypes",{mouseStore:cs.a}),d()(this,"handleMouseEnter",()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})}),d()(this,"handleMouseLeave",()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}),d()(this,"handleMouseDown",()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!0})}),d()(this,"handleMouseUp",()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!1})}),d()(this,"handleWindowMouseUp",()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!1,mouseEntered:!1})})}willMount(){Object(v.a)(window,"mouseup",this.handleWindowMouseUp)}willUnmount(){Object(v.b)(window,"mouseup",this.handleWindowMouseUp)}renderComponent(){const{mouseEntered:e,mousePressed:t}=this.stores.mouseStore.state;return this.props.render({mouseEntered:e,mousePressed:t,events:{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp}})}}var ps=us;class ms extends u.a{renderComponent(){const{device:e}=this.environment,{title:t,caption:a,image:i,onClick:n}=this.props;return s()(ps,{render:({mouseEntered:r,events:l})=>o.a.createElement("div",We()({},l,{onClick:n,style:this.getWrapStyle(r)}),s()("img",{src:i,style:this.getImageStyle(r)}),s()("div",{style:this.getInfoStyle()},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()("span",{style:this.getMobileTitleStyle()},void 0,t)),!e.isMobile&&s()("div",{style:this.getCaptionStyle()},void 0,a)))})}getWrapStyle(e){const{device:t}=this.environment;return{display:"flex",flexDirection:t.isMobile?"column":"row",alignItems:"center",flexGrow:0,...e&&{cursor:"pointer"},...t.isMobile?{padding:"12px 4px 16px"}:{marginBottom:8}}}getImageStyle(e){const{device:t}=this.environment,{selected:a}=this.props,i=(()=>a?"0 0 0 2px ".concat(Qe.g.blue):e?"0 0 0 2px ".concat(this.theme.darkDividerColor):"0 0 0 1px ".concat(this.theme.darkDividerColor))(),s=t.isMobile?"42vw":"169px";return{display:"flex",flexDirection:"column",borderRadius:3,boxShadow:i,transition:"box-shadow 200ms ease-out",marginTop:8,marginBottom:t.isMobile?12:8,height:"calc(".concat(s," / (169 / 97))"),maxHeight:97,maxWidth:s}}getInfoStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",...!e.isMobile&&{marginLeft:16}}}getTitleStyle(){const{device:e}=this.environment,{selected:t}=this.props;return{display:"flex",fontSize:14,...t&&!e.isMobile&&{fontWeight:600},marginBottom:2,...e.isMobile&&{justifyContent:"center"}}}getMobileTitleStyle(){const{device:e}=this.environment,{selected:t}=this.props;return e.isMobile?{fontSize:12,padding:"2px 10px",borderRadius:20,textAlign:"center",...t&&{background:Qe.g.blue,color:Qe.g.white}}:{}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor}}}var gs=ms,hs=a("Erf6"),fs=a("Ng05"),Ms=a("IULH"),ys=a("sSHh");class vs extends u.a{constructor(...e){super(...e),d()(this,"storeTypes",{databaseSearchButtonPopupStore:Wa.a}),d()(this,"renderDesktopModalContent",()=>{const{currentBlockStore:e}=Z.default.state,t=hs.a.state;if(t.open&&e)return s()("div",{style:vs.modalStyle},void 0,s()("div",{style:vs.modalHeaderStyle},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.header",defaultMessage:"Create a relation to another database"})),s()("div",{style:vs.sourceSectionStyle},void 0,s()("div",{style:vs.defaultTextStyle},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.description",defaultMessage:"A relation allows you to link pages from other databases."})),this.renderDatabaseButtonPopup()),t.relationCollectionId===t.targetCollectionId&&s()("div",{style:vs.selfRelationSectionStyle},void 0,s()("div",{style:vs.defaultTextStyle},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt",defaultMessage:"You selected the same database. In which property should the linked pages appear?"})),this.renderSelfRelationConfigure()),s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(ys.a,{title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.helpCenterLink",defaultMessage:"Learn about relations"}),href:Object(Ae.a)("guides.relations"),analyticsFrom:"configure_relation_modal"}),s()(Ms.a,{isLarge:!0,style:{marginLeft:"auto",marginRight:12},onClick:this.handleCancelClick},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.cancelButton",defaultMessage:"Cancel"})),s()(fs.a,{isLarge:!0,onClick:this.handleDoneClick,disabled:!this.canAccept()},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.confirmButton",defaultMessage:"Create relation"}))))}),d()(this,"renderMobilePopupContent",()=>{const e=hs.a.state;if(e.open)return s()(ve.b,{menuType:ve.b.MenuType.Modal,right:s()(ke.DoneMenuText,{}),left:s()(ke.CancelMenuText,{}),title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.databaseSelect.label",defaultMessage:"Select a database"}),onClickRight:this.handleDoneClick,onClickLeft:this.handleCancelClick,rightDisabled:!this.canAccept()},void 0,s()(Me.a,{title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.databaseSelect.mobile.title",defaultMessage:"Database source"})},void 0,s()(ls.a,{title:this.renderDatabaseButtonPopup()})),s()("div",{style:this.getMobileSectionCaption()},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.databaseSelect.mobile.caption",defaultMessage:"The database you wish to link to."})),e.relationCollectionId===e.targetCollectionId&&s()(n.Fragment,{},void 0,s()("div",{style:{...this.getMobileSectionHeading(),marginTop:28}},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt.mobileTitle",defaultMessage:"Self-relation type"})),s()("div",{style:this.getMobileSectionCaption()},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt",defaultMessage:"You selected the same database. In which property should the linked pages appear?"})),s()(Me.a,{disableMobilePadding:!0},void 0,s()(ls.a,{title:this.renderSelfRelationConfigure()})),s()("div",{style:this.getMobileSectionCaption()},void 0,this.renderSelfRelationCaption(e.selfRelationType))),s()(Me.a,{},void 0,s()(Te.a,{title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.helpCenterLinkMobile",defaultMessage:"Learn about relations"}),href:Object(Ae.a)("guides.relations"),analyticsFrom:"configure_relation_modal"})))}),d()(this,"renderDatabaseButtonPopupOrigin",e=>{const{device:t}=this.environment,{currentBlockStore:a}=Z.default.state;if(hs.a.state.open&&a)return t.isMobile?o.a.createElement(vt.a,We()({mobileFeedback:!0,style:{width:"100%"}},e),this.getButtonTitle()):o.a.createElement(Ms.a,We()({isLarge:!0,style:{width:"100%"}},e),this.getButtonTitle(),gt.a.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}),d()(this,"renderDatabaseButtonPopupContent",()=>{const{device:e}=this.environment,{currentBlockStore:t}=Z.default.state,a=hs.a.state;if(!a.open||!t)return;const i={request:a.collectionSearchQuery,debounce:kt.b,performRequest:this.getCollectionAutocompleteItems,render:(i,r,l)=>{let d;if(i&&(d=s()(Me.a,{},void 0,s()(ka.a,{title:this.props.intl.formatMessage({id:"configureRelationModal.relationProperty.render.error",defaultMessage:"Something went wrong."})}))),l||(d=s()(Me.a,{},void 0,s()(ka.a,{title:this.props.intl.formatMessage({id:"configureRelationModal.relationProperty.render.loading",defaultMessage:"Loading..."})}))),r&&0===r.length)d=s()(Me.a,{},void 0,s()(ka.a,{title:this.props.intl.formatMessage({id:"configureRelationModal.relationProperty.createModal.noResults",defaultMessage:"No results"})}));else{const e=(r||[]).map(e=>{const a=os.a.createChildStore(t,{table:Bi.a,id:e});return{key:e,render:e=>o.a.createElement(Ta.a,We()({store:a},e)),action:()=>{this.handleSelectCollection(e)}}});d=s()(Sa.a,{type:Sa.a.Type.Vertical,initialFocus:a.collectionSearchQuery?0:void 0,sections:[{key:"results",render:e=>o.a.createElement(Me.a,e),items:e}]})}return e.isMobile?s()(n.Fragment,{},void 0,d):s()("div",{style:vs.customPopupStyle},void 0,d)}},r=s()(Me.a,{isInput:!0},void 0,this.renderDatabaseInputMenuItem());let l;return l=e.isMobile?{menuType:ve.b.MenuType.Modal,title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.databaseSelect.label",defaultMessage:"Select a database"}),right:s()(ke.DoneMenuText,{}),header:r,onClickRight:this.handleDatabaseSearchDoneClick}:{menuType:ve.b.MenuType.Popup,width:"100%",header:r},o.a.createElement(ve.b,l,o.a.createElement(Tt.a,i))}),d()(this,"handleSamePropertyClick",()=>{const e=hs.a.state;e.open&&hs.a.setState({...e,selfRelationType:"same_property"})}),d()(this,"handleSeparatePropertyClick",()=>{const e=hs.a.state;e.open&&hs.a.setState({...e,selfRelationType:"separate_property"})}),d()(this,"getCollectionAutocompleteItems",async e=>kt.c(this.environment,{query:e,limit:20,source:"relation_setup_menu"})),d()(this,"handleDatabaseSearchInputChange",e=>{const t=hs.a.state;t.open&&hs.a.setState({...t,collectionSearchQuery:e.target.value})}),d()(this,"handleSelectCollection",e=>{const t=hs.a.state;t.open&&(hs.a.setState({...t,targetCollectionId:e}),this.stores.databaseSearchButtonPopupStore.setState({open:!1}))}),d()(this,"handleDatabaseSearchDoneClick",()=>{this.stores.databaseSearchButtonPopupStore.setState({open:!1})}),d()(this,"handleCancelClick",()=>{rs.b()}),d()(this,"handleDoneClick",()=>{rs.a(this.environment)}),d()(this,"handleDatabaseButtonPopupClick",()=>{const e=hs.a.state;e.open&&hs.a.setState({...e,collectionSearchQuery:""})})}renderComponent(){const{device:e}=this.environment,{open:t}=hs.a.state;return e.isMobile?s()(he.a,{popupType:he.b.SlideUp,alignmentToOrigin:he.a.Alignment.Start,open:t,render:this.renderMobilePopupContent,onDismiss:rs.b}):s()(ns.a,{open:t,render:this.renderDesktopModalContent,onDismiss:rs.b})}renderSelfRelationConfigure(){const e=hs.a.state;if(e.open)return s()("div",{style:this.getSelfRelationButtonWrapStyle()},void 0,s()(gs,{title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt.createNewPropertyOption.title",defaultMessage:"Create a new property"}),caption:this.renderSelfRelationCaption("separate_property"),image:Ga.a.images.selfRelationSeparateSvg,selected:"separate_property"===e.selfRelationType,onClick:this.handleSeparatePropertyClick}),s()(gs,{title:s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt.samePropertyOption.title",defaultMessage:"Use the same property"}),caption:this.renderSelfRelationCaption("same_property"),image:Ga.a.images.selfRelationSameSvg,selected:"same_property"===e.selfRelationType,onClick:this.handleSamePropertyClick}))}getButtonTitle(){const{currentBlockStore:e}=Z.default.state,t=hs.a.state;if(t.open&&e){if(t.targetCollectionId){const a=os.a.createChildStore(e,{table:Bi.a,id:t.targetCollectionId});return s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(Vt.a,{disabled:!0,icon:a.getIcon(),isEmptyPage:!1,size:20}),s()(ds.a,{store:a,style:{margin:"0 6px"}}))}return s()("span",{style:{color:this.theme.mediumTextColor}},void 0,s()(ne.FormattedMessage,{id:"configureRelationModal.relationProperty.createModal.databaseSelect.label",defaultMessage:"Select a database"}))}}renderDatabaseButtonPopup(){const{device:e}=this.environment;return s()(Ti.a,{popupType:e.isMobile?he.b.SlideUp:he.b.Popup,renderOrigin:this.renderDatabaseButtonPopupOrigin,render:this.renderDatabaseButtonPopupContent,buttonPopupStore:this.stores.databaseSearchButtonPopupStore,onClick:this.handleDatabaseButtonPopupClick,style:{width:440}})}renderDatabaseInputMenuItem(){const e=hs.a.state;if(e.open)return s()(ye.a,{focus:!0,focusAfterAnimation:!0,value:e.collectionSearchQuery,onChange:this.handleDatabaseSearchInputChange,placeholder:this.props.intl.formatMessage({id:"configureRelationModal.relationProperty.createModal.databaseSelect.placeholder",defaultMessage:"Search for a database…"})})}renderSelfRelationCaption(e){return s()(n.Fragment,{},void 0,s()(ne.FormattedMessage,"same_property"===e?{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt.createNewPropertyOption.caption",defaultMessage:'<b>No syncing.</b> Use this option when modeling a "Related tasks" property in a "Task" database.',values:{b:(...e)=>s()("b",{style:{color:this.theme.regularTextColor}},void 0,e)}}:{id:"configureRelationModal.relationProperty.createModal.selfRelationPrompt.samePropertyOption.caption",defaultMessage:'<b>Sync both ways.</b> Use this option when modeling "Parent Task" and "Child Task" properties in a "Task" database.',values:{b:(...e)=>s()("b",{style:{color:this.theme.regularTextColor}},void 0,e)}}))}canAccept(){const e=hs.a.state;return e.open&&e.targetCollectionId}getSelfRelationButtonWrapStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:e.isMobile?"row":"column",justifyContent:"space-between"}}getMobileSectionHeading(){return{marginTop:8,marginRight:16,marginBottom:8,marginLeft:16,fontSize:12,textTransform:"uppercase",color:this.theme.mediumTextColor}}getMobileSectionCaption(){return{marginTop:8,marginRight:16,marginBottom:8,marginLeft:16,fontSize:12,color:this.theme.mediumTextColor}}}d()(vs,"defaultTextStyle",{marginBottom:8,fontSize:14}),d()(vs,"modalStyle",{padding:30,width:538}),d()(vs,"modalHeaderStyle",{fontWeight:600,marginBottom:20}),d()(vs,"sourceSectionStyle",{marginBottom:30}),d()(vs,"selfRelationSectionStyle",{marginBottom:30}),d()(vs,"customPopupStyle",{maxHeight:"24vh"});var bs=Object(ne.injectIntl)(vs),Ss=(a("UxlC"),a("QmC8")),Cs=a("AXyr");class Ts extends u.a{constructor(...e){super(...e),d()(this,"lastOpenState",void 0),d()(this,"renderModal",()=>{if(!this.lastOpenState)return;const{acceptLabel:e,requiredInputValue:t}=this.lastOpenState,a=[{key:"accept",render:t=>o.a.createElement(Ms.a,We()({isRed:!0,isLarge:!0,style:Ts.buttonStyle,hovered:t.focused},t),e),action:this.handleAccept},{key:"cancel",render:e=>o.a.createElement(Ms.a,We()({isLarge:!0,style:Ts.buttonStyle,hovered:e.focused},e),s()(ne.FormattedMessage,{id:"confirmationInputDialog.cancelButton.label",defaultMessage:"Cancel"})),action:this.handleCancel}];return s()(He.a,{capture:!0},void 0,s()("div",{},void 0,s()("div",{style:{minHeight:64,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16}},void 0,this.lastOpenState.message),s()(Fe.b,{value:this.lastOpenState.inputValue,onChange:this.handleInputChange,style:{height:38,marginBottom:2},placeholder:t}),s()(Sa.a,{type:Sa.a.Type.Vertical,initialFocus:void 0,sections:[{key:"dialog",render:e=>o.a.createElement(Me.a,e),items:a}]})))}),d()(this,"handleAccept",()=>{const e=Ss.a.state;e.open&&(this.cleanAcceptInput(e.inputValue)===this.cleanAcceptInput(e.requiredInputValue)?Cs.a({didConfirm:!0}):da.showErrorMessage(s()(ne.FormattedMessage,{id:"confirmDialogInput.incorrectInputError.message",defaultMessage:'Please type "{requiredInputValue}" to continue',values:{requiredInputValue:e.requiredInputValue}})))}),d()(this,"cleanAcceptInput",e=>e.trim().toLowerCase().replace(/’/g,"'")),d()(this,"handleCancel",()=>{Cs.a({didConfirm:!1})}),d()(this,"handleInputChange",e=>{const t=Ss.a.state;t.open&&Ss.a.setState({...t,inputValue:e.target.value})})}renderComponent(){const e=Ss.a.state;return e.open&&(this.lastOpenState={...e}),s()(ns.a,{open:e.open,keepFocus:!0,overlayZIndex:ze.a,onDismiss:this.handleCancel,preventHideChildrenWhileOpening:!0,innerStyle:{borderRadius:3,paddingTop:24,paddingBottom:16,paddingLeft:32,paddingRight:32,width:this.lastOpenState&&this.lastOpenState.width||336,fontSize:16,boxShadow:this.theme.largeBoxShadow,background:this.theme.contentBackground,maxHeight:"90vh",overflowY:"scroll",marginLeft:24,marginRight:24},render:this.renderModal})}}d()(Ts,"buttonStyle",{width:"100%",marginTop:16});var ks=Ts,As=a("NbyO"),ws=a("mKX5"),Is=a("lk/1"),Ps=a("922z"),Fs=a("8fuX"),xs=a("zK7c"),Es=a("XBB3"),Bs=a("lBar"),Ds=a("g90h"),Os=a("G+Ai"),Rs=a("zgcg"),Ls=a("Tuh7");class _s extends u.a{constructor(...e){super(...e),d()(this,"handleOverrideLinkClick",e=>{Object(As.b)(),J.navigate({environment:this.environment,url:e})}),d()(this,"loadSnapshot",async e=>{const{timestamp:t}=e,a=e.block.id,i=await K.getSnapshotContents(this.environment,e);if("failed"===i.type)throw i.error;const s=new Ps.a(i.data.contentMap),n=this.environment.currentUser.id,o=new Is.a;for(const{pointer:g,value:h}of s)h&&o.setRecord({pointer:g,userId:n},{...h,role:"reader"});o.snapshotData={blockId:a,timestamp:t};const r=new Set,l=[];for(const{pointer:g,value:h}of s){if(g.table!==S.a||!h||!h.value)continue;const{value:e}=h,t=e,a=_.g(t),i=_.B(t)?[]:t.content||[],s=[...a.map(e=>e.id),...i];for(const d of s){if(!o.getRecord({pointer:{table:S.a,id:d},userId:n})&&Object(Ds.f)(d)&&!r.has(d)){r.add(d);const e=Object(G.c)(this.props.blockStore,{table:S.a,id:d});e&&l.push(e)}}}const d=new Set,c=new Set;for(const{pointer:g,value:h}of s){if(!h||!h.value)continue;const{table:e}=g,{value:t}=h;if(e===S.a){const e=t;for(const t of _.m(e))d.add(t);e.created_by_table&&e.created_by_id&&(e.created_by_table===La.a?d.add(e.created_by_id):c.add(e.created_by_id)),e.last_edited_by_table&&e.last_edited_by_id&&(e.last_edited_by_table===La.a?d.add(e.last_edited_by_id):c.add(e.last_edited_by_id))}else if(e===Ei.a){const e=t;e.created_by_id&&e.created_by_table&&(e.created_by_table===La.a?d.add(e.created_by_id):c.add(e.created_by_id))}}const u=f.a.compact(Array.from(d).map(e=>Object(G.c)(this.props.blockStore,{table:La.a,id:e}))),p=f.a.compact(Array.from(c).map(e=>Object(G.c)(this.props.blockStore,{table:Os.a,id:e}))),m=[...l,...u,...p];return await Promise.all(m.map(async e=>{await e.load();const t=e.getValue();t&&o.setRecord({pointer:{table:e.table,id:t.id},userId:n},{role:"reader",value:t})})),{blockStore:new b.a(this.environment,{table:S.a,id:a},{inMemoryRecordCache:o}),timestamp:t}})}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,a={request:{block:{id:e,spaceId:Object(Ls.c)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:this.loadSnapshot,render:(e,t,a)=>s()(Aa.a,{show:!a||!t,showDelay:400,showHold:400,render:a=>a?s()("div",{style:this.getSpinnerWrapperStyles()},void 0,s()(At.a,{})):e?s()("div",{style:{padding:32}},void 0,s()(ne.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})):t?s()(xs.a,{store:t.blockStore,isDefaultContainer:!0,render:e=>o.a.createElement(Fs.b,We()({style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:this.useSeparateHorizontalScroller(t.blockStore)?Fs.a.Y:Fs.a.All},e),s()(Es.b,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Es.a.InAppTemplatePreview,paddingBottom:Es.b.paddingBottom(this.environment),paddingLeft:Es.b.defaultPaddingLeftRight(this.environment),paddingRight:Es.b.defaultPaddingLeftRight(this.environment),pageCoverHeight:Es.b.defaultPageCoverHeight(this.environment)}))},t.timestamp):void 0})};return o.a.createElement(Tt.a,a)}useSeparateHorizontalScroller(e){return!e.isCollectionView()||!Bs.b(this.environment)}getSpinnerWrapperStyles(){return{padding:32,display:"flex",alignItems:"center",justifyContent:"center"}}}d()(_s,"contextTypes",u.b),d()(_s,"childContextTypes",Rs.a);var Us=_s,js=a("cYwG");class Ns extends u.a{constructor(...e){super(...e),d()(this,"handleScroll",e=>{if(this.props.loading)return;if(e>(this.props.loadMoreOffsetThreshold||200))return;this.props.resultSize>=this.props.fetchSize&&this.props.onLoadMore()})}renderComponent(){return s()(js.a,{onChange:this.handleScroll})}}var Zs=Ns,Ws=a("DbeH"),Vs=a("j9U3"),zs=a("7KuZ"),qs=a("1G+a");class Hs extends u.a{constructor(...e){super(...e),d()(this,"renderSnapshotsListRequest",()=>{const{device:e}=this.environment,t=Vs.a.state;if(!t.open)return;const a={request:{block:{id:t.blockStore.id,spaceId:Object(Ls.c)(t.blockStore.pointer.spaceId)},size:t.size},performRequest:e=>this.loadSnapshotsList(e,t),render:(a,i,n)=>s()(Aa.a,{show:Boolean(!i||i.snapshots.length>=t.size&&t.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:s=>e.isMobile?this.renderMobileHistory({snapshotValues:i?i.snapshots:[],menuState:t,error:a,initialLoading:s,loadingMore:!n}):this.renderDesktopHistory({snapshotValues:i?i.snapshots:[],menuState:t,error:a,initialLoading:s,loadingMore:!n})})};return o.a.createElement(Tt.a,a)}),d()(this,"renderMobileHistory",e=>{let t,a;return this.historyIsEnabled()?e.loadingMore||0!==e.snapshotValues.length||(t=this.renderUnavailableMessage(Hs.noSnapshotsMessage,!1)):t=this.renderUnavailableMessage(this.getUnavailableMessage(),ht.j(this.environment)||"team"),a=e.error?s()("div",{style:Hs.wrapStyle},void 0,s()(ne.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})):e.initialLoading?s()("div",{style:Hs.wrapStyle},void 0,s()(At.a,{})):s()(n.Fragment,{},void 0,s()(Fs.b,{type:Fs.a.Y},void 0,this.renderSnapshotsMenuList(e)),this.renderMobileSnapshotPreview(e.menuState)),s()(ve.b,{menuType:ve.b.MenuType.Modal,title:s()(ne.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:this.renderMobileHelpButton(),right:s()(ke.DoneMenuText,{}),onClickRight:As.b,header:t},void 0,a)}),d()(this,"renderDesktopHistory",e=>{let t;return t=e.error?s()("div",{style:Hs.wrapStyle},void 0,s()(ne.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})):e.initialLoading?s()("div",{style:Hs.wrapStyle},void 0,s()(At.a,{})):this.historyIsEnabled()?e.menuState.snapshot&&!this.snapshotIsAvailable(e.menuState.snapshot)?this.renderUnavailableMessage(Hs.restrictedMessage,"enterprise"):e.loadingMore||0!==e.snapshotValues.length?this.renderDesktopSnapshotPreview(e.menuState):this.renderUnavailableMessage(Hs.noSnapshotsMessage,!1):this.renderUnavailableMessage(this.getUnavailableMessage(),ht.j(this.environment)||"team"),s()(n.Fragment,{},void 0,s()("div",{style:{display:"flex",flexDirection:"column",width:"calc(100% - ".concat(Hs.sidebarWidth,"px)"),boxShadow:"1px 0 0 ".concat(this.theme.regularDividerColor)}},void 0,t),this.renderDesktopSidebar(e))}),d()(this,"renderSnapshotsMenuList",e=>{const{device:t}=this.environment,{menuState:a,loadingMore:i}=e,r=f.a.compact(e.snapshotValues.map(e=>{const i=this.snapshotIsAvailable(e);return{key:e.id,action:()=>{As.f(this.environment,e)},render:n=>{const r=e.authors||[],l=this.props.intl.formatList(f.a.compact(r.map((e,t)=>{if(e.table===La.a){const t=Object(G.c)(a.blockStore,e).getValue();if(!t)return;return Object(La.e)(this.props.intl,t)}{const t=Object(G.c)(a.blockStore,e).getValue();if(!t)return;return t.name}})),{type:"conjunction",style:"narrow"}),d=s()("div",{style:{...Ke.a.textOverflowStyle}},void 0,l),c=Boolean(a.snapshot&&a.snapshot.id===e.id);if(i){const a=Object(ws.a)(parseInt(e.timestamp)).format("lll");return s()(lt.a,{render:a=>o.a.createElement(It.a,We()({},Object(Ka.a)(n,a),{title:Object(ws.a)(parseInt(e.timestamp)).calendar(),focused:!t.isMobile&&c,caption:d})),renderTooltip:()=>s()("div",{style:{maxWidth:270,whiteSpace:"normal"}},void 0,s()("div",{},void 0,a),s()("div",{},void 0,l))},n.key)}{const a=!this.historyIsEnabled();return s()(lt.a,{render:i=>o.a.createElement(It.a,We()({},Object(Ka.a)(i,n),{title:s()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,s()("div",{style:{...t.isMobile&&{display:"flex",flex:1},...Ke.a.textOverflowStyle}},void 0,Object(ws.a)(parseInt(e.timestamp)).calendar()),!a&&s()(dt.a,{subscriptionTier:"enterprise",analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>this.handleUpgrade("enterprise")})),focused:!t.isMobile&&c,disabled:a,caption:d})),renderTooltip:()=>s()(ne.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!a},n.key)}}}})),l=a.snapshot&&a.snapshot.id,d=r.findIndex(e=>l===e.key),c=[{key:"snapshots",render:e=>o.a.createElement(Me.a,e),items:r}];return s()(n.Fragment,{},void 0,s()(Sa.a,{type:Sa.a.Type.Vertical,initialFocus:d,sections:c}),s()(Zs,{loading:i,fetchSize:a.size,resultSize:e.snapshotValues.length,onLoadMore:As.c}),s()(Aa.a,{show:i,showDelay:300,showHold:100,render:e=>e&&s()("div",{style:Hs.wrapStyle},void 0,s()(At.a,{}))}))}),d()(this,"handleUpgrade",e=>{Ws.a(this.environment,{from:"history_modal",for:e})}),d()(this,"loadSnapshotsList",async(e,t)=>{const{device:a}=this.environment,i=await K.getSnapshotsList(this.environment,e);if("failed"===i.type)throw i.error;const{snapshots:s}=i.data;if(t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),a=s.findIndex(t=>parseInt(t.timestamp)<e);0===s.length||(0===a?As.f(this.environment,s[a]):a>0?As.f(this.environment,s[a-1]):s.length<t.size?As.f(this.environment,s[s.length-1]):As.c())}else Boolean(t.snapshot)||a.isMobile||Vs.a.setState({...t,snapshot:s[0]});return i.data}),d()(this,"iconSize",()=>{const{device:e}=this.environment;return e.isMobile?24:20})}renderComponent(){const{device:e}=this.environment,t=Vs.a.state;return e.isMobile?s()(he.c,{popupType:he.c.PopupType.SlideUp,open:t.open,render:this.renderSnapshotsListRequest,onDismiss:As.b}):s()(ns.a,{open:t.open,innerStyle:{height:"80vh",width:"80vw",overflow:"hidden",display:"flex"},onDismiss:As.b,render:this.renderSnapshotsListRequest,className:Ft.G})}renderMobileSnapshotPreview(e){if(this.historyIsEnabled())return s()(he.c,{popupType:he.c.PopupType.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return;const t=this.snapshotIsAvailable(e.snapshot),a=t?s()(Us,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):this.renderUnavailableMessage(Hs.restrictedMessage,"enterprise");return s()(ve.b,{menuType:ve.b.MenuType.Modal,title:Object(ws.a)(parseInt(e.snapshot.timestamp)).calendar(),right:s()(ke.DoneMenuText,{}),onClickRight:As.a,leftDisabled:!t,left:s()(ne.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>As.e(this.environment),whiteBackground:t,forceFullScreenSlideUp:!0},void 0,a)}})}renderDesktopSidebar(e){const{menuState:t}=e,a=Boolean(t.snapshot&&this.snapshotIsAvailable(t.snapshot)),i=!this.historyIsEnabled();return s()("div",{style:this.getSidebarStyle()},void 0,s()(Fs.b,{type:Fs.a.Y,style:{flex:1}},void 0,this.renderSnapshotsMenuList(e)),s()("div",{style:{display:"flex",padding:14,borderTop:"\n\t\t\t\t\t\t\t1px solid ".concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t")}},void 0,s()(lt.a,{disableTooltip:!i,renderTooltip:()=>s()(ne.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>o.a.createElement(fs.a,We()({isLarge:!0,onClick:()=>As.e(this.environment),disabled:!a},e),s()(ne.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"}))}),s()(Ms.a,{isLarge:!0,style:{marginLeft:12},onClick:As.b},void 0,s()(ne.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"}))),s()(Me.a,{topBorder:!0,disableDesktopPadding:!0},void 0,s()(Te.a,{title:s()(ne.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:Object(Ae.a)("guides.pageHistory"),analyticsFrom:"page_history"})))}renderDesktopSnapshotPreview(e){if(e.snapshot)return s()(n.Fragment,{},void 0,s()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14}},void 0,e.blockStore.hasIcon()&&s()(Vt.a,{disabled:!0,icon:e.blockStore.getIcon(),isEmptyPage:e.blockStore.isEmptyPage(),size:this.iconSize(),style:{marginRight:6}}),s()(ds.a,{store:e.blockStore})),s()(Us,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}))}deviceSupportsUpgrade(e){const{device:t}=this.environment;return!t.isMobile||"personal"===e&&Object(qs.b)({environment:this.environment})}renderUnavailableMessage(e,t){const{device:a}=this.environment,i=Mt.default.state.data;let n=this.deviceSupportsUpgrade(t);const o=i&&ht.w(i);return n&&Object(qs.b)({environment:this.environment})&&"personal"===t&&!o&&(n=!1),s()("div",{style:this.getUnavailableMessageStyle()},void 0,this.deviceSupportsUpgrade(t)&&this.renderVersionHistoryIcon(),s()("div",{style:{...!a.isMobile&&{maxWidth:340}}},void 0,e),n&&t&&s()(fs.a,{isLarge:!0,onClick:()=>this.handleUpgrade(t),style:{marginTop:16}},void 0,s()(ne.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})))}renderVersionHistoryIcon(){return gt.a.versionHistory({width:64,height:"auto",fill:this.theme.lightIconColor,marginBottom:12})}renderMobileHelpButton(){return s()(zs.a,{href:Object(Ae.a)("guides.pageHistory"),analyticsFrom:"page_history"})}snapshotIsAvailable(e){return!!Q.default.isAdminMode||!!this.historyIsEnabled()&&(!!ht.Q(this.environment,"enterprise")||parseInt(e.timestamp)>Date.now()-30*mi.a)}historyIsEnabled(){return!!Q.default.isAdminMode||ht.I(this.environment)}getUnavailableMessage(){return s()(n.Fragment,{},void 0,s()(ne.FormattedMessage,{defaultMessage:"Version history is not available for free workspaces.",id:"historyModal.unavailableForFreeWorkspaces.messagePart1"}),s()("br",{}),s()(ne.FormattedMessage,{defaultMessage:"Please upgrade to one of our paid plans.",id:"historyModal.unavailableForFreeWorkspaces.messagePart2"}))}getSidebarStyle(){return{display:"flex",flexDirection:"column",flexShrink:0,width:Hs.sidebarWidth}}getUnavailableMessageStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...e.isMobile?{position:"relative",zIndex:1,background:this.theme.popoverBackground,boxShadow:"\n\t\t\t\t\t\t\t0 -1px 0 ".concat(this.theme.regularDividerColor,",\n\t\t\t\t\t\t\t0 1px 0 ").concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t")}:{height:"100%"}}}}d()(Hs,"sidebarWidth",240),d()(Hs,"restrictedMessage",s()(ne.FormattedMessage,{defaultMessage:"Please upgrade to the Enterprise Plan to access versions older than 30 days.",id:"historyModal.upgradeToEnterprise.message"})),d()(Hs,"noSnapshotsMessage",s()(ne.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"})),d()(Hs,"wrapStyle",{display:"flex",justifyContent:"center",padding:32});var Gs=Object(ne.injectIntl)(Hs),Ks=a("ijm6");class Ys extends u.a{constructor(...e){super(...e),d()(this,"renderPopupContent",()=>s()(Js,{}))}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:a}=Vi.a.state;return s()(he.c,{popupType:e.isMobile?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:Boolean(t),originRect:a,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,originGap:4,onDismiss:()=>Ks.a(this.environment),render:this.renderPopupContent})}}class Qs extends u.a{didMount(){const{blockStore:e}=Vi.a.state;if(!e)return;const t=e.getTitleStore();t&&Gt.k({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=Vi.a.state;if(!t)return;const a=t.getTitleStore();if(!a)return;let i;return i=e.isMobile?{menuType:ve.b.MenuType.ActionSheet}:{menuType:ve.b.MenuType.Popup,width:380},o.a.createElement(ve.b,i,s()("div",{style:this.getWrapStyle()},void 0,s()(zt.a,{store:a,disabled:!t.canEdit(),onEsc:()=>Ks.a(this.environment),onEnter:()=>Ks.a(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:this.getInputStyle()})))}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}const Js=Object(ne.injectIntl)(Qs);var Xs=Ys,$s=a("UWl0"),en=a("onX9");class tn extends u.a{constructor(...e){super(...e),d()(this,"renderMenu",()=>{const{device:e}=this.environment,t=en.a.state;if(!t.open)return;let a;return a=e.isMobileNative&&!e.isTablet?{menuType:ve.b.MenuType.ActionSheet}:{menuType:ve.b.MenuType.Popup,width:410,maxHeight:270,onClickOutside:$s.c},o.a.createElement(ve.b,a,s()(ot.a,{filter:this.getFilter(t)||"",onSubmit:this.handleSubmit,onNoResults:this.handleNoResults,isCallout:!1}))}),d()(this,"handleNoResults",()=>{const e=en.a.state;if(!e.open)return;const t=this.getFilter(e),a=f.a.last(t);a&&/\s/g.test(a)&&$s.c()}),d()(this,"handleSubmit",e=>{jt.createAndCommit(this.environment,t=>{$s.a({environment:this.environment,emoji:e,transaction:t})})}),d()(this,"handleCancel",()=>{$s.c()})}willMountOrUpdate(){const e=en.a.state;if(e.open){var t;const a=Ra.default.state,i=this.getFilter(e);("editing"!==a.mode||(null===(t=Object($a.a)("EmojiMenu",a.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===i||":"===i||i.startsWith("\n")||i.startsWith(" "))&&$s.c()}}renderComponent(){const{device:e}=this.environment,t=en.a.state;let a=!1;if(t.open){const e=this.getFilter(t);e&&e.length>0&&(a=!0),t.showPopupWithEmptyFilter&&(a=!0)}return s()(he.c,{popupType:e.isMobileNative&&!e.isTablet?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:a,originRect:t.open?t.selectionRect:void 0,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu,keepFocus:!0})}getFilter(e){return Ia.a(e.textStore,e.oldTextValue,!0)}}var an=tn,sn=a("oqx9"),nn=a("Rnyl"),on=a("rXSH"),rn=a("wllP"),ln=a("wiBh");class dn extends u.a{constructor(...e){super(...e),d()(this,"input",o.a.createRef()),d()(this,"handleInputChange",(e,t)=>{Hi.b.isOpen()&&Hi.b.setState({...Hi.b.state,value:e,error:t})}),d()(this,"handleSubmit",()=>{jt.createAndCommit(this.environment,e=>{nn.c({environment:this.environment,equationStore:Hi.b,transaction:e})})}),d()(this,"handleClose",()=>{nn.a()}),d()(this,"handleLeft",e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(this.handleSubmit(),nn.a(Hi.a.Backward))}),d()(this,"handleRight",e=>{if(!Hi.b.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const a=Hi.b.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===a&&t.endIndex===a&&(this.handleSubmit(),nn.a())}),d()(this,"isDisabled",()=>{var e;if("editing"!==Ra.default.state.mode&&!Hi.b.isOpen())return!0;const t=Hi.b.isOpen()?null===(e=Object($a.a)("InlineEquationOverlay",Hi.b.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=Object(rn.b)(t);if(e&&e.isLocked())return!0}if(t&&t.table===Ei.a){const e=this.getCommentValue(t),{currentUserStore:a}=Z.default.state;if(!e||!a)return!0;if(e.created_by_table!==La.a||a.id!==e.created_by_id)return!0}const a={[Pa.b.User]:Pa.b.User,[Pa.b.Page]:Pa.b.Page,[Pa.b.Bot]:Pa.b.Bot,[Pa.b.Date]:Pa.b.Date,[Pa.b.TemporaryPage]:Pa.b.TemporaryPage};for(const i of Object.values(a))if(Object(ln.t)(i))return!0;return!1}),d()(this,"INPUT_ORIGIN_GAP_PX",8)}renderComponent(){if(!Hi.b.isOpen())return;const e=!Hi.b.isOpen(),t=this.isDisabled(),a=this.getInputOriginRect(),i=Hi.b.state.value,n=Hi.b.state.error;return s()(re.DependencyConsumer,{dependency:re.deps.prismjs},void 0,s=>{if(!e)return o.a.createElement(on.a,{Prism:s,ref:this.input,isOpen:!0,equationValue:i,error:n,displayMode:"inline",disabled:t,originRect:a,originGap:this.INPUT_ORIGIN_GAP_PX,onDismiss:this.handleClose,onChange:this.handleInputChange,onSubmit:this.handleSubmit,onLeft:this.handleLeft,onRight:this.handleRight})})}getCommentValue(e){return sn.a.createChildStore(e,{table:Ei.a,id:e.id,spaceId:Object(Ls.c)(e.pointer.spaceId)}).getValue()}getInputOriginRect(){if(Hi.b.isOpen())return Hi.b.state.savedTextSelectionRect}}var cn=dn,un=a("40tV");class pn extends u.a{constructor(...e){super(...e),d()(this,"renderTooltip",()=>s()(be.a,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter},void 0,o.a.createElement(o.a.Fragment,null,s()(ne.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),s()("div",{},void 0,s()(Fi.a,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}}))))),d()(this,"handleEnter",e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:a,store:i}=t;if(!a)return;e.preventDefault&&e.preventDefault();const s=b.a.createChildStore(i,{table:S.a,id:a});J.navigateToBlock({store:s,environment:this.environment,visitType:un.c.Link})}),d()(this,"handleCommandEnter",e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:a,store:i}=t;if(!a)return;e.preventDefault();const s=b.a.createChildStore(i,{table:S.a,id:a});J.navigateToBlock({store:s,environment:this.environment,visitType:un.c.Link,metaClick:!0})}),d()(this,"pageMentionTokenStore",this.createComputedStore(()=>{const e=Ra.default.state;if("editing"!==e.mode)return;const t=Object(Gi.c)(e.multiSelection);if(!t)return;const{store:a,selection:i}=t;if(i.endIndex!==i.startIndex+1)return;const s=a.getValue(),n=Pa.ib(s,i.startIndex);if(!n||!Pa.Cb(n))return;const[o]=Pa.Y([n]);return{pageId:o,store:a}}))}renderComponent(){if(this.environment.device.isMobile)return;const e=Si.getSelectionRect(),t=this.pageMentionTokenStore.state;return s()(lt.a,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:lt.a.Placement.Bottom})}}var mn=pn,gn=a("FmD2");class hn extends u.a{constructor(...e){super(...e),d()(this,"handleKey",e=>{D.a.state.isActive&&(e.preventDefault(),Object(gn.b)({environment:this.environment,currentX:D.a.state.currentX,currentY:D.a.state.currentY,toggle:e.shiftKey}))}),d()(this,"handleMouseMove",e=>{D.a.state.isActive&&(e.preventDefault(),Object(gn.b)({environment:this.environment,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}),d()(this,"handleMouseUp",e=>{D.a.state.isActive&&(e.preventDefault(),Object(gn.a)(this.environment))})}willMount(){window.addEventListener("keydown",this.handleKey),window.addEventListener("keyup",this.handleKey),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}willUnmount(){window.removeEventListener("keydown",this.handleKey),window.removeEventListener("keyup",this.handleKey),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}renderComponent(){return null}}var fn=hn,Mn=a("FkPB"),yn=a("Zo/l"),vn=a("GQP/"),bn=a("nM47"),Sn=a("W7EN"),Cn=a("mUbl"),Tn=a("S26v"),kn=a("yFBc"),An=a("PHZn"),wn=a("VhAz"),In=a("d933"),Pn=a("aZ00"),Fn=a("Wvka");function xn(){const[e]=Object(Mn.b)(_i.a),t=Object(yn.a)(),a=Object(Mn.a)(()=>{if(!e.open)return!1;if(e.focusMenu)return!1;const t=Ra.default.state;if("editing"!==t.mode)return!0;const a=Object($a.a)("LinkMenu",t.multiSelection);if(!a)return!0;const{store:i,selection:s}=a;return Object(ln.r)(s)?!Pa.ob(i.getValue(),s.startIndex,s.endIndex,Pa.b.Link):!Object(Gi.f)(t.multiSelection,e.savedTextSelectionState.multiSelection)},[e]);return Object(n.useEffect)(()=>{a&&vn.a()},[a]),s()(he.c,{popupType:t.isMobile?t.isTablet?he.c.PopupType.Popup:he.c.PopupType.SlideUp:he.c.PopupType.Popup,style:{width:330},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:vn.a,render:()=>e.open?s()(En,{state:e}):void 0})}function En(e){const{state:t}=e,a=Object(yn.c)(),i=Object(ne.useIntl)(),r=i.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder",description:"Placeholder text in the link input field when there is no current link"}),l=i.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder",description:"Placeholder text in the link input field when there is an existing link that will be modified"}),[d,c]=Object(n.useState)(!0);if(Object(n.useEffect)(()=>c(!1),[]),t.showCreateIn&&!a)return s()(Bn,{state:t});const u=!a||!t.showCreateIn,p=a?void 0:!t.showCreateIn&&t.focusMenu,m=t.editingToken?l:r,g=s()(Me.a,{isInput:!0,desktopStyle:Wn(t)?{marginBottom:8}:void 0},void 0,u&&s()(ye.a,{onFocus:jn,placeholder:m,value:t.url,onChange:Un,focus:p,focusInitial:a,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0}));let h;return h=a?{menuType:ve.b.MenuType.Modal,title:s()(ne.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:s()(ke.CancelMenuText,{}),onClickRight:vn.a,header:g,footer:s()(he.c,{popupType:he.c.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>s()(Bn,{state:t})})}:{menuType:ve.b.MenuType.Popup,header:g},s()(Ji.a,{capture:t.open&&(d||t.focusMenu),allowEsc:!0},void 0,o.a.createElement(ve.b,h,s()(Dn,{state:t})),s()(be.a,{capture:!0,onCommandSlash:jn}))}function Bn(e){var t;const{state:a}=e,i=Object(yn.b)(),o=Object(n.useCallback)(async e=>{var t;if(!bn.j(i))return;const s=null===(t=Object($a.a)("LinkMenu",a.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!s)return;const n=jt.create(i),o=Object(ja.e)({environment:i,transaction:n,titleText:a.url||"",createInValue:e,recordStoreParent:s}),[r]=o.createdPages;r&&vn.b({environment:i,url:Object(Sn.a)({pageId:r.id}),transaction:n,editingToken:a.editingToken,savedTextSelectionState:a.savedTextSelectionState}),await o.moveToStorePromise,await jt.commit({environment:i,transaction:n}),await Object(ja.a)({analyticsFrom:"link_menu",createInState:o})},[a,i]),r=null===(t=Object($a.a)("LinkMenu",a.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,l=r&&"block"===r.table?r.id:void 0;return s()(wa.a,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:o,captureSelection:!1,restoreSelection:!1,parentBlockId:l,onAutocompleteQueryChange:On,autocompleteQuery:a.createInQuery||"",desktopWidth:330,onCancel:Ln})}function Dn(e){var t;const{state:a}=e,i=Object(yn.b)(),r=Object(yn.c)(),l=Object(An.b)(),[{online:d}]=Object(Mn.b)(Ea.a),c=Object(n.useMemo)(()=>Zn(a),[a]),u=Object(n.useMemo)(()=>Vn(c),[c]),p=Object(n.useMemo)(()=>{var e;const t=null===(e=Object($a.a)("LinkMenu",a.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store;if(t&&Object(oe.p)(t))return t},[a]),[{value:m,status:g}]=Object(Cn.a)(async()=>{if(!c||!d)return[];return(await Object(kt.e)({nearBlock:p,environment:i,query:c,source:"mention_menu",limit:10})).map(e=>e.id)},[c,p,i,d]),h=Object(n.useMemo)(()=>{if(u&&"notion"===u.type){const e=m?f.a.without(m,u.notionPage.blockId):[];return[u,...e]}return m},[m,u]),M=Object(n.useMemo)(()=>{if(!h||0===h.length)return;if(u&&"web"===u.type&&u.url===c)return;const e=In.a.withListenerIgnored(B.e);if(!e)return;const t=a.url?5:3,n=s()(ne.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block",description:"Shown beneath a page title if linking to a block inside that page"}),r=s()(ne.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"}),l=f.a.compact(h.map(t=>{const r="object"==typeof t?t.notionPage.peekViewBlockId||t.notionPage.blockId:t,l=b.a.createChildStore(e,{table:S.a,id:r});return{key:r,action:()=>{if("object"==typeof t){const e=Object(Sn.a)({pageId:t.notionPage.blockId,peekViewBlockId:t.notionPage.peekViewBlockId,discussionId:t.notionPage.discussionId,collectionViewId:t.notionPage.collectionViewId,scrollToBlockId:t.notionPage.scrollToBlockId});_n(i,a,e)}else _n(i,a,Object(Sn.a)({pageId:r}))},render:e=>{const a="object"==typeof t&&t.notionPage.scrollToBlockId;return o.a.createElement(Ta.a,We()({},e,{store:l,caption:a?n:void 0,placeholder:s()(Aa.a,{showHold:300,showDelay:300,show:"resolved"===g,render:e=>s()(ne.FormattedMessage,e?{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}:{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})}))}}})).slice(0,t),d=h.some(e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId));return{key:"mention results",items:l,render:e=>o.a.createElement(Me.a,We()({},e,{title:d?r:n,isTitleUppercase:!0}))}},[h,a,i,c,u,g]),y=Object(n.useMemo)(()=>{const e=s()(ne.FormattedMessage,{defaultMessage:"Linked to",id:"selectionLinkButton.linkedToSection.title"}),t=Nn(a),n=t?Object(Sn.c)(t):void 0;if(n&&t){const a=In.a.withListenerIgnored(B.e);if(!a)return;const s=b.a.createChildStore(a,{table:S.a,id:n});return{key:"linked to",render:t=>o.a.createElement(Me.a,We()({title:e,isTitleUppercase:!0},t)),items:[{key:"linked to page",action:({event:e})=>{const a=e&&e.metaKey;a||_i.a.setState({open:!1}),Object(J.navigate)({environment:i,url:t,metaClick:a})},render:e=>o.a.createElement(Ta.a,We()({},e,{store:s}))}]}}if(t)return{key:"linked to",render:t=>o.a.createElement(Me.a,We()({title:e,isTitleUppercase:!0},t)),items:[{key:"linked to web",action:({event:e})=>Object(J.navigate)({environment:i,url:t,metaClick:e&&e.metaKey}),render:e=>o.a.createElement(It.a,We()({},e,{title:t,caption:s()(ne.FormattedMessage,{defaultMessage:"Web page",id:"selectionLinkButton.linkedToSection.webPage"}),icon:gt.a.globe2({width:16,fill:l.mediumIconColor})}))}]}},[i,a,l]),v=Object(n.useMemo)(()=>{if(!u)return;if("notion"===u.type&&d)return;let e;return"web"===u.type?e=s()(ne.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===u.type?e=s()(ne.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===u.type?e=s()(ne.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):Object(wn.f)(u),{key:"link to url",action:()=>_n(i,a,c),render:t=>o.a.createElement(It.a,We()({},t,{title:e,icon:gt.a.link({width:16})}))}},[a,c,i,d,u]),C=Object(n.useMemo)(()=>{if(a.editingToken)return{key:"copy link",action:()=>function(e,t){const a=Nn(t);if(!a)return;const i=Object(Sn.c)(a),s=i?Object(Fn.a)({pageId:i,baseUrl:Q.default.domainBaseUrl}):a;Pn.c({environment:e,stringValue:s}),vn.a()}(i,a),render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{id:"selectionLinkButton.copyLink",defaultMessage:"Copy link",description:"Copies the URL for the focused link to the user's clipboard"}),icon:gt.a.copy({width:16})}))}},[a,i]),T=Object(n.useMemo)(()=>{if(a.editingToken)return{key:"unlink",action:()=>vn.d(i),render:e=>o.a.createElement(It.a,We()({},e,{title:s()(ne.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:gt.a.trash({width:16})}))}},[a.editingToken,i]),k=null===(t=Object($a.a)("LinkMenu",a.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,A=Object(n.useMemo)(()=>{if(!c)return;if(!k||!k.isDefaultRecordCache())return;const e=Vn(c);return!e||e.url!==c&&!e.notionPage?{key:"create page",action:Rn,render:e=>o.a.createElement(It.a,We()({},e,{icon:gt.a.alias({width:16}),title:s()(za,{pageTitle:c})}))}:void 0},[c,k]),w=f.a.compact([M,y]),I=w.length>0,P=Object(n.useMemo)(()=>{const e=f.a.compact([v,C,T,A]);if(0!==e.length)return{key:"link actions",render:e=>o.a.createElement(Me.a,We()({topBorder:I},e)),items:e}},[I,v,C,T,A]),F=f.a.compact([...w,P]),x=Object(n.useMemo)(()=>{if(r)return;if(!u||!P||!v)return 0===F.length?void 0:0;const e=f.a.sum(w.map(e=>e.items.length))+P.items.indexOf(v);return Math.max(e,0)},[r,u,P,v,F,w]);return s()(Sa.a,{type:Sa.a.Type.Vertical,initialFocus:x,sections:F})}function On(e){const t=_i.a.state;t.open&&_i.a.setState({...t,createInQuery:e})}function Rn(){const e=_i.a.state;e.open&&_i.a.setState({...e,showCreateIn:!0})}function Ln(){const e=_i.a.state;e.open&&_i.a.setState({...e,showCreateIn:!1,createInQuery:""})}function _n(e,t,a){const i=Object(kn.a)(a);i&&jt.createAndCommit(e,a=>{vn.b({environment:e,transaction:a,url:i,editingToken:t.editingToken,savedTextSelectionState:t.savedTextSelectionState})})}const Un=e=>{const t=_i.a.state;t.open&&_i.a.setState({...t,url:e.target.value,focusMenu:!0})};function jn(){const e=_i.a.state;e.open&&(e.focusMenu||_i.a.setState({...e,focusMenu:!0}))}function Nn(e){const{editingToken:t}=e;if(!t)return;const a=Pa.fb(t),i=Pa.A(a);return i?Pa.R(i):void 0}function Zn(e){return e.url||""}function Wn(e){return""===Zn(e)&&void 0===Nn(e)}function Vn(e){const t=Pa.T(e);if(t&&"url"===t.type){const e=Object(hi.l)({url:t.href,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const a=Object(Tn.k)(e);if(a)return{type:"other",url:a}}var zn=a("Ko2L"),qn=a("DaKt"),Hn=a("gyLq"),Gn=a("mY49"),Kn=a("DyNK");function Yn(e){const[t]=Object(Mn.b)(zn.a),a=Object(Mn.c)(qn.a),i=Object(Gn.b)(t,400,Object.is),o=t&&t===i,r=Object(n.useMemo)(()=>i&&i.token.node.getBoundingClientRect(),[i]);return s()(he.c,{disableMouseCapture:!0,preventCaptureEsc:!0,preventPointerEvents:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:he.c.PopupType.Popup,open:Boolean(!a&&o),originRect:r,originGap:8,alignmentToOrigin:he.c.Alignment.Start,placementToOrigin:he.c.Placement.Bottom,useLightBoxShadow:!0,render:()=>i&&s()(Qn,{state:i})})}function Qn(e){Object(n.useEffect)(()=>{const e=f.a.throttle(Kn.a,200,{leading:!0});return v.a(window,"scroll",e,!0),()=>v.b(window,"scroll",e,!0)},[]);const t=e.state.annotation;return Pa.yb(t)?o.a.createElement(Jn,We()({},e,{state:{...e.state,annotation:t}})):Pa.sb(t)?o.a.createElement(Xn,We()({},e,{state:{...e.state,annotation:t}})):Object(wn.f)(t)}function Jn(e){const{annotation:t,store:a}=e.state,i=Object(yn.b)(),n=Object(An.b)(),r=Pa.R(t),l=Object(Sn.c)(r),d=Object(An.a)(e=>({wrapper:{fontSize:Ke.a.fontSize.UISmall.desktop,padding:"4px 8px",color:e.mediumTextColor,fontWeight:Ke.a.fontWeight.medium,fill:e.mediumIconColor,maxWidth:450},icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor}}),[]),c=Object(Mn.a)(()=>{if(!l)return;const e=b.a.createChildStore(a,{table:S.a,id:l}),t=e.getValue(),n=t&&Object(_a.h)({pageValue:t,baseUrl:Q.default.domainBaseUrl,getRecordValue:a.getRecordValue,emojiType:Object(Ua.a)(i),isSafariOrIOS:i.device.isSafari||i.device.isIOS,isClient:!0,showEmojiInline:i.device.isWindows,currentUserId:i.currentUser.id}),r=t&&t.parent_id!==a.id?gt.a.alias(d.icon):void 0;return o.a.createElement(o.a.Fragment,null,n,r,s()(ds.a,{style:Ke.a.textOverflowStyle,store:e}))},[l,n,d]);return s()(Hn.a,{style:d.wrapper,alignItems:"center"},void 0,c||o.a.createElement(o.a.Fragment,null,gt.a.globe2(d.icon),s()("div",{style:Ke.a.textOverflowStyle},void 0,r)))}function Xn(e){const{annotation:t}=e.state,a=Pa.J(t),i=Object(An.a)(e=>({container:{fontSize:Ke.a.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"},icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor}}),[]),n=Object(ne.useIntl)(),o="relative"===a.date_format?"ll":"relative",r=Object(xa.a)({value:a,date_format:o,time_format:"h:mm A",allowRelativeDates:!0,intl:n});return r===Object(xa.a)({value:a,date_format:a.date_format,time_format:a.time_format,allowRelativeDates:!0,intl:n})?null:s()(Hn.a,{style:i.container,alignItems:"center"},void 0,gt.a.calendar(i.icon),s()("div",{style:Ke.a.textOverflowStyle},void 0,r))}var $n=a("FYnd"),eo=a("cftq"),to=a("mgru");const ao=Object(ne.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class io extends u.a{constructor(...e){super(...e),d()(this,"renderMenu",()=>{const{device:e}=this.environment,t=eo.a.state;if(!t.open)return;const a=this.getSections(t);let i;return i=e.isMobile?{menuType:ve.b.MenuType.ActionSheet}:{menuType:ve.b.MenuType.Popup,width:320,maxHeight:"40vh"},o.a.createElement(ve.b,We()({},i,{className:Ft.z}),s()(Sa.a,{type:Sa.a.Type.Vertical,sections:a,initialFocus:0}))}),d()(this,"handleDismiss",()=>{$n.c()})}willMountOrUpdate(){const e=eo.a.state;if(e.open){const{stores:t,phase:a}=T.default.state;Object(to.a)(t,e.blocks)&&a===T.SelectionPhase.Selected||$n.c()}}renderComponent(){const{device:e}=this.environment,t=eo.a.state;return s()(he.c,{popupType:e.isMobileNative&&!e.isTablet?he.c.PopupType.SlideUp:he.c.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:he.c.Placement.Bottom,alignmentToOrigin:he.c.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{blocks:t,copiedStores:a,pageSource:i}=e,s=[];$n.f({blocks:t,copiedStores:a})&&s.push({name:xt.default.formatMessage(ao.createTransclusion),action:async()=>{await $n.a({environment:this.environment,blocks:t,copiedBlockIds:a.map(e=>e.id)})}}),$n.g({blocks:t})&&s.push({name:xt.default.formatMessage(ao.linkToPage),action:async()=>{await Object(jt.createAndCommit)(this.environment,e=>$n.b({environment:this.environment,blocks:t,transaction:e,copiedStores:a,pageSource:i}))}});return[{key:"embed section",render:e=>o.a.createElement(Me.a,e),items:[{key:"dismiss",render:e=>o.a.createElement(It.a,We()({},e,{title:xt.default.formatMessage(ao.dismissItem)})),action:this.handleDismiss},...s.map(({name:e,action:t})=>({key:"embed ".concat(e),render:t=>o.a.createElement(It.a,We()({},t,{title:e})),action:t}))]}]}}var so=io,no=a("60ux"),oo=a("IdSf"),ro=a("vio7"),lo=a("hU3F");class co extends u.a{constructor(...e){super(...e),d()(this,"showingAnimatedList",new lo.a(!1)),d()(this,"handleShow",()=>{this.showingAnimatedList.set(!0)}),d()(this,"handleHide",()=>{this.showingAnimatedList.set(!1)})}renderComponent(){const{currentItem:e}=no.a.state,t=Boolean(e||this.showingAnimatedList.get());return s()(Ue.a,{open:t,render:()=>s()(ro.a,{render:()=>f.a.compact([this.renderCurrentItem()]),onShow:this.handleShow,onHide:this.handleHide})})}renderCurrentItem(){const{currentItem:e}=no.a.state;if(e)return s()(qe.a,{isVisible:!0,enterAnimationStyle:{translateY:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>s()("div",{style:{position:"fixed",bottom:24,left:0,width:"100%",display:"flex"}},void 0,s()("div",{style:{background:this.theme.tooltipBackground,color:this.theme.regularInvertedTextColor,borderRadius:3,padding:"6px 12px",boxShadow:this.theme.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center"}},void 0,e.label,e.helpUrl&&s()(oo.a,{href:e.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16}},void 0,gt.a.help({fill:this.theme.mediumInvertedTextColor}))))},e.key)}}var uo=co;class po extends u.a{willMount(){this.environment.device.isMobile&&document.addEventListener("gesturestart",(function(e){e.preventDefault()}))}renderComponent(){const e=this.environment.currentUser.isLoggedIn(),{isMobile:t,isElectron:a}=this.environment.device,{currentSpaceStore:i}=Z.default.state;return s()(n.Fragment,{},void 0,s()(pe,{}),s()(la,{}),s()(ha,{}),s()(va,{}),s()(g,{}),s()(r.a,{isRoot:!0,capture:!0}),s()(j,{}),e&&!t&&s()(q,{}),e&&i&&s()(de,{rootStore:i}),s()(Ne,{}),s()(Zt,{}),s()(Pe,{}),s()(Jt,{}),s()(Xs,{}),s()(et,{}),s()(De,{}),!t&&s()(Yi,{}),s()(cn,{}),s()(mn,{}),s()(_t,{}),s()(Xt.a,{store:F.a}),s()(Xt.a,{store:P.a}),s()(ii,{}),s()(di,{}),s()(an,{}),s()(bi,{}),s()(so,{}),s()(uo,{}),s()(xn,{}),a&&s()(es,{}),s()(ss,{}),s()(bs,{}),s()(ks,{}),s()(fn,{}),e&&s()(Gs,{}),s()(Yn,{}))}}t.default=po},DQmc:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("SYor"),a("LvDl")),c=a.n(d),u=a("q1tI"),p=a.n(u),m=a("mF3+"),g=a("Mr7a"),h=a("4HCU"),f=a("wldR"),M=a("yisX"),y=a("y6Dp"),v=a("VBxf"),b=a("tw5M"),S=a("zmp8"),C=a("Sb6f"),T=a("LeVO"),k=a("Pl3d"),A=a("WgIs"),w=a("2Y+N"),I=a("f0kS"),P=a("SR/M"),F=a("gbGO"),x=a("zTdN"),E=a("W3at"),B=a("Cycz"),D=a("nM47"),O=a("r8MX"),R=a("Ng05"),L=a("7M94"),_=a("WLsh"),U=a("KTXS"),j=a("9wIn"),N=a("5/h/"),Z=a("z22Z"),W=a("xL2i"),V=a("3JF5"),z=a("kdGy");class q extends f.a{renderComponent(){const{bot:e}=this.props;return p.a.createElement(P.a,s()({},this.props,{icon:o()(z.a,{botValue:e}),title:Object(V.a)(e)}))}}l()(q,"contextTypes",F.c);var H=q,G=a("J9+s"),K=a("nPEg"),Y=a("AXh+"),Q=a("DbeH");class J extends f.a{renderComponent(){return p.a.createElement(w.a,s()({},this.props,{title:o()(G.FormattedMessage,{id:"inviteUserModal.searchDropdown.selectPersonTitle",defaultMessage:"Select a person"})}))}}var X=a("DNfA"),$=a("0CAA"),ee=a("Pqcg"),te=a("5Nka"),ae=a("8f5p"),ie=a("VhAz"),se=a("xRf7"),ne=a("MeYt");class oe extends f.a{renderComponent(){return o()(ne.a,{hovered:this.props.hovered,onClick:this.props.onClick,disabled:this.props.disabled,disabledFeedback:!0,style:{...this.getButtonStyle(),...this.props.isLarge&&{height:32},...this.props.style},hoveredStyle:{background:this.theme.buttonHoveredBackground},pressedStyle:{background:this.theme.buttonPressedBackground},onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,className:this.props.className},void 0,this.props.children)}getButtonStyle(){return{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:3,boxShadow:this.theme.plainButtonBoxShadow,background:this.theme.inputBackground,color:this.theme.mediumTextColor,fill:S.g.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}}}var re=oe,le=a("Oy36"),de=a("QcDD"),ce=a("7TLZ"),ue=a("FUUC"),pe=a("HRSx");class me extends f.a{constructor(...e){super(...e),l()(this,"storeTypes",{permissionsInviteStore:b.a}),l()(this,"renderOverlay",()=>{const{permissionsInviteStore:e}=this.stores,{tokenQuery:t}=e.state,a=Object(ce.p)(this.props.store),i=e.state.inviteTargets.map(e=>{const t="newUser"===e.type?e.value.email:"".concat(e.type,"-").concat(e.value.id);return o()(j.a,{target:e,onClickRemove:this.handleClickRemoveToken},t)}),n={request:t,performRequest:async e=>{const[t,i,s,{user:n,email:o}]=await Promise.all([h.m({environment:this.environment,query:e,membersOnly:this.props.membersOnly}),h.k({environment:this.environment,query:e}),a?h.l({query:e,intl:this.props.intl}):[],h.d(this.environment,e)]),r=t.slice(0,10).map(e=>({type:"existingUser",value:e})),l=i.slice(0,10).map(e=>({type:"bot",value:e})),d=s.slice(0,10).map(e=>({type:"group",value:e}));return n&&r.push({type:"existingUser",value:n}),o&&r.push({type:"newUser",value:{email:o}}),{inviteUsers:c.a.uniqBy(r,e=>e.value.email),inviteBots:l,inviteGroups:d}},render:(e,i,n)=>{if(e)return o()(J,{loading:!n},void 0,o()(x.a,{title:o()(G.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})}));const r=(i&&i.inviteUsers||[]).filter(e=>!this.alreadyInvitingTarget(e)&&!("existingUser"===e.type&&this.targetHasPermission(e))),l=(i&&i.inviteBots||[]).filter(e=>!(!e.value.alive||this.alreadyInvitingTarget(e))&&!this.targetHasPermission(e)),d=(i&&i.inviteGroups||[]).filter(e=>!this.alreadyInvitingTarget(e)&&!this.targetHasPermission(e)),{data:c}=O.default.state,u=r.map(e=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>{const a=c?B.v(c):[],i="existingUser"===e.type&&a.find(t=>t.userId===e.value.id);let n;return i&&Object(Z.a)(i.role)?n=o()(T.a,{renderTooltip:()=>o()(G.FormattedMessage,{id:"inviteUserModal.userRole.adminBadge.tooltip",defaultMessage:"This person is an admin in this workspace"}),render:e=>p.a.createElement("div",s()({style:this.getBadgeStyle()},e),o()(G.FormattedMessage,{id:"inviteUserModal.userRole.adminBadge.label",defaultMessage:"Admin"}))}):i&&Object(Z.c)(i.role)?n=o()(T.a,{renderTooltip:()=>o()(G.FormattedMessage,{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"This person is a member in this workspace"}),render:e=>p.a.createElement("div",s()({style:this.getBadgeStyle()},e),o()(G.FormattedMessage,{id:"inviteUserModal.userRole.memberBadge.label",defaultMessage:"Member"}))}):i&&(n=o()(T.a,{renderTooltip:()=>o()(G.FormattedMessage,{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"This person is a guest in this workspace"}),render:e=>p.a.createElement("div",s()({style:this.getBadgeStyle()},e),o()(G.FormattedMessage,{id:"inviteUserModal.userRole.guestBadge.label",defaultMessage:"Guest"}))})),"existingUser"===e.type?p.a.createElement(I.a,s()({},t,{user:e.value,right:n})):p.a.createElement(P.a,s()({},t,{icon:m.a.mail({width:me.avatarSize,height:me.avatarSize}),right:n,title:e.value.email.trim()}))},action:()=>{const{permissionsInviteStore:t}=this.stores;!t.state.isInviteTargetsEmpty&&Object(b.c)(t.state)||t.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}})),g=l.map(e=>{const{value:t}=e;return{key:t.id,render:e=>p.a.createElement(H,s()({},e,{bot:t})),action:()=>{const{permissionsInviteStore:t}=this.stores;(t.state.isInviteTargetsEmpty||Object(b.c)(t.state))&&(t.state.table===pe.a?this.stores.permissionsInviteStore.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],inviteRole:this.getDefaultRoleForBlockBot(),isInviteTargetsEmpty:!1,tokenQuery:"",table:t.state.table}):t.state.table===ue.a?this.stores.permissionsInviteStore.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],inviteRole:this.getDefaultRoleForSpaceBot(),isInviteTargetsEmpty:!1,tokenQuery:"",table:t.state.table}):Object(ie.f)(t.state.table))}}}),{currentSpaceStore:h}=de.default.state,f=d.map(e=>{const{value:t}=e,a=Object(ae.a)({intl:this.props.intl,group:t}),i=h&&t.icon?{pointer:{table:h.table,id:h.id},icon:t.icon}:void 0;return{key:t.id,render:e=>p.a.createElement(P.a,s()({},e,{icon:o()(le.a,{disabled:!0,size:22,icon:i,isEmptyPage:!1,title:a}),title:a})),action:()=>{const{permissionsInviteStore:t}=this.stores;!t.state.isInviteTargetsEmpty&&Object(b.c)(t.state)||t.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}}}),M=[],{permissionsInviteStore:y}=this.stores;if(u.length>0&&(y.state.isInviteTargetsEmpty||!Object(b.c)(y.state))&&M.push({key:"user results",render:e=>p.a.createElement(J,s()({},e,{loading:!n})),items:u}),g.length>0&&(y.state.isInviteTargetsEmpty||Object(b.c)(y.state))&&M.push({key:"bot results",render:e=>p.a.createElement(w.a,s()({},e,{title:this.props.intl.formatMessage({id:"permissionsInvite.integration.select.message",defaultMessage:"Select an integration"}),loading:!n})),items:g}),a&&f.length>0&&(y.state.isInviteTargetsEmpty||!Object(b.c)(y.state))&&M.push({key:"group results",render:e=>p.a.createElement(w.a,s()({},e,{title:o()(G.FormattedMessage,{id:"inviteUserModal.searchDropdown.selectGroupTitle",defaultMessage:"Select a group"}),loading:!n})),items:f}),0===M.length&&(y.state.isInviteTargetsEmpty||!Object(b.c)(y.state))){const e=Object(_.d)(y.state.tokenQuery);if(e){const t={type:"newUser",value:{email:e}},a=this.alreadyInvitingTarget(t);if(!a)return;if(a)return o()(J,{loading:!n},void 0,o()(x.a,{title:o()(G.FormattedMessage,{id:"inviteUserModal.userAlreadyInvitedMessage",defaultMessage:"Already inviting {user}.",values:{user:o()("span",{style:{fontWeight:C.a.fontWeight.bold}},void 0,this.getTargetName(a))}})}));const s=(i&&i.inviteUsers||[]).find(t=>"existingUser"===t.type&&t.value.email===e);if(s&&"existingUser"===s.type&&this.targetHasPermission(s))return o()(J,{loading:!n},void 0,o()(x.a,{title:o()(G.FormattedMessage,{id:"inviteUserModal.userAlreadyHasPermissionMessage",defaultMessage:"{user} already has permission.",values:{user:o()("span",{style:{fontWeight:C.a.fontWeight.bold}},void 0,Object(N.e)(this.props.intl,s.value))}})}))}return o()(J,{loading:!n},void 0,o()(x.a,{title:o()(G.FormattedMessage,{id:"inviteUserModal.searchPersonDropdown.noSearchResultsMessage",defaultMessage:"Type or paste in emails above, separated by commas."})}))}return o()(A.a,{type:A.a.Type.Vertical,initialFocus:t.length>0?0:void 0,sections:M})}},{device:r}=this.environment,l=Object(ce.r)(this.props.store)?this.props.intl.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):this.props.intl.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),d=o()(E.a,{focus:!r.isMobile||void 0,focusInitial:r.isMobile,focusAfterAnimation:!0,format:E.a.Format.Share,value:t,onChange:this.handleInputChange,type:"email",tokens:i,disabled:!1,placeholder:l,onRemoveLastToken:()=>{const e={...this.stores.permissionsInviteStore.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=this.getDefaultRoleForNonBot()),this.stores.permissionsInviteStore.setState(e)},right:!r.isMobile&&this.renderDesktopInputRightInner(),onEmptyEnter:this.handleInviteClick,dontShowBorderBottom:r.isAndroid});let g;return g=r.isMobile?{menuType:F.b.MenuType.Modal,title:Object(ce.r)(this.props.store)?o()(G.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):o()(G.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:o()("div",{style:{color:S.g.blue}},void 0,o()(G.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})),left:o()(K.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:this.handleInviteClick,header:d}:{menuType:F.b.MenuType.Popup,width:480,height:"60vh",header:d,tokenInputHeader:!0,footer:this.renderHelpButton()},p.a.createElement(F.b,s()({},g,{className:L.H}),o()(u.Fragment,{},void 0,r.isMobile&&o()(w.a,{title:o()(G.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"})},void 0,this.renderDesktopInputRightInnerSelect()),p.a.createElement(k.a,n),r.isMobile&&this.renderHelpButton()))}),l()(this,"handleTrialClick",()=>{Q.a(this.environment,{from:this.props.upgradeButtonName,for:"team_free"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()}),l()(this,"handleUpgradeClick",()=>{Q.a(this.environment,{from:this.props.upgradeButtonName,for:"team"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()}),l()(this,"handleButtonClick",()=>{this.stores.permissionsInviteStore.setState({modalOpen:!0,tokenQuery:"",inviteTargets:[],inviteRole:this.getDefaultRoleForNonBot(),isInviteTargetsEmpty:!0,table:Object(ce.r)(this.props.store)?ue.a:pe.a}),Object(ce.r)(this.props.store)?y.Ad(this.environment):y.sd(this.environment)}),l()(this,"handleInviteClick",async()=>{const{store:e}=this.props,{permissionsInviteStore:t}=this.stores,{tokenQuery:a}=t.state;if(Object(_.e)(a.trim())&&(t.state.isInviteTargetsEmpty||!Object(b.c)(t.state))){const e={type:"newUser",value:{email:a.trim()}};this.alreadyInvitingTarget(e)||t.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}if(!t.state.isInviteTargetsEmpty&&t.state.inviteTargets.length>0)if(this.props.onInviteClick&&this.props.onInviteClick(),Object(b.c)(t.state))if(t.state.table===pe.a){if(!Object(ce.p)(e))throw new Error("Table mismatch.");const{inviteTargets:a,inviteRole:i}=t.state;t.reset(),await g.c({environment:this.environment,store:e,inviteTargets:a,inviteRole:i,isOnboarding:!1})}else if(t.state.table===ue.a){if(!Object(ce.r)(e))throw new Error("Table mismatch.");const{inviteTargets:a,inviteRole:i}=t.state;t.reset(),await g.c({environment:this.environment,store:e,inviteTargets:a,inviteRole:i,isOnboarding:!1})}else Object(ie.f)(t.state);else{const{inviteTargets:a,inviteRole:i}=t.state;t.reset(),await g.c({environment:this.environment,store:e,inviteTargets:a,inviteRole:i,isOnboarding:!1})}this.props.onInviteComplete&&this.props.onInviteComplete()}),l()(this,"handleModalDismiss",async()=>{const{permissionsInviteStore:e}=this.stores;return e.setState({...e.state,modalOpen:await this.attemptCloseInviteModal()})}),l()(this,"handleInputChange",e=>{if(!this.stores.permissionsInviteStore.state.isInviteTargetsEmpty&&Object(b.c)(this.stores.permissionsInviteStore.state))return;const t=e.target.value,{extractedEmails:a,newInputValue:i}=Object(_.a)(t),s=a.map(e=>({type:"newUser",value:{email:e}})).filter(e=>!this.alreadyInvitingTarget(e)),n=[...this.stores.permissionsInviteStore.state.inviteTargets,...s];n.length>0?this.stores.permissionsInviteStore.setState({...this.stores.permissionsInviteStore.state,inviteTargets:n,isInviteTargetsEmpty:!1,tokenQuery:i}):this.stores.permissionsInviteStore.setState({...this.stores.permissionsInviteStore.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:i})}),l()(this,"handleClickRemoveToken",e=>{const{permissionsInviteStore:t}=this.stores;if(!t.state.isInviteTargetsEmpty)if(Object(b.c)(t.state))if(Object(b.c)(t.state)){const a=t.state.inviteTargets.filter(t=>t!==e);0===a.length?t.setState({...t.state,inviteTargets:[],inviteRole:this.getDefaultRoleForNonBot(),isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:a})}else Object(ie.f)(t.state);else{const a=t.state.inviteTargets.filter(t=>t!==e);0===a.length?t.setState({...t.state,inviteTargets:[],inviteRole:this.getDefaultRoleForNonBot(),isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:a})}})}async willMount(){await D.e(this.environment)}renderComponent(){const{store:e}=this.props,{device:t}=this.environment,{modalOpen:a}=this.stores.permissionsInviteStore.state;let i,n,r=!1;return e.canAdmin()?e.canAdmin()&&Object(ce.r)(e)&&O.default.state.data&&!B.J(this.environment)?(i=!1,r=!0,n=o()(ee.a,{imageURL:te.a.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:o()(G.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:o()(G.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):i=!0:(i=!1,n=Object(ce.r)(e)?o()(G.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):o()(G.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),o()("div",{},void 0,Object(ce.r)(e)?o()(se.a,{open:a,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:o()(T.a,{renderTooltip:()=>n,disableTooltip:i,render:e=>p.a.createElement(R.a,s()({isLarge:!0,onClick:r?this.handleTrialClick:this.handleButtonClick,disabled:!i&&!r,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle}},e),o()(G.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}))})}):o()(se.a,{open:a,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:o()(T.a,{renderTooltip:()=>n,disableTooltip:i,render:e=>o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(re,{onClick:r?this.handleTrialClick:this.handleButtonClick,disabled:!i&&!r,style:{flex:1,justifyContent:"flex-start",height:t.isMobile?34:26,borderTopRightRadius:0,borderBottomRightRadius:0}},void 0,o()(G.FormattedMessage,{defaultMessage:"Add people, emails, groups, or integrations",id:"inviteUserButton.addGuestsAndGroupsAndIntegrationsLabel"})),p.a.createElement(R.a,s()({onClick:r?this.handleTrialClick:this.handleButtonClick,disabled:!i&&!r,style:{height:t.isMobile?36:28,borderTopLeftRadius:0,borderBottomLeftRadius:0}},e),o()(G.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})))})}))}renderHelpButton(){return o()(w.a,{topBorder:!0,disableDesktopPadding:!0},void 0,o()(U.a,{title:o()(G.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:Object($.a)("guides.invitePerson"),analyticsFrom:"invite_person"}))}renderDesktopInputRightInner(){return o()("div",{style:{marginLeft:8,display:"flex",alignItems:"center"}},void 0,this.renderDesktopInputRightInnerSelect(),this.renderDesktopInputRightInnerButton())}renderDesktopInputRightInnerButton(){const{disabled:e}=this.props,{permissionsInviteStore:t}=this.stores,a=t.state.inviteTargets,i=a.filter(({type:e})=>"newUser"===e).map(({value:e})=>e.email),n=a.filter(({type:e})=>"existingUser"===e).map(({value:e})=>e.id),r=e||Object(Y.d)({environment:this.environment,userIds:[...i,...n],includesOwner:!0});return o()(T.a,{textWrap:!0,alignment:X.a.Center,disableTooltip:!r,renderTooltip:()=>o()(p.a.Fragment,{},void 0,o()("div",{style:{width:280}},void 0,o()(G.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your personal plan allows up to 5 unique guests."})),o()("div",{},void 0,o()(G.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited."}))),render:e=>p.a.createElement(R.a,s()({style:{minWidth:me.inviteButtonWidth},onClick:r?this.handleUpgradeClick:this.handleInviteClick},e),o()(G.FormattedMessage,r?{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}:{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"}))})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{isSubscribed:t}=this.props,{permissionsInviteStore:a}=this.stores;return a.state.isInviteTargetsEmpty||!Object(b.c)(a.state)?o()(M.a,{role:a.state.inviteRole,table:a.state.table,type:"user_permission",isSubscribed:t,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",marginTop:e.isMobile?4:0,color:S.g.uiGray},isMenuItem:e.isMobile,onChange:e=>{!a.state.isInviteTargetsEmpty&&Object(b.c)(a.state)||a.setState({...a.state,inviteRole:e})}}):a.state.table===pe.a?o()(M.a,{role:a.state.inviteRole,table:a.state.table,type:"bot_permission",isSubscribed:t,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",marginTop:e.isMobile?4:0,color:S.g.uiGray},isMenuItem:e.isMobile,onChange:e=>{(a.state.isInviteTargetsEmpty||Object(b.c)(a.state))&&a.state.table===pe.a&&a.setState({...a.state,inviteRole:e})}}):a.state.table===ue.a?o()(M.a,{role:a.state.inviteRole,table:a.state.table,type:"bot_permission",isSubscribed:t,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",marginTop:e.isMobile?4:0,color:S.g.uiGray},isMenuItem:e.isMobile,onChange:e=>{(a.state.isInviteTargetsEmpty||Object(b.c)(a.state))&&a.state.table===ue.a&&a.setState({...a.state,inviteRole:e})}}):void Object(ie.f)(a.state)}async attemptCloseInviteModal(){const{permissionsInviteStore:e}=this.stores,t=o()(G.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),a=o()(G.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes",description:"Label for button that appears below the question, 'Your changes have not been saved. Discard changes?' to confirm that the user would like to discard the changes."}),i=o()(G.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel",description:"Label for button that appears below the question, 'Your changes have not been saved. Discard changes?' to confirm that the user does not want to discard the changes."});if(e.state.inviteTargets.length>0){return!(await v.confirmUserAction({message:t,acceptLabel:a,cancelLabel:i}))}return!1}getDefaultRoleForNonBot(){const{store:e,isSubscribed:t}=this.props;return Object(ce.r)(e)?t?"read_and_write":"editor":B.O(this.environment)?"editor":"read_and_write"}getDefaultRoleForBlockBot(){return"read_and_write"}getDefaultRoleForSpaceBot(){return"editor"}alreadyInvitingTarget(e){return this.stores.permissionsInviteStore.state.inviteTargets.find(t=>"newUser"===e.type?"newUser"===t.type&&e.value.email===t.value.email:t.type===e.type&&t.value.id===e.value.id)}targetHasPermission(e){const t=this.props.store.getValue();if(!t)return!1;return Object(W.i)(t).some(t=>{switch(e.type){case"existingUser":return Object(Z.q)(t)&&t.user_id===e.value.id;case"bot":return Object(Z.g)(t)&&t.bot_id===e.value.id;case"group":return Object(Z.i)(t)&&t.group_id===e.value.id;default:return!1}})}getTargetName(e){const{intl:t}=this.props;switch(e.type){case"newUser":return e.value.email;case"existingUser":return Object(N.e)(t,e.value);case"bot":return Object(V.a)(e.value);case"group":return Object(ae.a)({intl:t,group:e.value});default:Object(ie.f)(e)}}getBadgeStyle(){const{device:e}=this.environment;return{display:"inline-flex",height:18,textTransform:"uppercase",fontSize:10,marginBottom:2,fontWeight:C.a.fontWeight.medium,letterSpacing:1,color:S.g.uiLightGray,border:"1px solid ".concat(S.g.uiLightGray),minWidth:me.inviteButtonWidth,alignItems:"center",justifyContent:"center",paddingTop:e.isAndroid?2:1,paddingBottom:1,paddingLeft:3,paddingRight:3,borderRadius:3}}}l()(me,"avatarSize",24),l()(me,"inviteButtonWidth",70);t.default=Object(G.injectIntl)(me)},G8iD:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var i=a("lSNA"),s=a.n(i),n=(a("3bBZ"),a("/ssM")),o=a("LEzx");const r=20;let l;!function(e){e.Default="Default",e.Results="Results"}(l||(l={}));class d extends o.a{constructor(...e){super(...e),s()(this,"resetQuery",({resetFilters:e})=>{this.setState({...this.state,mode:l.Default,query:{...this.state.query,text:"",...e&&{filters:Object(n.f)()}},limit:r,allResultsLoaded:!1})}),s()(this,"updateFilters",e=>{const t=this.state.query.filters,a=Object(n.g)(t,e);this.state.mode,l.Default,this.setState({...this.state,query:{...this.state.query,filters:a}})})}getInitialState(){return{mode:l.Default,isSidebarOpen:!1,query:{text:"",filters:Object(n.f)(),sort:n.e.Relevance},limit:r,allResultsLoaded:!1}}isSidebarOpen(){if(this.state.isSidebarOpen){const{state:e}=this;return!0}return!1}}s()(d,"Mode",l),t.c=d},"J9+n":function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("pVnL"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("q1tI")),c=a.n(d),u=a("LvDl"),p=a.n(u),m=a("N34Z"),g=a("bkwR"),h=a("hvW1"),f=a("VBxf"),M=a("frzs"),y=a("QcDD"),v=a("y6Dp"),b=a("dlZW"),S=a("J9+s"),C=a("vl8/");const T=Object(S.defineMessages)({deletingAccount:{id:"accountActions.deletingAccount.loadingMessage",defaultMessage:"Deleting your account…"},noUserError:{id:"accountActions.deletingAccount.noUserToDeleteMessage",defaultMessage:"No account to delete."}}),k=function(e){const{userStore:t,data:a,transaction:i}=e,s={};a.name&&(s.name=a.name),a.givenName&&(s.given_name=a.givenName),a.familyName&&(s.family_name=a.familyName),s.profile_photo=a.profilePhoto,m.e({store:t,data:s,transaction:i})};var A=a("SAEH"),w=a("nM47"),I=a("LEzx"),P=a("D2XV");class F extends I.a{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:Object(P.H)()}}getValueForUser(e,t){const a=e.getValue();if(a){const{given_name:e,family_name:i,profile_photo:s,name:n}=a,o=t.getSettings();return{uploadingProfilePhoto:!1,givenName:e||"",familyName:i||"",profilePhoto:s,name:n||"",startDayOfWeek:void 0===o.start_day_of_week?Object(P.H)():o.start_day_of_week}}}}var x=F;class E extends I.a{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[]}}getValueForSpace(e){const t=e.getValue(),a=e.getPublicContentDomain();if(t){const{name:e,email_domains:i}=t;return{name:e||"",domain:a||"",emailDomains:i||[],domainState:"current-space"}}}}var B=E;class D extends I.a{getInitialState(){return{disablePublicAccess:!1,disableGuests:!1,disableMoveToSpace:!1,disableExport:!1,disableSpacePageEdits:!1,disablePublicAccessRequests:!1}}getValueForSpace(e){const t=e.getValue();if(t){const{disable_public_access:e,disable_guests:a,disable_move_to_space:i,disable_export:s,disable_space_page_edits:n,disable_public_access_requests:o}=t;return{disablePublicAccess:Boolean(e),disableGuests:Boolean(a),disableMoveToSpace:Boolean(i),disableExport:Boolean(s),disableSpacePageEdits:Boolean(n),disablePublicAccessRequests:Boolean(o)}}}}var O=D;async function R(e){const{environment:t,spaceId:a,store:i}=e,s=await g.getSamlConfigForSpace(t,{spaceId:a});if("failed"===s.type)f.showError(s);else if(s.data&&s.data.samlConfig){const e={...s.data.samlConfig,useMetadataUrl:Boolean(s.data.samlConfig.idpMetadataUrl)};return i.setState(e),s.data}return i.reset(),{}}class L extends I.a{getInitialState(){return{status:"unconfigured",emailDomains:[],spaceIds:[],createAccount:!1,useMetadataUrl:!1}}async getValueForSpace(e,t){const a=new L;return await R({environment:e,spaceId:t.id,store:a}),Promise.resolve(a.state)}}var _=L,U=a("toub"),j=a("wldR"),N=a("pqiZ"),Z=a("/6eU"),W=a("AXyr"),V=a("qKs6"),z=a("A9TN"),q=a("2m/B"),H=a("yNyh"),G=a("wlCD"),K=a("2A6Q"),Y=a("rQb/"),Q=a("MYfK"),J=a("MBf9"),X=a("hU3F"),$=a("Sb6f"),ee=a("p+Y9"),te=a("1y3T"),ae=a("vJXr"),ie=a("zmp8"),se=a("Ng05"),ne=a("IULH");function oe(){return(navigator.languages?navigator.languages.map(e=>e.toLowerCase()):navigator.language?[navigator.language.toLowerCase()]:navigator.userLanguage?[navigator.userLanguage.toLowerCase()]:[]).map(e=>e.split("-")[0])}const re=["ar","az","he","fa","ur"];class le extends j.a{renderComponent(){return this.renderTranslatedText()}renderTranslatedText(){const{translations:e}=this.props,t=oe();for(const a of t){const t=e[a];if(t)return s()("div",{style:this.getTextStyle(a)},void 0,t)}}getTextStyle(e){return re.includes(e)?{direction:"rtl",...this.props.style}:{...this.props.style}}}var de=le,ce=a("sSHh"),ue=a("Mkmb"),pe=a("aEEb"),me=a("HTHG"),ge=a("VoJ/"),he=a("CSYU"),fe=a("ibYI"),Me=a("Cycz"),ye=a("mF3+"),ve=a("kFin"),be=a("CNGQ"),Se=a("bxQm"),Ce=a("sZEU");let Te;!function(e){e.Password="Password",e.CurrentEmail="TemporaryPasscode"}(Te||(Te={}));class ke extends I.a{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}var Ae=ke,we=a("IYZQ"),Ie=a("zzAG");class Pe extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:Ae}),l()(this,"renderModalContent",()=>{const{store:e}=this.stores,{state:t}=e;return s()("div",{style:{...this.styles.modal,...this.getColors().modal}},void 0,s()(ve.a,{fetch:this.getAuthorizationType,loading:e=>e&&s()("div",{style:this.styles.loadingSpinner},void 0,s()(G.a,{})),render:()=>s()(c.a.Fragment,{},void 0,t.authorizationType===Te.Password?this.renderVerifyPassword(t):t.authorizationType===Te.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t))}))}),l()(this,"renderSetNewEmail",e=>{const{store:t}=this.stores;if(t.state.authorized)return s()(c.a.Fragment,{},void 0,s()("p",{style:this.styles.paragraph},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})),s()("div",{},void 0,this.renderNewEmailInput()),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),this.renderEducationPlanDowngradeWarning())}),l()(this,"handleSendCurrentEmailVerification",async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;const a=await g.sendTemporaryPassword(this.environment,{email:e.email,disableLoginLink:!0,isSignup:!1});"success"===a.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0}):t.setState({...t.state,currentEmailPasscodeSent:!0,error:Object(Ie.b)(this.props.intl,a)})}),l()(this,"handleChangeCurrentEmailPasscode",e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})}),l()(this,"handleChangePassword",e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:Te.Password,password:e.currentTarget.value,error:void 0})}),l()(this,"handleClearPassword",()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:Te.Password,password:""})}),l()(this,"handleSubmitAuthorization",async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===Te.Password){const t=this.getUserCurrentEmail();if(!t)return;const a=await g.loginWithEmail(this.environment,{email:t,password:e.state.password});if("failed"===a.type)return void e.setState({...e.state,error:Object(Ie.b)(this.props.intl,a)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1})}else e.state.authorizationType===Te.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1})}),l()(this,"handleChangeNewEmail",e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})}),l()(this,"handleClearNewEmail",()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,error:void 0})}),l()(this,"handleSendNewEmailVerification",async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=await g.sendEmailVerification(this.environment,{email:e.state.newEmail});"success"===t.type?e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:void 0}):e.setState({...e.state,error:Object(Ie.b)(this.props.intl,t)})}),l()(this,"handleChangeNewEmailPasscode",e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})}),l()(this,"handleSubmit",async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===Te.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode},a=await g.changeEmail(this.environment,t);"success"===a.type?await this.closeModal():e.setState({...e.state,error:Object(Ie.b)(this.props.intl,a)})}),l()(this,"handleSendUsMessageClick",()=>{Ce.a({environment:this.environment,from:"change_email_student"})}),l()(this,"openModal",()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})}),l()(this,"closeModal",async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await w.e(this.environment)}),l()(this,"getAuthorizationType",async()=>{const{store:e}=this.stores,{intl:t}=this.props,a=this.getUserCurrentEmail();if(!a)return;const i=await be.b({environment:this.environment,userEmail:a});i.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:a})}):i.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:Te.Password,password:""}):e.setState({open:!0,authorized:!1,authorizationType:Te.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""})}),l()(this,"styles",{modal:{width:460,padding:32,borderRadius:3,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:ie.g.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:$.a.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14}})}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return s()(c.a.Fragment,{},void 0,s()(Q.a,{},void 0,s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.emailSetting.label",defaultMessage:"Email"})),s()("div",{},void 0,s()("span",{style:{marginRight:12}},void 0,e&&e.email),s()(Se.a,{onClick:this.openModal},void 0,s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"}))),s()(Z.a,{open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent}))}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return s()(c.a.Fragment,{},void 0,s()("p",{style:{margin:0}},void 0,this.renderCurrentEmail()),s()("p",{style:this.styles.paragraph},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})),s()(H.b,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),s()(H.b,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:this.styles.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&s()("div",{style:this.styles.error},void 0,e.error),!e.authorized&&s()(se.a,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue",description:"After the user verifies their current password or email, they click this button to continue changing their email."})))}renderVerifyCurrentEmail(e){return s()(c.a.Fragment,{},void 0,s()("p",{style:{...this.styles.paragraph,marginTop:0}},void 0,this.renderCurrentEmail()," ",e.currentEmailPasscodeSent?s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton())}renderSendCurrentEmailPasscodeButton(){return s()(se.a,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code",description:"Sends a temporary verification passcode to the user's current email."}))}renderCurrentEmailPasscodeInput(e){return s()(c.a.Fragment,{},void 0,s()(H.b,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),!e.authorized&&s()(se.a,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue",description:"After the user verifies their current password or email, they click this button to continue changing their email."})))}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return s()(H.b,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:this.styles.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return s()(c.a.Fragment,{},void 0,e.error&&s()("div",{style:this.styles.error},void 0,e.error),s()(se.a,{isLarge:!0,style:this.styles.button,onClick:this.handleSendNewEmailVerification},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})))}renderNewEmailPasscodeInput(e){return s()(c.a.Fragment,{},void 0,s()("p",{style:this.styles.paragraph},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:s()("span",{style:this.styles.bold},void 0,e.newEmail)}})),s()(H.b,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:this.handleSubmit,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),e.error&&s()("div",{style:this.styles.error},void 0,e.error),s()(se.a,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmit},void 0,s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})))}renderEducationPlanDowngradeWarning(){const{hasEducationPlan:e}=this.props;if(e)return s()("div",{style:{...this.styles.educationPlanWarning,...this.getColors().educationPlanWarning}},void 0,ye.a.help({width:14,marginTop:4,marginRight:6,fill:this.theme.lightIconColor})," ",s()("div",{},void 0,s()(S.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Send us a message</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:(...e)=>s()(we.a,{onClick:this.handleSendUsMessageClick},void 0,e)}})))}renderCurrentEmail(){const{userValue:e}=this.props;if(e)return s()(S.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:s()("span",{style:this.styles.bold},void 0,e&&e.email)}})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:a}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:a.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getColors(){return{modal:{background:this.theme.contentBackground},educationPlanWarning:{color:this.theme.lightTextColor,borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}}}var Fe=Object(S.injectIntl)(Pe),xe=a("2ZkR"),Ee=a("0CAA"),Be=a("qX+M");class De extends I.a{getInitialState(){return{open:!1}}}var Oe=new De;class Re extends j.a{constructor(...e){super(...e),l()(this,"handleLogOutFromActiveSessions",async()=>{await g.logoutActiveSessions(this.environment,{}),this.openConfirmationModal()})}renderComponent(){return c.a.createElement(c.a.Fragment,null,s()("div",{style:this.getSettingsOptionStyle()},void 0,s()(Y.a,{smallMarginBottom:!0},void 0,s()(S.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,s()(S.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"You will be logged out of all other active sessions besides this one and will have to log back in."})),s()(ne.a,{isLarge:!0,isRed:!0,onClick:this.handleLogOutFromActiveSessions,style:{marginTop:12}},void 0,s()(S.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.button",defaultMessage:"Log out"}))),this.renderManageActiveSessionsModal())}renderManageActiveSessionsModal(){const{device:e}=this.environment,{open:t}=Oe.state,a=this.getUserEmailAddress();return s()(Z.a,{open:t,onDismiss:this.closeConfirmationModal,innerStyle:{width:e.isPhone?"90%":350,padding:24,display:"flex",flexDirection:"column"},render:()=>c.a.createElement(c.a.Fragment,null,s()("div",{style:{marginBottom:24}},void 0,s()(S.FormattedMessage,a?{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:a}}:{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})),s()(se.a,{onClick:this.closeConfirmationModal},void 0,s()(S.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})))})}openConfirmationModal(){Oe.setState({...Oe.state,open:!0})}closeConfirmationModal(){Oe.setState({...Oe.state,open:!1})}getUserEmailAddress(){let e=void 0;const{currentUserStore:t}=y.default.state;if(t){const a=t.getValue();e=a&&a.email}return e}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}var Le=Re,_e=a("8Gp+"),Ue=a("6dM0");class je extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{spaceProfileSettingsStore:x,passwordRequestStore:he.a,isEducationStore:X.a.of(!1)}),l()(this,"handleUploadProfilePhoto",()=>{ee.c({environment:this.environment,onStart:this.handleUploadStart,bucket:"public",onError:this.handleUploadError,onComplete:this.handleUploadComplete,accept:"image/*"})}),l()(this,"handleDeleteProfilePhoto",()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,profilePhoto:void 0})}),l()(this,"handleUpdateClick",()=>{const{givenName:e,familyName:t,name:a,profilePhoto:i,startDayOfWeek:n}=this.stores.spaceProfileSettingsStore.state,o=Object(Ue.x)(this.environment);o||e&&t?o&&!a?f.showErrorMessage(s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})):(J.createAndCommit(this.environment,s=>{const{currentUserStore:o,currentUserSettingsStore:r}=y.default.state;if(o&&k({userStore:o,data:{givenName:e,familyName:t,profilePhoto:i,name:a},transaction:s}),r){r.getSettings().start_day_of_week!==n&&V.f({userSettingsStore:r,data:{start_day_of_week:n},transaction:s})}}),U.a.setState({...U.a.state,open:!1})):f.showErrorMessage(s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.firstOrLastNameMissing.message",defaultMessage:"Please fill in both first name and last name."}))}),l()(this,"handleStartOfWeekToggle",()=>{const{state:e}=this.stores.spaceProfileSettingsStore,{startDayOfWeek:t}=e;this.stores.spaceProfileSettingsStore.setState({...e,startDayOfWeek:t?0:1})}),l()(this,"handleCancelClick",()=>{U.a.setState({...U.a.state,open:!1})}),l()(this,"handleGivenNameChange",e=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,givenName:e.target.value})}),l()(this,"handleFamilyNameChange",e=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,familyName:e.target.value})}),l()(this,"handleNameChange",e=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,name:e.target.value})}),l()(this,"handleUploadStart",()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,uploadingProfilePhoto:!0})}),l()(this,"handleUploadError",()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,uploadingProfilePhoto:!1}),f.showErrorMessage(s()(S.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))}),l()(this,"handleUploadComplete",e=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,profilePhoto:e[0],uploadingProfilePhoto:!1})}),l()(this,"handleDeleteAccountClick",async()=>{const{currentUserStore:e,currentUserRootStore:t}=y.default.state;if(!e||!t)return;const a=e.getValue();if(!a)return;const i=p.a.compact(t.getSpaceViewStores().map(e=>e.getSpaceStore())).filter(e=>!Object(ue.e)(e.getValue(),e.getRole())),n=p.a.compact(i.map(e=>Object(Be.getSpaceName)(this.environment,e)));await W.b({width:420,message:s()("div",{},void 0,s()("div",{},void 0,s()(S.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.warning",defaultMessage:"This action cannot be undone. This will permanently delete your entire account. All private workspaces will be deleted, and you will be removed from all shared workspaces."}),n.length>0&&s()("ul",{style:{padding:0}},void 0,n.map(e=>s()("li",{style:{marginTop:6,color:ie.g.red,fontWeight:$.a.fontWeight.medium,listStyle:"none"}},void 0,e)))," ",s()(S.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.prompt",defaultMessage:"Please type in your email to confirm."})),s()(de,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente su cuenta completa. Se eliminarán todas las áreas de trabajo privadas y se eliminará de todas las áreas de trabajo compartidas. Por favor, escriba su correo electrónico para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит всю вашу учетную запись. Все частные рабочие области будут удалены, и вы будете удалены из всех общих рабочих областей. Пожалуйста, введите ваш адрес электронной почты для подтверждения.",zh:"此操作无法撤消。 这将永久删除您的整个帐户。 将删除所有私有工作空间，您将从所有共享工作空间中删除。 请输入您的电子邮箱进行确认。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird Ihr gesamtes Konto dauerhaft gelöscht. Alle privaten Arbeitsbereiche werden gelöscht und Sie werden aus allen freigegebenen Arbeitsbereichen entfernt. Bitte geben Sie Ihre E-Mail-Adresse zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement votre compte en entier. Tous les espaces de travail privés seront supprimés et vous serez supprimé de tous les espaces de travail partagés. Veuillez taper votre email pour confirmer.",ja:"この操作を元に戻すことはできません。 これによりアカウント全体が完全に削除されます。 すべてのプライベートワークスペースが削除され、あなたはすべての共有ワークスペースから削除されます。 確認のためにメールアドレスを入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'intero account. Tutti gli spazi di lavoro privati verranno eliminati e verranno rimossi da tutti gli spazi di lavoro condivisi. Inserisci la tua email per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente sua conta inteira. Todos os espaços de trabalho privados serão excluídos e você será removido de todos os espaços de trabalho compartilhados. Por favor, digite o seu email para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt uw gehele account permanent verwijderd. Alle privéwerkruimten worden verwijderd en u wordt verwijderd uit alle gedeelde werkruimten. Voer je e-mailadres in om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie całego konta. Wszystkie prywatne obszary robocze zostaną usunięte, a użytkownik zostanie usunięty ze wszystkich współużytkowanych obszarów roboczych. Wpisz swój e-mail, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort hela ditt konto permanent. Alla privata arbetsytor kommer att raderas, och du kommer att tas bort från alla delade arbetsytor. Vänligen skriv in din email för att bekräfta.",uk:"Цю дію не можна скасувати. Таким чином буде видалено весь обліковий запис назавжди. Всі приватні робочі області будуть видалені, і ви будете видалені з усіх спільних робочих областей. Будь ласка, введіть електронний лист для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette hele kontoen din. Alle private arbeidsområder blir slettet, og du vil bli fjernet fra alle delte arbeidsområder. Vennligst skriv inn din epost for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu işlem hesabınızın tamamını kalıcı olarak siler. Tüm özel çalışma alanları silinecek ve paylaşılan tüm çalışma alanlarından kaldırılacaksınız. Lütfen onaylamak için e-postanızı yazın.",cs:"Tuto akci nelze vrátit zpět. Tím bude trvale smazán celý váš účet. Všechny soukromé pracovní prostory budou smazány a budete ze všech sdílených pracovních prostor odstraněni. Pro potvrzení zadejte svůj e-mail.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn toàn bộ tài khoản của bạn. Tất cả các không gian làm việc riêng tư sẽ bị xóa và bạn sẽ bị xóa khỏi tất cả các không gian làm việc chung. Vui lòng nhập email của bạn để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette hele din konto. Alle private arbejdsområder slettes, og du vil blive fjernet fra alle delte arbejdsområder. Indtast venligst din email for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a teljes fiókot. Minden privát munkaterület törlődik, és eltávolításra kerül minden megosztott munkaterületről. Kérjük, írja be e-mail címét, hogy megerősítse.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي الإجراء إلى حذف حسابك بالكامل. سيتم أيضا حذف جميع مساحات العمل الخاصة ، وستتم إزالتك من جميع مساحات العمل المشتركة. يرجى كتابة البريد الإلكتروني الخاص بك للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบบัญชีทั้งหมดของคุณอย่างถาวร พื้นที่ทำงานส่วนตัวทั้งหมดจะถูกลบและคุณจะถูกลบออกจากพื้นที่ทำงานที่ใช้ร่วมกันทั้งหมด กรุณาพิมพ์อีเมลของคุณเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את כל החשבון שלך. כל סביבות העבודה הפרטיות יימחקו, ותוסר מכל סביבות העבודה המשותפות. הקלד את האימייל שלך כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa koko tilin pysyvästi. Kaikki yksityiset työtilat poistetaan ja poistetaan kaikista jaetuista työtiloista. Vahvistaaksesi kirjoita sähköpostiosoitteesi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus seluruh akun Anda. Semua ruang kerja pribadi akan dihapus, dan Anda akan dihapus dari semua ruang kerja bersama. Ketikkan email Anda untuk mengonfirmasi."}})),acceptLabel:0===n.length?s()(S.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.deleteAccountButton.label",defaultMessage:"Permanently delete account"}):s()(S.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.deleteAccountAndWorkspacesButton.label",defaultMessage:"{numberOfWorkspaces, plural, one {Permanently delete account and 1 workspace} other {Permanently delete account and {numberOfWorkspaces} workspaces}}",values:{numberOfWorkspaces:n.length}}),requiredInputValue:a.email})&&(U.a.reset(),async function(e){h.b({message:T.deletingAccount});const t=e.currentUser.id,{currentUserRootStore:a,currentUserStore:i}=y.default.state;if(!a||!i||!t)return h.a(),void f.showErrorMessage(C.default.formatMessage(T.noUserError));v.wb(e),await g.deleteUser(e,{}),await b.transactionQueue.clearForUser(t),M.logoutSingleAccount({environment:e,userId:t}),h.a()}(this.environment))})}willMount(e){super.willMount(e);const{spaceProfileSettingsStore:t,isEducationStore:a}=this.stores,{currentUserStore:i,currentUserSettingsStore:s,currentUserRootStore:n}=y.default.state;if(i&&s){const e=t.getValueForUser(i,s);e&&t.setState(e)}if(n){const e=(Object(Me.b)({environment:this.environment,userRootStore:n})||[]).some(e=>e===z.default.pricing.student.productId);a.set(e)}}renderComponent(){return ae.a.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})))}renderSettings(){const{currentUserStore:e}=y.default.state;if(!e)return;e.getValue();const{profilePhoto:t,uploadingProfilePhoto:a,givenName:i,familyName:n,name:o,startDayOfWeek:r}=this.stores.spaceProfileSettingsStore.state,{passwordRequestStore:l}=this.stores,c="on"===xe.default.getGroup(this.environment,"lion-tamer"),u="on"===xe.default.getGroup(this.environment,"user-data-consent");return l.state.loading?s()(G.a,{style:{margin:"50% auto"}}):s()(K.a,{controlRow:this.renderControlRow()},void 0,this.renderSpaceProfileHeader(),s()("div",{style:{marginBottom:24}},void 0,s()(ce.a,{title:s()(d.Fragment,{},void 0,s()(S.FormattedMessage,{id:"profileSettings.helpButton.caption",defaultMessage:"Changes to account settings will apply to all of your workspaces."})," ",s()(S.FormattedMessage,{id:"profileSettings.helpButton.learnMoreLink",defaultMessage:"<s>Learn more.</s>",values:{s:(...e)=>s()("span",{style:{textDecoration:"underline"}},void 0,e)}})),href:Object(Ee.a)("guides.profileSettings"),analyticsFrom:"profile_settings"})),s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"profileSettings.profilePhotoSection.title",defaultMessage:"Photo"})),t&&s()(te.a,{url:t,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>s()("div",{style:{width:90,height:90}},void 0,s()(q.a,{src:t,style:{width:90,height:90,objectFit:"cover",borderRadius:"100%"}}))}),s()(ne.a,{isLarge:!0,onClick:this.handleUploadProfilePhoto,style:{marginTop:8,marginBottom:4}},void 0,s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(S.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadPhotoButton.label",defaultMessage:"Upload photo"}),a&&s()(G.a,{style:{marginLeft:4}}))),t&&"on"===xe.default.getGroup(this.environment,"remove-profile-photo-string")&&s()(ne.a,{onClick:this.handleDeleteProfilePhoto,style:{marginTop:4,marginLeft:12,marginBottom:2}},void 0,s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(S.FormattedMessage,{id:"profileSettings.profilePhotoSection.removePhotoButton.label",defaultMessage:"Remove"}))),K.a.renderDivider(),s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.title",defaultMessage:"Personal info"})),s()(Fe,{userValue:Object(me.h)(this.environment),hasEducationPlan:this.stores.isEducationStore.get()}),Object(Ue.x)(this.environment)?this.renderNameRow(o):this.renderFirstAndLastNameRows(i,n),K.a.renderDivider(),s()(ge.a,{isEducationPlan:this.props.isEducationPlan,requestStore:l}),u&&K.a.renderDivider(),u&&s()(_e.a,{}),K.a.renderDivider(),s()(Le,{}),!c&&K.a.renderDivider(),!c&&s()(fe.a,{onClick:this.handleStartOfWeekToggle,startDayOfWeek:r}),K.a.renderDivider(),s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"profileSettings.dangerousSettings.title",defaultMessage:"Danger zone",description:"Title for the user settings that we consider 'dangerous', like deleting an account."})),s()(ne.a,{isLarge:!0,isRed:!0,onClick:this.handleDeleteAccountClick},void 0,s()(S.FormattedMessage,{id:"profileSettings.dangerousSettings.deleteAccountButton.label",defaultMessage:"Delete my account"})))}renderFirstAndLastNameRows(e,t){return c.a.createElement(c.a.Fragment,null,s()(Q.a,{hasMarginTop:!0},void 0,s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.firstNameInput.label",defaultMessage:"First name",description:"User's first name, also known as forename or given name."})),s()(H.b,{value:e,onChange:this.handleGivenNameChange}),s()(Q.a,{hasMarginTop:!0},void 0," ",s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.lastNameInput.label",defaultMessage:"Last name",description:"User's last name, also known as family name or surname"})),s()(H.b,{value:t,onChange:this.handleFamilyNameChange}))}renderNameRow(e){return c.a.createElement(c.a.Fragment,null,s()(Q.a,{hasMarginTop:!0},void 0,s()(S.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Name",description:"User's name, may be full name or a nickname."})),s()(H.b,{value:e,onChange:this.handleNameChange}))}renderControlRow(){return s()("div",{style:{display:"flex"}},void 0,s()(se.a,{isLarge:!0,onClick:this.handleUpdateClick},void 0,s()(S.FormattedMessage,{id:"profileSettings.updateButton.label",defaultMessage:"Update"})),s()(ne.a,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,s()(S.FormattedMessage,{id:"profileSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderSpaceProfileHeader(){return s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"profileSettings.title",defaultMessage:"Account"}))}}var Ne=Object(S.injectIntl)(je);class Ze extends j.a{renderComponent(){return s()("div",{style:this.getStyle(),onMouseDown:this.props.onMouseDown,onClick:this.props.onClick,onDoubleClick:this.props.onDoubleClick,onContextMenu:this.props.onContextMenu},void 0,s()("div",{style:this.getSidebarStyle()},void 0,this.props.sidebar),s()("div",{style:this.getChildrenStyle()},void 0,this.props.children))}getStyle(){return{display:"flex",height:"100%",flexDirection:this.props.isReversed?"row-reverse":"row"}}getSidebarStyle(){return{width:160,height:"100%",background:this.theme.sidebarBackground,flexGrow:0,flexShrink:0,...this.props.sidebarStyle}}getChildrenStyle(){return{flexGrow:1,position:"relative",zIndex:1,height:"100%"}}}var We=Ze,Ve=(a("SYor"),a("Oy36")),ze=a("fw5W"),qe=a("7Q97"),He=a("LeVO"),Ge=a("aZ00"),Ke=a("wXH4"),Ye=a("gbGO"),Qe=a("WgIs"),Je=a("SR/M"),Xe=a("2Y+N"),$e=a("r8MX"),et=(a("WLsh"),a("lODM")),tt=a("FIf6"),at=a("tvfY"),it=a("mjq6"),st=a("5/h/"),nt=a("pQrc");function ot(){return s()(S.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your name or the name of your team. Keep it simple.",description:"The caption below the text input where a user edits the name of their workspace"})}const rt=Object(S.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});class lt extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{spaceBasicSettingsStore:B,tokenQuery:X.a.of("")}),l()(this,"handleSpaceNameChange",e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})}),l()(this,"handleCheckDomainAvailability",e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:a}=this.props;A.c({environment:this.environment,spaceStore:a,domain:e}).then(e=>{if("success"!==e.type)return;const a=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:a?e.data.domainState:t.state.domainState})})}),l()(this,"checkSpaceDomainAvailabilityDebounced",u.debounce(this.handleCheckDomainAvailability,250)),l()(this,"handleSpaceUrlChange",e=>{const t=A.D(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()}),l()(this,"handleConfirm",async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores;await A.b({environment:this.environment,spaceId:e.id,spaceBasicSettingsStore:t})&&(await A.C({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t}),U.a.setState({...U.a.state,open:!1}))}),l()(this,"handleCancelClick",()=>{U.a.setState({...U.a.state,open:!1})}),l()(this,"handleExportClick",()=>{const{currentSpaceStore:e}=y.default.state;e&&et.h({environment:this.environment,root:{table:"space",id:e.id}})}),l()(this,"handleExportMembersClick",()=>{const{currentSpaceStore:e}=y.default.state,{data:t}=$e.default.state;e&&t&&"subscribed_admin"===t.type&&et.e({spaceStore:e,subscriptionData:t,intl:this.props.intl})}),l()(this,"handleLeaveClick",()=>{const{spaceStore:e}=this.props,{currentUserSettingsStore:t}=y.default.state;t&&f.showDialog({message:s()(S.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:s()(S.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await A.n({environment:this.environment,spaceId:e.id,userSettingsStore:t})&&(v.vc(this.environment),U.a.setState({...U.a.state,open:!1}))}}]})}),l()(this,"handleDeleteClick",async()=>{const{currentUserSettingsStore:e}=y.default.state;if(!e)return;const{spaceStore:t,intl:a}=this.props,i=Object(Be.getSpaceName)(this.environment,t)||a.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"});await W.b({message:s()("div",{},void 0,s()("div",{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."})),s()(de,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})),acceptLabel:s()(S.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(A.j({environment:this.environment,spaceId:t.id,userSettingsStore:e}),v.ub(this.environment),U.a.setState({...U.a.state,open:!1}))}),l()(this,"handleRecordIconChange",e=>{const{spaceStore:t}=this.props;J.createAndCommit(this.environment,a=>{m.d({store:t.getIconStore(),value:e,transaction:a})})})}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:a}=this.stores,i=a.getValueForSpace(t);i&&a.setState(i)}renderComponent(){return ae.a.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})))}validateDomainInput(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:a}=e.state;if("available"!==a&&"current-space"!==a)return{error:!0,message:s()(S.FormattedMessage,{id:"spaceBasicSettings.domainInUseError",defaultMessage:"Sorry, this domain is not available."})};return"on"===xe.default.getGroup(this.environment,"paul-mockapetris")&&!t?{error:!0,message:s()(S.FormattedMessage,{id:"spaceBasicSettings.domainRequiredError",defaultMessage:"A domain is required."})}:{error:!1,message:lt.renderDomainCaption(this.environment,t,!0,this.theme)}}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:a,domain:i}=t.state,{data:n}=$e.default.state;if(!n)return;const o=e.canAdmin(),r=!e.canRead(),l=Object(Be.getSpacePermissionItems)(e),c=Me.J(this.environment),u=e.getValue(),p=o&&u&&!u.disable_export,m=o,g="subscribed_admin"===n.type&&"enterprise"===Me.h(this.environment),h=this.validateDomainInput();return s()(K.a,{controlRow:o&&this.renderControlRow()},void 0,this.renderSpaceBasicHeader(),r&&s()(pe.a,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages and workspace settings."})),r&&K.a.renderDivider(),o&&s()(d.Fragment,{},void 0,s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})),s()(H.b,{value:a,placeholder:C.default.formatMessage(rt.nameInputPlaceholder),readOnly:!o,onChange:this.handleSpaceNameChange}),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,s()(ot,{})),K.a.renderDivider()),o&&s()(d.Fragment,{},void 0,s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})),s()("div",{style:{width:72,height:72,border:"1px solid ".concat(this.theme.regularDividerColor),borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"}},void 0,s()(Ve.a,o?{bucket:"public",disabled:!1,icon:Object(Be.getSpaceIcon)(this.environment,e),isEmptyPage:!1,title:a,size:64,onChange:this.handleRecordIconChange}:{disabled:!0,icon:Object(Be.getSpaceIcon)(this.environment,e),isEmptyPage:!1,title:a,size:64})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})),K.a.renderDivider()),o&&s()("div",{},void 0,s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})),s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()("div",{},void 0,window.location.host,"/"),s()("div",{style:{marginLeft:6,width:"100%"}},void 0,s()(H.b,{value:i,placeholder:C.default.formatMessage(rt.workspaceDomainInputPlaceholder),readOnly:!o,onChange:this.handleSpaceUrlChange}))),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,h.error?s()("span",{style:{color:ie.g.red}},void 0,h.message):h.message),K.a.renderDivider()),o&&c&&s()(d.Fragment,{},void 0,s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})),this.renderAllowedEmailDomains(),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,lt.renderAllowEmailDomainsCaption()),K.a.renderDivider()),p&&s()(d.Fragment,{},void 0,s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})),s()("div",{style:{display:"flex"}},void 0,s()(ne.a,{isLarge:!0,onClick:this.handleExportClick},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"}))),s()("div",{style:{height:12}}),s()(ce.a,{title:s()(S.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:Object(Ee.a)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),K.a.renderDivider()),m&&s()(d.Fragment,{},void 0,s()(Y.a,{style:{display:"flex",alignItems:"center"}},void 0,s()("span",{style:{marginRight:8}},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})),!g&&s()(tt.a,{subscriptionTier:"enterprise",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})),s()("div",{style:{display:"flex"}},void 0,s()(ne.a,{isLarge:!0,disabled:!g,onClick:this.handleExportMembersClick,disabledFeedback:!0},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"}))),s()("div",{style:{height:12}}),s()(ce.a,{title:s()(S.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:Object(Ee.a)("guides.exportMembers"),analyticsFrom:"space_settings"}),K.a.renderDivider()),s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})),s()("div",{style:{display:"flex"}},void 0,(l.length>1||r)&&s()(ne.a,{isLarge:!0,onClick:this.handleLeaveClick,style:{marginRight:o?12:void 0}},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})),o&&s()(ne.a,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"}))),o&&s()(d.Fragment,{},void 0,s()("div",{style:{height:12}}),s()(ce.a,{title:s()(S.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:Object(Ee.a)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})))}renderSpaceBasicHeader(){return s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"}))}renderControlRow(){const e=this.validateDomainInput();return s()("div",{style:{display:"flex"}},void 0,s()(se.a,{isLarge:!0,onClick:this.handleConfirm,disabled:e.error},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})),s()(ne.a,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:a}=this.stores,{emailDomains:i}=a.state,n=t.canAdmin();return s()(Ke.c,{popupType:e.isMobile?Ke.c.PopupType.SlideUp:Ke.c.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.get().length>0,origin:s()(ze.a,{placeholder:C.default.formatMessage(rt.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.get(),onChange:e=>this.stores.tokenQuery.set(e.target.value),readOnly:!n,onRemoveLastToken:()=>{const e=i.slice(0,i.length-1);a.setState({...a.state,emailDomains:e})},tokens:i.map(e=>s()(qe.b,{showRemoveButton:!0,isSingle:!1,format:qe.b.Format.Medium,onClickRemove:()=>{const t=i.filter(t=>t!==e);a.setState({...a.state,emailDomains:t})},value:e},e))}),render:()=>{const t=this.stores.tokenQuery.get().trim(),{data:n}=$e.default.state,{spaceStore:r}=this.props,l=s()(S.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),d=s()(S.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),u=n?Me.t(n).map(e=>{if(("unsubscribed_admin"===n.type||"unsubscribed_member"===n.type||"subscribed_admin"===n.type)&&n.joinedMemberIds.includes(e.userId)){const t=at.a.createChildStore(r,{table:st.a,id:e.userId}).getEmail();return t&&Object(nt.a)(t)}}).filter((e,t,a)=>Boolean(e&&t===a.indexOf(e)&&!i.includes(e))):[],p=Object(it.b)(t,u,e=>e).map((e,t)=>({key:t,render:t=>c.a.createElement(Je.a,o()({},t,{title:e})),action:()=>{const t=[...i,e];a.setState({...a.state,emailDomains:t}),this.stores.tokenQuery.set("")}}));let m;return m=e.isMobile?{menuType:Ye.b.MenuType.ActionSheet}:{menuType:Ye.b.MenuType.Popup,width:"100%"},c.a.createElement(Ye.b,m,s()(Qe.a,{type:Qe.a.Type.Vertical,initialFocus:p.length>0?0:void 0,sections:[{key:0,render:e=>c.a.createElement(Xe.a,o()({},e,{disableDesktopPadding:!0,title:p.length>0?l:d})),items:p}]}))},onDismiss:()=>{this.stores.tokenQuery.set("")}})}}l()(lt,"renderDomainCaption",(e,t,a=!1,i)=>{const n="".concat(window.location.host,"/").concat(t);let r;if(t&&(r=a?s()(He.a,{delayThreshold:0,renderTooltip:()=>C.default.formatMessage(rt.copyDomainTooltip),render:t=>c.a.createElement(we.a,o()({onClick:()=>{Ge.c({environment:e,stringValue:n})}},t),n)}):s()("span",{style:{color:i.regularTextColor}},void 0,n)),!Me.Q(e,"personal")&&!Me.Q(e,"student"))return s()("div",{},void 0,s()(S.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.caption",defaultMessage:"Share the link {linkText} to add anyone with an allowed email domain to your workspace.",values:{linkText:r}}))}),l()(lt,"renderAllowEmailDomainsCaption",()=>s()(S.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."}));var dt=Object(S.injectIntl)(lt),ct=a("3wHm"),ut=a("5XPD"),pt=a("2HDO"),mt=a("Z1H8"),gt=a("nWgh"),ht=a("8fuX");class ft extends I.a{getInitialState(){return{churnSurveyModalOpen:!1}}}var Mt=ft,yt=a("6BTz"),vt=a("LB1/"),bt=a("Z0iJ"),St=a("T8dS");const Ct={"en-US":{enterpriseContact:"https://notionup.typeform.com/to/FbZ6Tk",enterpriseTrial:"https://notionup.typeform.com/to/OHk8LR",startupFounder:"https://notionup.typeform.com/to/HgYsu8",startupPartner:"https://notionup.typeform.com/to/XEqmGB",nonprofit:"https://notionup.typeform.com/to/nlhrVv",apiPrivateBeta:"https://notionup.typeform.com/to/dSurQQp2"},"ko-KR":{enterpriseContact:"https://notionup.typeform.com/to/K5knuI18",enterpriseTrial:"https://notionup.typeform.com/to/XkdAkTfV",startupFounder:"https://notionup.typeform.com/to/DYAiiu7x",startupPartner:"https://notionup.typeform.com/to/GfPkKEJZ",nonprofit:"https://notionup.typeform.com/to/cSKAL2LL",apiPrivateBeta:"https://notionup.typeform.com/to/dSurQQp2"}};async function Tt(e){const t=Ct[St.a][e.typeform];let a={};e.params&&(a={...a,...e.params});const i=t+"?".concat(Object.keys(a).map(e=>"".concat(e,"=").concat(a[e])).join("&"));v.Ed(e.environment,{from:e.frontContext,name:e.typeform}),await Object(bt.b)("https://embed.typeform.com/embed.js"),window.typeformEmbed.makePopup(i,{hideHeaders:!0,hideFooter:!1}).open()}const kt=(...e)=>s()("p",{style:{marginTop:8,marginBottom:8}},void 0,1===e.length?e[0]:c.a.Children.toArray(e)),At=(...e)=>s()(we.a,{external:!0,href:Object(Ee.a)("guides.guides")},void 0,e),wt=(...e)=>s()(we.a,{external:!0,href:Object(Ee.a)("guides.billingAndPayment")},void 0,e);function It(e,t,a){Tt({environment:e,typeform:"enterpriseContact",frontContext:t,params:{source:a}})}const Pt={general:function(e){return[{question:s()(S.FormattedMessage,{id:"faq.freeVsPersonalAndTeam.question",defaultMessage:"How is the free Personal Plan different from the Personal Pro and Team Plans?"}),answer:s()(S.FormattedMessage,{id:"faq.freeVsPersonalAndTeam.answer",defaultMessage:'<p>The biggest difference is how you can collaborate with others.</p><p>The free Personal Plan is designed for individual use, but allows up to 5 unique guests. These are friends, family members, and others you can invite to collaborate with you privately on any page. You can also share a page publicly and turn on commenting or editing access. In the Share menu at the top right, turn on "Share to web" then "Allow editing." Any Notion user with the link will be able to edit your page.</p><p>With the Personal Pro Plan, you can invite unlimited guests for private collaboration. For example, if you run your own business, you can invite all your clients to provide feedback on your work. </p><p>With the Team Plan, you can add members to your workspace so you all share and work on the same content. It also comes with more permission and admin controls so you and your teammates can work together securely. See the plan comparison chart for more details.</p>',values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.overGuestLimitInFreePlan.question",defaultMessage:"What happens when I go over the guest limit on my Personal Plan?"}),answer:s()(S.FormattedMessage,{id:"faq.overGuestLimitInFreePlan.answer",defaultMessage:"<p>Upgrade to the Personal Pro Plan for unlimited guests, or the Team Plan if you collaborate with the same group of people automatically. You can also review and remove inactive guests in Settings & Members.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.teamTrial.question",defaultMessage:"How do I try out the Team Plan for free?"}),answer:s()(S.FormattedMessage,{id:"faq.teamTrial.answer",defaultMessage:"<p>When asked how you would like to set up Notion during sign up, select Team, and you’ll be automatically enrolled in a Team Plan trial. You’ll get access to most features of a paid Team Plan, with a 1,000 block storage limit. If your team wants to add more than that, upgrade to the full Team Plan. Details above.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.overStorageLimitInFreePlan.question",defaultMessage:"What happens when I go over the block storage limit on my Team trial?"}),answer:s()(S.FormattedMessage,{id:"faq.overStorageLimitInFreePlan.answer",defaultMessage:"<p>You can still read, edit, and organize existing content blocks as usual, but you won’t be able to add new content blocks.</p><p>However, you can delete existing content blocks to free up your storage.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.useNotionForFree.question",defaultMessage:"Can I use Notion for free?"}),answer:s()(S.FormattedMessage,{id:"faq.useNotionForFree.answer",defaultMessage:"<p>Absolutely! Notion is free to use indefinitely.</p><p>The Personal Plan is completely free for individual use. The Team Plan has a free trial with a 1,000 block limit, more than enough to try out Notion with your team before upgrading.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.whatIsABlock.question",defaultMessage:"What is a block?"}),answer:s()(S.FormattedMessage,{id:"faq.whatIsABlock.answer",defaultMessage:"<p>A block is any single piece of content you add to your page, like a paragraph of text, a to-do item, an image, a code block, an embedded file, etc. Think of your page as being made up of these building blocks.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.deleteBlocks.question",defaultMessage:"Can I delete blocks to free up my storage?"}),answer:s()(S.FormattedMessage,{id:"faq.deleteBlocks.answer",defaultMessage:"<p>Of course! It works just like the storage limit on your phone or computer. If you delete something, you will free up space for more.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.studentDiscount.question",defaultMessage:"Do you offer student discounts?"}),answer:s()(S.FormattedMessage,{id:"faq.studentDiscount.answer",defaultMessage:"<p>The Personal Pro Plan is free for students and educators. This lets you collaborate with unlimited guests and gives you version history. Simply sign up with your school email address and you’ll immediately gain access to these features.</p><p>If you’re already on a Personal Pro Plan, change the email associated with your account to your school email address to get it for free. If you're already on our free Education Plan, you've been automatically upgraded to the Personal Pro Plan.</p><p><helpcenterlink>Visit the help center to learn more</helpcenterlink></p>",values:{p:kt,helpcenterlink:At}})},{question:s()(S.FormattedMessage,{id:"faq.howToEarnCredit.question",defaultMessage:"How do I earn credit?"}),answer:s()(S.FormattedMessage,{id:"faq.howToEarnCredit.answer",defaultMessage:"<p>You can earn credit by using Notion across your devices and trying out new features. Go to the Earn Credit tab in Settings & Members to learn more.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.howToApplyCredit.question",defaultMessage:"How do I apply credit to my workspace?"}),answer:s()(S.FormattedMessage,{id:"faq.howToApplyCredit.answer",defaultMessage:"<p>To apply credit, you must first upgrade to a paid plan. As part of this process, you can choose to apply some or all of your account credit to the plan.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.whyBillingInformation.question",defaultMessage:"Why do you need my billing information if I have enough credit to pay for Notion?"}),answer:s()(S.FormattedMessage,{id:"faq.whyBillingInformation.answer",defaultMessage:"<p>We still require your billing information, even if you applied enough credit to make your first bill $0, because you may run out of credit in the future and we need to be able to charge your account.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.runOutOfCredit.question",defaultMessage:"What happens if I run out of credit?"}),answer:s()(S.FormattedMessage,{id:"faq.runOutOfCredit.answer",defaultMessage:"<p>If you run out of credit, your account will be charged via your selected payment method.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.maximumEarnedCredit.question",defaultMessage:"Is there a maximum amount of credit I can earn?"}),answer:s()(S.FormattedMessage,{id:"faq.maximumEarnedCredit.answer",defaultMessage:"<p>Yes, you can earn up to {maximumAmountInDollars} in credit.</p>",values:{p:kt,maximumAmountInDollars:Object(yt.b)({amount:vt.f,currency:"dollar",intl:C.default.getIntl()})}})},{question:s()(S.FormattedMessage,{id:"faq.advancedPermissions.question",defaultMessage:"What advanced permissions does the paid Team & Enterprise Plans offer?"}),answer:s()(S.FormattedMessage,{id:"faq.advancedPermissions.answer",defaultMessage:'<p>If you are on a free Team trial, you can set the access level on each page to "Full access," "Can view," or "Can comment." That dictates how other users can interact with that page. "Full access" means someone can edit, comment, and share the page with others.</p><p>On paid Team and Enterprise Plans, you have the ability to grant "Can edit" access to other users. This gives someone the ability to edit and comment on that page, but not share it with others. This is especially useful if you do not want your content leaking outside your team.</p><p><contactsales>Contact sales to learn more</contactsales></p>',values:{p:kt,contactsales:(...t)=>s()(we.a,{onClick:()=>It(e,"faq","Advanced permissions")},void 0,t)}})},{question:s()(S.FormattedMessage,{id:"faq.teamAdminTools.question",defaultMessage:"What admin tools come with the Team Plan? "}),answer:s()(S.FormattedMessage,{id:"faq.teamAdminTools.answer",defaultMessage:"<p>On a free Team trial, every member in your workspace is an admin. This means all of you can adjust team settings and invite other people into the workspace.</p><p>If you want only a few people to have admin abilities, we recommend upgrading to the full Team Plan. It comes with tools that allow you to make only select people admins while everyone else is a member. Members can't edit billing information or security options, and can't share your content outside the workspace.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.personalPricing.question",defaultMessage:"How is pricing calculated for the Personal Pro Plan?"}),answer:s()(S.FormattedMessage,{id:"faq.personalPricing.answer",defaultMessage:"<p>If you upgrade your workspace to Personal Pro, you will be charged a flat fee ($5 monthly or $48 yearly).</p><p>Guests are free of charge, but they can only be added to one page at a time.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.teamPricing.question",defaultMessage:"How is pricing calculated for the Team Plan?"}),answer:s()(S.FormattedMessage,{id:"faq.teamPricing.answer",defaultMessage:'<p>If you upgrade your workspace to the Team Plan, you will be charged a fee per member ($10 monthly or $96 yearly). For example, if you pay per month and have 5 members, you will be charged $50 each month.</p><p>Guests are free of charge – but they can only access individual pages they are invited to. In other words, guests won’t be able to see all the team pages under the "Workspace" section in the left sidebar.</p>',values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.monthlyAndYearlyBilling.question",defaultMessage:"Do you have monthly and yearly billing options?"}),answer:s()(S.FormattedMessage,{id:"faq.monthlyAndYearlyBilling.answer",defaultMessage:"<p>Yes! We offer both monthly and yearly billing options. The yearly billing option is always cheaper (an estimated 20% discount). For example, the Team Plan is $10 per member per month when you choose the monthly option, but $8 per member per month if you choose to pay yearly.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.addingAndRemovingMembers.question",defaultMessage:"How does adding and removing members work?"}),answer:s()(S.FormattedMessage,{id:"faq.addingAndRemovingMembers.answer",defaultMessage:"<p>Whether you're on a monthly or yearly billing schedule, your account may be charged on a monthly basis if you make these types of changes. If you added members, your account will be charged a prorated amount based on the percentage of the billing cycle left at the time each member was added. If you removed members, your account will be credited in the same way.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.changePlans.question",defaultMessage:"What happens when I change plans?"}),answer:s()(S.FormattedMessage,{id:"faq.changePlans.answer",defaultMessage:"<p>Upgrading or downgrading your plan works similarly to adding and removing members. Your account will be charged or credited based on the percentage of the billing cycle left at the time the plan was changed.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.cancelPlan.question",defaultMessage:"How do I cancel my paid plan?"}),answer:s()(S.FormattedMessage,{id:"faq.cancelPlan.answer",defaultMessage:'<p>Your Notion subscription, annual or monthly, will automatically renew until you cancel it. You can cancel your subscription by going to "Settings & Members" in the left-hand sidebar on a desktop computer, then selecting "Plans," then "Downgrade." After you cancel, you’ll still have access to all the paid features until the end of your billing cycle.</p><p><billingandpaymentlink>More on billing & payment here</billingandpaymentlink></p>',values:{p:kt,billingandpaymentlink:wt}})},{question:s()(S.FormattedMessage,{id:"faq.paymentFailure.question",defaultMessage:"What happens if my payment fails? Like if my credit card expires?"}),answer:s()(S.FormattedMessage,{id:"faq.paymentFailure.answer",defaultMessage:"<p>Your account email will be notified after each failed payment. Payments may be retried up to 4 times within the next month. After this, if the payment did not succeed, you will be downgraded to the free plan.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.changePaymentMethod.question",defaultMessage:"Can I change my payment method?"}),answer:s()(S.FormattedMessage,{id:"faq.changePaymentMethod.answer",defaultMessage:"<p>You can change your payment method at any time in your billing settings.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.refund.question",defaultMessage:"How do refunds work?"}),answer:s()(S.FormattedMessage,{id:"faq.refund.answer",defaultMessage:"<p>Our refund policy is simple. If you believe you've made a mistake signing up for a paid Notion subscription online or in-app, please contact us inside the app or email team@makenotion.com. We'll be happy to refund you the full amount (not pro-rated) if you downgrade your subscription within 72 hours of signing up for monthly billing, or within 30 days of signing up for annual billing.</p><p>And if for any reason you're unhappy with Notion, please let us know at team@makenotion.com — we'd love to hear your feedback, and will be happy to work with you to create the best experience possible.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.mandatoryRefund.question",defaultMessage:"What if I live in a region with a mandatory refund policy?"}),answer:s()(S.FormattedMessage,{id:"faq.mandatoryRefund.answer",defaultMessage:"<p>If you live in the European Union, United Kingdom, or another region with a mandatory refund policy, you may be eligible for a monthly subscription refund past 72 hours. For example, customers in the European Union can receive a full refund for a monthly subscription within 14 days of purchase, rather than 72 hours.</p><p>To request a refund, please contact us inside the app or email team@makenotion.com. If you live in a region with a mandatory refund policy, please let us know and we'll be happy to assist you.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.serviceLevelAgreement.question",defaultMessage:"Do you have a Service-Level Agreement (SLA)?"}),answer:s()(S.FormattedMessage,{id:"faq.serviceLevelAgreement.answer",defaultMessage:"<p>We do not offer a standard SLA. For teams with greater than 100 members, we can offer a custom SLA.</p><p><contactsales>Contact sales to learn more</contactsales></p>",values:{p:kt,contactsales:(...t)=>s()(we.a,{onClick:()=>It(e,"faq","SLA")},void 0,t)}})},{question:s()(S.FormattedMessage,{id:"faq.importStorageLimit.question",defaultMessage:"How does importing content from another app affect my block storage limit if I'm on the Team Plan trial?"}),answer:s()(S.FormattedMessage,{id:"faq.importStorageLimit.answer",defaultMessage:"<p>Content created via import doesn’t count toward your workspace’s storage limit. We want to make sure you get started with Notion as smoothly as possible.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.paymentProcessor.question",defaultMessage:"How is my payment being processed?"}),answer:s()(S.FormattedMessage,{id:"faq.paymentProcessor.answer",defaultMessage:"<p>We use Stripe to process your payment. It’s the same payment provider used by products such as Twitter, Pinterest, and Lyft. We do not handle your credit card information directly.</p>",values:{p:kt}})},{question:s()(S.FormattedMessage,{id:"faq.multipleTeams.question",defaultMessage:"Can I belong to multiple teams on Notion? "}),answer:s()(S.FormattedMessage,{id:"faq.multipleTeams.answer",defaultMessage:"<p>Yes! You can use the same email address to create and join multiple teams. However, each one of these workspaces is on its own plan and needs to be upgraded individually.</p>",values:{p:kt}})}]}};class Ft extends j.a{constructor(...e){super(...e),l()(this,"renderFaqItem",(e,t)=>s()(d.Fragment,{},t,s()("div",{style:Ft.questionStyle},void 0,e.question),s()("div",{style:this.getAnswerStyle()},void 0,e.answer))),l()(this,"handleHelpButtonClick",()=>{Ce.a({environment:this.environment,from:"pricing"})})}renderComponent(){return s()("div",{style:{maxWidth:600}},void 0,this.getFaqList().map((e,t)=>this.renderFaqItem(e,t)),s()("div",{style:{color:this.props.isSettings?this.theme.mediumTextColor:ie.g.frontTextMedium}},void 0,this.props.cta?"intercom"===this.props.cta?this.renderIntercomCTA():this.renderGuidesCTA():null))}renderIntercomCTA(){return s()(S.FormattedMessage,{id:"faqList.moreQuestionsTextIntercom",defaultMessage:"Still have more questions? <messagelink>Send us a message</messagelink>",values:{messagelink:(...e)=>s()(we.a,{onClick:this.handleHelpButtonClick},void 0,e)}})}renderGuidesCTA(){return s()(S.FormattedMessage,{id:"faqList.moreQuestionsTextHelpCenter",defaultMessage:"Still have more questions? Learn more in our <messagelink>help center</messagelink>.",values:{messagelink:(...e)=>s()(we.a,{href:Object(Ee.a)("guides.guides")},void 0,e)}})}getFaqList(){return Pt[this.props.type](this.environment)}getAnswerStyle(){return{color:this.props.isSettings?this.theme.mediumTextColor:ie.g.frontTextMedium,marginBottom:"1.5rem",lineHeight:1.5}}}l()(Ft,"questionStyle",{fontWeight:$.a.fontWeight.semibold,marginBottom:4});var xt=Ft,Et=a("4VgC"),Bt=a("DlEO"),Dt=a("62KP"),Ot=a("1Imc"),Rt=a("enKW"),Lt=a("H4VD"),_t=a("qqdV"),Ut=a("CI7d");class jt extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{loginStore:Ot.a,loginPermissionsStore:Dt.a}),l()(this,"handleLoginClick",async()=>{const{email:e}=this.stores.loginStore.state;this.props.analyticsName&&v.Y(this.environment,{from:this.props.analyticsName});const t=await g.checkEmailType(this.environment,{email:e});if("failed"===t.type)return;const a=t.data;a.samlRedirect?M.redirectToSaml(this.environment,a.samlRedirect.redirectUrl):a.isGoogleAppsEmail?M.requestLoginWithGoogle({environment:this.environment,store:this.stores.loginStore,email:e,permissionsStore:this.stores.loginPermissionsStore}):a.hasPassword?(Lt.navigate({environment:this.environment,url:_t.d.login}),a.mustReverify?(await M.sendTemporaryPassword({environment:this.environment,store:Bt.a,reverify:!0}),this.stores.loginStore.reset()):Bt.a.setState({loginType:"password",email:e,password:"",emailInputFocused:!1,alert:void 0})):(Lt.navigate({environment:this.environment,url:_t.d.signup}),Bt.a.setState({loginType:"email",email:e,password:"",emailInputFocused:!1}),await M.sendTemporaryPassword({environment:this.environment,store:Bt.a}),this.stores.loginStore.reset())}),l()(this,"handleInputChange",e=>{""===e.target.value&&this.stores.loginStore.reset(),this.stores.loginStore.setState({...this.stores.loginStore.state,email:e.target.value})}),l()(this,"handleInputFocus",e=>{this.stores.loginStore.setState({...this.stores.loginStore.state,emailInputFocused:!0})}),l()(this,"handleInputBlur",e=>{this.stores.loginStore.setState({...this.stores.loginStore.state,emailInputFocused:!1})})}renderComponent(){const e=this.renderPlaceholderText();return s()("div",{style:this.getWrapStyle()},void 0,s()(H.b,{style:jt.inputStyle,value:this.stores.loginStore.state.email,type:"email",format:H.b.Format.Large,autoFocus:!1,autoComplete:"off",placeholder:e,onSubmit:this.handleLoginClick,showClearButton:!0,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,onChange:this.handleInputChange}),s()(Et.a,{variant:this.props.buttonVariant?this.props.buttonVariant:"primary",style:{textAlign:"center",width:this.props.buttonWidth?this.props.buttonWidth:"auto"},onClick:this.handleLoginClick},void 0,this.props.buttonTitle||s()(S.FormattedMessage,{id:"frontSignupComponent.submitButton.label",defaultMessage:"Sign up"})))}renderPlaceholderText(){const{persona:e,intl:t}=this.props,a=t.formatMessage({id:"frontSignupComponent.emailInput.genericEmailPlaceholder",defaultMessage:"Enter your email…"});switch(e){case"personal":return a;case"education":return t.formatMessage({id:"frontSignupComponent.emailInput.educationEmailPlaceholder",defaultMessage:"Enter your school email…"});case"team":return t.formatMessage({id:"frontSignupComponent.emailInput.teamEmailPlaceholder",defaultMessage:"Enter your work email…"});default:return a}}getWrapStyle(){return{width:"100%",maxWidth:this.props.maxWidth?this.props.maxWidth:320,display:"flex",alignItems:"center"}}}l()(jt,"inputStyle",{fontSize:Ut.a.fontSize.ui.m,height:36,flex:1,background:ie.g.white,boxShadow:Rt.a.frontInputShadow,marginRight:8});var Nt=Object(S.injectIntl)(jt),Zt=a("5Nka"),Wt=a("7Vnh");class Vt extends I.a{getInitialState(){return{termType:"yearly"}}}var zt=new Vt,qt=a("lEhh");class Ht extends j.a{renderComponent(){const e="yearly"===zt.state.termType?"monthly":"yearly";return s()("div",{style:this.getTermToggleStyle(this.theme),onClick:()=>{v.ec(this.environment,{from:"pricing_grid_top",toggle_to:e}),zt.setState({...zt.state,termType:e})}},void 0,s()("div",{style:{marginRight:8}},void 0,this.props.isSettings?s()(S.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payAnnually.label",defaultMessage:"Pay annually"}):s()(S.FormattedMessage,{id:"frontPricingPage.pricingTermToggle.payAnnually.label",defaultMessage:"Pay annually"})),s()(qt.a,{on:"monthly"===zt.state.termType}),s()("div",{style:{marginLeft:8}},void 0,this.props.isSettings?s()(S.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payMonthly.label",defaultMessage:"Monthly"}):s()(S.FormattedMessage,{id:"frontPricingPage.pricingTermToggle.payMonthly.label",defaultMessage:"Pay monthly"})))}getTermToggleStyle(e){return{cursor:"pointer",fontSize:14,color:e.mediumTextColor,display:"flex",alignItems:"center",marginBottom:8}}}var Gt=Ht;var Kt=function(e){return!!e.device.isMobile||e.WindowSizeStore.state.width<960},Yt=a("uRvc"),Qt=a("VhAz"),Jt=a("w4oV");const Xt=["free","personal","team","enterprise"];class $t extends j.a{willMount(e){const t=Me.o(e.data);t&&e.data&&zt.setState({termType:"year"===t.interval?"yearly":"monthly"})}renderComponent(){const e=Object(Wt.e)();return s()("div",{},void 0,s()("table",{style:this.getTableStyle(this.props.isSettings)},void 0,this.props.isSettings&&this.renderHeader(),s()("tbody",{},void 0,e.map((e,t)=>this.renderSection(e,t))),!this.props.isSettings&&this.renderFooter()))}renderCheck(){return ye.a.thinCheck({display:"inline",height:this.props.isSettings?12:14,width:this.props.isSettings?12:14,color:this.theme.regularTextColor})}upgradeLink(e,t){const{planState:a}=this.props;if(a)return s()(we.a,{onClick:a.plans[e].onClick,style:{fontSize:12,fontWeight:500,textDecoration:"none",color:this.theme.mediumTextColor,lineHeight:1.2}},void 0,t||s()(S.FormattedMessage,{id:"pricingGrid.planAttribute.button.upgrade",defaultMessage:"Upgrade"}))}renderPlanContent(e){const{label:t,upgradeCta:a,upgradeCTALabel:i}=e;return t&&a?s()(d.Fragment,{},void 0,t,s()("br",{}),this.upgradeLink(a,i)):t||(a?s()(d.Fragment,{},void 0,s()(S.FormattedMessage,{id:"pricingGrid.planAttribute.notInTrial",defaultMessage:"Not in trial"}),s()("br",{}),this.upgradeLink(a,i)):this.renderCheck())}renderPlan(e,t,a){return s()("td",{style:{...this.getRowStyle(this.theme),...this.getValueStyle(),...this.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,a.hasFeature&&s()(He.a,{delayThreshold:0,placement:He.a.Placement.Right,renderTooltip:()=>Object(Wt.f)(t),textWrap:!0,render:e=>c.a.createElement("div",o()({style:{cursor:"help",lineHeight:1.3,padding:"6px 0"}},e),this.renderPlanContent(a))}))}renderItem(e,t){const a=this.props.isSettings?"auto":300,i=this.props.planState&&this.props.planState.isTeamTrial;return s()("tr",{},"table-row-".concat(t),s()("td",{style:{...this.getRowStyle(this.theme),...this.getRowLabelStyle(this.theme),width:a,maxWidth:a,minWidth:a}},void 0,s()(He.a,{delayThreshold:0,placement:He.a.Placement.Right,renderTooltip:()=>Object(Wt.f)(e.tooltip),textWrap:!0,render:t=>c.a.createElement("span",o()({},t,{style:this.getTooltipInnerStyle(this.theme)}),e.label,e.isComingSoon&&this.renderBadge("comingSoon"),e.isBeta&&this.renderBadge("beta"))})),Xt.map(t=>{const a="team"===t&&i?"teamTrial":t;return this.renderPlan(t,e.tooltip,e.plans[a])}))}renderEmptyTableCell(e,t){return s()("td",{style:{...this.getSectionStyle(this.theme,t),...this.getValueStyle(),...this.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e),color:ie.g.lightTextColor,fontWeight:400}},void 0,!this.props.isSettings&&this.getPlanName(e))}renderEmptyTableCells(e){return s()(d.Fragment,{},void 0,Xt.map(t=>this.renderEmptyTableCell(t,e)))}renderSection(e,t){const a=this.props.isSettings?"auto":300;return s()(d.Fragment,{},"table-section-".concat(t),s()("tr",{},void 0,s()("td",{style:{...this.getSectionStyle(this.theme,t),width:a,maxWidth:a,minWidth:a}},void 0,e.label),this.renderEmptyTableCells(t)),e.items.map((e,t)=>this.renderItem(e,t)))}renderButton(e,t){const a=t.plans[e],i="notion-pricing-grid-upgrade-".concat(e);let n;switch(a.buttonType){case"current":n=s()(S.FormattedMessage,{id:"pricingGrid.currentPlanButton.label",defaultMessage:"Current"});break;case"upgrade":n=s()(S.FormattedMessage,{id:"pricingGrid.upgradePlanButton.label",defaultMessage:"Upgrade"});break;case"downgrade":n=s()(S.FormattedMessage,{id:"pricingGrid.downgradePlanButton.label",defaultMessage:"Downgrade"});break;case"will-downgrade":n=s()(S.FormattedMessage,{id:"pricingGrid.willDowngradePlanButton.label",defaultMessage:"Future plan"});break;case"resubscribe":n=s()(S.FormattedMessage,{id:"pricingGrid.resubscribePlanButton.label",defaultMessage:"Resubscribe"});break;default:Qt.f(a.buttonType)}if("current"===a.buttonType)return this.renderDisabledButtonWithTooltip({tooltip:s()(S.FormattedMessage,{id:"pricingGrid.currentPlan.tooltip",defaultMessage:"This is your current active plan"}),label:s()(S.FormattedMessage,{id:"pricingGrid.currentPlan.largeScreenLabel",defaultMessage:"Current plan"}),buttonClassName:i,wrapTooltip:!1});if(!t.canSwitchPlans){let e;return e=t.isInAppPurchase?s()(S.FormattedMessage,{id:"pricingGrid.switchPlanFromInAppPurchase.tooltip",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}):s()(S.FormattedMessage,{id:"pricingGrid.switchPlanAsMember.tooltip",defaultMessage:"You need to be an administrator of this workspace to switch plans."}),this.renderDisabledButtonWithTooltip({tooltip:e,label:n,buttonClassName:i,wrapTooltip:!0})}return("personal"===e||"free"===e)&&t.memberCount>1?this.renderDisabledButtonWithTooltip({tooltip:s()(S.FormattedMessage,{id:"pricingGrid.switchToPersonalPlanButton.tooltip",defaultMessage:"The Personal and Personal Pro Plans are only available for 1-person use. If you'd like to use these plans, please remove the other members in this workspace."}),label:n,buttonClassName:i,wrapTooltip:!0}):"will-downgrade"===a.buttonType?this.renderDisabledButtonWithTooltip({tooltip:s()(S.FormattedMessage,{id:"pricingGrid.willDowngradePlan.tooltip",defaultMessage:"This is the plan after your current plan expires"}),label:s()(S.FormattedMessage,{id:"pricingGrid.willDowngradePlan.largeScreenLabel",defaultMessage:"Future plan"}),buttonClassName:i,wrapTooltip:!1}):"downgrade"===a.buttonType?s()(ne.a,{isLarge:!0,style:{width:"100%"},onClick:()=>{v.Vd(this.environment,{plan:e,from:"pricing_grid_top",button_text:a.buttonType}),a.onClick()},className:i},void 0,n):s()(se.a,{isLarge:!0,style:{width:"100%"},onClick:()=>{v.Vd(this.environment,{plan:e,from:"pricing_grid_top",button_text:a.buttonType}),a.onClick()},className:i},void 0,n)}renderDisabledButtonWithTooltip(e){const{tooltip:t,label:a,buttonClassName:i,wrapTooltip:n}=e;return s()(He.a,{style:{width:n?320:"auto"},textWrap:n,renderTooltip:()=>t,render:e=>c.a.createElement(ne.a,o()({style:{width:"100%",opacity:.5},isLarge:!0,disabled:!0},e,{className:i}),a)})}renderSalesContactLink(){return s()(we.a,{onClick:()=>{const{currentUserStore:e}=y.default.state,t=e&&e.getValue();v.Z(this.environment),Jt.a.setState({open:!0,email:t&&t.email,name:t&&Object(st.e)(this.props.intl,t)})}},void 0,s()("div",{style:this.getUpgradeButtonBelowLinkStyle()},void 0,s()(S.FormattedMessage,{id:"pricingGrid.contactSalesLink",defaultMessage:"Contact sales"})))}renderTeamTrialIndicator(){return s()(He.a,{delayThreshold:0,placement:He.a.Placement.Bottom,renderTooltip:()=>s()(S.FormattedMessage,{id:"pricingGrid.inTeamTrial.tooltip",defaultMessage:"Your current Team trial has a 1,000 block limit. Upgrade to go unlimited."}),textWrap:!0,style:{width:280},render:e=>c.a.createElement("div",o()({style:{...this.getUpgradeButtonBelowLinkStyle(),fontWeight:500,display:"flex",flexDirection:"row",cursor:"help"}},e),s()("div",{style:{paddingRight:4,paddingTop:2}},void 0,this.renderCheck()),s()("div",{},void 0,s()(S.FormattedMessage,{id:"pricingGrid.inTeamTrial",defaultMessage:"In free trial"})))})}renderTeamTrialButton(e){if(e.isActive&&"resubscribe"===e.buttonType)return;const t="current"===e.buttonType?s()(S.FormattedMessage,{id:"pricingGrid.cancelPlanLink",defaultMessage:"Cancel plan"}):s()(S.FormattedMessage,{id:"pricingGrid.teamTrialLink",defaultMessage:"Try for free"});return s()(we.a,{onClick:e.onClickTeamFree},void 0,s()("div",{style:this.getUpgradeButtonBelowLinkStyle()},void 0,t))}getPlanName(e){const{intl:t}=this.props;switch(e){case"free":return t.formatMessage({id:"pricingGrid.personalFreePlanColumn.header",defaultMessage:"Personal"});case"personal":return t.formatMessage({id:"pricingGrid.personalProPlanColumn.header",defaultMessage:"Personal Pro"});case"team":return t.formatMessage({id:"pricingGrid.teamPlanColumn.header",defaultMessage:"Team"});case"enterprise":return t.formatMessage({id:"pricingGrid.enterprisePlanColumn.header",defaultMessage:"Enterprise"});default:Qt.f(e)}}renderHeaderTitle(e){const t=this.getPlanName(e.plan);return s()("td",{style:{...this.getHeaderStyle(),...this.getActiveStyle(this.theme,this.isPlanActive(e.plan)),...this.getBorderStyle(e.plan)}},void 0,!this.props.isSettings&&s()("img",{style:{height:80,marginBottom:-5},src:e.image,alt:t}),s()("div",{style:this.getHeaderTitleStyle()},void 0,t),void 0!==e.price&&s()("div",{style:{display:Kt(this.environment)?"block":"flex"}},void 0,s()("div",{style:this.getHeaderPriceStyle()},void 0,e.price),void 0!==e.terms&&s()("div",{style:this.getHeaderTermsStyle(this.theme)},void 0,Object(Wt.c)(this.props.intl,e.terms))),!this.props.isSettings&&"enterprise"===e.plan&&s()("div",{style:{height:30}},void 0,this.renderSalesContactLink()))}renderHeaderLabels(){const e=this.isPlanActive("team")||this.isPlanActive("enterprise");return s()("tr",{},void 0,s()("td",{style:{width:"28%"}}),s()("td",{style:{...this.getHeaderLabelStyle(!e),...this.getBorderStyle("free"),borderLeft:this.props.isSettings?"1px solid ".concat(this.theme.lightDividerColor):void 0},colSpan:2},void 0,s()(S.FormattedMessage,{id:"pricingGrid.personalPlans.label",defaultMessage:"For individuals"})),s()("td",{style:{...this.getHeaderLabelStyle(e),...this.getBorderStyle("enterprise")},colSpan:2},void 0,s()(S.FormattedMessage,{id:"pricingGrid.teamPlans.label",defaultMessage:"For teams & businesses"})))}renderHeaderTitles(){const e=zt.state.termType,t=Object(Wt.d)(z.default,this.props.intl);return s()("tr",{},void 0,s()("td",{}),this.renderHeaderTitle({plan:"free",price:t.price[e].personal,image:Zt.a.images.pricing.pricingFreeV2Png}),this.renderHeaderTitle({plan:"personal",price:t.price[e].pro,image:Zt.a.images.pricing.pricingPersonalV2Png,terms:t.terms.pro}),this.renderHeaderTitle({plan:"team",price:t.price[e].team,image:Zt.a.images.pricing.pricingTeamV2Png,terms:t.terms.team}),this.props.isSettings?this.renderHeaderTitle({plan:"enterprise",price:t.price[e].enterprise,image:Zt.a.images.pricing.pricingEnterpriseV2Png,terms:t.terms.enterprise}):this.renderHeaderTitle({plan:"enterprise",image:Zt.a.images.pricing.pricingEnterpriseV2Png}))}renderHeaderAction(e){const{planState:t}=this.props;if(t)return s()("td",{style:{...this.getHeaderStyle(),...this.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,this.renderButton(e,t),this.renderHeaderSubAction(e))}renderHeaderSubAction(e){if("enterprise"===e)return s()("div",{style:{marginTop:7}},void 0,this.renderSalesContactLink());if("team"===e){const{planState:t}=this.props;if(!t||!t.canSwitchPlans||t.plans.personal.isActive)return;return s()("div",{style:{marginTop:7}},void 0,t.isTeamTrial?this.renderTeamTrialIndicator():this.renderTeamTrialButton(t.plans[e]))}}renderHeaderActions(){if(this.props.isSettings&&this.props.planState)return s()("tr",{},void 0,s()("td",{style:{width:"28%",verticalAlign:"top",paddingTop:16}},void 0,s()(Gt,{isSettings:this.props.isSettings})),Xt.map(e=>this.renderHeaderAction(e)))}renderHeader(){return s()("thead",{},void 0,this.renderHeaderLabels(),this.renderHeaderTitles(),this.renderHeaderActions())}renderStandardCTA(){return s()(Nt,{buttonTitle:s()(S.FormattedMessage,{id:"pricingGrid.signupComponent.submitButton.label",defaultMessage:"Try it free"}),analyticsName:"pricing_grid_bottom",buttonWidth:100,persona:"personal"})}renderEnterpriseCTA(){return s()(Et.a,{variant:"secondary",isFullWidth:!0,onClick:()=>{Tt({environment:this.environment,typeform:"enterpriseTrial",frontContext:"pricing_grid_bottom",params:{source:"pricing_grid_bottom"}})}},void 0,s()(S.FormattedMessage,{defaultMessage:"Try Enterprise",id:"pricingGrid.enterpriseCallToAction.message"}))}renderCTAs(){return s()(d.Fragment,{},void 0,s()("td",{colSpan:3,style:{...this.getCTACellStyle()}},void 0,s()("div",{style:{display:"flex",justifyContent:"flex-start",width:"100%"}},void 0,this.renderStandardCTA())),s()("td",{style:{...this.getCTACellStyle()}},void 0,this.renderEnterpriseCTA()))}renderFooter(){return s()("tfoot",{},void 0,s()("tr",{},void 0,s()("td",{style:{verticalAlign:"middle",fontWeight:500}},void 0,s()(S.FormattedMessage,{defaultMessage:"Sign up for free.{br}Add your team later.",id:"pricingGrid.footerSignupCallToAction.message",values:{br:s()("br",{})}})),this.renderCTAs()))}renderBadge(e){return s()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap",position:"relative",top:-1}},void 0,"comingSoon"===e&&s()(S.FormattedMessage,{id:"pricingGrid.comingSoonBadge",defaultMessage:"Coming soon"}),"beta"===e&&s()(S.FormattedMessage,{id:"pricingGrid.betaBadge",defaultMessage:"Beta"}))}isPlanActive(e){return!(!this.props.planState||!this.props.planState.plans[e].isActive)}getTableStyle(e){return{fontSize:e?14:16,width:e?"100%":Yt.b.m,tableLayout:"fixed",borderCollapse:"initial"}}getSectionStyle(e,t){const a={borderBottom:"1px solid ".concat(e.regularDividerColor),paddingBottom:7,paddingRight:15,fontWeight:500,verticalAlign:"bottom"};return 0===t?{...a,paddingTop:this.props.isSettings?0:54}:{...a,paddingTop:this.props.isSettings?20:42}}getUpgradeButtonBelowLinkStyle(){return{fontSize:this.props.isSettings?12:14}}getRowStyle(e){return{borderBottom:"1px solid ".concat(e.regularDividerColor)}}getRowLabelStyle(e){const t=(this.props.isSettings,5);return{color:e.mediumTextColor,paddingRight:10,paddingTop:t,paddingBottom:t+1,verticalAlign:"top"}}getCTACellStyle(){return{padding:"20px 15px"}}getValueStyle(){const e=this.props.isSettings?10:15;return{paddingLeft:e,paddingRight:e,textAlign:"left",overflow:"hidden",verticalAlign:"top"}}getActiveStyle(e,t){return{background:t?e.sidebarBackground:ie.g.transparent}}getBorderStyle(e){return{borderLeft:this.props.isSettings?"1px solid ".concat(this.theme.lightDividerColor):void 0,borderRight:this.props.isSettings&&["enterprise"].includes(e)?"1px solid ".concat(this.theme.lightDividerColor):void 0}}getHeaderLabelStyle(e){const t=this.props.isSettings?10:15;return{paddingLeft:t,paddingRight:t,verticalAlign:"top",width:"36%",paddingTop:this.props.isSettings?10:0,fontWeight:700,fontSize:12,paddingBottom:10,borderBottom:e?"2px solid ".concat(this.theme.regularTextColor):"1px solid ".concat(this.theme.lightDividerColor),borderTop:"1px solid ".concat(this.theme.lightDividerColor)}}getHeaderStyle(){const e=this.props.isSettings?10:15;return{paddingLeft:e,paddingRight:e,verticalAlign:"top",width:"18%",paddingTop:this.props.isSettings?10:0}}getHeaderTitleStyle(){return{fontSize:this.props.isSettings?16:25,fontWeight:this.props.isSettings&&Kt(this.environment)?500:700,lineHeight:1.3,marginBottom:2}}getHeaderPriceStyle(){return{fontSize:this.props.isSettings?20:25,marginRight:7}}getTooltipInnerStyle(e){return{cursor:"help",width:"100%",display:"inline-block"}}getHeaderTermsStyle(e){return{fontSize:this.props.isSettings?10:12,lineHeight:1,color:e.mediumTextColor,width:70,paddingTop:this.props.isSettings?Kt(this.environment)?0:3:5}}}var ea=Object(S.injectIntl)($t);const ta=["not_using_enough","too_difficult","trial_over","too_expensive","security_compliance_requirements","company_shutting_down","upgraded_by_mistake","using_alternative","missing_features","other"],aa=["google_drive_docs","asana","trello","microsoft_office","atlassian_confluence","atlassian_jira","airtable","coda","dropbox_paper","quip","evernote","other"];class ia extends I.a{getInitialState(){return{reasons:[],reasonMissingFeatures:"",reasonOther:"",alternatives:[],alternativeOther:"",otherFeedback:""}}}var sa=ia,na=a("3DNc"),oa=a("mKX5");const ra=Object(S.defineMessages)({missingFeaturesPlaceholder:{id:"churnSurveyMenu.reasons.missingFeaturesPlaceholder",defaultMessage:"Let us know which features are missing..."},reasonOtherPlaceholder:{id:"churnSurveyMenu.reasons.reasonOtherPlaceholder",defaultMessage:"Tell us more..."},alternativeOtherPlaceholder:{id:"churnSurveyMenu.alternatives.alternativeOtherPlaceholder",defaultMessage:"Tell us more..."},otherFeedbackPlaceholder:{id:"churnSurveyMenu.other.otherFeedbackPlaceholder",defaultMessage:"Our team will review your feedback to make Notion better."}});class la extends j.a{constructor(...e){super(...e),l()(this,"shuffledReasons",[...p.a.shuffle(p.a.without(ta,"other")),"other"]),l()(this,"shuffledAlternatives",[...p.a.shuffle(p.a.without(aa,"other")),"other"]),l()(this,"storeTypes",{store:sa}),l()(this,"handleAccept",()=>{Object(v.x)(this.environment,this.stores.store.state),this.props.onAccept()})}renderComponent(){const{churnType:e,onClose:t,periodEnd:a}=this.props,{store:i}=this.stores,{reasons:n,reasonMissingFeatures:o,reasonOther:r,alternatives:l,alternativeOther:d,otherFeedback:u}=i.state,m=Object(oa.a)(a).format("LL");return s()("div",{style:{fontSize:14}},void 0,s()("div",{style:{display:"flex",fontSize:14,padding:24,paddingBottom:20,borderBottom:"1px solid ".concat(this.theme.lightDividerColor)}},void 0,s()("div",{},void 0,s()("h3",{style:la.headerStyle},void 0,s()(S.FormattedMessage,"personal"===e?{id:"churnSurveyMenu.header.personal.title",defaultMessage:"Downgrade to Personal"}:{id:"churnSurveyMenu.header.team.title",defaultMessage:"Downgrade to Team Trial"})),s()("p",{style:{lineHeight:1.4,margin:"8px 0 12px"}},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.header.description",defaultMessage:"Notion is constantly improving. Before you downgrade, we’d love your input to help us make Notion better for everyone. Thank you for your feedback."})),s()(ne.a,{onClick:t},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.goBackButton.title",defaultMessage:"Back to Plans"}))),s()("div",{style:{alignSelf:"center",padding:"0px 8px"}},void 0,s()("img",{src:Zt.a.images.downgradeFeedbackPng,style:{filter:this.theme.illustrationFilter},width:160}))),s()("div",{style:{padding:"8px 12px",margin:"20px 24px 12px 24px",background:this.theme.sidebarBackground,borderRadius:3}},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.header.covidMessage",defaultMessage:"💛 If you are impacted by COVID-19, <contactuslink>contact us</contactuslink> for assistance.",values:{contactuslink:(...e)=>s()(we.a,{onClick:()=>{Object(Ce.a)({environment:this.environment,from:"churn_survey"})}},void 0,e)}})),s()("div",{style:la.surveySectionStyle},void 0,s()("h4",{style:la.subheaderStyle},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.title",defaultMessage:"1. What are your reasons for downgrading?"})),s()("div",{style:this.getDescriptionStyle()},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.description",defaultMessage:"Please select one or more"})),this.shuffledReasons.map(e=>{const t=n.includes(e);return c.a.createElement(c.a.Fragment,null,s()("div",{style:la.optionRowStyle,onClick:()=>{i.setState({...i.state,reasons:t?p.a.without(n,e):[...n,e]})}},e,s()(na.a,{checked:t,size:14}),s()("span",{style:{marginLeft:4}},void 0,this.renderMessageForReason(e))),"missing_features"===e&&t&&s()(H.b,{style:la.inlineInputStyle,autoFocus:!0,value:o,placeholder:C.default.formatMessage(ra.missingFeaturesPlaceholder),onChange:e=>{i.setState({...i.state,reasonMissingFeatures:e.target.value})}}),"other"===e&&t&&s()(H.b,{style:la.inlineInputStyle,autoFocus:!0,value:r,placeholder:C.default.formatMessage(ra.reasonOtherPlaceholder),onChange:e=>{i.setState({...i.state,reasonOther:e.target.value})}}))})),s()("div",{style:la.surveySectionStyle},void 0,s()("h4",{style:la.subheaderStyle},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.title",defaultMessage:"2. What tools are you using instead?"})),s()("div",{style:this.getDescriptionStyle()},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.description",defaultMessage:"Please select one or more"})),this.shuffledAlternatives.map(e=>{const t=l.includes(e);return c.a.createElement(c.a.Fragment,null,s()("div",{style:la.optionRowStyle,onClick:()=>{i.setState({...i.state,alternatives:t?p.a.without(l,e):[...l,e]})}},e,s()(na.a,{checked:t,size:14}),s()("span",{style:{marginLeft:4}},void 0,this.renderMessageForAlternative(e))),"other"===e&&t&&s()(H.b,{style:la.inlineInputStyle,autoFocus:!0,value:d,placeholder:C.default.formatMessage(ra.alternativeOtherPlaceholder),onChange:e=>{i.setState({...i.state,alternativeOther:e.target.value})}}))})),s()("div",{style:la.surveySectionStyle},void 0,s()("h4",{style:la.subheaderStyle},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.otherFeedback.title",defaultMessage:"3. Any other feedback for us?"})),s()(H.b,{textarea:!0,style:{marginTop:4},value:u,placeholder:C.default.formatMessage(ra.otherFeedbackPlaceholder),onChange:e=>{i.setState({...i.state,otherFeedback:e.target.value})}})),s()("div",{style:{padding:"20px 24px",marginTop:20,borderTop:"1px solid ".concat(this.theme.lightDividerColor)}},void 0,s()("h4",{style:la.subheaderStyle},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.continueDowngrade.title",defaultMessage:"Continue downgrade?"})),s()("p",{style:{margin:"4px 0 20px",lineHeight:1.4}},void 0,s()(S.FormattedMessage,"personal"===e?{id:"churnSurveyMenu.continueDowngrade.downgradeMessage.personal",defaultMessage:"If you cancel now, you'll still enjoy all the features of your paid plan until {periodEnd}. You can resubscribe or switch to another paid plan anytime.{br}After {periodEnd}, this workspace will be downgraded to the free Personal plan, with these restrictions: <li>Single-person use</li><li>Guest limit of 5 per workspace</li><li>Upload files up to 5 MB</li><li>No version history</li><li>No member shared workspace</li>",values:{periodEnd:s()("span",{style:{fontWeight:600}},void 0,m),br:s()("div",{style:{height:8}}),li:(...e)=>s()("ul",{style:la.restrictionListItemStyle},void 0,s()("li",{},void 0,e))}}:{id:"churnSurveyMenu.continueDowngrade.downgradeMessage.team",defaultMessage:"If you cancel now, you'll still enjoy all the features of your paid plan until {periodEnd}. You can resubscribe or switch to another paid plan anytime.{br}After {periodEnd}, this workspace will be downgraded to a free trial of the Team Plan, with these restrictions: <li>1,000 block limit</li><li>Upload files up to 5 MB</li><li>No version history</li><li>No bulk exports</li><li>No advanced permissions</li><li>No permission groups</li>",values:{periodEnd:s()("span",{style:{fontWeight:600}},void 0,m),br:s()("div",{style:{height:8}}),li:(...e)=>s()("ul",{style:la.restrictionListItemStyle},void 0,s()("li",{},void 0,e))}})),s()("div",{style:{display:"flex"}},void 0,s()(ne.a,{isRed:!0,onClick:this.handleAccept},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.downgradeButton.title",defaultMessage:"Downgrade"})),s()(ne.a,{onClick:t,style:{marginLeft:12}},void 0,s()(S.FormattedMessage,{id:"churnSurveyMenu.cancelButton.title",defaultMessage:"Cancel"})))))}renderMessageForReason(e){return"not_using_enough"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.notUsingEnough",defaultMessage:"Not using it enough"}):"too_difficult"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.toDifficult",defaultMessage:"Too difficult to use"}):"trial_over"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.trialOver",defaultMessage:"Trial is over"}):"too_expensive"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.tooExpensive",defaultMessage:"Too expensive"}):"security_compliance_requirements"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.securityComplianceRequirements",defaultMessage:"Security or compliance requirements"}):"company_shutting_down"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.companyShuttingDown",defaultMessage:"Company is shutting down or making cuts"}):"upgraded_by_mistake"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.upgradedByMistake",defaultMessage:"Upgraded by mistake"}):"using_alternative"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.usingAlternative",defaultMessage:"Using an alternative"}):"missing_features"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.missingFeatures",defaultMessage:"Missing features"}):"other"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.reasons.other",defaultMessage:"Other"}):void Object(Qt.f)(e)}renderMessageForAlternative(e){return"google_drive_docs"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.googleDriveDocs",defaultMessage:"Google Drive / Docs"}):"asana"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.asana",defaultMessage:"Asana"}):"trello"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.trello",defaultMessage:"Trello"}):"microsoft_office"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.microsoftOffice",defaultMessage:"Microsoft 365 / Office"}):"atlassian_confluence"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.atlassianConfluence",defaultMessage:"Confluence"}):"atlassian_jira"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.atlassianJira",defaultMessage:"Jira"}):"airtable"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.airtable",defaultMessage:"Airtable"}):"coda"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.coda",defaultMessage:"Coda"}):"dropbox_paper"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.dropboxPaper",defaultMessage:"Dropbox Paper"}):"quip"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.quip",defaultMessage:"Quip"}):"evernote"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.evernote",defaultMessage:"Evernote"}):"other"===e?s()(S.FormattedMessage,{id:"churnSurveyMenu.alternatives.other",defaultMessage:"Other"}):void Object(Qt.f)(e)}getDescriptionStyle(){return{margin:0,color:this.theme.mediumTextColor,marginBottom:8}}}l()(la,"optionRowStyle",{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:4}),l()(la,"restrictionListItemStyle",{paddingLeft:20,margin:"6px 0"}),l()(la,"surveySectionStyle",{padding:"8px 24px"}),l()(la,"headerStyle",{margin:0,marginBottom:8}),l()(la,"subheaderStyle",{margin:0,marginTop:8,fontSize:16,fontWeight:600}),l()(la,"inlineInputStyle",{marginBottom:12,marginLeft:18,width:"calc(100% - 18px)"});var da=la,ca=a("AfJk");class ua extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:Mt}),l()(this,"renderChurnSurveyModal",()=>{const e=this.stores.store.state,{data:t}=this.props,a=Me.o(t),i=Me.h(this.environment);if(e.churnSurveyModalOpen&&i&&a)return s()(da,{churnType:e.churnType,periodEnd:a.periodEnd,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose})}),l()(this,"handleFreeClick",async()=>{const{data:e}=this.props;if(e&&"subscribed_admin"===e.type){const e=await new Promise(e=>{const{store:t}=this.stores;t.setState({churnType:"personal",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})});if(!e)return;e&&await w.a({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal"})}else if(e&&("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type)){await new Promise((e,t)=>{f.showDialog({showCancel:!0,keepFocus:!1,message:s()("div",{},void 0,s()("h4",{style:{margin:"8px 0 0"}},void 0,s()(S.FormattedMessage,{id:"subscriptSettings.freePersonal.downgradeTitle",defaultMessage:"Downgrade to the Personal Plan?"})),s()("p",{style:{margin:"8px 0"}},void 0,s()(S.FormattedMessage,{id:"subscriptionSettings.freePersonal.downgradeMessage",defaultMessage:"The Personal Plan is free for 1-person use. You'll lose the ability to add members, and guests will be limited to 5 per workspace."}))),items:[{label:s()(S.FormattedMessage,{id:"subscriptionSettings.freePersonal.downgradeConfirmationButton",defaultMessage:"Downgrade to Personal Plan"}),color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})})&&await w.a({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal"})}}),l()(this,"handlePersonalClick",async()=>{const{spaceStore:e,data:t}=this.props,a=Me.o(t);if(a&&Me.H(t)){const t=gt.d.personal[a.interval];await w.h({environment:this.environment,spaceStore:e,plan:t,billing:a.billing})}else w.d(this.environment,{subscriptionTier:"personal",from:"pricing_grid"})}),l()(this,"handleEducationPlanClick",()=>{const{spaceStore:e}=this.props;w.i({environment:this.environment,spaceStore:e})}),l()(this,"handleTeamClick",async()=>{const{spaceStore:e,data:t}=this.props,a=Me.o(t),i=a&&void 0===a.canceledAt;let n;if(a&&i&&"enterprise"!==Me.h(this.environment)&&(n=this.props.intl.formatMessage({id:"spaceSubscriptionPlans.teamPlan.confirmMessage",defaultMessage:"You are about to subscribe to Notion's Team Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance."},{price:Me.i({subscriptionTier:"team",billingInterval:a.interval,intl:this.props.intl}),br:s()("br",{})})),n){const e="unsubscribed_admin"===t.type||"unsubscribed_member"===t.type||a&&a.canceledAt||"enterprise"!==Me.h(this.environment);if(!(await f.confirmUserAction({message:n,acceptLabel:this.props.intl.formatMessage({id:"spaceSubscriptionPlans.teamPlan.confirmButtonLabel",defaultMessage:"{upgrading, select, true {Upgrade to Team Plan} other {Downgrade to Team Plan}}"},{upgrading:e})})))return}if(a&&Me.H(t)){const t=gt.d.team[a.interval];await w.h({environment:this.environment,spaceStore:e,plan:t,billing:a.billing})}else w.d(this.environment,{subscriptionTier:"team",from:"pricing_grid"})}),l()(this,"handleTeamFreeClick",async()=>{const{data:e}=this.props;if(e&&"subscribed_admin"===e.type){const e=await new Promise(e=>{const{store:t}=this.stores;t.setState({churnType:"team",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})});if(v.I(this.environment,{confirmed:e}),!e)return;e&&await w.a({environment:this.environment,spaceStore:this.props.spaceStore,planType:"team"})}else if(e&&("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type)){const e=await new Promise((e,t)=>{f.showDialog({showCancel:!0,keepFocus:!1,message:s()("div",{},void 0,s()("h4",{style:{margin:"8px 0 0"}},void 0,s()(S.FormattedMessage,{id:"subscriptionSettings.freeTeam.upgradeTitle",defaultMessage:"Try the Team Plan for free"})),s()("p",{style:{margin:"8px 0"}},void 0,s()(S.FormattedMessage,{id:"subscriptionSettings.freeTeam.upgradeMessage",defaultMessage:"You'll get access to most features of a paid Team Plan, with a 1,000 block storage limit. Upgrade to go unlimited anytime."}))),items:[{label:s()(S.FormattedMessage,{id:"subscriptionSettings.startTeamTrialDialog.confirmationbutton",defaultMessage:"Start Team trial"}),color:"blue",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})});if(v.J(this.environment,{confirmed:Boolean(e)}),!e)return;e&&await w.a({environment:this.environment,spaceStore:this.props.spaceStore,planType:"team"})}}),l()(this,"handleEnterpriseClick",async()=>{const{spaceStore:e,data:t}=this.props,a=Me.o(t),i=a&&void 0===a.canceledAt;if(a&&i){const e=s()(S.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseDialog.message",defaultMessage:"You are about to subscribe to Notion's Enterprise Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance.",values:{price:Me.i({subscriptionTier:"enterprise",billingInterval:a.interval,intl:this.props.intl}),br:s()("br",{})}});if(!(await f.confirmUserAction({message:e,acceptLabel:s()(S.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseDialog.confirmationbutton",defaultMessage:"Upgrade to Enterprise Plan"})})))return}if(a&&Me.H(t)){const t=gt.d.enterprise[a.interval];await w.h({environment:this.environment,spaceStore:e,plan:t,billing:a.billing})}else w.d(this.environment,{subscriptionTier:"enterprise",from:"pricing_grid"})}),l()(this,"handleChurnSurveyModalAccept",()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept(),e.reset()}),l()(this,"handleChurnSurveyModalClose",()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()})}willMount(){w.e(this.environment)}renderComponent(){return ae.a.state.online?this.renderPlans():s()(ca.a,{})}renderPlans(){const{churnSurveyModalOpen:e}=this.stores.store.state;return s()("div",{style:ua.wrapStyle},void 0,s()(ht.b,{style:ua.scrollerStyle,type:ht.a.Y},void 0,this.renderSubscriptionInfo(),this.renderPricingGrid(),this.renderPriceDisclaimer(),this.allowEducationUpgrade()&&this.renderStudentUpgrade(),this.renderFAQ(),s()(Z.a,{innerStyle:{width:600,height:"80vh",overflow:"scroll"},open:e,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})))}renderPriceDisclaimer(){const{intl:e}=this.props;return s()("div",{style:ua.priceDisclaimerStyle},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionPlans.priceDisclaimer",defaultMessage:"Prices shown are for annual billing. When billed month-to-month, the <b>Personal Pro Plan</b> is {personalMonthlyPrice} per month, the <b>Team Plan</b> is {teamMonthlyPrice} per member per month, and the <b>Enterprise Plan</b> is {enterpriseMonthlyPrice} per member per month.",values:{b:(...e)=>s()("b",{},void 0,e),personalMonthlyPrice:Object(yt.b)({amount:z.default.pricing.personal.monthlyPrice,currency:"dollar",intl:e}),teamMonthlyPrice:Object(yt.b)({amount:z.default.pricing.team.monthlyPricePerMember,currency:"dollar",intl:e}),enterpriseMonthlyPrice:Object(yt.b)({amount:z.default.pricing.enterprise.monthlyPricePerMember,currency:"dollar",intl:e})}}))}renderSubscriptionInfo(){const{spaceStore:e}=this.props,{data:t}=this.props;return"subscribed_admin"===t.type?s()("div",{style:this.subscriptionInfoStyle()},void 0,Me.G(this.environment,e,t)):"unsubscribed_admin"===t.type||"unsubscribed_member"===t.type?s()("div",{style:{...this.subscriptionInfoStyle(),display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,s()("div",{},void 0,Me.G(this.environment,e,t))):void 0}renderPricingGrid(){const e=this.getPlanState();return s()(ea,{isSettings:!0,planState:e,data:this.props.data})}renderStudentUpgrade(){return s()("div",{style:ua.subsectionStyle},void 0,s()("div",{style:ua.subsectionTitleStyle},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"})),s()("div",{style:{color:this.theme.mediumTextColor,marginBottom:15}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.text",defaultMessage:"<p>Personal Pro Plans are free for students and educators! Simply sign up with your school email address and you'll immediately gain access to those features.</p><p>If you're already on a Personal Pro Plan, change the email associated with your account to your school email address to get it for free.</p>",values:{p:(...e)=>s()("div",{style:{marginBottom:4}},void 0,e)}})),s()(se.a,{isLarge:!0,onClick:this.handleEducationPlanClick},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.getEducationPlanButton.label",defaultMessage:"Get free Education plan"})))}renderFAQ(){return s()("div",{style:ua.subsectionStyle},void 0,s()("div",{style:ua.subsectionTitleStyle},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"})),s()(xt,{cta:"intercom",type:"general",isSettings:!0}))}getMemberCount(){return Me.u(this.props.data)}canSwitchPlans(){const e=Me.y(this.props.data);return this.props.spaceStore.canAdmin()&&!e}calculateButtonState(e){const{data:t}=this.props,a=Me.C(t);return"personal_free"===e?{free:"current",personal:"upgrade",team:"upgrade",enterprise:"upgrade"}:"personal"===e||"student"===e?{free:a?"current":"downgrade",personal:a?"resubscribe":"current",team:"upgrade",enterprise:"upgrade"}:"team_free"===e||"free"===e?{free:"downgrade",personal:"upgrade",team:"upgrade",enterprise:"upgrade"}:"team"===e?{free:"downgrade",personal:"downgrade",team:a?"resubscribe":"current",enterprise:"upgrade"}:"enterprise"===e?{free:"downgrade",personal:"downgrade",team:"downgrade",enterprise:a?"resubscribe":"current"}:void Object(Qt.f)(e)}isButtonStateActive(e){return["current","resubscribe"].includes(e)}getPlanState(){const e=Me.h(this.environment);if(!e)return;const t="team_free"===e||"free"===e,a=Me.y(this.props.data),i=this.calculateButtonState(e);return{plans:{free:{buttonType:i.free,isActive:this.isButtonStateActive(i.free),onClick:this.handleFreeClick},personal:{buttonType:i.personal,isActive:this.isButtonStateActive(i.personal),onClick:this.handlePersonalClick},team:{buttonType:i.team,isActive:this.isButtonStateActive(i.team)||t,onClick:this.handleTeamClick,onClickTeamFree:this.handleTeamFreeClick},enterprise:{buttonType:i.enterprise,isActive:this.isButtonStateActive(i.enterprise),onClick:this.handleEnterpriseClick}},isTeamTrial:t,isInAppPurchase:a,canSwitchPlans:this.canSwitchPlans(),memberCount:this.getMemberCount()}}allowEducationUpgrade(){const{data:e}=this.props,t=this.getPlanState();return t&&t.canSwitchPlans&&!Me.x(e)&&1===t.memberCount&&(t.plans.free.isActive||t.plans.personal.isActive)}subscriptionInfoStyle(){return{textAlign:"left",marginBottom:24,fontSize:14,borderBottom:"1px solid ".concat(this.theme.regularDividerColor),paddingBottom:16}}}l()(ua,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(ua,"scrollerStyle",{transform:"translateZ(0px)",flexGrow:1,padding:30}),l()(ua,"subscriptionInfoCtaButtonStyle",{marginLeft:16,paddingLeft:10}),l()(ua,"priceDisclaimerStyle",{fontSize:14,marginTop:20,marginBottom:40}),l()(ua,"subsectionStyle",{fontSize:14,marginTop:40}),l()(ua,"subsectionTitleStyle",{fontSize:20,fontWeight:$.a.fontWeight.bold,marginBottom:12});var pa=Object(S.injectIntl)(ua),ma=a("Nvzn");class ga extends I.a{getInitialState(){return{paymentMethodModalOpen:!1,billingIntervalModalOpen:!1,billingEmailModalOpen:!1,vatIdModalOpen:!1,addressModalOpen:!1,applyCreditModalOpen:!1,billingEventsLimit:20,applyCouponModalOpen:!1,addressErrorMessage:void 0}}setAddressField(e,t){const a=this.state.temporaryAddress?this.state.temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""};this.setState({...this.state,temporaryAddress:{...a,[e]:t}})}}var ha=ga;class fa extends I.a{getInitialState(){return{inputValue:void 0}}}var Ma=fa;class ya extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:Ma}),l()(this,"handleInputChange",e=>{const{store:t}=this.stores,a=e.target.value,i=this.inputValueToCents(a);let s;s=a?void 0!==i?a:this.getCurrentInputValue():"",t.setState({inputValue:s}),this.forceUpdate(),this.props.onChange(this.inputValueToCents(s)||0)})}renderComponent(){const{focus:e,selectAll:t,availableCredit:a}=this.props,i=this.getCurrentInputValue();return s()(H.b,{value:i,onChange:this.handleInputChange,focus:e,selectAll:t,disabled:a<=0,style:{maxWidth:120},inputStyle:{textAlign:"right"}})}getCurrentInputValue(){const{availableCredit:e}=this.props,{inputValue:t}=this.stores.store.state;return void 0===t?"".concat(Math.floor(e/100)):t}inputValueToCents(e){const{availableCredit:t}=this.props,a=Math.floor(100*parseFloat(e));if(!isNaN(a)&&a<=t&&a>=0)return a}}var va=ya;const ba={workspaceBalance:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"})};var Sa=a("Pl3d"),Ca=a("d9nj"),Ta=a("IdSf");class ka extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:ha,billingHistoryRequestStore:he.a}),l()(this,"performGetBillingHistoryRequest",async e=>{const{spaceStore:t}=this.props,a=await g.getBillingHistory(this.environment,{spaceId:t.id,limit:e});if("failed"===a.type)throw a.error;return a.data}),l()(this,"renderBillingHistoryResults",(e,t)=>{this.props.mockBillingHistoryResult&&(t=this.props.mockBillingHistoryResult);const{billingHistoryRequestStore:a}=this.stores;return s()("div",{},void 0,t&&0===t.events.length&&s()("div",{style:{color:this.theme.mediumTextColor,fontSize:14}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})),t&&t.events.length>0&&s()("table",{},void 0,s()("tbody",{},void 0,t.events.map(this.renderBillingHistoryEvent))),t&&!t.reachedEndOfResults&&s()(Ca.a,{onClick:this.handleLoadMoreBillingEventsClick,style:{marginLeft:-4,width:"100%"}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.loadMoreInvoicesButton.label",defaultMessage:"Load more"})),a.state.loading&&s()(G.a,{}))}),l()(this,"renderBillingHistoryEvent",(e,t)=>{let a;const{intl:i}=this.props;return a="paid"===e.status?e.total<0?s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due",description:"Label for the amount that the user owes on a given invoice"}),s()("tr",{style:{height:28,fontSize:14,whiteSpace:"nowrap"}},t,s()("td",{style:{width:"100%",paddingRight:18,color:this.theme.mediumTextColor}},void 0,Object(oa.a)(e.timestamp).format("LL")),s()("td",{style:{paddingRight:18}},void 0,a),s()("td",{style:{paddingRight:18,textAlign:"right"}},void 0,Object(yt.b)({amount:e.total,currency:"dollar",intl:i})),s()("td",{},void 0,s()(Ta.a,{inline:!0,href:"/invoice/".concat(e.id),external:!0,innerStyle:this.getViewInvoiceButtonStyle()},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.viewInvoiceButton",defaultMessage:"View invoice"}))))}),l()(this,"handleLoadMoreBillingEventsClick",()=>{this.stores.store.setState({...this.stores.store.state,billingEventsLimit:this.stores.store.state.billingEventsLimit+ka.billingEventsLimitIncrement})})}renderComponent(){const{store:e,billingHistoryRequestStore:t}=this.stores,a={request:e.state.billingEventsLimit,performRequest:this.performGetBillingHistoryRequest,render:this.renderBillingHistoryResults};return s()("div",{},void 0,s()(Y.a,{large:!0,divider:"full",style:{marginTop:36}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.title",defaultMessage:"Invoices"})),c.a.createElement(Sa.a,o()({},a,{requestStore:t})))}static getModalStyle(e){return{width:480,background:e.popoverBackground,padding:24,borderRadius:3}}getViewInvoiceButtonStyle(){return{color:this.theme.mediumTextColor,padding:"2px 3px",borderRadius:3}}}l()(ka,"billingEventsLimitIncrement",20),l()(ka,"modalTitleStyle",{fontSize:18,marginBottom:16,fontWeight:$.a.fontWeight.medium});var Aa=Object(S.injectIntl)(ka);const wa=Object(S.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit",description:"Button a user clicks to apply Notion credits towards their Notion bill."},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});class Ia extends j.a{renderComponent(){const{title:e,caption:t,buttonArgs:a}=this.props,i=c.a.createElement(S.FormattedMessage,wa[a.buttonPurpose]);return s()("div",{style:{display:"flex",alignItems:"center",fontSize:14}},void 0,s()("div",{style:{marginRight:"auto"}},void 0,e),s()("div",{style:{color:this.theme.mediumTextColor}},void 0,t),s()("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"}},void 0,a.showButton&&s()(Ca.a,{isBlue:!0,onClick:a.onClick,style:Ia.buttonStyle},void 0,i)))}}l()(Ia,"buttonStyle",{marginLeft:18,marginRight:-4,fontWeight:$.a.fontWeight.medium});var Pa=Object(S.injectIntl)(Ia),Fa=a("gHFd"),xa=a("MZdi"),Ea=a("8FJR"),Ba=a("AId3");const Da={offline:s()(S.FormattedMessage,{defaultMessage:"Please go online to manage billing.",id:"spaceSubscriptionBilling.offline.message"})};class Oa extends j.a{constructor(...e){super(...e),l()(this,"couponEntryInput",null),l()(this,"storeTypes",{store:ha,billingHistoryRequestStore:he.a}),l()(this,"renderPaymentMethodModal",()=>{const{customerData:e,spaceStore:t}=this.props;return s()(Fa.LazySpaceSubscriptionUpdatePaymentMethodModal,{customerData:e,spaceStore:t,onComplete:this.handleModalClose})}),l()(this,"renderBillingIntervalModal",()=>{const{temporaryBillingInterval:e}=this.stores.store.state,{customerData:t}=this.props,a=e||t.interval,{monthlyPlanAmount:i,yearlyPlanAmount:n}=t,o=1-n/(12*i);return s()(Ra,{theme:this.theme,title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingInterval.title",defaultMessage:"Change billing interval"}),helpButton:s()(ce.a,{title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingInterval.helpButton.label",defaultMessage:"Learn about how this change will impact what you pay."}),href:Object(Ee.a)("guides.changeBillingInterval"),analyticsFrom:"billing_interval_settings"}),acceptAction:"update",onAccept:this.handleBillingIntervalAccept,onClose:this.handleModalClose},void 0,s()("div",{style:{marginTop:12,marginBottom:16}},void 0,Me.F({environment:this.environment,productId:t.productId,yearlyPlanAmount:n,monthlyPlanAmount:i,yearlySavingsPercent:o,currentBillingInterval:a,handleMonthlyBillingClick:this.handleMonthlyBillingClick,handleYearlyBillingClick:this.handleYearlyBillingClick})))}),l()(this,"renderApplyCreditModal",()=>{const{subscriptionData:e,customerData:t,intl:a}=this.props,{availableCredit:i}=e,n=this.getCurrentFormCreditAmount(),o=Math.max(0,(t.nextInvoiceAmount||0)-n);return s()("div",{style:Oa.getModalStyle(this.theme)},void 0,s()("div",{style:Oa.modalTitleStyle},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.title",defaultMessage:"Use Notion credit - {creditInDollars} available",values:{creditInDollars:Object(yt.b)({amount:i,currency:"dollar",intl:a})}})),s()("div",{style:{fontSize:14,display:"flex",alignItems:"center",marginBottom:16}},void 0,s()("div",{style:{width:"100%",marginRight:20,color:this.theme.mediumTextColor}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.amountOfCreditQuestion",defaultMessage:"How much credit would you like to apply to your next invoice?"})),s()(va,{availableCredit:i,focus:!0,selectAll:!0,onChange:this.handleApplyCreditAmountInputChange}),s()("div",{style:{whiteSpace:"nowrap",marginLeft:8}},void 0,"/"," ",Object(yt.b)({amount:i,currency:"dollar",intl:a}))),s()("div",{style:{borderTop:"1px solid ".concat(this.theme.regularDividerColor),paddingTop:16}},void 0,s()("div",{style:{paddingBottom:18,fontSize:12,color:this.theme.mediumTextColor}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.warning",defaultMessage:"Applying credit to your account <bold>cannot be undone</bold>.",values:{bold:(...e)=>s()("b",{},void 0,e)}})),s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()("div",{style:{fontSize:36,lineHeight:1}},void 0,Object(yt.b)({amount:o,currency:"dollar",intl:a})),s()("div",{style:{marginLeft:8,fontSize:12,color:this.theme.mediumTextColor,alignSelf:"flex-end"}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.nextInvoiceAmount",defaultMessage:"next invoice total",description:"Text that appears next to the amount, in dollars, that the user's next invoice will be after applying their Notion credits to their bill."})),s()(ne.a,{isLarge:!0,style:{marginLeft:"auto"},onClick:this.handleModalClose},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.cancelButton.label",defaultMessage:"Cancel"})),s()(se.a,{isLarge:!0,style:{marginLeft:12},disabled:n<=0,onClick:this.handleApplyCreditAccept},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.applyCreditButton.label",defaultMessage:"Apply credit"})))))}),l()(this,"renderSingleTextFieldModal",(e,t,a,i,n)=>s()(Ra,{theme:this.theme,title:t,acceptAction:n,onAccept:i,onClose:this.handleModalClose},void 0,s()(H.b,{focus:!0,selectAll:!0,value:e,onChange:a,onSubmit:i,style:Oa.modalInputStyle}))),l()(this,"renderBillingEmailModal",()=>{const{customerData:e}=this.props,{temporaryBillingEmail:t}=this.stores.store.state,a=void 0!==t?t:e.billingEmail||"",i=e.billingEmail?"update":"add";return this.renderSingleTextFieldModal(a,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingEmailModal.title",defaultMessage:"Change billing email"}),this.handleBillingEmailChange,this.handleBillingEmailAccept,i)}),l()(this,"renderVatIdModal",()=>{const{customerData:e}=this.props,{temporaryVatId:t}=this.stores.store.state,a=void 0!==t?t:e.vatId||"",i=e.vatId?"update":"add";return s()(Ra,{theme:this.theme,title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeVATIDModal.title",defaultMessage:"Change VAT/GST number"}),acceptAction:i,onAccept:this.handleVatIdAccept,onClose:this.handleModalClose},void 0,s()(H.b,{focus:!0,selectAll:!0,value:a,onChange:this.handleVatIdChange,onSubmit:this.handleVatIdAccept,style:Oa.modalInputStyle}),s()("div",{style:{color:this.theme.mediumTextColor,fontSize:$.a.fontSize.UISmall.desktop,marginTop:-10}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeVATIDModal.subtitle",defaultMessage:"Please include your country code"})))}),l()(this,"renderApplyCouponModal",()=>s()(Ra,{theme:this.theme,title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.applyCouponModal.title",defaultMessage:"Apply coupon"}),acceptAction:"apply",onAccept:()=>{this.couponEntryInput&&this.couponEntryInput.checkCouponCode()},onClose:this.handleModalClose},void 0,c.a.createElement(xa.a,{ref:e=>this.couponEntryInput=e,hideApply:!0,plan:this.props.customerData.plan,handlePromo:async e=>{this.handleModalClose();await w.h({environment:this.environment,spaceStore:this.props.spaceStore,coupon:e&&"coupon"===e.source?e.code:void 0,promoCodeId:e&&"promo_code"===e.source?e.code:void 0})&&Object(f.showMessage)({message:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.applyCouponModal.successMessage",defaultMessage:"Coupon applied!"})})}}))),l()(this,"updateTemporaryAddress",e=>{const{temporaryAddress:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,temporaryAddress:{...this.props.customerData.address,...t,...e}})}),l()(this,"renderAddressModal",()=>{const{customerData:e}=this.props,{temporaryAddress:t,addressErrorMessage:a}=this.stores.store.state,i=Me.h(this.environment);return s()("div",{style:{display:"flex",flexDirection:"column",maxHeight:"75vh"}},void 0,s()("div",{style:Oa.getModalStyle(this.theme)},void 0,s()("div",{style:Oa.modalTitleStyle},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeYourAddressModal.title",defaultMessage:"Change your address"})),s()(Ea.a,{address:t||{name:e.customerName||"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},updateAddressField:(e,t)=>{this.stores.store.setAddressField(e,t)},shouldShowBusinessName:Boolean(i&&["team","enterprise"].includes(i))}),s()("div",{style:{color:ie.g.red,marginTop:10}},void 0,a)),s()("div",{style:{display:"flex",justifyContent:"flex-end",padding:"16px 24px",background:this.theme.contentBackground}},void 0,s()(ne.a,{isLarge:!0,onClick:this.handleModalClose},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingAddressModal.cancelButton.label",defaultMessage:"Cancel"})),s()(se.a,{style:{marginLeft:12},isLarge:!0,disabled:void 0===this.getUpdatedAddress(),onClick:this.handleAddressAccept},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingAddressModal.updateButton.label",defaultMessage:"Update"}))))}),l()(this,"handleChangePlanClick",()=>{U.a.setState({open:!0,currentTab:"plans"})}),l()(this,"handlePaymentMethodChangeClick",()=>{this.stores.store.setState({...this.stores.store.state,paymentMethodModalOpen:!0})}),l()(this,"handleBillingIntervalChangeClick",()=>{this.stores.store.setState({...this.stores.store.state,billingIntervalModalOpen:!0})}),l()(this,"handleBillingEmailChangeClick",()=>{this.stores.store.setState({...this.stores.store.state,billingEmailModalOpen:!0})}),l()(this,"handleAddressChangeClick",()=>{this.stores.store.setState({...this.stores.store.state,addressModalOpen:!0})}),l()(this,"handleVatIdChangeClick",e=>{const t=e.address.country;if(!t)return void Object(f.showErrorMessage)(s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.vatId.missingCountry",defaultMessage:"To update your VAT/GST number, please update your billing address."}));!{AE:"ae_trn",AU:"au_abn",CA:"ca_bn",CH:"ch_vat",ES:"eu_vat",AT:"eu_vat",BE:"eu_vat",BG:"eu_vat",CY:"eu_vat",CZ:"eu_vat",DE:"eu_vat",EE:"eu_vat",FI:"eu_vat",FR:"eu_vat",GR:"eu_vat",HR:"eu_vat",HU:"eu_vat",IE:"eu_vat",IT:"eu_vat",LT:"eu_vat",LU:"eu_vat",LV:"eu_vat",MT:"eu_vat",NL:"eu_vat",PL:"eu_vat",PT:"eu_vat",RO:"eu_vat",SE:"eu_vat",SI:"eu_vat",SK:"eu_vat",GB:"gb_vat",IN:"in_gst",KR:"kr_brn",NZ:"nz_gst",SG:"sg_gst"}[t]?Object(f.showErrorMessage)(s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.vatId.vatNotRequired",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."})):this.stores.store.setState({...this.stores.store.state,vatIdModalOpen:!0})}),l()(this,"handleApplyCouponClick",()=>{this.stores.store.setState({...this.stores.store.state,applyCouponModalOpen:!0})}),l()(this,"handleModalClose",()=>{this.stores.store.reset()}),l()(this,"handleBillingEmailChange",e=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingEmail:e.target.value})}),l()(this,"handleBillingEmailAccept",async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingEmail:a}=this.stores.store.state;a!==t.billingEmail&&await w.h({environment:this.environment,spaceStore:e,billingEmail:a}),this.handleModalClose()}),l()(this,"handleVatIdChange",e=>{this.stores.store.setState({...this.stores.store.state,temporaryVatId:e.target.value})}),l()(this,"handleVatIdAccept",async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryVatId:a}=this.stores.store.state;a!==t.vatId&&await w.h({environment:this.environment,spaceStore:e,vatId:a}),this.handleModalClose()}),l()(this,"handleAddressAccept",async()=>{const{spaceStore:e}=this.props,t=this.getUpdatedAddress();if(!t)return void this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBilling.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})});const a=await Object(Ba.a)(this.environment,t);if(!a.valid)return void this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBilling.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})});const i={...t,...a.validatedAddresses?a.validatedAddresses[0]:void 0};if(t)try{await w.f({environment:this.environment,spaceStore:e,address:i}),this.handleModalClose()}catch(s){}}),l()(this,"getUpdatedAddress",()=>{const{customerData:e}=this.props,{temporaryAddress:t}=this.stores.store.state;if(t&&t!==e.address)return t}),l()(this,"handleMonthlyBillingClick",()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"month"})}),l()(this,"handleYearlyBillingClick",()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"year"})}),l()(this,"handleBillingIntervalAccept",async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingInterval:a}=this.stores.store.state;if(a&&a!==t.interval){const t=this.getPlanForOppositeBillingInterval();t&&await w.h({environment:this.environment,spaceStore:e,plan:t})}this.handleModalClose()}),l()(this,"handleUseCardClick",()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingType:"charge_automatically"})}),l()(this,"handleSendInvoiceClick",()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingType:"send_invoice"})}),l()(this,"handleCardUpdateClick",async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props;if(t.billingEmail){const a=await w.c({name:"Update your Card",panelLabel:"Update",email:t.billingEmail});await w.h({environment:this.environment,spaceStore:e,billing:"charge_automatically",stripeToken:a})}this.handleModalClose()}),l()(this,"handlePaymentMethodAccept",async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props,{temporaryBillingType:a}=this.stores.store.state,i=a||t.billing;if("charge_automatically"!==i||t.brand)i!==t.billing&&await w.h({environment:this.environment,spaceStore:e,billing:a});else{const{currentUserStore:a}=y.default.state,i=a?a.getValue():void 0,s=t.billingEmail||(i?i.email:void 0);if(!s)throw new Error("No billing email found.");const n=await w.c({name:"Update your Card",panelLabel:"Update",email:s});await w.h({environment:this.environment,spaceStore:e,billing:"charge_automatically",stripeToken:n,billingEmail:s})}this.handleModalClose()}),l()(this,"handleApplyCreditClick",()=>{this.stores.store.setState({...this.stores.store.state,applyCreditModalOpen:!0})}),l()(this,"handleApplyCreditAccept",async()=>{const e=this.getCurrentFormCreditAmount(),{spaceStore:t}=this.props;e>0&&await w.h({environment:this.environment,spaceStore:t,creditAmount:e}),this.handleModalClose(),v.He(this.environment,{amount:e})}),l()(this,"handleApplyCreditAmountInputChange",e=>{this.stores.store.setState({...this.stores.store.state,temporaryApplyCreditCents:e})}),l()(this,"handleRestartSubscriptionClick",async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props;await w.h({environment:this.environment,spaceStore:e,plan:t.plan}),this.handleModalClose()})}willMount(){w.e(this.environment)}renderComponent(){return ae.a.state.online?this.renderBilling():Oa.renderOfflineMessage()}static renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,Da.offline))}renderBilling(){const{customerData:e,subscriptionData:t}=this.props,{paymentMethodModalOpen:a,billingIntervalModalOpen:i,billingEmailModalOpen:n,addressModalOpen:r,applyCreditModalOpen:l,vatIdModalOpen:d,applyCouponModalOpen:u}=this.stores.store.state;return s()("div",{style:Oa.wrapStyle},void 0,s()(ht.b,{style:Oa.scrollerStyle,type:ht.a.Y},void 0,this.renderHeader(e),this.renderSummary(t),this.renderPaymentMethod(e),this.renderSeparator(),this.renderBillingInterval(e),this.renderSeparator(),this.renderBillingEmail(e),this.renderSeparator(),this.renderAddress(e),this.renderSeparator(),this.renderVatId(e),this.renderSeparator(),this.renderCredit(e),this.renderSeparator(),this.renderCoupon(),this.renderSeparator(),c.a.createElement(Aa,o()({},this.props,{data:t})),s()(Z.a,{open:a,render:this.renderPaymentMethodModal,onDismiss:this.handleModalClose}),s()(Z.a,{open:i,render:this.renderBillingIntervalModal,onDismiss:this.handleModalClose}),s()(Z.a,{open:l,render:this.renderApplyCreditModal,onDismiss:this.handleModalClose}),s()(Z.a,{open:n,render:this.renderBillingEmailModal,onDismiss:this.handleModalClose}),s()(Z.a,{open:r,render:this.renderAddressModal,onDismiss:this.handleModalClose}),s()(Z.a,{open:d,render:this.renderVatIdModal,onDismiss:this.handleModalClose}),s()(Z.a,{open:u,render:this.renderApplyCouponModal,onDismiss:this.handleModalClose})))}renderHeader(e){let t=s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.legacyPlanTitle",defaultMessage:"Legacy Plan"});switch(e.productId){case z.default.pricing.personal.productId:t=s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.personalPlanTitle",defaultMessage:"Personal Pro Plan"});break;case z.default.pricing.student.productId:t=s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.personalEducationPlanTitle",defaultMessage:"Personal Pro (Education) Plan"});break;case z.default.pricing.team.productId:t=s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.teamPlanTitle",defaultMessage:"Team Plan"});break;case z.default.pricing.enterprise.productId:t=s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.enterprisePlanTitle",defaultMessage:"Enterprise Plan"})}return s()(Y.a,{large:!0,divider:"full"},void 0,t)}renderSummary(e){const{spaceStore:t}=this.props,a=Me.G(this.environment,t,e),i=Me.C(e),n="subscribed_admin"===e.type;return s()("div",{style:Oa.summaryStyle},void 0,s()("div",{style:Oa.summaryMessageStyle},void 0,a),i&&s()(se.a,{isLarge:!0,onClick:this.handleRestartSubscriptionClick,style:{marginRight:8}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.restartSubscriptionButton.label",defaultMessage:"Restart subscription"})),n&&s()(ne.a,{isLarge:!0,onClick:this.handleChangePlanClick},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.changePlanButton.label",defaultMessage:"Change plan"})))}renderSeparator(){return s()("div",{style:{flex:"none",height:1,marginTop:10,marginBottom:10,background:this.theme.regularDividerColor}})}renderPaymentMethod(e){return s()(Pa,{title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.title",defaultMessage:"Payment method"}),caption:s()(d.Fragment,{},void 0,"send_invoice"===e.billing&&s()("div",{},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"})),"charge_automatically"===e.billing&&(e.last4&&e.brand?s()("div",{},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.creditCard",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:Object(ma.a)(e.brand),lastFourDigits:e.last4}})):s()("div",{},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None",description:"The payment method setting we display for users who haven't set up a payment method yet"})))),buttonArgs:{showButton:!0,buttonPurpose:"update",onClick:this.handlePaymentMethodChangeClick}})}renderBillingInterval(e){return s()(Pa,{title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.title",defaultMessage:"Billing interval"}),caption:s()("div",{},void 0,"month"===e.interval?s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"}):s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.yearly",defaultMessage:"Yearly"})),buttonArgs:{showButton:Boolean(this.getPlanForOppositeBillingInterval()),buttonPurpose:"update",onClick:this.handleBillingIntervalChangeClick}})}renderBillingEmail(e){return s()(Pa,{title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingEmail.title",defaultMessage:"Billing email"}),caption:s()("div",{},void 0,e.billingEmail||""),buttonArgs:{showButton:!0,buttonPurpose:Boolean(e.billingEmail)?"update":"add",onClick:this.handleBillingEmailChangeClick}})}renderVatId(e){return s()(Pa,{title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.VATID.title",defaultMessage:"VAT/GST number",description:"Title for the section where users can update their VAT (value added tax) identification number"}),caption:s()("div",{},void 0,e.vatId||""),buttonArgs:{showButton:!0,buttonPurpose:Boolean(e.vatId)?"update":"add",onClick:()=>this.handleVatIdChangeClick(e)}})}renderAddress(e){return s()(Pa,{title:s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.yourAddress.title",defaultMessage:"Your address"}),caption:s()("div",{style:{textAlign:"right",width:"80%",float:"right"}},void 0,this.renderAddressString(e.address)||""),buttonArgs:{showButton:!0,buttonPurpose:e.address&&!p.a.isEmpty(e.address)?"update":"add",onClick:this.handleAddressChangeClick}})}renderCredit(e){const t=-Math.min(0,e.accountBalance),{intl:a}=this.props;return s()(Pa,{title:ba.workspaceBalance,caption:s()("div",{},void 0,Object(yt.b)({amount:t,currency:"dollar",intl:a})),buttonArgs:{showButton:!0,buttonPurpose:"apply_credit",onClick:this.handleApplyCreditClick}})}renderCoupon(){return s()(Pa,{title:ba.applyCoupon,caption:void 0,buttonArgs:{showButton:!0,buttonPurpose:"apply",onClick:this.handleApplyCouponClick}})}renderAddressString(e){return e?this.props.intl.formatList([e.name,e.businessName,e.addressLine1,e.country].filter(Boolean),{type:"conjunction",style:"narrow"}):""}getCurrentFormCreditAmount(){const{subscriptionData:e}=this.props,{store:t}=this.stores,{temporaryApplyCreditCents:a}=t.state;return void 0!==a?a:e.availableCredit}getPlanForOppositeBillingInterval(){const{customerData:e}=this.props,t=gt.c.find(t=>t.indexOf(e.plan)>=0);if(t){const a=t.indexOf(e.plan);return t[0===a?1:0]}}static getModalStyle(e){return{width:480,background:e.popoverBackground,padding:24,borderRadius:3}}}function Ra(e){const t=c.a.createElement(S.FormattedMessage,wa[e.acceptAction]);return s()("div",{style:Oa.getModalStyle(e.theme)},void 0,s()("div",{style:Oa.modalTitleStyle},void 0,e.title),e.children,s()("div",{style:{marginBottom:20}},void 0,e.helpButton),s()("div",{style:{display:"flex",justifyContent:"flex-end"}},void 0,s()(ne.a,{isLarge:!0,onClick:e.onClose,style:{marginRight:12}},void 0,s()(S.FormattedMessage,{id:"spaceSubscriptionBilling.cancelButton.label",defaultMessage:"Cancel"})),s()(se.a,{isLarge:!0,onClick:e.onAccept},void 0,t)))}l()(Oa,"modalTitleStyle",{fontSize:18,marginBottom:16,fontWeight:$.a.fontWeight.medium}),l()(Oa,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(Oa,"scrollerStyle",{height:"100%",padding:"36px 60px"}),l()(Oa,"summaryStyle",{display:"flex",alignItems:"flex-start",fontSize:14,marginBottom:36}),l()(Oa,"summaryMessageStyle",{marginRight:"auto",paddingRight:32}),l()(Oa,"modalInputStyle",{marginTop:12,marginBottom:20});var La=Object(S.injectIntl)(Oa);class _a extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:ha,billingHistoryRequestStore:he.a})}willMount(){w.e(this.environment)}renderComponent(){const{data:e}=this.props;return ae.a.state.online?s()("div",{style:_a.wrapStyle},void 0,s()(ht.b,{style:_a.scrollerStyle,type:ht.a.Y},void 0,s()(Y.a,{large:!0,divider:"full"},void 0,c.a.createElement(S.FormattedMessage,U.d.billingTab)),this.renderCredit(e),this.renderSeparator(),c.a.createElement(Aa,this.props))):_a.renderOfflineMessage()}static renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,Da.offline))}renderCredit(e){const t=-Math.min(0,e.accountBalance),{intl:a}=this.props;return s()(Pa,{title:ba.workspaceBalance,caption:s()("div",{},void 0,Object(yt.b)({amount:t,currency:"dollar",intl:a})),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:p.a.noop}})}renderSeparator(){return s()("div",{style:{flex:"none",marginTop:30}})}}l()(_a,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(_a,"scrollerStyle",{height:"100%",padding:"36px 60px"});var Ua=Object(S.injectIntl)(_a);a("E9XD");class ja extends I.a{getInitialState(){return{emailInputValue:"",showAllInviteCredits:!1}}}var Na=ja,Za=a("RqMp"),Wa=a("58VE");class Va extends j.a{constructor(...e){super(...e),l()(this,"handleImportActionClick",()=>{Za.a.setState({open:!0}),v.ob(this.environment,{type:"import_evernote"})}),l()(this,"handleWebActionClick",()=>{Lt.navigateToExternalURL({environment:this.environment,url:"/product"}),v.ob(this.environment,{type:"web_login"})}),l()(this,"handleDesktopActionClick",()=>{Lt.navigateToExternalURL({environment:this.environment,url:"/desktop"}),v.ob(this.environment,{type:"desktop_login"})}),l()(this,"handleMobileActionClick",()=>{Lt.navigateToExternalURL({environment:this.environment,url:"/mobile"}),v.ob(this.environment,{type:"mobile_login"})}),l()(this,"handleBrowserExtensionActionClick",()=>{Lt.navigateToExternalURL({environment:this.environment,url:"/web-clipper"}),v.ob(this.environment,{type:"browser_extension"})}),l()(this,"handleMobileShareSheetActionClick",()=>{Lt.navigateToExternalURL({environment:this.environment,url:"/mobile"}),v.ob(this.environment,{type:"mobile_share_sheet"})})}renderComponent(){return s()("div",{style:this.getWrapperStyle()},void 0,s()("div",{style:{flex:0}},void 0,this.renderLeft()),s()("div",{style:this.getCenterStyle()},void 0,s()("div",{},void 0,this.renderTitle()),s()(pe.a,{isSmall:!0,style:{marginBottom:2}},void 0,this.renderCaption())),s()("div",{style:{flex:0}},void 0,this.renderRight()))}renderTitle(){const{credit:e,intl:t}=this.props;if("invited_user"===e.type){const a=this.getUserStore(e.to_user_id).getValue();return s()(d.Fragment,{},void 0,Object(st.e)(t,a)," ",!e.activated&&a&&!a.onboarding_completed&&s()("span",{style:{color:this.theme.mediumTextColor}},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.userHasNotSignedUpNote",defaultMessage:"(has not signed up)",description:"Annotation that appears next to a referred user's name if the user hasn't signed up for Notion yet"})),!e.activated&&a&&a.onboarding_completed&&s()("span",{style:{color:this.theme.mediumTextColor}},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.userHasAlreadySignedUpNote",defaultMessage:"(has already signed up)",description:"Annotation that appears next to a referred user's name if the user has signed up for Notion already"})))}if("invited_by_user"===e.type){const a=this.getUserStore(e.from_user_id).getValue();return s()(d.Fragment,{},void 0,Object(st.e)(t,a),s()("span",{style:{color:this.theme.mediumTextColor}},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.sourceOfReferralNote",defaultMessage:"(invited you)",description:"Annotation that appears next to the name of the user who invited this user to Notion"})))}return"import_evernote"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.title",defaultMessage:"Import from Evernote"}):"web_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.title",defaultMessage:"Log in on the web"}):"desktop_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.title",defaultMessage:"Log in on the desktop app"}):"mobile_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.title",defaultMessage:"Log in on the mobile app"}):"browser_extension"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.title",defaultMessage:"Use the Web Clipper"}):"mobile_share_sheet"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.title",defaultMessage:"Use the iOS or Android system share menu"}):void 0}renderCaption(){const{credit:e,intl:t}=this.props;if("invited_user"===e.type){const t=this.getUserStore(e.to_user_id).getValue();return t&&t.email}if("invited_by_user"===e.type){const t=this.getUserStore(e.from_user_id).getValue();return t&&t.email}return"import_evernote"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.description",defaultMessage:"Import your notes and notebooks"}):"web_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.description",defaultMessage:"Sign in to Notion from any web browser"}):"desktop_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.description",defaultMessage:"Download the desktop app and sign in"}):"mobile_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.description",defaultMessage:"Download the mobile app and sign in"}):"browser_extension"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.description",defaultMessage:"Download the Chrome extension and save a link"}):"mobile_share_sheet"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.description",defaultMessage:"Use the share menu to save a link into Notion"}):void 0}renderLeft(){const{credit:e}=this.props;if("invited_user"===e.type){const t=this.getUserStore(e.to_user_id);return s()(Wa.a,{userValue:t.getValue(),style:{marginRight:8},size:24,hasTooltip:!0})}if("invited_by_user"===e.type){const t=this.getUserStore(e.from_user_id);return s()(Wa.a,{userValue:t.getValue(),style:{marginRight:8},size:24,hasTooltip:!0})}return"import_evernote"===e.type?ye.a.evernoteLogo(this.getIconStyle()):"web_login"===e.type?ye.a.logInWeb(this.getIconStyle()):"desktop_login"===e.type?ye.a.deviceDesktop(this.getIconStyle()):"mobile_login"===e.type?ye.a.deviceMobile(this.getIconStyle()):"browser_extension"===e.type?ye.a.googleChrome(this.getIconStyle()):"mobile_share_sheet"===e.type?ye.a.deviceMobileShareSheet(this.getIconStyle()):void 0}renderRight(){const{credit:e,intl:t}=this.props;let a;return"import_evernote"===e.type?a={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.actionLink",defaultMessage:"Connect"}),onClick:this.handleImportActionClick}:"web_login"===e.type?a={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.actionLink",defaultMessage:"Visit"}),onClick:this.handleWebActionClick}:"desktop_login"===e.type?a={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.actionLink",defaultMessage:"Download"}),onClick:this.handleDesktopActionClick}:"mobile_login"===e.type?a={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.actionLink",defaultMessage:"Download"}),onClick:this.handleMobileActionClick}:"browser_extension"===e.type?a={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.actionLink",defaultMessage:"Install"}),onClick:this.handleBrowserExtensionActionClick}:"mobile_share_sheet"===e.type&&(a={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.actionLink",defaultMessage:"Download"}),onClick:this.handleMobileShareSheetActionClick}),s()("div",{style:{display:"flex",alignItems:"center"}},void 0,a&&!e.activated&&s()(Ca.a,{isBlue:!0,isSmall:!0,onClick:a.onClick},void 0,a.text),s()("div",{style:{minWidth:32,marginLeft:8,marginRight:8,textAlign:"right",fontWeight:$.a.fontWeight.semibold,...!e.activated&&{color:this.theme.lightTextColor}}},void 0,Object(yt.b)({amount:e.amount,currency:"dollar",intl:this.props.intl})),s()("div",{style:this.getTickStyles(e.activated)},void 0,ye.a.check({fill:ie.g.white,width:12,height:12,opacity:e.activated?1:0})))}getUserStore(e){const{currentSpaceStore:t}=y.default.state;if(!t)throw new Error("No current space.");return at.a.createChildStore(t,{table:st.a,id:e})}getWrapperStyle(){const e="1px solid ".concat(this.theme.regularDividerColor);return{display:"flex",alignItems:"center",borderTop:this.props.isFirst?e:void 0,borderBottom:e,paddingTop:8,paddingBottom:8}}getCenterStyle(){return{flex:1,fontSize:14,marginLeft:4}}getIconStyle(){return{width:24,height:24,fill:this.theme.mediumIconColor,marginRight:8}}getTickStyles(e){const t=e?void 0:"inset 0 0 0 2px ".concat(this.theme.regularDividerColor);return{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:20,background:e?ie.g.blue:void 0,boxShadow:t}}}var za=Object(S.injectIntl)(Va);class qa extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:Na}),l()(this,"renderCredit",(e,t)=>s()(za,{credit:e,isFirst:0===t},e.id)),l()(this,"handleInviteCreditsToggleShowMoreClick",()=>{const{store:e}=this.stores;e.setState({...e.state,showAllInviteCredits:!e.state.showAllInviteCredits})}),l()(this,"handleApplyCreditClick",()=>{const{data:e}=this.props;U.a.setState({open:!0,currentTab:"subscribed_admin"===e.type?"billing":"plans"}),v.n(this.environment)})}willMount(){w.e(this.environment)}renderComponent(){if(ae.a.state.online){const{credits:e}=this.props.data;return this.renderSettings(e)}return this.renderOfflineMessage()}renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.offline.message",defaultMessage:"Please go online to manage your account credit."})))}renderOtherCreditWays(e){const t=this.getActionCredits(e);return t.length>0&&s()(d.Fragment,{},void 0,s()(Y.a,{large:!0},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.otherWaysToEarnCreditSectionAlt.title",defaultMessage:"Ways to earn credit"})),s()("div",{},void 0,t.map(this.renderCredit)))}renderReferralSection(e){const{store:t}=this.stores,{showAllInviteCredits:a}=t.state,i=this.getInviteCredits(e),n=a?i:i.slice(0,qa.showInviteCreditCount);return i.length>0&&s()(c.a.Fragment,{},void 0,s()("div",{style:this.getHeaderContainerStyles()},void 0,s()("div",{style:this.getHeaderStyles()},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.title",defaultMessage:"Invite friends and earn credit"}))),s()("div",{style:this.getInviteCreditStyles()},void 0,n.map(e=>this.renderCredit(e,1)),i.length>qa.showInviteCreditCount&&s()(Se.a,{style:{marginTop:8},onClick:this.handleInviteCreditsToggleShowMoreClick},void 0,s()(S.FormattedMessage,a?{id:"userCreditSettings.inviteFriendsSection.showLessReferredUsers.link",defaultMessage:"Show {numberOfReferredUsers} less",values:{numberOfReferredUsers:i.length-qa.showInviteCreditCount}}:{id:"userCreditSettings.inviteFriendsSection.showMoreReferredUsers.link",defaultMessage:"Show {numberOfReferredUsers} more",values:{numberOfReferredUsers:i.length-qa.showInviteCreditCount}}))))}renderTotalCreditEarned(e){const{intl:t}=this.props,a=e.reduce((e,t)=>e+(t.activated?t.amount:0),0);return a>0&&s()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}},void 0,s()(ce.a,{title:t.formatMessage({id:"userCreditSettings.helpButton.caption",defaultMessage:"Learn how to earn and apply credits"}),href:Object(Ee.a)("guides.referralsAndCredit"),analyticsFrom:"credit_settings"}),s()("div",{style:{display:"flex",alignItems:"center",paddingRight:28,marginTop:16}},void 0,s()("div",{style:{marginLeft:"auto",fontSize:14,color:this.theme.mediumTextColor}},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.otherWaysToEarnCreditSection.totalCreditSummaryText",defaultMessage:"Total credit earned"})),s()("div",{style:{minWidth:44,fontWeight:$.a.fontWeight.semibold,textAlign:"right"}},void 0,Object(yt.b)({amount:a,currency:"dollar",intl:t}))))}renderSettings(e){return s()(K.a,{},void 0,this.renderCreditBalance(),this.renderReferralSection(e),this.renderOtherCreditWays(e),this.renderTotalCreditEarned(e))}renderCreditBalance(){const{data:e,intl:t}=this.props,{availableCredit:a,totalCredit:i}=e,n=$e.default.state.data;if(!n)return;const o=Me.D(n),r=Math.floor(a/z.default.pricing.personal.monthlyPrice),l=i>=vt.f;return s()(d.Fragment,{},void 0,s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.title",defaultMessage:"Credit balance"})),s()("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:40,fontSize:14}},void 0,s()("div",{},void 0,s()(S.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.creditBalanceMessage",defaultMessage:"Your current credit balance is {creditBalance}.",values:{creditBalance:s()("b",{style:{color:this.theme.regularTextColor}},void 0,Object(yt.b)({amount:a,currency:"dollar",intl:t}))}})," ",a>0&&!l&&s()(S.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.freeMonthMessage",description:"Message in sidebar letting user know how many months of free Notion they can get with their credits",defaultMessage:"{numberOfMonths, plural, one {That's equivalent to <b>{numberOfMonths} month</b> of the Personal Pro Plan.} other {That's equivalent to <b>{numberOfMonths} months</b> of the Personal Pro Plan.}}",values:{numberOfMonths:r,b:(...e)=>s()("b",{style:{color:this.theme.regularTextColor}},void 0,e)}}),l&&s()(S.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.maximumCreditBalanceExceeded",defaultMessage:"You've exceeded the maximum amount of credit per account, {maximumCreditBalance}. Any additional credit you earn will not increase your balance.",values:{maximumCreditBalance:Object(yt.b)({amount:vt.f,currency:"dollar",intl:t})}})),a>0&&s()(ne.a,{isLarge:!0,onClick:this.handleApplyCreditClick},void 0,o?ye.a.settingsBilling(qa.applyCreditButtonIconStyle):ye.a.settingsUpgrade(qa.applyCreditButtonIconStyle),o?t.formatMessage({id:"userCreditSettings.creditBalanceSection.applyCreditButton.label",defaultMessage:"Apply your credit"}):t.formatMessage({id:"userCreditSettings.creditBalanceSection.upgradeForFreeButton.label",defaultMessage:"Upgrade for free"}))))}getActionCredits(e){const{id:t}=this.environment.currentUser,{currentUserSettingsStore:a}=y.default.state;if(!t||!a)return[];const i=[],s=a.getValue();if(s&&vt.e(s)){const a={id:"web_login_default",version:0,amount:vt.a.web_login,activated:!1,created_timestamp:Date.now(),type:"web_login",user_id:t};i.push(e.find(e=>"web_login"===e.type)||a);const s={id:"desktop_login_default",version:0,amount:vt.a.desktop_login,activated:!1,created_timestamp:Date.now(),type:"desktop_login",user_id:t};i.push(e.find(e=>"desktop_login"===e.type)||s);const n={id:"mobile_login_default",version:0,amount:vt.a.mobile_login,activated:!1,created_timestamp:Date.now(),type:"mobile_login",user_id:t};i.push(e.find(e=>"mobile_login"===e.type)||n)}const n={id:"import_evernote_default",version:0,amount:vt.a.import_evernote,activated:!1,created_timestamp:Date.now(),type:"import_evernote",user_id:t};i.push(e.find(e=>"import_evernote"===e.type)||n);const o={id:"browser_extension_default",version:0,amount:vt.a.browser_extension,activated:!1,created_timestamp:Date.now(),type:"browser_extension",user_id:t};i.push(e.find(e=>"browser_extension"===e.type)||o);const r={id:"mobile_share_sheet_default",version:0,amount:vt.a.mobile_share_sheet,activated:!1,created_timestamp:Date.now(),type:"mobile_share_sheet",user_id:t};return i.push(e.find(e=>"mobile_share_sheet"===e.type)||r),i}getInviteCredits(e){const t=e.find(e=>"invited_by_user"===e.type),a=e.filter(e=>"invited_user"===e.type&&!e.activated),i=e.filter(e=>"invited_user"===e.type&&e.activated);return p.a.compact([t,...p.a.sortBy(a,e=>-e.created_timestamp),...p.a.sortBy(i,e=>-e.created_timestamp)])}getHeaderContainerStyles(){return{borderBottom:"1px solid ".concat(this.theme.regularDividerColor),paddingBottom:4,marginBottom:12}}getHeaderStyles(){return{fontWeight:$.a.fontWeight.medium,fontSize:18}}getInviteCreditStyles(){return{marginBottom:44}}}l()(qa,"showInviteCreditCount",3),l()(qa,"applyCreditButtonIconStyle",{width:20,height:20,marginRight:6});var Ha=Object(S.injectIntl)(qa);class Ga extends j.a{isMultipleAccounts(e){return Array.isArray(e)}isSingleAccount(e){return"string"==typeof e}isConnected(e){return this.isSingleAccount(e)||this.isMultipleAccounts(e)&&e.length>0}renderComponent(){const{account:e,intl:t}=this.props;return s()(d.Fragment,{},void 0,s()("div",{style:{display:"flex",alignItems:"center",fontSize:14,paddingTop:2,paddingBottom:2}},void 0,this.renderIcon(),s()("div",{style:{marginRight:"auto"}},void 0,s()("div",{},void 0,this.props.appName),s()("div",{style:{fontSize:12,color:this.theme.mediumTextColor}},void 0,this.props.caption)),s()("div",{style:Ga.buttonWrapStyle},void 0,this.renderConnectButton(this.isConnected(e)?t.formatMessage({id:"connectedAppsSettingsItem.connectAnotherAccountLink",defaultMessage:"Connect another account",description:"Link that enables user to connect another account from a 3rd-party app (like Google Drive) to Notion, assuming they've already connected an account previously"}):t.formatMessage({id:"connectedAppsSettingsItem.connectAccountLink",defaultMessage:"Connect",description:"Link that enables user to connect an account from a 3rd-party app (like Google Drive) to Notion"})))),this.isSingleAccount(e)?this.renderAccount({accountName:e,onDisconnect:this.props.onDisconnect}):this.renderMultipleAccounts(),s()(N.a,{size:12}))}renderIcon(){const{logo:e}=this.props;return s()("img",{style:Ga.imageIconStyle,src:e})}renderConnectButton(e){return s()(Ca.a,{isBlue:!0,onClick:this.props.onConnect,style:Ga.buttonStyle},void 0,e)}renderAccount(e){const{accountName:t,onDisconnect:a,key:i}=e;return s()("div",{style:{marginLeft:44}},i,s()(N.a,{size:12}),s()("div",{style:{display:"flex",alignItems:"center",height:32,marginBottom:2,fontSize:14}},void 0,s()("div",{style:{marginRight:"auto"}},void 0,s()("div",{style:{color:this.theme.mediumTextColor}},void 0,t)),s()("div",{style:Ga.buttonWrapStyle},void 0,s()(Ca.a,{isRed:!0,onClick:()=>a(),style:Ga.buttonStyle},void 0,s()(S.FormattedMessage,{id:"connectedAppsSettingsItem.disconnectLink",defaultMessage:"Disconnect",description:"If a user has connected an account from a 3rd-party app (like Google Drive) to Notion, they can click this link to disconnect the account."})))))}renderMultipleAccounts(){const e=this.props.account;if(this.isMultipleAccounts(e))return e.map(e=>this.renderAccount({accountName:e.accountName,onDisconnect:()=>{this.props.onDisconnect(e)},key:e.accountId}))}}l()(Ga,"iconSize",32),l()(Ga,"buttonStyle",{marginLeft:14,marginRight:-4}),l()(Ga,"buttonWrapStyle",{minWidth:80,display:"flex",justifyContent:"flex-end"}),l()(Ga,"imageIconStyle",{flexShrink:0,width:Ga.iconSize,height:Ga.iconSize,borderRadius:3,marginRight:12,background:ie.g.white});var Ka=Object(S.injectIntl)(Ga);async function Ya(e){const t=await g.getConnectedAppsStatus(e,{});if("failed"===t.type){const e=t.error;return console.error(e),{drive:[],evernote:void 0,trello:void 0,asana:void 0}}return t.data}var Qa=a("cgvQ"),Ja=a("BJ/B"),Xa=a("3eY8"),$a=a("9f/M");class ei extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{connectedAppsStatus:he.a})}renderComponent(){return ae.a.state.online?s()(Sa.a,{request:this.environment,performRequest:Ya,requestStore:this.stores.connectedAppsStatus,render:(e,t)=>t?this.renderConnectedAppsSettings(t):s()("div",{style:ei.loadingWrapStyle},void 0,s()(G.a,{}))}):this.renderOfflineMessage()}renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{id:"connectedAppsSettings.offline.message",defaultMessage:"Please go online to manage connecting to apps."})))}renderSectionTitle(){return s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"connectedAppsSettings.connectedAppsSection.title",defaultMessage:"Connected apps"}))}renderConnectedAppsSettings(e){const{intl:t}=this.props,a=this.stores.connectedAppsStatus;return s()("div",{style:ei.wrapStyle},void 0,s()(ht.b,{style:ei.scrollerStyle,type:ht.a.Y},void 0,this.renderSectionTitle(),s()(Ka,{appName:"Google Drive",caption:t.formatMessage({id:"connectedAppsSettings.googleDrive.caption",defaultMessage:"Find and embed your files"}),logo:Zt.a.images.import.googleDrivePng,account:a.state.result.drive,onConnect:()=>this.handleDriveAuth(),onDisconnect:e=>{this.handleDisconnectDrive(e)}}),s()(Ka,{appName:"Evernote",caption:t.formatMessage({id:"connectedAppsSettings.evernote.caption",defaultMessage:"Import notebooks"}),logo:Zt.a.images.import.evernotePng,account:a.state.result.evernote,onConnect:()=>Ja.a({environment:this.environment,requestStore:a}),onDisconnect:()=>async function(e,t){await g.disconnectEvernote(e,{}),await t.refresh(),v.fe(e,{name:"evernote"})}(this.environment,a)}),s()(Ka,{appName:"Trello",caption:t.formatMessage({id:"connectedAppsSettings.trello.caption",defaultMessage:"Import your boards"}),logo:Zt.a.images.import.trelloPng,account:a.state.result.trello,onConnect:()=>$a.a({environment:this.environment,requestStore:a}),onDisconnect:()=>async function(e,t){await g.disconnectTrello(e,{}),await t.refresh(),v.fe(e,{name:"trello"})}(this.environment,a)}),s()(Ka,{appName:"Asana",caption:t.formatMessage({id:"connectedAppsSettings.asana.caption",defaultMessage:"Import tasks from boards and lists"}),logo:Zt.a.images.import.asanaPng,account:a.state.result.asana,onConnect:()=>Xa.a({environment:this.environment,requestStore:a}),onDisconnect:()=>async function(e,t){await g.disconnectAsana(e,{}),await t.refresh(),v.fe(e,{name:"asana"})}(this.environment,a)}),s()("div",{style:{marginTop:8}},void 0,s()(ce.a,{title:t.formatMessage({id:"connectedAppsSettings.helpButton.caption",defaultMessage:"Learn more about embedding content in Notion"}),href:Object(Ee.a)("guides.import"),analyticsFrom:"connected_apps_settings"}))))}async handleDriveAuth(){v.Wd(this.environment,{name:"google",from:"connected_apps"}),await Qa.f(this.environment),this.stores.connectedAppsStatus.refresh()}handleDisconnectDrive(e){const{intl:t}=this.props;f.showDialog({message:t.formatMessage({id:"connectedAppsSettings.disconnectGoogleDriveModal.message",defaultMessage:"Disconnecting disables file preview on Google Drive files embedded in all of your workspaces. It would not delete your embeds from Notion, so you can re-connect at anytime."}),showCancel:!0,keepFocus:!0,items:[{label:t.formatMessage({id:"connectedAppsSettings.disconnectGoogleDriveModal.disconnectButton.label",defaultMessage:"Disconnect"}),color:"red",onAccept:async()=>{await g.disconnectDrive(this.environment,{googleUserId:e.accountId}),this.stores.connectedAppsStatus.refresh()}}]})}}l()(ei,"loadingWrapStyle",{alignItems:"center",display:"flex",flexDirection:"column",flex:1,height:"100%",justifyContent:"center"}),l()(ei,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(ei,"scrollerStyle",{height:"100%",padding:"36px 60px"});var ti=Object(S.injectIntl)(ei),ai=a("MeYt"),ii=a("7M94"),si=a("DbeH"),ni=a("zDGE");function oi(e,t){return"".concat(function(e){return"".concat(e||"https://www.notion.so").concat(_t.d.samlAuth)}(t),"/").concat(e)}var ri=a("6q9u"),li=a("L0YQ"),di=a("+fkW"),ci=a("nylu"),ui=a("FUUC"),pi=a("G+Ai"),mi=a("bPtJ"),gi=a("AXh+"),hi=a("g4rC"),fi=a("I8ZR"),Mi=a("i3uR"),yi=a("6sah");class vi extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{tokenOptionsButtonPopupStore:hi.a}),l()(this,"handleRevokeApiTokenClick",async()=>{const e=this.props.botStore.getValue();if(!e)return;if(!(await f.confirmUserAction({message:"scim"===e.type?s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.revokeTokenModal.message",defaultMessage:"Revoke SCIM token? All SCIM API requests that use this token will no longer succeed."}):s()(S.FormattedMessage,{id:"botWithTokenSettings.revokeTokenModal.message",defaultMessage:"Revoke API token? All API requests that use this token will no longer succeed."}),acceptLabel:"scim"===e.type?s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.revokeTokenModal.acceptButton.label",defaultMessage:"Revoke SCIM token"}):s()(S.FormattedMessage,{id:"botWithTokenSettings.revokeTokenModal.acceptButton.label",defaultMessage:"Revoke API token"}),cancelLabel:s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.revokeTokenModal.cancelButton.label",defaultMessage:"Cancel"})})))return;await ci.d({environment:this.environment,botId:e.id})&&f.showMessage({message:"scim"===e.type?s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.tokenRevoked.message",defaultMessage:"SCIM token revoked successfully. A new token is available."}):s()(S.FormattedMessage,{id:"botWithTokenSettings.revokeTokenModal.tokenRevoked.message",defaultMessage:"API token revoked successfully. A new token is now available."})})})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:Ye.b.MenuType.ActionSheet}:{menuType:Ye.b.MenuType.Popup},s()("div",{style:{display:"flex"}},void 0,s()(fi.a,{botValue:this.props.botStore.getValue(),avatarSize:24,style:{fontSize:14,flex:1}}),s()(Ca.a,{onClick:()=>ci.e({environment:this.environment,botStore:this.props.botStore,from:"scim-settings"}),isBlue:!0},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.viewToken.label",defaultMessage:"View token"})),s()(Mi.a,{popupType:e.isMobile?Mi.a.PopupType.SlideUp:Mi.a.PopupType.Popup,buttonPopupStore:this.stores.tokenOptionsButtonPopupStore,renderOrigin:t=>c.a.createElement(yi.a,o()({isMobile:e.isMobile},t,{style:{marginLeft:8,marginRight:8}})),render:e=>c.a.createElement(Ye.b,t,s()(Qe.a,{type:Qe.a.Type.Vertical,sections:[{key:"token options",render:e=>c.a.createElement(Xe.a,e),items:[{key:"revoke token",render:e=>c.a.createElement(Je.a,o()({title:s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.revokeToken.label",defaultMessage:"Revoke token"}),icon:ye.a.showDeletedPages({width:18,fill:"currentColor"})},e)),action:()=>{this.handleRevokeApiTokenClick(),e.close()}}]}],initialFocus:void 0}))}))}}var bi=vi;class Si extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{botsRequestStore:he.a,tokenOptionsButtonPopupStore:hi.a}),l()(this,"renderScimBotTokens",(e,t,a)=>{if(!a)return s()(G.a,{});if(t&&!e){const{botIds:e}=t,a=e[0]&&Object(mi.c)(this.props.spaceStore,{table:pi.a,id:e[0]});return s()(d.Fragment,{},void 0,s()(N.a,{size:48,style:{opacity:0}}),s()("div",{style:this.getHeaderStyle()},void 0,s()("span",{style:{marginRight:8}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.title",defaultMessage:"SCIM configuration"})),"enterprise"!==Me.h(this.environment)&&s()(tt.a,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{marginTop:-1}})),a&&s()(bi,{botStore:a})||"enterprise"===Me.h(this.environment)&&this.renderScimContactUs(),this.renderScimHelp())}}),l()(this,"handleDisablePublicAccessSwitcherClick",async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disablePublicAccess;if(!t){if(!(await f.confirmUserAction({message:s()(S.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:s()(S.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}e.setState({...e.state,disablePublicAccess:!t})}),l()(this,"handleAllowDisableGuestsSwitcherClick",async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disableGuests;if(!t){if(!(await f.confirmUserAction({message:s()(S.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:s()(S.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}e.setState({...e.state,disableGuests:!t})}),l()(this,"handleDisableMoveToSwitcherClick",()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disableMoveToSpace:!e.state.disableMoveToSpace})}),l()(this,"handleAllowDisableWorkspaceTopLevelSwitcherClick",()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disableSpacePageEdits:!e.state.disableSpacePageEdits})}),l()(this,"handleDisableExportClick",()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disableExport:!e.state.disableExport})}),l()(this,"handleDisablePublicAccessRequestsClick",()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disablePublicAccessRequests:!e.state.disablePublicAccessRequests})}),l()(this,"handleUpdateClick",async()=>{await Promise.all([this.saveSecuritySettings(),this.saveSamlConfig()]),this.props.securitySettingsStore.state.error?f.showError(this.props.securitySettingsStore.state.error):this.closeSettings()}),l()(this,"handleCancelClick",()=>{this.closeSettings()}),l()(this,"handleEnableSamlToggle",()=>{if(!this.isSamlEditable())return;const{state:e}=this.props.samlConfigStore,t=!this.isInvalidSamlConfig(e);"unconfigured"===e.status||"disabled"===e.status?t&&this.props.samlConfigStore.setState({...e,status:"configured"}):this.props.samlConfigStore.setState({...e,status:t?"disabled":"unconfigured"})}),l()(this,"handleIdpMetadataUrlChange",e=>{this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,idpMetadataUrl:e.target.value})}),l()(this,"handleIdpMetadataUrlBlur",e=>{Boolean(e.target.value)&&this.setUseMetadataUrl(!0)}),l()(this,"handleIdpMetadataChange",e=>{this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,idpMetadata:e.target.value})}),l()(this,"handleIdpMetadataBlur",e=>{Boolean(e.target.value)&&this.setUseMetadataUrl(!1)}),l()(this,"handleEnforceSamlToggle",()=>{const{state:e}=this.props.samlConfigStore;if(this.isSamlEditable()&&!this.isInvalidSamlConfig(e)){const t="enforced"===e.status?"configured":"enforced";this.props.samlConfigStore.setState({...e,status:t})}}),l()(this,"handleCreateAccountToggle",()=>{const{state:e}=this.props.samlConfigStore;this.isSamlEditable()&&this.props.samlConfigStore.setState({...e,createAccount:!e.createAccount})}),l()(this,"handleEmailDomainContactUsClick",()=>{Ce.a({environment:this.environment,from:"saml_settings",prepopulatedContent:"Request to add or change an email domain for SAML Single Sign-on on workspace ".concat(this.props.spaceStore.id,".")})}),l()(this,"handleWorkspaceContactUsClick",()=>{Ce.a({environment:this.environment,from:"saml_settings",prepopulatedContent:"Request to add or remove a workspace for SAML Single Sign-on on workspace ".concat(this.props.spaceStore.id,".")})}),l()(this,"handleUpgradeClick",()=>{si.a(this.environment,{from:"space_saml",for:"enterprise"})}),l()(this,"handleScimTokenContactUsClick",()=>{Ce.a({environment:this.environment,from:"saml_settings",prepopulatedContent:"Request to generate a SCIM API token for workspace ".concat(this.props.spaceStore.id,".")})}),l()(this,"setUseMetadataUrl",e=>{this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,useMetadataUrl:e})})}renderComponent(){return ae.a.state.online?s()(K.a,{controlRow:this.renderControlRow()},void 0,this.renderSecuritySettings(),this.renderSamlSettings(),this.renderScimSettings()):this.renderOfflineMessage()}renderUpsell(){if(!this.isSecuritySubscribed())return s()("div",{style:{border:"1px solid ".concat(this.theme.regularDividerColor),borderRadius:3,padding:16,marginTop:Object(gi.f)(this.environment)?void 0:24,marginBottom:24}},void 0,s()(li.a,{for:"enterprise",from:"space_saml",icon:ye.a.key,title:s()(S.FormattedMessage,{id:"securitySAMLSettings.upsell.title",defaultMessage:"Upgrade for advanced security, SAML & SCIM"}),caption:s()(S.FormattedMessage,{id:"securitySAMLSettings.upsell.caption",defaultMessage:"Upgrade to the Enterprise Plan for advanced security settings, SAML single sign-on, and automated user and group provisioning."}),learnMoreRoute:"guides.securitySettings"}))}renderSecuritySettings(){const{securitySettingsStore:e}=this.props,t=s()(tt.a,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),a=a=>s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisablePublicAccessSwitcherClick:this.handleUpgradeClick},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Prevent members from sharing pages publicly"}),!a&&t,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"This will disable the Share to web option in the Share menu on every page in this workspace."}))),s()("div",{style:{marginTop:5,opacity:a?void 0:.5}},void 0,s()(qt.a,{on:e.state.disablePublicAccess,disabled:!a}))),s()(N.a,{size:24,style:{opacity:0}})),i=a=>s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleAllowDisableWorkspaceTopLevelSwitcherClick:this.handleUpgradeClick},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from changing the Workspace section"}),!a&&t,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"This disables the ability for members to create, move, reorder, and delete top-level Workspace pages."}))),s()("div",{style:{marginTop:5,opacity:a?void 0:.5}},void 0,s()(qt.a,{on:e.state.disableSpacePageEdits,disabled:!a}))),s()(N.a,{size:24,style:{opacity:0}})),n=a=>s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!a&&t,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"This prevents anyone from inviting people outside the workspace to any page."}))),s()("div",{style:{marginTop:5,opacity:a?void 0:.5}},void 0,s()(qt.a,{on:e.state.disableGuests,disabled:!a}))),s()(N.a,{size:24,style:{opacity:0}})),o=a=>s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisableMoveToSwitcherClick:this.handleUpgradeClick},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable moving or duplicating pages to other workspaces"}),!a&&t,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"This prevents anyone from moving or duplicating pages to other workspaces via the Move To or Duplicate To action."}))),s()("div",{style:{marginTop:5,opacity:a?void 0:.5}},void 0,s()(qt.a,{on:e.state.disableMoveToSpace,disabled:!a}))),s()(N.a,{size:24,style:{opacity:0}})),{state:r}=e,l=a=>s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisableExportClick:this.handleUpgradeClick},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!a&&t,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"This prevents anyone from exporting as Markdown, CSV, or PDF."}))),s()("div",{style:{marginTop:5,opacity:a?void 0:.5}},void 0,s()(qt.a,{on:e.state.disableExport,disabled:!a}))),s()(N.a,{size:24,style:{opacity:0}})),c=a=>{if(Object(gi.f)(this.environment))return s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisablePublicAccessRequestsClick:this.handleUpgradeClick},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.label",defaultMessage:"Disable page access requests from non-members"}),!a&&t,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.caption",defaultMessage:"This prevents anyone with the link to a page from requesting access. Workspace members can always request access."}))),s()("div",{style:{marginTop:5,opacity:a?void 0:.5}},void 0,s()(qt.a,{on:e.state.disablePublicAccessRequests,disabled:!a}))),s()(N.a,{size:24,style:{opacity:0}}))};return this.isSecuritySubscribed()?s()(d.Fragment,{},void 0,s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})),c(!0),a(!0),i(!0),n(!0),o(!0),l(!0),s()("div",{style:{height:36}})):s()(d.Fragment,{},void 0,this.renderUpsell(),s()("div",{style:this.getHeaderStyle()},void 0,s()("span",{style:{marginRight:8}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"}))),c(!0),a(r.disablePublicAccess),i(r.disableSpacePageEdits),n(r.disableGuests),o(r.disableMoveToSpace),l(r.disableExport),s()("div",{style:{height:32}}))}renderSamlSettings(){return s()(Sa.a,{request:{environment:this.environment,spaceId:this.props.spaceStore.id,store:this.props.samlConfigStore},performRequest:R,render:(e,t,a)=>a?t&&!e?this.isSamlAvailable()?this.renderSamlConfig():this.renderUpgradeSamlPrompt():void 0:s()(G.a,{})})}renderSamlHelp(){return s()("div",{style:{marginTop:18,marginBottom:24}},void 0,s()(ce.a,{title:s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSection.helpButton.label",defaultMessage:"Learn about SAML and single sign-on"}),href:Object(Ee.a)("guides.samlSettings"),analyticsFrom:"saml_settings"}))}renderSamlUneditable(e){if(this.isSamlEditable()||!e)return;const t=di.a.getPublicSpaceData(this.environment,e);return t?s()("div",{style:{marginBottom:24}},void 0,s()(pe.a,{isMultiline:!0},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSection.uneditableMessage",defaultMessage:"SAML is being managed by the workspace <bold>{workspaceName}</bold>. Please go there to change any SAML settings.",values:{workspaceName:t.name,bold:(...e)=>s()("span",{style:{fontWeight:$.a.fontWeight.semibold}},void 0,e)}}))):void 0}renderUpgradeSamlPrompt(){return s()("div",{},void 0,s()(d.Fragment,{},void 0,s()("div",{style:this.getHeaderStyle()},void 0,s()("span",{style:{marginRight:8}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.title",defaultMessage:"SAML single sign-on"})),s()(tt.a,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{marginTop:-1}})),this.renderSamlHelp()))}renderEmailDomains(e){return s()(d.Fragment,{},void 0,s()(Y.a,{smallMarginBottom:!0},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.title",defaultMessage:"Email domains"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{...Si.captionStyle,marginBottom:12,marginTop:2}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emailInput.caption",defaultMessage:"Once you enable SAML, anyone using an email address with the domains below will be able to log in using SAML SSO. <contactlink>Contact support</contactlink> to add or remove a domain.",values:{contactlink:(...e)=>s()(we.a,{onClick:this.handleEmailDomainContactUsClick},void 0,e)}})),s()("div",{style:{height:32}},void 0,s()(ze.a,{placeholder:this.props.intl.formatMessage({id:"securitySAMLSettings.emailDomainsSection.emailInput.placeholder",defaultMessage:"No email domains configured"}),value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:e.map(e=>s()(qe.b,{showRemoveButton:!1,isSingle:!1,format:qe.b.Format.Medium,value:e},e))})),s()(N.a,{size:40}))}renderSpaceNames(e){if(!this.isSamlEditable())return;const t=e.map(e=>di.a.getPublicSpaceData(this.environment,e)).filter(e=>Boolean(e));return t.length<=1?void 0:s()(d.Fragment,{},void 0,s()(Y.a,{smallMarginBottom:!0},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.spaceNamesSection.title",defaultMessage:"Workspaces"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{...Si.captionStyle,marginBottom:12,marginTop:2}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.spaceNamesSection.spaceNameInput.caption",defaultMessage:"The SAML settings here apply to multiple workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:(...e)=>s()(we.a,{onClick:this.handleWorkspaceContactUsClick},void 0,e)}})),s()("div",{style:{height:32}},void 0,s()(ze.a,{placeholder:"",value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:t.map(e=>s()(qe.b,{showRemoveButton:!1,isSingle:!1,format:qe.b.Format.Medium,value:e.name},e.id))})),s()(N.a,{size:40}))}renderSingleSignOnUrl(){const e=oi(this.props.spaceStore.id),t=s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.url.tooltip",defaultMessage:"Copy link"});return s()(d.Fragment,{},void 0,s()(Y.a,{},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.title",defaultMessage:"Single sign-on URL"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{...Si.captionStyle,marginTop:2}},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.url.caption",defaultMessage:"Enter this in your Identity Provider's SAML configuration."})),s()("div",{},void 0,s()("div",{style:{display:"flex",alignItems:"flex-start",marginTop:12,marginBottom:6}},void 0,s()(H.b,{type:"text",format:H.a.Default,value:e,disabled:!0,style:{borderTopRightRadius:0,borderBottomRightRadius:0,width:"calc(100% - 90px)",height:32}}),s()(se.a,{onClick:()=>{Ge.c({environment:this.environment,stringValue:e})},style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,width:90},isLarge:!0},void 0,t))))}renderIdpSettings(e){return s()(d.Fragment,{},void 0,s()(Ca.a,{style:this.getRadioTitleStyle(),onClick:e=>{this.setUseMetadataUrl(!0)},disabled:!this.isSamlEditable()},void 0,s()(ri.a,{isSelected:Boolean(e.useMetadataUrl)})," ",s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataURLOption.label",defaultMessage:"IDP metadata URL"})),s()("div",{style:{maxWidth:"100%",marginLeft:32}},void 0,s()(H.b,{value:e.idpMetadataUrl,onChange:this.handleIdpMetadataUrlChange,onBlur:this.handleIdpMetadataUrlBlur,placeholder:"https://...",style:{height:32},readOnly:!this.isSamlEditable()})),s()(Ca.a,{style:this.getRadioTitleStyle(),onClick:e=>{this.setUseMetadataUrl(!1)},disabled:!this.isSamlEditable()},void 0,s()(ri.a,{isSelected:!e.useMetadataUrl})," ",s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataXMLOption.label",defaultMessage:"IDP metadata XML"})),s()("div",{style:{maxWidth:"100%",marginLeft:32}},void 0,s()(H.b,{textarea:!0,value:e.idpMetadata,onChange:this.handleIdpMetadataChange,onBlur:this.handleIdpMetadataBlur,placeholder:this.props.intl.formatMessage({id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataXMLOption.input.placeholder",defaultMessage:"IDP metadata XML"}),readOnly:!this.isSamlEditable()}),s()(pe.a,{isSmall:!0,isMultiline:!0,style:Si.captionStyle},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataXMLOption.caption",defaultMessage:"Enter the value provided by your Identity Provider (IDP)."}))))}renderCreateAccountToggle(e){const t=!this.isSamlEditable();return s()("div",{},void 0,s()(N.a,{size:24,style:{marginTop:12}}),s()("div",{style:Si.settingOptionStyle(t),onClick:this.handleCreateAccountToggle},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.automaticallyCreateAccounts.label",defaultMessage:"Automatically create accounts on sign-in"}),s()(pe.a,{isSmall:!0,isMultiline:!0,style:Si.captionStyle},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.automaticallyCreateAccounts.caption",defaultMessage:"Allow users to create Notion accounts without provisioning from the IDP."}))),s()(qt.a,{on:e,disabled:t})),s()(N.a,{size:24}))}renderEnableSamlToggle(e,t){return s()("div",{},void 0,s()("div",{style:Si.settingOptionStyle(t||!this.isSamlEditable()),onClick:this.handleEnableSamlToggle},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enableSAML.label",defaultMessage:"Enable SAML"}),s()(pe.a,{isSmall:!0,isMultiline:!0,style:Si.captionStyle},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enableSAML.caption",defaultMessage:"This allows users with emails on the configured domains to log in with SAML. SAML authentication can be enforced below."}))),s()("div",{},void 0,t?s()(He.a,{delayThreshold:0,renderTooltip:()=>s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enableSAML.tooltip",defaultMessage:"SAML can be enabled once it is fully configured."}),alignment:ni.a.End,render:e=>c.a.createElement("div",e,s()(qt.a,{on:!1,disabled:!0}))}):s()(qt.a,{on:"disabled"!==e&&"unconfigured"!==e,disabled:!this.isSamlEditable()}))),s()(N.a,{size:24}))}renderEnforceSamlToggle(e,t){return s()("div",{style:Si.settingOptionStyle(t||!this.isSamlEditable()),onClick:this.handleEnforceSamlToggle},void 0,s()("div",{style:this.getTitleStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enforceSAML.label",defaultMessage:"Enforce SAML"}),s()(pe.a,{isSmall:!0,isMultiline:!0,style:Si.captionStyle},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enforceSAML.captionMulti",defaultMessage:"Once enforced, workspace members with an email on the domains configured above can only use SAML SSO to log in. Administrator accounts can still log in using email."}))),s()("div",{},void 0,t?s()(He.a,{delayThreshold:0,renderTooltip:()=>s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enforceSAML.tooltip",defaultMessage:"Enable SAML to access this option."}),alignment:ni.a.End,render:e=>c.a.createElement("div",e,s()(qt.a,{on:!1,disabled:!0}))}):s()(qt.a,{on:"enforced"===e,disabled:!this.isSamlEditable()})))}renderSamlConfig(){const e=this.props.samlConfigStore.state,t=this.isInvalidSamlConfig(e);return s()(d.Fragment,{},void 0,s()("div",{style:this.getHeaderStyle()},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.title",defaultMessage:"SAML single sign-on"})),this.renderSamlHelp(),this.renderSamlUneditable(e.id),this.renderEmailDomains(e.emailDomains),this.renderSpaceNames(e.spaceIds),this.renderSingleSignOnUrl(),this.renderIdpSettings(e),this.renderCreateAccountToggle(e.createAccount),this.renderEnableSamlToggle(e.status,t),this.renderEnforceSamlToggle(e.status,t))}renderScimSettings(){return s()(Sa.a,{requestStore:this.stores.botsRequestStore,request:{environment:this.environment,table:ui.a,id:this.props.spaceStore.id,type:"scim"},performRequest:ci.c,render:this.renderScimBotTokens})}renderScimContactUs(){return s()(pe.a,{isSmall:!0,isMultiline:!0,style:Si.captionStyle},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.contactUs",defaultMessage:"To generate a SCIM API token, please <contactlink>contact support</contactlink>.",values:{contactlink:(...e)=>s()(we.a,{onClick:this.handleScimTokenContactUsClick},void 0,e)}}))}renderScimHelp(){return s()("div",{style:{marginTop:18,marginBottom:24}},void 0,s()(ce.a,{title:s()(S.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),href:Object(Ee.a)("guides.scim"),analyticsFrom:"scim_settings"}))}renderControlRow(){if(this.isSecuritySubscribed()||Object(gi.f)(this.environment))return s()("div",{style:{display:"flex"}},void 0,s()(se.a,{isLarge:!0,onClick:this.handleUpdateClick},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.updateButton.label",defaultMessage:"Update"})),s()(ne.a,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,s()(S.FormattedMessage,{id:"securitySAMLSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})))}closeSettings(){U.a.setState({...U.a.state,open:!1})}isSamlAvailable(){return this.props.samlConfigStore.state.emailDomains.length>0||"enterprise"===Me.h(this.environment)}isSamlEditable(){const e=this.props.samlConfigStore.state;return this.isSamlAvailable()&&(!e.id||e.id===this.props.spaceStore.id)}isSecuritySubscribed(){const e=Me.h(this.environment);if("enterprise"===e)return!0;if("team"===e||"team_free"===e){const{data:e}=$e.default.state,t=Me.o(e);return e&&t&&"subscribed_admin"===e.type&&t.created<P.d}return!1}isInvalidSamlConfig(e){return 0===e.emailDomains.length||e.useMetadataUrl&&!e.idpMetadataUrl||!e.useMetadataUrl&&!e.idpMetadata}saveSecuritySettings(){const{securitySettingsStore:e,spaceStore:t}=this.props,{disablePublicAccess:a,disableGuests:i,disableMoveToSpace:s,disableExport:n,disableSpacePageEdits:o,disablePublicAccessRequests:r}=e.state;return J.createAndCommit(this.environment,e=>{A.A({environment:this.environment,transaction:e,spaceStore:t,disablePublicAccess:a,disableGuests:i,disableMoveToSpace:s,disableExport:n,disableSpacePageEdits:o,disablePublicAccessRequests:r})})}async saveSamlConfig(){if(this.isSamlAvailable()){const e=this.props.samlConfigStore.state,t=await g.adminSamlConfigForSpace(this.environment,{spaceId:this.props.spaceStore.id,status:e.status,useMetadataUrl:e.useMetadataUrl,idpMetadataUrl:e.idpMetadataUrl,idpMetadata:e.idpMetadata,createAccount:e.createAccount});"failed"===t.type&&this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,error:t})}}static settingOptionStyle(e=!1){return{display:"flex",alignItems:"center",width:"100%",cursor:e?"default":"pointer"}}getHeaderStyle(){return{fontWeight:$.a.fontWeight.medium,fontSize:18,borderBottom:"1px solid ".concat(this.theme.regularDividerColor),paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}getRadioTitleStyle(){return{marginTop:8,marginBottom:4}}}l()(Si,"captionStyle",{marginTop:4,width:"85%"});var Ci=Object(S.injectIntl)(Si),Ti=a("gND8"),ki=a("KWgd"),Ai=a("RBMm");class wi extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{buttonPopupStore:hi.a}),l()(this,"handleSelectChange",e=>{const{label:t}=this.getItemLabelAndCaption(e);if(this.props.confirm){const a=()=>{this.props.onChange(e)};f.showDialog({showCancel:!0,keepFocus:!1,message:s()(S.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:t}}),items:[{label:s()(S.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:a}]})}else this.props.onChange(e)})}renderComponent(){const{device:e}=this.environment;if(!e.isMobile)return s()(Mi.a,{popupType:Mi.a.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>c.a.createElement(Ca.a,o()({style:{marginLeft:-8,paddingLeft:8,paddingRight:8}},e),this.getItemLabelAndCaption(this.props.currentLocale).label,ye.a.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),placementToOrigin:Ai.b.Bottom,alignmentToOrigin:Ai.a.Start,render:e=>{let t;t="on"===xe.default.getGroup(this.environment,"polyglot")?[...ki.a,...ki.b]:ki.a;const a=[{key:"languages",render:e=>c.a.createElement(Xe.a,o()({},e,{topBorder:0!==e.index})),items:t.map(t=>({key:t,render:e=>this.getItem(t,e.focused,e),action:()=>{this.handleSelect(t),e.close()}}))}],i={menuType:Ye.b.MenuType.Popup,width:216};return c.a.createElement(Ye.b,o()({className:ii.I},i),s()(Qe.a,{type:Qe.a.Type.Vertical,initialFocus:void 0,sections:a}))}})}renderItem(e){return c.a.createElement(Je.a,o()({},e.props,{title:s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()("div",{style:{...e.style,marginRight:0}},void 0,e.label)),caption:e.caption&&s()("span",{style:{color:this.theme.mediumTextColor}},void 0,e.caption),shouldWrapCaption:!0}))}handleSelect(e){this.props.currentLocale!==e&&this.handleSelectChange(e)}getItemLabelAndCaption(e){var t;return{"en-US":{label:"English",caption:(t=this.props.intl).formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"ko-KR":{label:"한국어",caption:t.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:t.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:t.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:t.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:t.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:t.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:t.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:t.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})}}[e]}getItem(e,t,a){return this.renderItem({...this.getItemLabelAndCaption(e),focused:t,props:a})}}var Ii=Object(S.injectIntl)(wi),Pi=a("h2IJ");class Fi extends j.a{renderComponent(){return s()("div",{style:this.getSettingsOptionStyle()},void 0,s()("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"}},void 0,s()("div",{style:{flex:1}},void 0,s()(pe.a,{},void 0,s()(S.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,s()(S.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."}))),s()(Ii,{confirm:!0,onChange:async e=>{Object(v.xc)(this.environment,{locale:e});const t=await g.setLocale(this.environment,{locale:e});"success"===t.type?(Pi.a.set("preferredLocale",e),await b.transactionQueue.drain(),window.location.reload(!0)):f.showError(t)},currentLocale:this.props.locale})))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}var xi=Fi,Ei=a("Agvv"),Bi=a("PHZn"),Di=a("FkPB");const Oi=[{name:"Afghanistan",countryCode:"AF"},{name:"Åland Islands",countryCode:"AX"},{name:"Albania",countryCode:"AL"},{name:"Algeria",countryCode:"DZ"},{name:"American Samoa",countryCode:"AS"},{name:"Andorra",countryCode:"AD"},{name:"Angola",countryCode:"AO"},{name:"Anguilla",countryCode:"AI"},{name:"Antarctica",countryCode:"AQ"},{name:"Antigua and Barbuda",countryCode:"AG"},{name:"Argentina",countryCode:"AR"},{name:"Armenia",countryCode:"AM"},{name:"Aruba",countryCode:"AW"},{name:"Australia",countryCode:"AU",vatApplicable:!0},{name:"Austria",countryCode:"AT",vatApplicable:!0},{name:"Azerbaijan",countryCode:"AZ"},{name:"Bahamas",countryCode:"BS"},{name:"Bahrain",countryCode:"BH"},{name:"Bangladesh",countryCode:"BD"},{name:"Barbados",countryCode:"BB"},{name:"Belarus",countryCode:"BY"},{name:"Belgium",countryCode:"BE",vatApplicable:!0},{name:"Belize",countryCode:"BZ"},{name:"Benin",countryCode:"BJ"},{name:"Bermuda",countryCode:"BM"},{name:"Bhutan",countryCode:"BT"},{name:"Bolivia (Plurinational State of)",countryCode:"BO"},{name:"Bonaire, Sint Eustatius and Saba",countryCode:"BQ"},{name:"Bosnia and Herzegovina",countryCode:"BA"},{name:"Botswana",countryCode:"BW"},{name:"Bouvet Island",countryCode:"BV"},{name:"Brazil",countryCode:"BR"},{name:"British Indian Ocean Territory",countryCode:"IO"},{name:"Brunei Darussalam",countryCode:"BN"},{name:"Bulgaria",countryCode:"BG",vatApplicable:!0},{name:"Burkina Faso",countryCode:"BF"},{name:"Burundi",countryCode:"BI"},{name:"Cabo Verde",countryCode:"CV"},{name:"Cambodia",countryCode:"KH"},{name:"Cameroon",countryCode:"CM"},{name:"Canada",countryCode:"CA",vatApplicable:!0},{name:"Cayman Islands",countryCode:"KY"},{name:"Central African Republic",countryCode:"CF"},{name:"Chad",countryCode:"TD"},{name:"Chile",countryCode:"CL"},{name:"China",countryCode:"CN"},{name:"Christmas Island",countryCode:"CX"},{name:"Cocos (Keeling) Islands",countryCode:"CC"},{name:"Colombia",countryCode:"CO"},{name:"Comoros",countryCode:"KM"},{name:"Congo",countryCode:"CG"},{name:"Congo, Democratic Republic of the",countryCode:"CD"},{name:"Cook Islands",countryCode:"CK"},{name:"Costa Rica",countryCode:"CR"},{name:"Côte d'Ivoire",countryCode:"CI"},{name:"Croatia",countryCode:"HR",vatApplicable:!0},{name:"Cuba",countryCode:"CU"},{name:"Curaçao",countryCode:"CW"},{name:"Cyprus",countryCode:"CY",vatApplicable:!0},{name:"Czechia",countryCode:"CZ",vatApplicable:!0},{name:"Denmark",countryCode:"DK",vatApplicable:!0},{name:"Djibouti",countryCode:"DJ"},{name:"Dominica",countryCode:"DM"},{name:"Dominican Republic",countryCode:"DO"},{name:"Ecuador",countryCode:"EC"},{name:"Egypt",countryCode:"EG"},{name:"El Salvador",countryCode:"SV"},{name:"Equatorial Guinea",countryCode:"GQ"},{name:"Eritrea",countryCode:"ER"},{name:"Estonia",countryCode:"EE",vatApplicable:!0},{name:"Eswatini",countryCode:"SZ"},{name:"Ethiopia",countryCode:"ET"},{name:"Falkland Islands (Malvinas)",countryCode:"FK"},{name:"Faroe Islands",countryCode:"FO"},{name:"Fiji",countryCode:"FJ"},{name:"Finland",countryCode:"FI",vatApplicable:!0},{name:"France",countryCode:"FR",vatApplicable:!0},{name:"French Guiana",countryCode:"GF"},{name:"French Polynesia",countryCode:"PF"},{name:"French Southern Territories",countryCode:"TF"},{name:"Gabon",countryCode:"GA"},{name:"Gambia",countryCode:"GM"},{name:"Georgia",countryCode:"GE"},{name:"Germany",countryCode:"DE",vatApplicable:!0},{name:"Ghana",countryCode:"GH"},{name:"Gibraltar",countryCode:"GI"},{name:"Greece",countryCode:"GR",vatApplicable:!0},{name:"Greenland",countryCode:"GL"},{name:"Grenada",countryCode:"GD"},{name:"Guadeloupe",countryCode:"GP"},{name:"Guam",countryCode:"GU"},{name:"Guatemala",countryCode:"GT"},{name:"Guernsey",countryCode:"GG"},{name:"Guinea",countryCode:"GN"},{name:"Guinea-Bissau",countryCode:"GW"},{name:"Guyana",countryCode:"GY"},{name:"Haiti",countryCode:"HT"},{name:"Heard Island and McDonald Islands",countryCode:"HM"},{name:"Holy See",countryCode:"VA"},{name:"Honduras",countryCode:"HN"},{name:"Hong Kong",countryCode:"HK"},{name:"Hungary",countryCode:"HU",vatApplicable:!0},{name:"Iceland",countryCode:"IS"},{name:"India",countryCode:"IN",vatApplicable:!0},{name:"Indonesia",countryCode:"ID"},{name:"Iran (Islamic Republic of)",countryCode:"IR"},{name:"Iraq",countryCode:"IQ"},{name:"Ireland",countryCode:"IE",vatApplicable:!0},{name:"Isle of Man",countryCode:"IM"},{name:"Israel",countryCode:"IL"},{name:"Italy",countryCode:"IT",vatApplicable:!0},{name:"Jamaica",countryCode:"JM"},{name:"Japan",countryCode:"JP"},{name:"Jersey",countryCode:"JE"},{name:"Jordan",countryCode:"JO"},{name:"Kazakhstan",countryCode:"KZ"},{name:"Kenya",countryCode:"KE"},{name:"Kiribati",countryCode:"KI"},{name:"Korea, Republic of",countryCode:"KR",vatApplicable:!0},{name:"Kosovo",countryCode:"XK"},{name:"Kuwait",countryCode:"KW"},{name:"Kyrgyzstan",countryCode:"KG"},{name:"Lao People's Democratic Republic",countryCode:"LA"},{name:"Latvia",countryCode:"LV",vatApplicable:!0},{name:"Lebanon",countryCode:"LB"},{name:"Lesotho",countryCode:"LS"},{name:"Liberia",countryCode:"LR"},{name:"Libya",countryCode:"LY"},{name:"Liechtenstein",countryCode:"LI"},{name:"Lithuania",countryCode:"LT",vatApplicable:!0},{name:"Luxembourg",countryCode:"LU",vatApplicable:!0},{name:"Macao",countryCode:"MO"},{name:"Madagascar",countryCode:"MG"},{name:"Malawi",countryCode:"MW"},{name:"Malaysia",countryCode:"MY"},{name:"Maldives",countryCode:"MV"},{name:"Mali",countryCode:"ML"},{name:"Malta",countryCode:"MT",vatApplicable:!0},{name:"Marshall Islands",countryCode:"MH"},{name:"Martinique",countryCode:"MQ"},{name:"Mauritania",countryCode:"MR"},{name:"Mauritius",countryCode:"MU"},{name:"Mayotte",countryCode:"YT"},{name:"Mexico",countryCode:"MX"},{name:"Micronesia (Federated States of)",countryCode:"FM"},{name:"Moldova, Republic of",countryCode:"MD"},{name:"Monaco",countryCode:"MC"},{name:"Mongolia",countryCode:"MN"},{name:"Montenegro",countryCode:"ME"},{name:"Montserrat",countryCode:"MS"},{name:"Morocco",countryCode:"MA"},{name:"Mozambique",countryCode:"MZ"},{name:"Myanmar",countryCode:"MM"},{name:"Namibia",countryCode:"NA"},{name:"Nauru",countryCode:"NR"},{name:"Nepal",countryCode:"NP"},{name:"Netherlands",countryCode:"NL",vatApplicable:!0},{name:"New Caledonia",countryCode:"NC"},{name:"New Zealand",countryCode:"NZ",vatApplicable:!0},{name:"Nicaragua",countryCode:"NI"},{name:"Niger",countryCode:"NE"},{name:"Nigeria",countryCode:"NG"},{name:"Niue",countryCode:"NU"},{name:"Norfolk Island",countryCode:"NF"},{name:"North Macedonia",countryCode:"MK"},{name:"Northern Mariana Islands",countryCode:"MP"},{name:"Norway",countryCode:"NO",vatApplicable:!0},{name:"Oman",countryCode:"OM"},{name:"Pakistan",countryCode:"PK"},{name:"Palau",countryCode:"PW"},{name:"Palestine, State of",countryCode:"PS"},{name:"Panama",countryCode:"PA"},{name:"Papua New Guinea",countryCode:"PG"},{name:"Paraguay",countryCode:"PY"},{name:"Peru",countryCode:"PE"},{name:"Philippines",countryCode:"PH"},{name:"Pitcairn",countryCode:"PN"},{name:"Poland",countryCode:"PL",vatApplicable:!0},{name:"Portugal",countryCode:"PT",vatApplicable:!0},{name:"Puerto Rico",countryCode:"PR"},{name:"Qatar",countryCode:"QA"},{name:"Réunion",countryCode:"RE"},{name:"Romania",countryCode:"RO",vatApplicable:!0},{name:"Russian Federation",countryCode:"RU",vatApplicable:!0},{name:"Rwanda",countryCode:"RW"},{name:"Saint Barthélemy",countryCode:"BL"},{name:"Saint Helena, Ascension and Tristan da Cunha",countryCode:"SH"},{name:"Saint Kitts and Nevis",countryCode:"KN"},{name:"Saint Lucia",countryCode:"LC"},{name:"Saint Martin (French part)",countryCode:"MF"},{name:"Saint Pierre and Miquelon",countryCode:"PM"},{name:"Saint Vincent and the Grenadines",countryCode:"VC"},{name:"Samoa",countryCode:"WS"},{name:"San Marino",countryCode:"SM"},{name:"Sao Tome and Principe",countryCode:"ST"},{name:"Saudi Arabia",countryCode:"SA"},{name:"Senegal",countryCode:"SN"},{name:"Serbia",countryCode:"RS"},{name:"Seychelles",countryCode:"SC"},{name:"Sierra Leone",countryCode:"SL"},{name:"Singapore",countryCode:"SG",vatApplicable:!0},{name:"Sint Maarten (Dutch part)",countryCode:"SX"},{name:"Slovakia",countryCode:"SK",vatApplicable:!0},{name:"Slovenia",countryCode:"SI",vatApplicable:!0},{name:"Solomon Islands",countryCode:"SB"},{name:"Somalia",countryCode:"SO"},{name:"South Africa",countryCode:"ZA"},{name:"South Georgia and the South Sandwich Islands",countryCode:"GS"},{name:"South Sudan",countryCode:"SS"},{name:"Spain",countryCode:"ES",vatApplicable:!0},{name:"Sri Lanka",countryCode:"LK"},{name:"Sudan",countryCode:"SD"},{name:"Suriname",countryCode:"SR"},{name:"Svalbard and Jan Mayen",countryCode:"SJ"},{name:"Sweden",countryCode:"SE",vatApplicable:!0},{name:"Switzerland",countryCode:"CH",vatApplicable:!0},{name:"Syrian Arab Republic",countryCode:"SY"},{name:"Taiwan",countryCode:"TW",vatApplicable:!0},{name:"Tajikistan",countryCode:"TJ"},{name:"Tanzania, United Republic of",countryCode:"TZ"},{name:"Thailand",countryCode:"TH"},{name:"Timor-Leste",countryCode:"TL"},{name:"Togo",countryCode:"TG"},{name:"Tokelau",countryCode:"TK"},{name:"Tonga",countryCode:"TO"},{name:"Trinidad and Tobago",countryCode:"TT"},{name:"Tunisia",countryCode:"TN"},{name:"Turkey",countryCode:"TR"},{name:"Turkmenistan",countryCode:"TM"},{name:"Turks and Caicos Islands",countryCode:"TC"},{name:"Tuvalu",countryCode:"TV"},{name:"Uganda",countryCode:"UG"},{name:"Ukraine",countryCode:"UA"},{name:"United Arab Emirates",countryCode:"AE"},{name:"United Kingdom of Great Britain and Northern Ireland",countryCode:"GB",vatApplicable:!0},{name:"United States",countryCode:"US"},{name:"United States Minor Outlying Islands",countryCode:"UM"},{name:"Uruguay",countryCode:"UY"},{name:"Uzbekistan",countryCode:"UZ"},{name:"Vanuatu",countryCode:"VU"},{name:"Venezuela (Bolivarian Republic of)",countryCode:"VE"},{name:"Viet Nam",countryCode:"VN"},{name:"Virgin Islands (British)",countryCode:"VG"},{name:"Virgin Islands (U.S.)",countryCode:"VI"},{name:"Wallis and Futuna",countryCode:"WF"},{name:"Western Sahara",countryCode:"EH"},{name:"Yemen",countryCode:"YE"},{name:"Zambia",countryCode:"ZM"},{name:"Zimbabwe",countryCode:"ZW"}];var Ri=a("dXb3"),Li=a("hfHo"),_i=a("O+wX");function Ui(e){var t,a;return(null==e||null===(t=e.settings)||void 0===t||null===(a=t.regional_format_settings)||void 0===a?void 0:a.region)||"United States"}function ji(e,t){var a;const i=null==e||null===(a=e.settings)||void 0===a?void 0:a.regional_format_settings;return"full_date"===t?null!=i&&i.use_default_region_settings?Ni(Ui(e)):(null==i?void 0:i.full_date)||Ni(Ui(e)):"short_date"===t?null!=i&&i.use_default_region_settings?{type:"short"}:(null==i?void 0:i.short_date)||{type:"short"}:"number"===t?null!=i&&i.use_default_region_settings?"number":(null==i?void 0:i.number)||"number":"week_start_on"===t?null!=i&&i.use_default_region_settings?"sunday":(null==i?void 0:i.week_start_on)||"sunday":Object(Qt.f)(t)}function Ni(e){return"ja"===e?{type:"short"}:{type:"long"}}const Zi={full_date:Object(S.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:Object(S.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:Object(S.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:Object(S.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},Wi=Object(S.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function Vi(e,t){return Object(yt.c)(1234567,e,t)}const zi=Object(S.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function qi(e,t){const a=Object(Li.default)();return Object(_i.b)(Object(Ei.d)(t),a,e)}function Hi(e,t){const a=Object(Li.default)();return Object(_i.c)(Object(Ei.d)(t),a,e)}function Gi(e){const t=Object(Bi.a)(()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}),[]);return s()("div",{style:t.container},void 0,s()("div",{style:t.label},void 0,s()(pe.a,{},void 0,s()(S.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,s()(S.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"}))),s()(Ki,{userSettingsStore:e.userSettingsStore,onChange:e=>{}}))}function Ki(e){const t=Object(Bi.b)(),[,,a]=Object(Di.b)(void 0,hi.a),i=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]),[n,r]=c.a.useState("");return s()(Mi.a,{popupType:Mi.a.PopupType.Popup,buttonPopupStore:a,renderOrigin:e=>c.a.createElement(Ca.a,e,Ui(i.value),ye.a.chevronDown({width:10,marginLeft:4,fill:t.lightIconColor})),placementToOrigin:Ai.b.Bottom,alignmentToOrigin:Ai.a.Start,render:t=>s()(Ye.b,{menuType:Ye.b.MenuType.Popup,width:216,header:s()(Qi,{value:n,onChange:e=>r(e)})},void 0,s()(Qe.a,{type:Qe.a.Type.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>c.a.createElement(Xe.a,o()({},e,{topBorder:0!==e.index})),items:Object(it.b)(n,Oi,e=>e.name).map(a=>({key:a.countryCode,render:e=>c.a.createElement(Je.a,o()({},e,{title:a.name})),action:()=>{e.onChange(a.countryCode),t.close(),r("")}}))}]}))})}const Yi=Object(S.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function Qi(e){return s()(Xe.a,{isInput:!0},void 0,s()(Ri.a,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:C.default.formatMessage(Yi.regionSearchPlaceholder),focusAfterAnimation:!0}))}var Ji=a("Zo/l"),Xi=a("B22C");const $i={full_date:Object(S.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:Object(S.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:Object(S.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:Object(S.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function es(e){const[,,t]=Object(Di.b)(void 0,hi.a),a=Object(Bi.b)(),i=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]);if(!i.ready||!i.value)return s()(G.a,{});const n=function(e,t){if("full_date"===t){return Zi[t][ji(e,t).type]}if("short_date"===t){return Zi[t][ji(e,t).type]}if("number"===t){return Zi[t][ji(e,t)]}if("week_start_on"===t){return Zi[t][ji(e,t)]}return Object(Qt.f)(t)}(i.value,e.option);return s()(Mi.a,{popupType:Mi.a.PopupType.Popup,buttonPopupStore:t,renderOrigin:e=>c.a.createElement(Ca.a,e,C.default.formatMessage(n),ye.a.chevronDown({width:10,marginLeft:4,fill:a.lightIconColor})),placementToOrigin:Ai.b.Bottom,alignmentToOrigin:Ai.a.Start,render:t=>"week_start_on"===e.option||"number"===e.option?s()(ts,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?s()(as,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):Object(Qt.f)(e.option)})}function ts(e){const t=Object(Ji.b)(),a=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]),i=Object(S.useIntl)();return s()(Ye.b,{menuType:Ye.b.MenuType.Popup,width:216},void 0,s()(Qe.a,{type:Qe.a.Type.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>c.a.createElement(Xe.a,o()({},e,{topBorder:0!==e.index})),items:Object(Qt.d)($i[e.option]).map(s=>({key:s,render:t=>{const a="number"===e.option?Vi(s,i):void 0;return c.a.createElement(Je.a,o()({},t,{title:C.default.formatMessage($i[e.option][s]),caption:a}))},action:()=>{Object(J.createAndCommit)(t,t=>{var i,n;Object(V.f)({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...null===(i=a.value)||void 0===i||null===(n=i.settings)||void 0===n?void 0:n.regional_format_settings,use_default_region_settings:!1,region:Ui(e.userSettingsStore.getValue()),[e.option]:s}},transaction:t})}),e.onAccept()}}))}]}))}function as(e){const t=Object(Ji.b)(),a=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]),[i,n]=Object(d.useState)(()=>{}),r=Object(S.useIntl)(),l=Object(Qt.d)($i[e.option]),u=s=>{const n="custom"===s?{type:s,format:i}:{type:s};Object(J.createAndCommit)(t,t=>{var i,s;Object(V.f)({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...null===(i=a.value)||void 0===i||null===(s=i.settings)||void 0===s?void 0:s.regional_format_settings,use_default_region_settings:!1,region:Ui(e.userSettingsStore.getValue()),[e.option]:n}},transaction:t})}),e.onAccept()};return s()(Ye.b,{menuType:Ye.b.MenuType.Popup,width:216},void 0,s()(Qe.a,{type:Qe.a.Type.Vertical,initialFocus:void 0,disableMouseLeaveBlur:!0,sections:[{key:"options",render:e=>c.a.createElement(Xe.a,o()({},e,{topBorder:0!==e.index})),items:l.map(t=>({key:t,render:a=>{if("custom"===t)return c.a.createElement(Xi.a,o()({},a,{renderOrigin:a=>c.a.createElement(Je.a,o()({},a,{title:C.default.formatMessage($i[e.option][t])})),onFocus:()=>{},renderExtension:()=>s()(is,{customFormat:i,onChange:e=>{n(e)},onAccept:()=>{u(t)}}),title:C.default.formatMessage($i[e.option][t])}));{const i="full_date"===e.option?qi({type:t},r):Hi({type:t},r);return c.a.createElement(Je.a,o()({},a,{title:C.default.formatMessage($i[e.option][t]),caption:i}))}},action:()=>{u(t)}}))}]}))}function is(e){const t=Object(Bi.a)(e=>({container:{},label:{color:e.mediumTextColor,fontWeight:$.a.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}}),[]);return s()("div",{style:t.container},void 0,s()("div",{},void 0,s()(pe.a,{isSmall:!0,style:t.label},void 0,s()(S.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"}))),s()(Ri.a,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),s()(Je.a,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:s()(S.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})}))}function ss(e){const t=Object(Bi.a)(()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}),[]),a=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]),i=Object(Di.a)(()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting(),[e.userSettingsStore]),n=Object(Ji.b)();return a.ready?s()("div",{style:t.container},void 0,s()("div",{style:t.controlRow},void 0,s()("div",{style:t.label},void 0,s()(pe.a,{},void 0,s()(S.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})),s()(pe.a,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,s()(S.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"}))),s()(qt.a,{on:i,onClick:()=>{Object(J.createAndCommit)(n,t=>{const a=i?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};Object(V.f)({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:Ui(e.userSettingsStore.getValue()),...a}},transaction:t})})}})),s()("div",{},void 0,s()(i?ns:ds,{userSettingsStore:e.userSettingsStore}))):s()(G.a,{})}function ns(e){const t=Object(Bi.a)(()=>({container:{marginTop:12}}),[]);return s()("div",{style:t.container},void 0,ls.map(t=>s()(os,{userSettingsStore:e.userSettingsStore,option:t})))}function os(e){const t=Object(Bi.a)(e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:$.a.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:$.a.fontSize.UIRegular.desktop}}),[]),a=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]),i=Object(S.useIntl)();if(!a.ready||!a.value)return s()(G.a,{});const n=rs(a.value,i,e.option);return s()("div",{style:t.container},void 0,s()("div",{style:t.option},void 0,C.default.formatMessage(Wi[e.option])),s()("div",{style:t.example},void 0,n))}function rs(e,t,a){if("full_date"===a){return qi(ji(e,a),t)}if("short_date"===a){return Hi(ji(e,a),t)}if("number"===a){return Vi(ji(e,a),t)}if("week_start_on"===a){return function(e){return"sunday"===e?C.default.formatMessage(zi.sunday):"monday"===e?C.default.formatMessage(zi.monday):Object(Qt.f)(e)}(ji(e,a))}return Object(Qt.f)(a)}const ls=["full_date","short_date","number","week_start_on"];function ds(e){return s()("div",{},void 0,ls.map(t=>s()(cs,{userSettingsStore:e.userSettingsStore,option:t})))}function cs(e){const t=Object(S.useIntl)(),a=Object(Di.a)(()=>e.userSettingsStore.state,[e.userSettingsStore]),i=Object(Bi.a)(us,[]);if(!a.ready||!a.value)return s()(G.a,{});const n=Ui(a.value),o=rs(a.value,t,e.option);return c.a.createElement(c.a.Fragment,null,s()(N.a,{size:24}),s()("div",{style:i.container},void 0,s()("div",{style:i.controlRow},void 0,s()("div",{style:i.label},void 0,s()(pe.a,{},void 0,C.default.formatMessage(Wi[e.option])),s()(pe.a,{isSmall:!0,isMultiline:!0,style:i.subtitle},void 0,o)),s()(es,{userSettingsStore:e.userSettingsStore,region:n,option:e.option}))))}function us(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}class ps extends j.a{constructor(...e){super(...e),l()(this,"handleStartOfWeekToggle",()=>{const e=this.getLanguageRegionSettingsState();if(!e)return;const{startDayOfWeek:t}=e;(1===t?V.e:V.d)(this.environment)})}renderComponent(){return ae.a.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return s()(K.a,{},void 0,s()(pe.a,{isSmall:!0,style:{textAlign:"center"}},void 0,s()(S.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})))}renderSettings(){const{currentUserSettingsStore:e}=y.default.state;if(!e)return;const t=this.getLanguageRegionSettingsState();if(!t)return;const{locale:a,startDayOfWeek:i}=t,n="on"===xe.default.getGroup(this.environment,"aloha");return s()(K.a,{},void 0,s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})),s()(xi,{locale:a,userSettingsStore:e}),s()(N.a,{size:24}),n?s()("div",{style:{marginTop:12}},void 0,s()(Gi,{locale:a,userSettingsStore:e}),s()(N.a,{size:24}),s()(Y.a,{large:!0,divider:"full"},void 0,s()(S.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})),s()(ss,{locale:a,userSettingsStore:e}),s()(N.a,{size:24})):s()(fe.a,{onClick:this.handleStartOfWeekToggle,startDayOfWeek:i}))}getLanguageRegionSettingsState(){const{currentUserSettingsStore:e}=y.default.state;if(!e)return;const t=e.getValue();if(!t||!t.settings)return;const{settings:a}=t;return{locale:a.preferred_locale||Ei.a,startDayOfWeek:void 0===a.start_day_of_week?Object(P.H)():a.start_day_of_week}}}var ms=Object(S.injectIntl)(ps),gs=a("ty0h"),hs=a("IoOo"),fs=a("VVh3"),Ms=a("CQbt"),ys=a("3JF5");function vs(e){const{botStore:t}=e,[,,a]=Object(Di.b)(void 0,hi.a),i=Object(Ji.a)(),n=Object(Ji.b)(),r=Object(Di.a)(()=>t.getValue(),[t]),l=null!=r&&r.integration_id?t.getRecordValue({table:Ms.a,id:r.integration_id}):void 0,d=null==l?void 0:l.info.website_url,u=null==l?void 0:l.info.email,p=!Boolean(l);let m;return m=i.isMobile?{menuType:Ye.b.MenuType.ActionSheet}:{menuType:Ye.b.MenuType.Popup},s()(Mi.a,{popupType:i.isMobile?Mi.a.PopupType.SlideUp:Mi.a.PopupType.Popup,buttonPopupStore:a,renderOrigin:e=>c.a.createElement(yi.a,o()({isMobile:i.isMobile},e,{style:{marginLeft:8,marginRight:8}})),render:e=>c.a.createElement(Ye.b,m,s()(Qe.a,{type:Qe.a.Type.Vertical,sections:[{key:"integration options",render:e=>c.a.createElement(Xe.a,e),items:[...d?[{key:"visit developer website",action:()=>{e.close(),Lt.navigateToExternalURL({environment:n,url:d}),v.Kb(n,{href:d,from:"integration-settings"})},render:e=>c.a.createElement(Je.a,o()({title:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.visitDeveloperWebsiteButton.label",defaultMessage:"Visit developer website"})},e))}]:[],...u?[{key:"contact support",action:()=>{e.close(),Lt.navigateToExternalURL({environment:n,url:"mailto:".concat(u)}),v.zb(n,{email:u,from:"integration-settings"})},render:e=>c.a.createElement(Je.a,o()({title:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.contactDeveloperSupportButton.label",defaultMessage:"Contact support",description:"Label for a button that users can click to contact customer support for an integration that's been added to their workspace"})},e))}]:[],...p?[{key:"copy bot token",action:()=>ci.e({environment:n,botStore:t,from:"integration-settings"}),render:e=>c.a.createElement(Je.a,o()({title:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.copyInternalIntegrationTokenButton.label",defaultMessage:"Copy internal integration token"})},e))}]:[],{key:"delete",action:async()=>{if(await ci.a(t)){const e=await g.deleteBot(n,{botId:t.id});"success"===e.type?v.Cb(n,{type:p?"internal":"public"}):f.showError(e)}e.close()},render:e=>c.a.createElement(Je.a,o()({title:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegrationButton.laber",defaultMessage:"Disconnect {integrationName}",values:{integrationName:Object(ys.a)(r)}}),style:{color:ie.g.red}},e))}]}],initialFocus:void 0}))})}var bs=a("bAi4"),Ss=a("prF1"),Cs=a("hy5g");class Ts extends j.a{constructor(...e){super(...e),l()(this,"storeTypes",{requestStore:he.a}),l()(this,"renderResult",(e,t,a)=>s()(fs.a,{loaded:a,spinnerSize:16,showSpinnerTimeout:600},void 0,e&&s()("div",{},void 0,s()(S.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})),t&&this.renderIntegrationTable(t.spaceBotIds),s()("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4}},void 0,s()(ce.a,{title:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.helpButton.caption",defaultMessage:"Learn about managing integrations"}),href:_t.d.publicAPIHelp,analyticsFrom:"api"}),s()(Ss.a,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:_t.d.myIntegrations,external:!0,onClick:()=>{v.Eb(this.environment,{from:"integration-settings",href:_t.d.myIntegrations})}},void 0,s()(Ca.a,{icon:ye.a.alias,isSmall:!0,isLightGray:!0},void 0,s()(S.FormattedMessage,{id:"spaceIntegrationSettings.integrationManagementSiteLink.caption",defaultMessage:"Develop your own integrations",description:"This link, when clicked, take users to a page where they can create their own public or private integration."})))))),l()(this,"fetchUserAndSpaceBots",async({userId:e,spaceId:t})=>{const[a,i]=await Promise.all([Object(ci.c)({environment:this.environment,table:st.a,id:e,type:"guest"}),Object(ci.c)({environment:this.environment,table:ui.a,id:t,type:"guest"})]);return{userBotIds:a.botIds,spaceBotIds:i.botIds}})}renderComponent(){const{spaceStore:e}=this.props,t=Object(Be.getSpaceName)(this.environment,e),{device:a}=this.environment;return s()(K.a,{},void 0,s()(Y.a,{large:!a.isMobile||void 0,divider:a.isMobile?void 0:"full",style:{borderBottom:"none",paddingBottom:4,marginBottom:8}},void 0,s()(S.FormattedMessage,{id:"spaceIntegrationSettings.title",defaultMessage:"All integrations in {workspaceName}",values:{workspaceName:t}})),this.renderRequest())}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return s()(Sa.a,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchUserAndSpaceBots,render:this.renderResult})}renderIntegrationTable(e){const{spaceStore:t}=this.props,a=e.map(e=>{const a=Object(mi.c)(t,{table:pi.a,id:e});return this.renderBotRow(a)}).filter(Qt.a);return c.a.createElement(c.a.Fragment,null,s()(bs.a,{columns:[{key:"integration",header:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.integrationColumn.title",defaultMessage:"Integration"}),style:{width:"40%"}},{key:"added_by",header:s()(S.FormattedMessage,{id:"spaceIntegrationSettings.integrationtable.creationInfoColumn.title",defaultMessage:"Added by"})},{key:"more",header:void 0}],rows:a}),0===a.length?s()("div",{style:{height:120,width:"100%",fontSize:12,color:this.theme.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid ".concat(this.theme.lightDividerColor)}},void 0,s()(S.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyMessage",defaultMessage:"No integration installed"})):void 0)}renderBotRow(e){const t=e.getValue();if(t&&t.alive){const a=at.a.createChildStore(e,{table:st.a,id:t.created_by_id}),i=Object(st.e)(this.props.intl,a.getName()),n=Object(oa.a)(t.created_at,"x").format("LLL"),o=!Boolean(t.integration_id);return{key:e.id,columns:[s()("div",{style:{maxWidth:300,display:"flex"}},void 0,s()(fi.a,{botValue:t,avatarSize:24,style:{marginRight:6}}),o&&s()(Cs.a,{},void 0,s()(S.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.row.internalIntegrationLabel",defaultMessage:"Internal",description:"This label indicates that an integration is internal, as opposed to public."}))),s()(S.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.creationInfoColumn.contents",defaultMessage:"{installerName} on {installedTime}",values:{installerName:i,installedTime:n},description:"Text describing who added an integration to a workspace and when. For example: 'Johnny Appleseed on May 13, 2021'"}),s()(vs,{botStore:e})]}}}}var ks=Object(S.injectIntl)(Ts);class As extends j.a{constructor(...e){super(...e),l()(this,"lastSpaceSettingsStoreState",void 0),l()(this,"lastSpaceSettingsModalStoreOpen",!1),l()(this,"storeTypes",{spaceBasicSettingsStore:B,spaceProfileSettingsStore:x,securitySettingsStore:O,spaceSecuritySamlSettingsStore:_}),l()(this,"renderContent",()=>{const e={profile:this.renderProfile,notifications:this.renderNotifications,settings:this.renderSettings,members:this.renderMembers,plans:this.renderPlans,billing:this.renderBilling,appearance:this.renderAppearance,subscription:this.renderSubscription,credit:this.renderCredit,connected_apps:this.renderConnectedApps,security_saml:this.renderSecuritySaml,language_and_region:this.renderLanguageAndRegion,integrations:this.renderIntegrations};return s()(mt.a,{capture:!0,allowEsc:!0,render:t=>s()(pt.a,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>c.a.createElement(We,o()({sidebar:this.renderSidebar(),sidebarStyle:{width:200}},t),e[U.a.state.currentTab]())})})}),l()(this,"renderProfile",()=>s()(Ne,{isEducationPlan:Me.x($e.default.state.data),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore})),l()(this,"renderLanguageAndRegion",()=>s()(ms,{})),l()(this,"renderNotifications",()=>s()(K.a,{},void 0,s()(ut.a,{}))),l()(this,"renderSettings",()=>s()(dt,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore})),l()(this,"renderMembers",()=>s()(ct.a,{store:this.props.spaceStore})),l()(this,"renderPlans",()=>{const{data:e}=$e.default.state;if(e)return s()(pa,{spaceStore:this.props.spaceStore,data:e})}),l()(this,"renderBilling",()=>{const{data:e}=$e.default.state,t=Me.o(e);return e&&"subscribed_admin"===e.type&&t?s()(La,{spaceStore:this.props.spaceStore,subscriptionData:e,customerData:t}):e&&"unsubscribed_admin"===e.type?s()(Ua,{spaceStore:this.props.spaceStore,data:e}):void 0}),l()(this,"renderAppearance",()=>s()(K.a,{},void 0,s()(gs.a,{}))),l()(this,"renderSubscription",()=>s()(K.a,{},void 0,s()(hs.a,{}))),l()(this,"renderCredit",()=>{const{data:e}=$e.default.state;if(e)return s()(Ha,{data:e})}),l()(this,"renderConnectedApps",()=>s()(ti,{})),l()(this,"renderSecuritySaml",()=>s()(Ci,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,samlConfigStore:this.stores.spaceSecuritySamlSettingsStore})),l()(this,"renderIntegrations",()=>s()(ks,{spaceStore:this.props.spaceStore,userStore:this.props.userStore})),l()(this,"handleModalOpen",()=>{w.e(this.environment)}),l()(this,"handleModalDismiss",()=>this.attemptCloseCurrentTab(()=>{U.a.setState({...U.a.state,open:!1})}))}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:a}=this.stores,i=a.getValueForSpace(t);i&&a.setState(i)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{open:t}=U.a.state,a=U.a.state;this.lastSpaceSettingsModalStoreOpen===t&&p.a.isEqual(this.lastSpaceSettingsStoreState,a)||t&&v.yd(this.environment,{tab:a.currentTab}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=p.a.clone(a)}renderComponent(){const{open:e}=U.a.state;return s()(Z.a,{open:e,innerStyle:{width:960,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:3,maxHeight:695},onOpen:this.handleModalOpen,onDismiss:this.handleModalDismiss,render:this.renderContent,className:ii.Fb})}renderSidebar(){const{spaceStore:e}=this.props,{data:t}=$e.default.state,a=Object(me.h)(this.environment),i="on"===xe.default.getGroup(this.environment,"lion-tamer"),n=Me.y(t);return s()("div",{style:As.sidebarStyle},void 0,s()("div",{},void 0,s()("div",{style:this.getSidebarHeader()},void 0,a&&a.email||s()(S.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Me"})),this.renderTabButton("profile"),this.renderTabButton("notifications"),this.renderTabButton("connected_apps"),i&&this.renderTabButton("language_and_region"),this.renderTabButton("appearance"),t&&t.creditEnabled&&this.renderTabButton("credit"),s()(N.a,{size:18,isHidden:!0}),s()("div",{style:this.getSidebarHeader()},void 0,s()(S.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})),this.renderTabButton("settings"),e.canRead()&&this.renderTabButton("members"),e.canRead()&&this.renderTabButton("plans"),e.canAdmin()&&t&&("subscribed_admin"===t.type||"unsubscribed_admin"===t.type)&&!n&&this.renderTabButton("billing"),n&&this.renderTabButton("subscription"),e.canAdmin()&&this.renderTabButton("security_saml"),e.canAdmin()&&this.renderTabButton("integrations"),e.canRead()&&s()(Ti.a,{source:"settings"})))}renderTabButton(e){const t=U.a.state.currentTab===e,a=U.b[e](this.environment),i=U.c[e]();return s()(ai.a,{hovered:t,style:{display:"flex",alignItems:"center",padding:"5px 15px",...t&&{fontWeight:$.a.fontWeight.semibold}},onClick:t=>{this.attemptCloseCurrentTab(()=>{U.a.setState({...U.a.state,currentTab:e}),v.if(this.environment,{tab:e})})}},void 0,s()("div",{style:this.getIconWrapStyle()},void 0,a),s()(pe.a,{},void 0,i))}async attemptCloseCurrentTab(e){const{spaceStore:t}=this.props,{spaceProfileSettingsStore:a}=this.stores,{currentUserStore:i,currentUserSettingsStore:n}=y.default.state;if(!i||!n)throw new Error("No user or settings store.");const o=s()(S.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),r=s()(S.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes",description:"Label for button that appears below the question, 'Your changes have not been saved. Save changes?' to confirm that the user would like to save their changes."}),l=s()(S.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No",description:"Label for button that appears below the question, 'Your changes have not been saved. Save changes?' to not save changes and return to settings menu."}),{currentTab:d}=U.a.state;if("profile"===d){if(!p.a.isEqual(a.state,a.getValueForUser(i,n))){const{givenName:t,familyName:i,profilePhoto:r,startDayOfWeek:l}=a.state;return f.showDialog({message:o,showCancel:!0,keepFocus:!0,items:[{label:s()(S.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{J.createAndCommit(this.environment,e=>{const{currentUserStore:a}=y.default.state;if(a&&k({userStore:a,data:{givenName:t,familyName:i,profilePhoto:r},transaction:e}),n){n.getSettings().start_day_of_week!==l&&Object(V.f)({userSettingsStore:n,data:{start_day_of_week:l},transaction:e})}}),e()}}],handleCancel:()=>{e()}}),!0}e()}else if("settings"===d&&t.canEdit()){const{spaceBasicSettingsStore:a}=this.stores;if(!p.a.isEqual(a.state,a.getValueForSpace(t))){if(await f.confirmUserAction({message:o,acceptLabel:r,cancelLabel:l})){if(!(await A.b({environment:this.environment,spaceId:t.id,spaceBasicSettingsStore:a})))return!1;A.C({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:a}),e()}else e();return!0}e()}else if("security_saml"===d&&t.canAdmin()){const{securitySettingsStore:a,spaceSecuritySamlSettingsStore:i}=this.stores,s=!p.a.isEqual(a.state,a.getValueForSpace(t)),n=await i.getValueForSpace(this.environment,t),d=(i.state.emailDomains.length>0||"enterprise"===Me.h(this.environment))&&(!i.state.id||i.state.id===t.id)&&!p.a.isEqual(i.state,n);if(s||d){if(await f.confirmUserAction({message:o,acceptLabel:r,cancelLabel:l})){const{disablePublicAccess:t,disableGuests:n,disableMoveToSpace:o,disableExport:r,disableSpacePageEdits:l,disablePublicAccessRequests:c}=a.state;if(s&&J.createAndCommit(this.environment,e=>{A.A({environment:this.environment,disablePublicAccess:t,disableGuests:n,disableMoveToSpace:o,disableExport:r,disableSpacePageEdits:l,disablePublicAccessRequests:c,transaction:e,spaceStore:this.props.spaceStore})}),d){const{state:e}=i,t=await g.adminSamlConfigForSpace(this.environment,{spaceId:this.props.spaceStore.id,status:e.status,useMetadataUrl:e.useMetadataUrl,idpMetadataUrl:e.idpMetadataUrl,idpMetadata:e.idpMetadata,createAccount:e.createAccount});"failed"===t.type&&f.showError(t)}e()}else e();return!0}e()}else e();return!1}getSidebarHeader(){return{letterSpacing:"0.03em",textTransform:"uppercase",fontSize:11,lineHeight:1,marginBottom:1,color:this.theme.mediumTextColor,fontWeight:$.a.fontWeight.medium,padding:"5px 15px",textOverflow:"ellipsis",overflow:"hidden"}}getIconWrapStyle(){return{width:20,height:20,marginRight:8,color:this.theme.regularIconColor,fill:this.theme.regularIconColor}}}l()(As,"theme",void 0),l()(As,"sidebarStyle",{display:"flex",flexDirection:"column",height:"100%",paddingTop:10,paddingBottom:12,justifyContent:"space-between"});t.default=As},KEFq:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("wldR"),c=a("w4oV"),u=a("/6eU"),p=a("MeYt"),m=a("mF3+"),g=a("gyLq"),h=a("Sb6f"),f=a("zmp8"),M=a("yNyh"),y=a("d9nj"),v=a("Ng05"),b=a("pVnL"),S=a.n(b),C=a("J9+s"),T=a("5zFd"),k=a("SR/M"),A=a("IULH");class w extends d.a{renderComponent(){const{intl:e,question:t}=this.props,a={setup_trial:s()(C.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),live_demo:s()(C.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:s()(C.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:s()(C.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},i={menuTitle:e.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_trial","live_demo","plan_help","other"],width:280,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>l.a.createElement(k.a,S()({title:a[e.key]},e)),renderOrigin:e=>s()(A.a,{isLarge:!0,onClick:t=>e.onClick(t),style:{...this.getInputStyle(),...this.props.invalid&&{border:"1px solid ".concat(f.g.red)}}},void 0,s()("div",{style:{display:"flex",alignItems:"center",color:t?this.theme.regularTextColor:this.theme.lightTextColor}},void 0,t?a[t]:s()(C.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})),m.a.expand({width:10,fill:this.theme.lightIconColor}))};return l.a.createElement(T.a,S()({key:"onboarding"},i))}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:31,...e.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:"0 0 0 1px ".concat(this.theme.outlineButtonBorder),background:this.theme.buttonBackground}}}var I=Object(C.injectIntl)(w),P=a("LEzx");class F extends P.a{getInitialState(){return{step:"initial"}}}var x=F,E=a("5Nka"),B=a("NOLh"),D=a("VyA+"),O=a("LvDl"),R=a.n(O),L=a("vl8/"),_=a("y6Dp"),U=a("GVKY");const j=Object(C.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class N extends d.a{constructor(...e){super(...e),o()(this,"storeTypes",{store:x}),o()(this,"renderMenu",()=>s()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),s()(g.a,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep()))),o()(this,"renderInitial",()=>{const{invalidField:e}=this.stores.store.state;if(c.a.state.open)return s()("div",{style:{...this.getSlideUpStyle(),padding:20}},void 0,m.a.speechBubbleThin({width:"100%",height:24}),s()("div",{style:{fontSize:14,fontWeight:h.a.fontWeight.semibold,paddingTop:6,paddingBottom:4}},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})),s()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"}},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})),s()("div",{style:{...this.getLabelStyle(),marginTop:24}},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})),s()(M.b,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...this.getInputStyle(),..."name"===e&&this.getInvalidInputStyle()},onChange:e=>{c.a.setState({...c.a.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value})}}),s()("div",{style:this.getLabelStyle()},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})),s()(M.b,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...this.getInputStyle(),..."email"===e&&this.getInvalidInputStyle()},onChange:e=>{c.a.setState({...c.a.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value})}}),s()("div",{style:this.getLabelStyle()},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})),s()(g.a,{},void 0,this.getCompanySizeButtonData().map(({type:e,message:t,style:a})=>s()(y.a,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...this.stores.store.state.companySize===e&&this.getSelectedButtonStyle(),...a},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:e})}},void 0,t))),s()("div",{style:this.getLabelStyle()},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})),s()(I,{question:this.stores.store.state.question,invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"})}}),s()(M.b,{textarea:!0,style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:L.default.formatMessage(j.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value})}}))}),o()(this,"renderCancel",()=>s()(p.a,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,m.a.closeSmall({width:14,fill:this.theme.mediumTextColor}))),o()(this,"renderThanks",()=>s()("div",{},void 0,s()("img",{style:{width:165,height:80},src:E.a.images.feedbackThankYouPng}),s()("div",{style:this.getThanksHeaderStyle()},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."})))),o()(this,"handleCancel",()=>{c.a.setState({open:!1})})}renderComponent(){return s()(u.a,{preventHideChildrenWhileOpening:!0,open:c.a.state.open,render:this.renderMenu,onDismiss:this.handleCancel})}renderStep(){const{step:e}=this.stores.store.state;return l.a.createElement(l.a.Fragment,null,s()(B.a,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>s()(D.a,{capture:!0,onBackspace:R.a.identity,onLeft:R.a.identity,onRight:R.a.identity,onSelectAll:R.a.identity,onRedo:R.a.identity,onUndo:R.a.identity,onCut:R.a.identity,onCopy:R.a.identity,onPaste:R.a.identity,onKeypress:R.a.identity,onDelete:R.a.identity,onTab:R.a.identity},void 0,this.renderInitial())}),s()(B.a,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),s()(B.a,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>s()(v.a,{isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?void 0:t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),c.a.state.open&&_.Yb(this.environment,{email:c.a.state.email,name:c.a.state.name,...this.stores.store.state}),R.a.delay(()=>{c.a.reset(),R.a.delay(()=>{this.stores.store.reset()},1e3)},2e3)}},void 0,s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"}))}))}getName(){if(c.a.state.open)return this.stores.store.state.name||c.a.state.name}getEmail(){if(c.a.state.open)return this.stores.store.state.email||c.a.state.email}getInvalidField(){const e=this.getEmail(),t=this.getName(),{question:a,companySize:i}=this.stores.store.state;return t?e&&U.b(e,"email")?i?a?void 0:"question":"company_size":"email":"name"}getCompanySizeButtonData(){return[{type:"1_100",message:s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:s()(C.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:h.a.fontWeight.semibold,fontSize:14}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:17,fontSize:12,color:this.theme.mediumTextColor,fontWeight:h.a.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getInputStyle(){return{backgroundColor:this.theme.whiteButtonBackground,height:31}}getInvalidInputStyle(){return{border:"1px solid ".concat(f.g.red)}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:f.g.blue,border:"1px solid ".concat(f.g.blue)}}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}t.default=N},MZdi:function(e,t,a){"use strict";var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI"),a("wldR")),l=a("J9+s"),d=a("yNyh"),c=a("vl8/"),u=a("IULH"),p=a("UWX6"),m=a("Pl3d"),g=a("bkwR"),h=a("LEzx");class f extends h.a{getInitialState(){return{temporaryCouponCode:void 0,couponCodeInput:void 0,error:void 0}}}var M=f,y=a("VVh3"),v=a("aEEb"),b=a("zmp8"),S=a("VhAz"),C=a("y6Dp");const T=Object(l.defineMessages)({couponCodePlaceholder:{id:"couponEntryInput.placeholder",defaultMessage:"Coupon code"},couponCodeNotFoundError:{id:"couponEntryInput.error.noPromo",defaultMessage:"Invalid coupon code"}});class k extends r.a{constructor(...e){super(...e),o()(this,"storeTypes",{couponCode:M})}didMount(){const e=Object(p.a)(this.environment.currentUser.id);e&&this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e})}renderComponent(){return s()("div",{style:this.getContainerStyle()},void 0,s()("div",{style:{display:"flex",flexDirection:"row"}},void 0,s()(d.b,{textarea:!1,value:this.stores.couponCode.state.couponCodeInput,placeholder:c.default.formatMessage(T.couponCodePlaceholder),onSubmit:()=>this.checkCouponCode(),onChange:e=>{this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:e.target.value})},style:{height:32,paddingLeft:10,marginRight:this.props.hideApply?0:10}}),s()(m.a,{request:this.stores.couponCode.state.temporaryCouponCode||null,performRequest:async e=>{if(e)return this.applyCouponCode(e)},render:(e,t,a)=>{if(!this.props.hideApply)return s()(u.a,{isLarge:!1,onClick:()=>this.checkCouponCode()},void 0,s()(y.a,{loaded:a,spinnerSize:16,showSpinnerTimeout:500},void 0,s()(l.FormattedMessage,{id:"couponEntryInput.button.apply",defaultMessage:"Apply"})))}})),this.stores.couponCode.state.error&&s()(v.a,{isMultiline:!1,style:{paddingTop:8,color:b.g.red}},void 0,this.stores.couponCode.state.error))}checkCouponCode(){const e=this.stores.couponCode.state.couponCodeInput;e&&(this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e}),this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:""}))}async applyCouponCode(e){const t=await g.getPromoCode(this.environment,{code:e});if("success"===t.type){var a;if(t.data.promo)return null!==(a=t.data.promo.applies_to)&&void 0!==a&&a.length&&!t.data.promo.applies_to.includes(this.props.plan)?void this.showError(e):(this.stores.couponCode.setState({...this.stores.couponCode.state,error:void 0}),this.props.handlePromo(t.data.promo),C.eb(this.environment,{code:e,valid:!0,id:t.data.promo.id}),t.data.promo);this.showError(e)}else if("failed"===t.type){const e=t.error.name;this.stores.couponCode.setState({...this.stores.couponCode.state,error:e})}else Object(S.f)(t)}showError(e){this.stores.couponCode.setState({...this.stores.couponCode.state,error:c.default.formatMessage(T.couponCodeNotFoundError)}),C.eb(this.environment,{code:e,valid:!1,id:void 0})}getContainerStyle(){return{display:"flex",flexDirection:"column",...this.props.style?this.props.style:void 0}}}t.a=k},NcKA:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("q1tI")),c=a.n(d),u=a("wldR"),p=a("RuPz"),m=a("Ripq"),g=a("gbGO"),h=a("WgIs"),f=a("2Y+N"),M=a("HTHG"),y=a("SR/M"),v=a("Oy36"),b=a("i3uR"),S=a("wXH4"),C=a("frzs"),T=a("QcDD"),k=a("nPEg"),A=a("J9+s"),w=a("qX+M");class I extends u.a{constructor(...e){super(...e),l()(this,"renderPopup",()=>{const{device:e}=this.environment,t=p.a.state;if(!t.open)return;const{currentUserRootStore:a}=T.default.state;if(!a)return;const i=M.k(a),n=[];for(const d of i){const a=d.getSpaceStore();if(a){const i=Object(w.getSpaceName)(this.environment,a),r=Object(w.getSpaceIcon)(this.environment,a);n.push({key:d.id,action:async()=>{await m.c({environment:this.environment,store:t.store,spaceStore:a,spaceViewStore:d,isPrivate:!0})},render:t=>c.a.createElement(y.a,s()({title:i,icon:o()(v.a,{icon:r,isEmptyPage:!1,title:i,size:e.isMobile?24:20,disabled:!0})},t))})}}const r=[{key:"spaces",render:t=>c.a.createElement(f.a,s()({title:e.isMobile?void 0:o()(A.FormattedMessage,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),isTitleUppercase:!0},t)),items:n},{key:"logout",render:e=>c.a.createElement(f.a,s()({},e,{topBorder:!0})),items:[{key:"logout",action:()=>C.logout(this.environment),render:e=>{const{currentUserStore:t}=T.default.state;let a="";if(t){const e=t.getValue();e&&(a=e.email)}return c.a.createElement(y.a,s()({caption:o()(A.FormattedMessage,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:a}})},e))}}]}];let l;return l=e.isMobile?{menuType:g.b.MenuType.Modal,title:o()(A.FormattedMessage,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:o()(k.CancelMenuText,{}),onClickRight:m.a}:{menuType:g.b.MenuType.Popup},c.a.createElement(g.b,l,o()(h.a,{type:h.a.Type.Vertical,sections:r,initialFocus:1}))})}renderComponent(){const{device:e}=this.environment;return o()(S.c,{popupType:e.isMobile?b.a.PopupType.SlideUp:b.a.PopupType.Popup,open:p.a.state.open,render:this.renderPopup,originGap:8,onDismiss:m.a,originRect:p.a.state.originRect,enableRounding:!0})}}t.default=I},P9PB:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("q1tI")),c=a.n(d),u=a("LvDl"),p=a.n(u),m=a("wldR"),g=a("D2XV"),h=(a("UNSI"),a("DUpR"),a("BFWj")),f=a.n(h),M=a("mKX5"),y=a("5zFd"),v=a("lEhh"),b=a("hfHo");const S=p.a.memoize(e=>({"Africa/Abidjan":e.formatMessage({id:"allTimeZones.Africa/Abidjan",defaultMessage:"Africa/Abidjan"}),"Africa/Accra":e.formatMessage({id:"allTimeZones.Africa/Accra",defaultMessage:"Africa/Accra"}),"Africa/Addis_Ababa":e.formatMessage({id:"allTimeZones.Africa/Addis_Ababa",defaultMessage:"Africa/Addis_Ababa"}),"Africa/Algiers":e.formatMessage({id:"allTimeZones.Africa/Algiers",defaultMessage:"Africa/Algiers"}),"Africa/Asmara":e.formatMessage({id:"allTimeZones.Africa/Asmara",defaultMessage:"Africa/Asmara"}),"Africa/Asmera":e.formatMessage({id:"allTimeZones.Africa/Asmera",defaultMessage:"Africa/Asmera"}),"Africa/Bamako":e.formatMessage({id:"allTimeZones.Africa/Bamako",defaultMessage:"Africa/Bamako"}),"Africa/Bangui":e.formatMessage({id:"allTimeZones.Africa/Bangui",defaultMessage:"Africa/Bangui"}),"Africa/Banjul":e.formatMessage({id:"allTimeZones.Africa/Banjul",defaultMessage:"Africa/Banjul"}),"Africa/Bissau":e.formatMessage({id:"allTimeZones.Africa/Bissau",defaultMessage:"Africa/Bissau"}),"Africa/Blantyre":e.formatMessage({id:"allTimeZones.Africa/Blantyre",defaultMessage:"Africa/Blantyre"}),"Africa/Brazzaville":e.formatMessage({id:"allTimeZones.Africa/Brazzaville",defaultMessage:"Africa/Brazzaville"}),"Africa/Bujumbura":e.formatMessage({id:"allTimeZones.Africa/Bujumbura",defaultMessage:"Africa/Bujumbura"}),"Africa/Cairo":e.formatMessage({id:"allTimeZones.Africa/Cairo",defaultMessage:"Africa/Cairo"}),"Africa/Casablanca":e.formatMessage({id:"allTimeZones.Africa/Casablanca",defaultMessage:"Africa/Casablanca"}),"Africa/Ceuta":e.formatMessage({id:"allTimeZones.Africa/Ceuta",defaultMessage:"Africa/Ceuta"}),"Africa/Conakry":e.formatMessage({id:"allTimeZones.Africa/Conakry",defaultMessage:"Africa/Conakry"}),"Africa/Dakar":e.formatMessage({id:"allTimeZones.Africa/Dakar",defaultMessage:"Africa/Dakar"}),"Africa/Dar_es_Salaam":e.formatMessage({id:"allTimeZones.Africa/Dar_es_Salaam",defaultMessage:"Africa/Dar_es_Salaam"}),"Africa/Djibouti":e.formatMessage({id:"allTimeZones.Africa/Djibouti",defaultMessage:"Africa/Djibouti"}),"Africa/Douala":e.formatMessage({id:"allTimeZones.Africa/Douala",defaultMessage:"Africa/Douala"}),"Africa/El_Aaiun":e.formatMessage({id:"allTimeZones.Africa/El_Aaiun",defaultMessage:"Africa/El_Aaiun"}),"Africa/Freetown":e.formatMessage({id:"allTimeZones.Africa/Freetown",defaultMessage:"Africa/Freetown"}),"Africa/Gaborone":e.formatMessage({id:"allTimeZones.Africa/Gaborone",defaultMessage:"Africa/Gaborone"}),"Africa/Harare":e.formatMessage({id:"allTimeZones.Africa/Harare",defaultMessage:"Africa/Harare"}),"Africa/Johannesburg":e.formatMessage({id:"allTimeZones.Africa/Johannesburg",defaultMessage:"Africa/Johannesburg"}),"Africa/Juba":e.formatMessage({id:"allTimeZones.Africa/Juba",defaultMessage:"Africa/Juba"}),"Africa/Kampala":e.formatMessage({id:"allTimeZones.Africa/Kampala",defaultMessage:"Africa/Kampala"}),"Africa/Khartoum":e.formatMessage({id:"allTimeZones.Africa/Khartoum",defaultMessage:"Africa/Khartoum"}),"Africa/Kigali":e.formatMessage({id:"allTimeZones.Africa/Kigali",defaultMessage:"Africa/Kigali"}),"Africa/Kinshasa":e.formatMessage({id:"allTimeZones.Africa/Kinshasa",defaultMessage:"Africa/Kinshasa"}),"Africa/Lagos":e.formatMessage({id:"allTimeZones.Africa/Lagos",defaultMessage:"Africa/Lagos"}),"Africa/Libreville":e.formatMessage({id:"allTimeZones.Africa/Libreville",defaultMessage:"Africa/Libreville"}),"Africa/Lome":e.formatMessage({id:"allTimeZones.Africa/Lome",defaultMessage:"Africa/Lome"}),"Africa/Luanda":e.formatMessage({id:"allTimeZones.Africa/Luanda",defaultMessage:"Africa/Luanda"}),"Africa/Lubumbashi":e.formatMessage({id:"allTimeZones.Africa/Lubumbashi",defaultMessage:"Africa/Lubumbashi"}),"Africa/Lusaka":e.formatMessage({id:"allTimeZones.Africa/Lusaka",defaultMessage:"Africa/Lusaka"}),"Africa/Malabo":e.formatMessage({id:"allTimeZones.Africa/Malabo",defaultMessage:"Africa/Malabo"}),"Africa/Maputo":e.formatMessage({id:"allTimeZones.Africa/Maputo",defaultMessage:"Africa/Maputo"}),"Africa/Maseru":e.formatMessage({id:"allTimeZones.Africa/Maseru",defaultMessage:"Africa/Maseru"}),"Africa/Mbabane":e.formatMessage({id:"allTimeZones.Africa/Mbabane",defaultMessage:"Africa/Mbabane"}),"Africa/Mogadishu":e.formatMessage({id:"allTimeZones.Africa/Mogadishu",defaultMessage:"Africa/Mogadishu"}),"Africa/Monrovia":e.formatMessage({id:"allTimeZones.Africa/Monrovia",defaultMessage:"Africa/Monrovia"}),"Africa/Nairobi":e.formatMessage({id:"allTimeZones.Africa/Nairobi",defaultMessage:"Africa/Nairobi"}),"Africa/Ndjamena":e.formatMessage({id:"allTimeZones.Africa/Ndjamena",defaultMessage:"Africa/Ndjamena"}),"Africa/Niamey":e.formatMessage({id:"allTimeZones.Africa/Niamey",defaultMessage:"Africa/Niamey"}),"Africa/Nouakchott":e.formatMessage({id:"allTimeZones.Africa/Nouakchott",defaultMessage:"Africa/Nouakchott"}),"Africa/Ouagadougou":e.formatMessage({id:"allTimeZones.Africa/Ouagadougou",defaultMessage:"Africa/Ouagadougou"}),"Africa/Porto-Novo":e.formatMessage({id:"allTimeZones.Africa/Porto-Novo",defaultMessage:"Africa/Porto-Novo"}),"Africa/Sao_Tome":e.formatMessage({id:"allTimeZones.Africa/Sao_Tome",defaultMessage:"Africa/Sao_Tome"}),"Africa/Timbuktu":e.formatMessage({id:"allTimeZones.Africa/Timbuktu",defaultMessage:"Africa/Timbuktu"}),"Africa/Tripoli":e.formatMessage({id:"allTimeZones.Africa/Tripoli",defaultMessage:"Africa/Tripoli"}),"Africa/Tunis":e.formatMessage({id:"allTimeZones.Africa/Tunis",defaultMessage:"Africa/Tunis"}),"Africa/Windhoek":e.formatMessage({id:"allTimeZones.Africa/Windhoek",defaultMessage:"Africa/Windhoek"}),"America/Adak":e.formatMessage({id:"allTimeZones.America/Adak",defaultMessage:"America/Adak"}),"America/Anchorage":e.formatMessage({id:"allTimeZones.America/Anchorage",defaultMessage:"America/Anchorage"}),"America/Anguilla":e.formatMessage({id:"allTimeZones.America/Anguilla",defaultMessage:"America/Anguilla"}),"America/Antigua":e.formatMessage({id:"allTimeZones.America/Antigua",defaultMessage:"America/Antigua"}),"America/Araguaina":e.formatMessage({id:"allTimeZones.America/Araguaina",defaultMessage:"America/Araguaina"}),"America/Argentina/Buenos_Aires":e.formatMessage({id:"allTimeZones.America/Argentina/Buenos_Aires",defaultMessage:"America/Argentina/Buenos_Aires"}),"America/Argentina/Catamarca":e.formatMessage({id:"allTimeZones.America/Argentina/Catamarca",defaultMessage:"America/Argentina/Catamarca"}),"America/Argentina/ComodRivadavia":e.formatMessage({id:"allTimeZones.America/Argentina/ComodRivadavia",defaultMessage:"America/Argentina/ComodRivadavia"}),"America/Argentina/Cordoba":e.formatMessage({id:"allTimeZones.America/Argentina/Cordoba",defaultMessage:"America/Argentina/Cordoba"}),"America/Argentina/Jujuy":e.formatMessage({id:"allTimeZones.America/Argentina/Jujuy",defaultMessage:"America/Argentina/Jujuy"}),"America/Argentina/La_Rioja":e.formatMessage({id:"allTimeZones.America/Argentina/La_Rioja",defaultMessage:"America/Argentina/La_Rioja"}),"America/Argentina/Mendoza":e.formatMessage({id:"allTimeZones.America/Argentina/Mendoza",defaultMessage:"America/Argentina/Mendoza"}),"America/Argentina/Rio_Gallegos":e.formatMessage({id:"allTimeZones.America/Argentina/Rio_Gallegos",defaultMessage:"America/Argentina/Rio_Gallegos"}),"America/Argentina/Salta":e.formatMessage({id:"allTimeZones.America/Argentina/Salta",defaultMessage:"America/Argentina/Salta"}),"America/Argentina/San_Juan":e.formatMessage({id:"allTimeZones.America/Argentina/San_Juan",defaultMessage:"America/Argentina/San_Juan"}),"America/Argentina/San_Luis":e.formatMessage({id:"allTimeZones.America/Argentina/San_Luis",defaultMessage:"America/Argentina/San_Luis"}),"America/Argentina/Tucuman":e.formatMessage({id:"allTimeZones.America/Argentina/Tucuman",defaultMessage:"America/Argentina/Tucuman"}),"America/Argentina/Ushuaia":e.formatMessage({id:"allTimeZones.America/Argentina/Ushuaia",defaultMessage:"America/Argentina/Ushuaia"}),"America/Aruba":e.formatMessage({id:"allTimeZones.America/Aruba",defaultMessage:"America/Aruba"}),"America/Asuncion":e.formatMessage({id:"allTimeZones.America/Asuncion",defaultMessage:"America/Asuncion"}),"America/Atikokan":e.formatMessage({id:"allTimeZones.America/Atikokan",defaultMessage:"America/Atikokan"}),"America/Atka":e.formatMessage({id:"allTimeZones.America/Atka",defaultMessage:"America/Atka"}),"America/Bahia":e.formatMessage({id:"allTimeZones.America/Bahia",defaultMessage:"America/Bahia"}),"America/Bahia_Banderas":e.formatMessage({id:"allTimeZones.America/Bahia_Banderas",defaultMessage:"America/Bahia_Banderas"}),"America/Barbados":e.formatMessage({id:"allTimeZones.America/Barbados",defaultMessage:"America/Barbados"}),"America/Belem":e.formatMessage({id:"allTimeZones.America/Belem",defaultMessage:"America/Belem"}),"America/Belize":e.formatMessage({id:"allTimeZones.America/Belize",defaultMessage:"America/Belize"}),"America/Blanc-Sablon":e.formatMessage({id:"allTimeZones.America/Blanc-Sablon",defaultMessage:"America/Blanc-Sablon"}),"America/Boa_Vista":e.formatMessage({id:"allTimeZones.America/Boa_Vista",defaultMessage:"America/Boa_Vista"}),"America/Bogota":e.formatMessage({id:"allTimeZones.America/Bogota",defaultMessage:"America/Bogota"}),"America/Boise":e.formatMessage({id:"allTimeZones.America/Boise",defaultMessage:"America/Boise"}),"America/Buenos_Aires":e.formatMessage({id:"allTimeZones.America/Buenos_Aires",defaultMessage:"America/Buenos_Aires"}),"America/Cambridge_Bay":e.formatMessage({id:"allTimeZones.America/Cambridge_Bay",defaultMessage:"America/Cambridge_Bay"}),"America/Campo_Grande":e.formatMessage({id:"allTimeZones.America/Campo_Grande",defaultMessage:"America/Campo_Grande"}),"America/Cancun":e.formatMessage({id:"allTimeZones.America/Cancun",defaultMessage:"America/Cancun"}),"America/Caracas":e.formatMessage({id:"allTimeZones.America/Caracas",defaultMessage:"America/Caracas"}),"America/Catamarca":e.formatMessage({id:"allTimeZones.America/Catamarca",defaultMessage:"America/Catamarca"}),"America/Cayenne":e.formatMessage({id:"allTimeZones.America/Cayenne",defaultMessage:"America/Cayenne"}),"America/Cayman":e.formatMessage({id:"allTimeZones.America/Cayman",defaultMessage:"America/Cayman"}),"America/Chicago":e.formatMessage({id:"allTimeZones.America/Chicago",defaultMessage:"America/Chicago"}),"America/Chihuahua":e.formatMessage({id:"allTimeZones.America/Chihuahua",defaultMessage:"America/Chihuahua"}),"America/Coral_Harbour":e.formatMessage({id:"allTimeZones.America/Coral_Harbour",defaultMessage:"America/Coral_Harbour"}),"America/Cordoba":e.formatMessage({id:"allTimeZones.America/Cordoba",defaultMessage:"America/Cordoba"}),"America/Costa_Rica":e.formatMessage({id:"allTimeZones.America/Costa_Rica",defaultMessage:"America/Costa_Rica"}),"America/Creston":e.formatMessage({id:"allTimeZones.America/Creston",defaultMessage:"America/Creston"}),"America/Cuiaba":e.formatMessage({id:"allTimeZones.America/Cuiaba",defaultMessage:"America/Cuiaba"}),"America/Curacao":e.formatMessage({id:"allTimeZones.America/Curacao",defaultMessage:"America/Curacao"}),"America/Danmarkshavn":e.formatMessage({id:"allTimeZones.America/Danmarkshavn",defaultMessage:"America/Danmarkshavn"}),"America/Dawson":e.formatMessage({id:"allTimeZones.America/Dawson",defaultMessage:"America/Dawson"}),"America/Dawson_Creek":e.formatMessage({id:"allTimeZones.America/Dawson_Creek",defaultMessage:"America/Dawson_Creek"}),"America/Denver":e.formatMessage({id:"allTimeZones.America/Denver",defaultMessage:"America/Denver"}),"America/Detroit":e.formatMessage({id:"allTimeZones.America/Detroit",defaultMessage:"America/Detroit"}),"America/Dominica":e.formatMessage({id:"allTimeZones.America/Dominica",defaultMessage:"America/Dominica"}),"America/Edmonton":e.formatMessage({id:"allTimeZones.America/Edmonton",defaultMessage:"America/Edmonton"}),"America/Eirunepe":e.formatMessage({id:"allTimeZones.America/Eirunepe",defaultMessage:"America/Eirunepe"}),"America/El_Salvador":e.formatMessage({id:"allTimeZones.America/El_Salvador",defaultMessage:"America/El_Salvador"}),"America/Ensenada":e.formatMessage({id:"allTimeZones.America/Ensenada",defaultMessage:"America/Ensenada"}),"America/Fort_Nelson":e.formatMessage({id:"allTimeZones.America/Fort_Nelson",defaultMessage:"America/Fort_Nelson"}),"America/Fort_Wayne":e.formatMessage({id:"allTimeZones.America/Fort_Wayne",defaultMessage:"America/Fort_Wayne"}),"America/Fortaleza":e.formatMessage({id:"allTimeZones.America/Fortaleza",defaultMessage:"America/Fortaleza"}),"America/Glace_Bay":e.formatMessage({id:"allTimeZones.America/Glace_Bay",defaultMessage:"America/Glace_Bay"}),"America/Godthab":e.formatMessage({id:"allTimeZones.America/Godthab",defaultMessage:"America/Godthab"}),"America/Goose_Bay":e.formatMessage({id:"allTimeZones.America/Goose_Bay",defaultMessage:"America/Goose_Bay"}),"America/Grand_Turk":e.formatMessage({id:"allTimeZones.America/Grand_Turk",defaultMessage:"America/Grand_Turk"}),"America/Grenada":e.formatMessage({id:"allTimeZones.America/Grenada",defaultMessage:"America/Grenada"}),"America/Guadeloupe":e.formatMessage({id:"allTimeZones.America/Guadeloupe",defaultMessage:"America/Guadeloupe"}),"America/Guatemala":e.formatMessage({id:"allTimeZones.America/Guatemala",defaultMessage:"America/Guatemala"}),"America/Guayaquil":e.formatMessage({id:"allTimeZones.America/Guayaquil",defaultMessage:"America/Guayaquil"}),"America/Guyana":e.formatMessage({id:"allTimeZones.America/Guyana",defaultMessage:"America/Guyana"}),"America/Halifax":e.formatMessage({id:"allTimeZones.America/Halifax",defaultMessage:"America/Halifax"}),"America/Havana":e.formatMessage({id:"allTimeZones.America/Havana",defaultMessage:"America/Havana"}),"America/Hermosillo":e.formatMessage({id:"allTimeZones.America/Hermosillo",defaultMessage:"America/Hermosillo"}),"America/Indiana/Indianapolis":e.formatMessage({id:"allTimeZones.America/Indiana/Indianapolis",defaultMessage:"America/Indiana/Indianapolis"}),"America/Indiana/Knox":e.formatMessage({id:"allTimeZones.America/Indiana/Knox",defaultMessage:"America/Indiana/Knox"}),"America/Indiana/Marengo":e.formatMessage({id:"allTimeZones.America/Indiana/Marengo",defaultMessage:"America/Indiana/Marengo"}),"America/Indiana/Petersburg":e.formatMessage({id:"allTimeZones.America/Indiana/Petersburg",defaultMessage:"America/Indiana/Petersburg"}),"America/Indiana/Tell_City":e.formatMessage({id:"allTimeZones.America/Indiana/Tell_City",defaultMessage:"America/Indiana/Tell_City"}),"America/Indiana/Vevay":e.formatMessage({id:"allTimeZones.America/Indiana/Vevay",defaultMessage:"America/Indiana/Vevay"}),"America/Indiana/Vincennes":e.formatMessage({id:"allTimeZones.America/Indiana/Vincennes",defaultMessage:"America/Indiana/Vincennes"}),"America/Indiana/Winamac":e.formatMessage({id:"allTimeZones.America/Indiana/Winamac",defaultMessage:"America/Indiana/Winamac"}),"America/Indianapolis":e.formatMessage({id:"allTimeZones.America/Indianapolis",defaultMessage:"America/Indianapolis"}),"America/Inuvik":e.formatMessage({id:"allTimeZones.America/Inuvik",defaultMessage:"America/Inuvik"}),"America/Iqaluit":e.formatMessage({id:"allTimeZones.America/Iqaluit",defaultMessage:"America/Iqaluit"}),"America/Jamaica":e.formatMessage({id:"allTimeZones.America/Jamaica",defaultMessage:"America/Jamaica"}),"America/Jujuy":e.formatMessage({id:"allTimeZones.America/Jujuy",defaultMessage:"America/Jujuy"}),"America/Juneau":e.formatMessage({id:"allTimeZones.America/Juneau",defaultMessage:"America/Juneau"}),"America/Kentucky/Louisville":e.formatMessage({id:"allTimeZones.America/Kentucky/Louisville",defaultMessage:"America/Kentucky/Louisville"}),"America/Kentucky/Monticello":e.formatMessage({id:"allTimeZones.America/Kentucky/Monticello",defaultMessage:"America/Kentucky/Monticello"}),"America/Knox_IN":e.formatMessage({id:"allTimeZones.America/Knox_IN",defaultMessage:"America/Knox_IN"}),"America/Kralendijk":e.formatMessage({id:"allTimeZones.America/Kralendijk",defaultMessage:"America/Kralendijk"}),"America/La_Paz":e.formatMessage({id:"allTimeZones.America/La_Paz",defaultMessage:"America/La_Paz"}),"America/Lima":e.formatMessage({id:"allTimeZones.America/Lima",defaultMessage:"America/Lima"}),"America/Los_Angeles":e.formatMessage({id:"allTimeZones.America/Los_Angeles",defaultMessage:"America/Los_Angeles"}),"America/Louisville":e.formatMessage({id:"allTimeZones.America/Louisville",defaultMessage:"America/Louisville"}),"America/Lower_Princes":e.formatMessage({id:"allTimeZones.America/Lower_Princes",defaultMessage:"America/Lower_Princes"}),"America/Maceio":e.formatMessage({id:"allTimeZones.America/Maceio",defaultMessage:"America/Maceio"}),"America/Managua":e.formatMessage({id:"allTimeZones.America/Managua",defaultMessage:"America/Managua"}),"America/Manaus":e.formatMessage({id:"allTimeZones.America/Manaus",defaultMessage:"America/Manaus"}),"America/Marigot":e.formatMessage({id:"allTimeZones.America/Marigot",defaultMessage:"America/Marigot"}),"America/Martinique":e.formatMessage({id:"allTimeZones.America/Martinique",defaultMessage:"America/Martinique"}),"America/Matamoros":e.formatMessage({id:"allTimeZones.America/Matamoros",defaultMessage:"America/Matamoros"}),"America/Mazatlan":e.formatMessage({id:"allTimeZones.America/Mazatlan",defaultMessage:"America/Mazatlan"}),"America/Mendoza":e.formatMessage({id:"allTimeZones.America/Mendoza",defaultMessage:"America/Mendoza"}),"America/Menominee":e.formatMessage({id:"allTimeZones.America/Menominee",defaultMessage:"America/Menominee"}),"America/Merida":e.formatMessage({id:"allTimeZones.America/Merida",defaultMessage:"America/Merida"}),"America/Metlakatla":e.formatMessage({id:"allTimeZones.America/Metlakatla",defaultMessage:"America/Metlakatla"}),"America/Mexico_City":e.formatMessage({id:"allTimeZones.America/Mexico_City",defaultMessage:"America/Mexico_City"}),"America/Miquelon":e.formatMessage({id:"allTimeZones.America/Miquelon",defaultMessage:"America/Miquelon"}),"America/Moncton":e.formatMessage({id:"allTimeZones.America/Moncton",defaultMessage:"America/Moncton"}),"America/Monterrey":e.formatMessage({id:"allTimeZones.America/Monterrey",defaultMessage:"America/Monterrey"}),"America/Montevideo":e.formatMessage({id:"allTimeZones.America/Montevideo",defaultMessage:"America/Montevideo"}),"America/Montreal":e.formatMessage({id:"allTimeZones.America/Montreal",defaultMessage:"America/Montreal"}),"America/Montserrat":e.formatMessage({id:"allTimeZones.America/Montserrat",defaultMessage:"America/Montserrat"}),"America/Nassau":e.formatMessage({id:"allTimeZones.America/Nassau",defaultMessage:"America/Nassau"}),"America/New_York":e.formatMessage({id:"allTimeZones.America/New_York",defaultMessage:"America/New_York"}),"America/Nipigon":e.formatMessage({id:"allTimeZones.America/Nipigon",defaultMessage:"America/Nipigon"}),"America/Nome":e.formatMessage({id:"allTimeZones.America/Nome",defaultMessage:"America/Nome"}),"America/Noronha":e.formatMessage({id:"allTimeZones.America/Noronha",defaultMessage:"America/Noronha"}),"America/North_Dakota/Beulah":e.formatMessage({id:"allTimeZones.America/North_Dakota/Beulah",defaultMessage:"America/North_Dakota/Beulah"}),"America/North_Dakota/Center":e.formatMessage({id:"allTimeZones.America/North_Dakota/Center",defaultMessage:"America/North_Dakota/Center"}),"America/North_Dakota/New_Salem":e.formatMessage({id:"allTimeZones.America/North_Dakota/New_Salem",defaultMessage:"America/North_Dakota/New_Salem"}),"America/Ojinaga":e.formatMessage({id:"allTimeZones.America/Ojinaga",defaultMessage:"America/Ojinaga"}),"America/Panama":e.formatMessage({id:"allTimeZones.America/Panama",defaultMessage:"America/Panama"}),"America/Pangnirtung":e.formatMessage({id:"allTimeZones.America/Pangnirtung",defaultMessage:"America/Pangnirtung"}),"America/Paramaribo":e.formatMessage({id:"allTimeZones.America/Paramaribo",defaultMessage:"America/Paramaribo"}),"America/Phoenix":e.formatMessage({id:"allTimeZones.America/Phoenix",defaultMessage:"America/Phoenix"}),"America/Port-au-Prince":e.formatMessage({id:"allTimeZones.America/Port-au-Prince",defaultMessage:"America/Port-au-Prince"}),"America/Port_of_Spain":e.formatMessage({id:"allTimeZones.America/Port_of_Spain",defaultMessage:"America/Port_of_Spain"}),"America/Porto_Acre":e.formatMessage({id:"allTimeZones.America/Porto_Acre",defaultMessage:"America/Porto_Acre"}),"America/Porto_Velho":e.formatMessage({id:"allTimeZones.America/Porto_Velho",defaultMessage:"America/Porto_Velho"}),"America/Puerto_Rico":e.formatMessage({id:"allTimeZones.America/Puerto_Rico",defaultMessage:"America/Puerto_Rico"}),"America/Punta_Arenas":e.formatMessage({id:"allTimeZones.America/Punta_Arenas",defaultMessage:"America/Punta_Arenas"}),"America/Rainy_River":e.formatMessage({id:"allTimeZones.America/Rainy_River",defaultMessage:"America/Rainy_River"}),"America/Rankin_Inlet":e.formatMessage({id:"allTimeZones.America/Rankin_Inlet",defaultMessage:"America/Rankin_Inlet"}),"America/Recife":e.formatMessage({id:"allTimeZones.America/Recife",defaultMessage:"America/Recife"}),"America/Regina":e.formatMessage({id:"allTimeZones.America/Regina",defaultMessage:"America/Regina"}),"America/Resolute":e.formatMessage({id:"allTimeZones.America/Resolute",defaultMessage:"America/Resolute"}),"America/Rio_Branco":e.formatMessage({id:"allTimeZones.America/Rio_Branco",defaultMessage:"America/Rio_Branco"}),"America/Rosario":e.formatMessage({id:"allTimeZones.America/Rosario",defaultMessage:"America/Rosario"}),"America/Santa_Isabel":e.formatMessage({id:"allTimeZones.America/Santa_Isabel",defaultMessage:"America/Santa_Isabel"}),"America/Santarem":e.formatMessage({id:"allTimeZones.America/Santarem",defaultMessage:"America/Santarem"}),"America/Santiago":e.formatMessage({id:"allTimeZones.America/Santiago",defaultMessage:"America/Santiago"}),"America/Santo_Domingo":e.formatMessage({id:"allTimeZones.America/Santo_Domingo",defaultMessage:"America/Santo_Domingo"}),"America/Sao_Paulo":e.formatMessage({id:"allTimeZones.America/Sao_Paulo",defaultMessage:"America/Sao_Paulo"}),"America/Scoresbysund":e.formatMessage({id:"allTimeZones.America/Scoresbysund",defaultMessage:"America/Scoresbysund"}),"America/Shiprock":e.formatMessage({id:"allTimeZones.America/Shiprock",defaultMessage:"America/Shiprock"}),"America/Sitka":e.formatMessage({id:"allTimeZones.America/Sitka",defaultMessage:"America/Sitka"}),"America/St_Barthelemy":e.formatMessage({id:"allTimeZones.America/St_Barthelemy",defaultMessage:"America/St_Barthelemy"}),"America/St_Johns":e.formatMessage({id:"allTimeZones.America/St_Johns",defaultMessage:"America/St_Johns"}),"America/St_Kitts":e.formatMessage({id:"allTimeZones.America/St_Kitts",defaultMessage:"America/St_Kitts"}),"America/St_Lucia":e.formatMessage({id:"allTimeZones.America/St_Lucia",defaultMessage:"America/St_Lucia"}),"America/St_Thomas":e.formatMessage({id:"allTimeZones.America/St_Thomas",defaultMessage:"America/St_Thomas"}),"America/St_Vincent":e.formatMessage({id:"allTimeZones.America/St_Vincent",defaultMessage:"America/St_Vincent"}),"America/Swift_Current":e.formatMessage({id:"allTimeZones.America/Swift_Current",defaultMessage:"America/Swift_Current"}),"America/Tegucigalpa":e.formatMessage({id:"allTimeZones.America/Tegucigalpa",defaultMessage:"America/Tegucigalpa"}),"America/Thule":e.formatMessage({id:"allTimeZones.America/Thule",defaultMessage:"America/Thule"}),"America/Thunder_Bay":e.formatMessage({id:"allTimeZones.America/Thunder_Bay",defaultMessage:"America/Thunder_Bay"}),"America/Tijuana":e.formatMessage({id:"allTimeZones.America/Tijuana",defaultMessage:"America/Tijuana"}),"America/Toronto":e.formatMessage({id:"allTimeZones.America/Toronto",defaultMessage:"America/Toronto"}),"America/Tortola":e.formatMessage({id:"allTimeZones.America/Tortola",defaultMessage:"America/Tortola"}),"America/Vancouver":e.formatMessage({id:"allTimeZones.America/Vancouver",defaultMessage:"America/Vancouver"}),"America/Virgin":e.formatMessage({id:"allTimeZones.America/Virgin",defaultMessage:"America/Virgin"}),"America/Whitehorse":e.formatMessage({id:"allTimeZones.America/Whitehorse",defaultMessage:"America/Whitehorse"}),"America/Winnipeg":e.formatMessage({id:"allTimeZones.America/Winnipeg",defaultMessage:"America/Winnipeg"}),"America/Yakutat":e.formatMessage({id:"allTimeZones.America/Yakutat",defaultMessage:"America/Yakutat"}),"America/Yellowknife":e.formatMessage({id:"allTimeZones.America/Yellowknife",defaultMessage:"America/Yellowknife"}),"Antarctica/Casey":e.formatMessage({id:"allTimeZones.Antarctica/Casey",defaultMessage:"Antarctica/Casey"}),"Antarctica/Davis":e.formatMessage({id:"allTimeZones.Antarctica/Davis",defaultMessage:"Antarctica/Davis"}),"Antarctica/DumontDUrville":e.formatMessage({id:"allTimeZones.Antarctica/DumontDUrville",defaultMessage:"Antarctica/DumontDUrville"}),"Antarctica/Macquarie":e.formatMessage({id:"allTimeZones.Antarctica/Macquarie",defaultMessage:"Antarctica/Macquarie"}),"Antarctica/Mawson":e.formatMessage({id:"allTimeZones.Antarctica/Mawson",defaultMessage:"Antarctica/Mawson"}),"Antarctica/McMurdo":e.formatMessage({id:"allTimeZones.Antarctica/McMurdo",defaultMessage:"Antarctica/McMurdo"}),"Antarctica/Palmer":e.formatMessage({id:"allTimeZones.Antarctica/Palmer",defaultMessage:"Antarctica/Palmer"}),"Antarctica/Rothera":e.formatMessage({id:"allTimeZones.Antarctica/Rothera",defaultMessage:"Antarctica/Rothera"}),"Antarctica/South_Pole":e.formatMessage({id:"allTimeZones.Antarctica/South_Pole",defaultMessage:"Antarctica/South_Pole"}),"Antarctica/Syowa":e.formatMessage({id:"allTimeZones.Antarctica/Syowa",defaultMessage:"Antarctica/Syowa"}),"Antarctica/Troll":e.formatMessage({id:"allTimeZones.Antarctica/Troll",defaultMessage:"Antarctica/Troll"}),"Antarctica/Vostok":e.formatMessage({id:"allTimeZones.Antarctica/Vostok",defaultMessage:"Antarctica/Vostok"}),"Arctic/Longyearbyen":e.formatMessage({id:"allTimeZones.Arctic/Longyearbyen",defaultMessage:"Arctic/Longyearbyen"}),"Asia/Aden":e.formatMessage({id:"allTimeZones.Asia/Aden",defaultMessage:"Asia/Aden"}),"Asia/Almaty":e.formatMessage({id:"allTimeZones.Asia/Almaty",defaultMessage:"Asia/Almaty"}),"Asia/Amman":e.formatMessage({id:"allTimeZones.Asia/Amman",defaultMessage:"Asia/Amman"}),"Asia/Anadyr":e.formatMessage({id:"allTimeZones.Asia/Anadyr",defaultMessage:"Asia/Anadyr"}),"Asia/Aqtau":e.formatMessage({id:"allTimeZones.Asia/Aqtau",defaultMessage:"Asia/Aqtau"}),"Asia/Aqtobe":e.formatMessage({id:"allTimeZones.Asia/Aqtobe",defaultMessage:"Asia/Aqtobe"}),"Asia/Ashgabat":e.formatMessage({id:"allTimeZones.Asia/Ashgabat",defaultMessage:"Asia/Ashgabat"}),"Asia/Ashkhabad":e.formatMessage({id:"allTimeZones.Asia/Ashkhabad",defaultMessage:"Asia/Ashkhabad"}),"Asia/Atyrau":e.formatMessage({id:"allTimeZones.Asia/Atyrau",defaultMessage:"Asia/Atyrau"}),"Asia/Baghdad":e.formatMessage({id:"allTimeZones.Asia/Baghdad",defaultMessage:"Asia/Baghdad"}),"Asia/Bahrain":e.formatMessage({id:"allTimeZones.Asia/Bahrain",defaultMessage:"Asia/Bahrain"}),"Asia/Baku":e.formatMessage({id:"allTimeZones.Asia/Baku",defaultMessage:"Asia/Baku"}),"Asia/Bangkok":e.formatMessage({id:"allTimeZones.Asia/Bangkok",defaultMessage:"Asia/Bangkok"}),"Asia/Barnaul":e.formatMessage({id:"allTimeZones.Asia/Barnaul",defaultMessage:"Asia/Barnaul"}),"Asia/Beirut":e.formatMessage({id:"allTimeZones.Asia/Beirut",defaultMessage:"Asia/Beirut"}),"Asia/Bishkek":e.formatMessage({id:"allTimeZones.Asia/Bishkek",defaultMessage:"Asia/Bishkek"}),"Asia/Brunei":e.formatMessage({id:"allTimeZones.Asia/Brunei",defaultMessage:"Asia/Brunei"}),"Asia/Calcutta":e.formatMessage({id:"allTimeZones.Asia/Calcutta",defaultMessage:"Asia/Calcutta"}),"Asia/Chita":e.formatMessage({id:"allTimeZones.Asia/Chita",defaultMessage:"Asia/Chita"}),"Asia/Choibalsan":e.formatMessage({id:"allTimeZones.Asia/Choibalsan",defaultMessage:"Asia/Choibalsan"}),"Asia/Chongqing":e.formatMessage({id:"allTimeZones.Asia/Chongqing",defaultMessage:"Asia/Chongqing"}),"Asia/Chungking":e.formatMessage({id:"allTimeZones.Asia/Chungking",defaultMessage:"Asia/Chungking"}),"Asia/Colombo":e.formatMessage({id:"allTimeZones.Asia/Colombo",defaultMessage:"Asia/Colombo"}),"Asia/Dacca":e.formatMessage({id:"allTimeZones.Asia/Dacca",defaultMessage:"Asia/Dacca"}),"Asia/Damascus":e.formatMessage({id:"allTimeZones.Asia/Damascus",defaultMessage:"Asia/Damascus"}),"Asia/Dhaka":e.formatMessage({id:"allTimeZones.Asia/Dhaka",defaultMessage:"Asia/Dhaka"}),"Asia/Dili":e.formatMessage({id:"allTimeZones.Asia/Dili",defaultMessage:"Asia/Dili"}),"Asia/Dubai":e.formatMessage({id:"allTimeZones.Asia/Dubai",defaultMessage:"Asia/Dubai"}),"Asia/Dushanbe":e.formatMessage({id:"allTimeZones.Asia/Dushanbe",defaultMessage:"Asia/Dushanbe"}),"Asia/Famagusta":e.formatMessage({id:"allTimeZones.Asia/Famagusta",defaultMessage:"Asia/Famagusta"}),"Asia/Gaza":e.formatMessage({id:"allTimeZones.Asia/Gaza",defaultMessage:"Asia/Gaza"}),"Asia/Harbin":e.formatMessage({id:"allTimeZones.Asia/Harbin",defaultMessage:"Asia/Harbin"}),"Asia/Hebron":e.formatMessage({id:"allTimeZones.Asia/Hebron",defaultMessage:"Asia/Hebron"}),"Asia/Ho_Chi_Minh":e.formatMessage({id:"allTimeZones.Asia/Ho_Chi_Minh",defaultMessage:"Asia/Ho_Chi_Minh"}),"Asia/Hong_Kong":e.formatMessage({id:"allTimeZones.Asia/Hong_Kong",defaultMessage:"Asia/Hong_Kong"}),"Asia/Hovd":e.formatMessage({id:"allTimeZones.Asia/Hovd",defaultMessage:"Asia/Hovd"}),"Asia/Irkutsk":e.formatMessage({id:"allTimeZones.Asia/Irkutsk",defaultMessage:"Asia/Irkutsk"}),"Asia/Istanbul":e.formatMessage({id:"allTimeZones.Asia/Istanbul",defaultMessage:"Asia/Istanbul"}),"Asia/Jakarta":e.formatMessage({id:"allTimeZones.Asia/Jakarta",defaultMessage:"Asia/Jakarta"}),"Asia/Jayapura":e.formatMessage({id:"allTimeZones.Asia/Jayapura",defaultMessage:"Asia/Jayapura"}),"Asia/Jerusalem":e.formatMessage({id:"allTimeZones.Asia/Jerusalem",defaultMessage:"Asia/Jerusalem"}),"Asia/Kabul":e.formatMessage({id:"allTimeZones.Asia/Kabul",defaultMessage:"Asia/Kabul"}),"Asia/Kamchatka":e.formatMessage({id:"allTimeZones.Asia/Kamchatka",defaultMessage:"Asia/Kamchatka"}),"Asia/Karachi":e.formatMessage({id:"allTimeZones.Asia/Karachi",defaultMessage:"Asia/Karachi"}),"Asia/Kashgar":e.formatMessage({id:"allTimeZones.Asia/Kashgar",defaultMessage:"Asia/Kashgar"}),"Asia/Kathmandu":e.formatMessage({id:"allTimeZones.Asia/Kathmandu",defaultMessage:"Asia/Kathmandu"}),"Asia/Katmandu":e.formatMessage({id:"allTimeZones.Asia/Katmandu",defaultMessage:"Asia/Katmandu"}),"Asia/Khandyga":e.formatMessage({id:"allTimeZones.Asia/Khandyga",defaultMessage:"Asia/Khandyga"}),"Asia/Kolkata":e.formatMessage({id:"allTimeZones.Asia/Kolkata",defaultMessage:"Asia/Kolkata"}),"Asia/Krasnoyarsk":e.formatMessage({id:"allTimeZones.Asia/Krasnoyarsk",defaultMessage:"Asia/Krasnoyarsk"}),"Asia/Kuala_Lumpur":e.formatMessage({id:"allTimeZones.Asia/Kuala_Lumpur",defaultMessage:"Asia/Kuala_Lumpur"}),"Asia/Kuching":e.formatMessage({id:"allTimeZones.Asia/Kuching",defaultMessage:"Asia/Kuching"}),"Asia/Kuwait":e.formatMessage({id:"allTimeZones.Asia/Kuwait",defaultMessage:"Asia/Kuwait"}),"Asia/Macao":e.formatMessage({id:"allTimeZones.Asia/Macao",defaultMessage:"Asia/Macao"}),"Asia/Macau":e.formatMessage({id:"allTimeZones.Asia/Macau",defaultMessage:"Asia/Macau"}),"Asia/Magadan":e.formatMessage({id:"allTimeZones.Asia/Magadan",defaultMessage:"Asia/Magadan"}),"Asia/Makassar":e.formatMessage({id:"allTimeZones.Asia/Makassar",defaultMessage:"Asia/Makassar"}),"Asia/Manila":e.formatMessage({id:"allTimeZones.Asia/Manila",defaultMessage:"Asia/Manila"}),"Asia/Muscat":e.formatMessage({id:"allTimeZones.Asia/Muscat",defaultMessage:"Asia/Muscat"}),"Asia/Nicosia":e.formatMessage({id:"allTimeZones.Asia/Nicosia",defaultMessage:"Asia/Nicosia"}),"Asia/Novokuznetsk":e.formatMessage({id:"allTimeZones.Asia/Novokuznetsk",defaultMessage:"Asia/Novokuznetsk"}),"Asia/Novosibirsk":e.formatMessage({id:"allTimeZones.Asia/Novosibirsk",defaultMessage:"Asia/Novosibirsk"}),"Asia/Omsk":e.formatMessage({id:"allTimeZones.Asia/Omsk",defaultMessage:"Asia/Omsk"}),"Asia/Oral":e.formatMessage({id:"allTimeZones.Asia/Oral",defaultMessage:"Asia/Oral"}),"Asia/Phnom_Penh":e.formatMessage({id:"allTimeZones.Asia/Phnom_Penh",defaultMessage:"Asia/Phnom_Penh"}),"Asia/Pontianak":e.formatMessage({id:"allTimeZones.Asia/Pontianak",defaultMessage:"Asia/Pontianak"}),"Asia/Pyongyang":e.formatMessage({id:"allTimeZones.Asia/Pyongyang",defaultMessage:"Asia/Pyongyang"}),"Asia/Qatar":e.formatMessage({id:"allTimeZones.Asia/Qatar",defaultMessage:"Asia/Qatar"}),"Asia/Qostanay":e.formatMessage({id:"allTimeZones.Asia/Qostanay",defaultMessage:"Asia/Qostanay"}),"Asia/Qyzylorda":e.formatMessage({id:"allTimeZones.Asia/Qyzylorda",defaultMessage:"Asia/Qyzylorda"}),"Asia/Rangoon":e.formatMessage({id:"allTimeZones.Asia/Rangoon",defaultMessage:"Asia/Rangoon"}),"Asia/Riyadh":e.formatMessage({id:"allTimeZones.Asia/Riyadh",defaultMessage:"Asia/Riyadh"}),"Asia/Saigon":e.formatMessage({id:"allTimeZones.Asia/Saigon",defaultMessage:"Asia/Saigon"}),"Asia/Sakhalin":e.formatMessage({id:"allTimeZones.Asia/Sakhalin",defaultMessage:"Asia/Sakhalin"}),"Asia/Samarkand":e.formatMessage({id:"allTimeZones.Asia/Samarkand",defaultMessage:"Asia/Samarkand"}),"Asia/Seoul":e.formatMessage({id:"allTimeZones.Asia/Seoul",defaultMessage:"Asia/Seoul"}),"Asia/Shanghai":e.formatMessage({id:"allTimeZones.Asia/Shanghai",defaultMessage:"Asia/Shanghai"}),"Asia/Singapore":e.formatMessage({id:"allTimeZones.Asia/Singapore",defaultMessage:"Asia/Singapore"}),"Asia/Srednekolymsk":e.formatMessage({id:"allTimeZones.Asia/Srednekolymsk",defaultMessage:"Asia/Srednekolymsk"}),"Asia/Taipei":e.formatMessage({id:"allTimeZones.Asia/Taipei",defaultMessage:"Asia/Taipei"}),"Asia/Tashkent":e.formatMessage({id:"allTimeZones.Asia/Tashkent",defaultMessage:"Asia/Tashkent"}),"Asia/Tbilisi":e.formatMessage({id:"allTimeZones.Asia/Tbilisi",defaultMessage:"Asia/Tbilisi"}),"Asia/Tehran":e.formatMessage({id:"allTimeZones.Asia/Tehran",defaultMessage:"Asia/Tehran"}),"Asia/Tel_Aviv":e.formatMessage({id:"allTimeZones.Asia/Tel_Aviv",defaultMessage:"Asia/Tel_Aviv"}),"Asia/Thimbu":e.formatMessage({id:"allTimeZones.Asia/Thimbu",defaultMessage:"Asia/Thimbu"}),"Asia/Thimphu":e.formatMessage({id:"allTimeZones.Asia/Thimphu",defaultMessage:"Asia/Thimphu"}),"Asia/Tokyo":e.formatMessage({id:"allTimeZones.Asia/Tokyo",defaultMessage:"Asia/Tokyo"}),"Asia/Tomsk":e.formatMessage({id:"allTimeZones.Asia/Tomsk",defaultMessage:"Asia/Tomsk"}),"Asia/Ujung_Pandang":e.formatMessage({id:"allTimeZones.Asia/Ujung_Pandang",defaultMessage:"Asia/Ujung_Pandang"}),"Asia/Ulaanbaatar":e.formatMessage({id:"allTimeZones.Asia/Ulaanbaatar",defaultMessage:"Asia/Ulaanbaatar"}),"Asia/Ulan_Bator":e.formatMessage({id:"allTimeZones.Asia/Ulan_Bator",defaultMessage:"Asia/Ulan_Bator"}),"Asia/Urumqi":e.formatMessage({id:"allTimeZones.Asia/Urumqi",defaultMessage:"Asia/Urumqi"}),"Asia/Ust-Nera":e.formatMessage({id:"allTimeZones.Asia/Ust-Nera",defaultMessage:"Asia/Ust-Nera"}),"Asia/Vientiane":e.formatMessage({id:"allTimeZones.Asia/Vientiane",defaultMessage:"Asia/Vientiane"}),"Asia/Vladivostok":e.formatMessage({id:"allTimeZones.Asia/Vladivostok",defaultMessage:"Asia/Vladivostok"}),"Asia/Yakutsk":e.formatMessage({id:"allTimeZones.Asia/Yakutsk",defaultMessage:"Asia/Yakutsk"}),"Asia/Yangon":e.formatMessage({id:"allTimeZones.Asia/Yangon",defaultMessage:"Asia/Yangon"}),"Asia/Yekaterinburg":e.formatMessage({id:"allTimeZones.Asia/Yekaterinburg",defaultMessage:"Asia/Yekaterinburg"}),"Asia/Yerevan":e.formatMessage({id:"allTimeZones.Asia/Yerevan",defaultMessage:"Asia/Yerevan"}),"Atlantic/Azores":e.formatMessage({id:"allTimeZones.Atlantic/Azores",defaultMessage:"Atlantic/Azores"}),"Atlantic/Bermuda":e.formatMessage({id:"allTimeZones.Atlantic/Bermuda",defaultMessage:"Atlantic/Bermuda"}),"Atlantic/Canary":e.formatMessage({id:"allTimeZones.Atlantic/Canary",defaultMessage:"Atlantic/Canary"}),"Atlantic/Cape_Verde":e.formatMessage({id:"allTimeZones.Atlantic/Cape_Verde",defaultMessage:"Atlantic/Cape_Verde"}),"Atlantic/Faeroe":e.formatMessage({id:"allTimeZones.Atlantic/Faeroe",defaultMessage:"Atlantic/Faeroe"}),"Atlantic/Faroe":e.formatMessage({id:"allTimeZones.Atlantic/Faroe",defaultMessage:"Atlantic/Faroe"}),"Atlantic/Jan_Mayen":e.formatMessage({id:"allTimeZones.Atlantic/Jan_Mayen",defaultMessage:"Atlantic/Jan_Mayen"}),"Atlantic/Madeira":e.formatMessage({id:"allTimeZones.Atlantic/Madeira",defaultMessage:"Atlantic/Madeira"}),"Atlantic/Reykjavik":e.formatMessage({id:"allTimeZones.Atlantic/Reykjavik",defaultMessage:"Atlantic/Reykjavik"}),"Atlantic/South_Georgia":e.formatMessage({id:"allTimeZones.Atlantic/South_Georgia",defaultMessage:"Atlantic/South_Georgia"}),"Atlantic/St_Helena":e.formatMessage({id:"allTimeZones.Atlantic/St_Helena",defaultMessage:"Atlantic/St_Helena"}),"Atlantic/Stanley":e.formatMessage({id:"allTimeZones.Atlantic/Stanley",defaultMessage:"Atlantic/Stanley"}),"Australia/ACT":e.formatMessage({id:"allTimeZones.Australia/ACT",defaultMessage:"Australia/ACT"}),"Australia/Adelaide":e.formatMessage({id:"allTimeZones.Australia/Adelaide",defaultMessage:"Australia/Adelaide"}),"Australia/Brisbane":e.formatMessage({id:"allTimeZones.Australia/Brisbane",defaultMessage:"Australia/Brisbane"}),"Australia/Broken_Hill":e.formatMessage({id:"allTimeZones.Australia/Broken_Hill",defaultMessage:"Australia/Broken_Hill"}),"Australia/Canberra":e.formatMessage({id:"allTimeZones.Australia/Canberra",defaultMessage:"Australia/Canberra"}),"Australia/Currie":e.formatMessage({id:"allTimeZones.Australia/Currie",defaultMessage:"Australia/Currie"}),"Australia/Darwin":e.formatMessage({id:"allTimeZones.Australia/Darwin",defaultMessage:"Australia/Darwin"}),"Australia/Eucla":e.formatMessage({id:"allTimeZones.Australia/Eucla",defaultMessage:"Australia/Eucla"}),"Australia/Hobart":e.formatMessage({id:"allTimeZones.Australia/Hobart",defaultMessage:"Australia/Hobart"}),"Australia/LHI":e.formatMessage({id:"allTimeZones.Australia/LHI",defaultMessage:"Australia/LHI"}),"Australia/Lindeman":e.formatMessage({id:"allTimeZones.Australia/Lindeman",defaultMessage:"Australia/Lindeman"}),"Australia/Lord_Howe":e.formatMessage({id:"allTimeZones.Australia/Lord_Howe",defaultMessage:"Australia/Lord_Howe"}),"Australia/Melbourne":e.formatMessage({id:"allTimeZones.Australia/Melbourne",defaultMessage:"Australia/Melbourne"}),"Australia/NSW":e.formatMessage({id:"allTimeZones.Australia/NSW",defaultMessage:"Australia/NSW"}),"Australia/North":e.formatMessage({id:"allTimeZones.Australia/North",defaultMessage:"Australia/North"}),"Australia/Perth":e.formatMessage({id:"allTimeZones.Australia/Perth",defaultMessage:"Australia/Perth"}),"Australia/Queensland":e.formatMessage({id:"allTimeZones.Australia/Queensland",defaultMessage:"Australia/Queensland"}),"Australia/South":e.formatMessage({id:"allTimeZones.Australia/South",defaultMessage:"Australia/South"}),"Australia/Sydney":e.formatMessage({id:"allTimeZones.Australia/Sydney",defaultMessage:"Australia/Sydney"}),"Australia/Tasmania":e.formatMessage({id:"allTimeZones.Australia/Tasmania",defaultMessage:"Australia/Tasmania"}),"Australia/Victoria":e.formatMessage({id:"allTimeZones.Australia/Victoria",defaultMessage:"Australia/Victoria"}),"Australia/West":e.formatMessage({id:"allTimeZones.Australia/West",defaultMessage:"Australia/West"}),"Australia/Yancowinna":e.formatMessage({id:"allTimeZones.Australia/Yancowinna",defaultMessage:"Australia/Yancowinna"}),"Brazil/Acre":e.formatMessage({id:"allTimeZones.Brazil/Acre",defaultMessage:"Brazil/Acre"}),"Brazil/DeNoronha":e.formatMessage({id:"allTimeZones.Brazil/DeNoronha",defaultMessage:"Brazil/DeNoronha"}),"Brazil/East":e.formatMessage({id:"allTimeZones.Brazil/East",defaultMessage:"Brazil/East"}),"Brazil/West":e.formatMessage({id:"allTimeZones.Brazil/West",defaultMessage:"Brazil/West"}),CET:e.formatMessage({id:"allTimeZones.CET",defaultMessage:"CET"}),CST6CDT:e.formatMessage({id:"allTimeZones.CST6CDT",defaultMessage:"CST6CDT"}),"Canada/Atlantic":e.formatMessage({id:"allTimeZones.Canada/Atlantic",defaultMessage:"Canada/Atlantic"}),"Canada/Central":e.formatMessage({id:"allTimeZones.Canada/Central",defaultMessage:"Canada/Central"}),"Canada/Eastern":e.formatMessage({id:"allTimeZones.Canada/Eastern",defaultMessage:"Canada/Eastern"}),"Canada/Mountain":e.formatMessage({id:"allTimeZones.Canada/Mountain",defaultMessage:"Canada/Mountain"}),"Canada/Newfoundland":e.formatMessage({id:"allTimeZones.Canada/Newfoundland",defaultMessage:"Canada/Newfoundland"}),"Canada/Pacific":e.formatMessage({id:"allTimeZones.Canada/Pacific",defaultMessage:"Canada/Pacific"}),"Canada/Saskatchewan":e.formatMessage({id:"allTimeZones.Canada/Saskatchewan",defaultMessage:"Canada/Saskatchewan"}),"Canada/Yukon":e.formatMessage({id:"allTimeZones.Canada/Yukon",defaultMessage:"Canada/Yukon"}),"Chile/Continental":e.formatMessage({id:"allTimeZones.Chile/Continental",defaultMessage:"Chile/Continental"}),"Chile/EasterIsland":e.formatMessage({id:"allTimeZones.Chile/EasterIsland",defaultMessage:"Chile/EasterIsland"}),Cuba:e.formatMessage({id:"allTimeZones.Cuba",defaultMessage:"Cuba"}),EET:e.formatMessage({id:"allTimeZones.EET",defaultMessage:"EET"}),EST:e.formatMessage({id:"allTimeZones.EST",defaultMessage:"EST"}),EST5EDT:e.formatMessage({id:"allTimeZones.EST5EDT",defaultMessage:"EST5EDT"}),Egypt:e.formatMessage({id:"allTimeZones.Egypt",defaultMessage:"Egypt"}),Eire:e.formatMessage({id:"allTimeZones.Eire",defaultMessage:"Eire"}),"Etc/GMT":e.formatMessage({id:"allTimeZones.Etc/GMT",defaultMessage:"Etc/GMT"}),"Etc/GMT+0":e.formatMessage({id:"allTimeZones.Etc/GMT+0",defaultMessage:"Etc/GMT+0"}),"Etc/GMT+1":e.formatMessage({id:"allTimeZones.Etc/GMT+1",defaultMessage:"Etc/GMT+1"}),"Etc/GMT+10":e.formatMessage({id:"allTimeZones.Etc/GMT+10",defaultMessage:"Etc/GMT+10"}),"Etc/GMT+11":e.formatMessage({id:"allTimeZones.Etc/GMT+11",defaultMessage:"Etc/GMT+11"}),"Etc/GMT+12":e.formatMessage({id:"allTimeZones.Etc/GMT+12",defaultMessage:"Etc/GMT+12"}),"Etc/GMT+2":e.formatMessage({id:"allTimeZones.Etc/GMT+2",defaultMessage:"Etc/GMT+2"}),"Etc/GMT+3":e.formatMessage({id:"allTimeZones.Etc/GMT+3",defaultMessage:"Etc/GMT+3"}),"Etc/GMT+4":e.formatMessage({id:"allTimeZones.Etc/GMT+4",defaultMessage:"Etc/GMT+4"}),"Etc/GMT+5":e.formatMessage({id:"allTimeZones.Etc/GMT+5",defaultMessage:"Etc/GMT+5"}),"Etc/GMT+6":e.formatMessage({id:"allTimeZones.Etc/GMT+6",defaultMessage:"Etc/GMT+6"}),"Etc/GMT+7":e.formatMessage({id:"allTimeZones.Etc/GMT+7",defaultMessage:"Etc/GMT+7"}),"Etc/GMT+8":e.formatMessage({id:"allTimeZones.Etc/GMT+8",defaultMessage:"Etc/GMT+8"}),"Etc/GMT+9":e.formatMessage({id:"allTimeZones.Etc/GMT+9",defaultMessage:"Etc/GMT+9"}),"Etc/GMT-0":e.formatMessage({id:"allTimeZones.Etc/GMT-0",defaultMessage:"Etc/GMT-0"}),"Etc/GMT-1":e.formatMessage({id:"allTimeZones.Etc/GMT-1",defaultMessage:"Etc/GMT-1"}),"Etc/GMT-10":e.formatMessage({id:"allTimeZones.Etc/GMT-10",defaultMessage:"Etc/GMT-10"}),"Etc/GMT-11":e.formatMessage({id:"allTimeZones.Etc/GMT-11",defaultMessage:"Etc/GMT-11"}),"Etc/GMT-12":e.formatMessage({id:"allTimeZones.Etc/GMT-12",defaultMessage:"Etc/GMT-12"}),"Etc/GMT-13":e.formatMessage({id:"allTimeZones.Etc/GMT-13",defaultMessage:"Etc/GMT-13"}),"Etc/GMT-14":e.formatMessage({id:"allTimeZones.Etc/GMT-14",defaultMessage:"Etc/GMT-14"}),"Etc/GMT-2":e.formatMessage({id:"allTimeZones.Etc/GMT-2",defaultMessage:"Etc/GMT-2"}),"Etc/GMT-3":e.formatMessage({id:"allTimeZones.Etc/GMT-3",defaultMessage:"Etc/GMT-3"}),"Etc/GMT-4":e.formatMessage({id:"allTimeZones.Etc/GMT-4",defaultMessage:"Etc/GMT-4"}),"Etc/GMT-5":e.formatMessage({id:"allTimeZones.Etc/GMT-5",defaultMessage:"Etc/GMT-5"}),"Etc/GMT-6":e.formatMessage({id:"allTimeZones.Etc/GMT-6",defaultMessage:"Etc/GMT-6"}),"Etc/GMT-7":e.formatMessage({id:"allTimeZones.Etc/GMT-7",defaultMessage:"Etc/GMT-7"}),"Etc/GMT-8":e.formatMessage({id:"allTimeZones.Etc/GMT-8",defaultMessage:"Etc/GMT-8"}),"Etc/GMT-9":e.formatMessage({id:"allTimeZones.Etc/GMT-9",defaultMessage:"Etc/GMT-9"}),"Etc/GMT0":e.formatMessage({id:"allTimeZones.Etc/GMT0",defaultMessage:"Etc/GMT0"}),"Etc/Greenwich":e.formatMessage({id:"allTimeZones.Etc/Greenwich",defaultMessage:"Etc/Greenwich"}),"Etc/UCT":e.formatMessage({id:"allTimeZones.Etc/UCT",defaultMessage:"Etc/UCT"}),"Etc/UTC":e.formatMessage({id:"allTimeZones.Etc/UTC",defaultMessage:"Etc/UTC"}),"Etc/Universal":e.formatMessage({id:"allTimeZones.Etc/Universal",defaultMessage:"Etc/Universal"}),"Etc/Zulu":e.formatMessage({id:"allTimeZones.Etc/Zulu",defaultMessage:"Etc/Zulu"}),"Europe/Amsterdam":e.formatMessage({id:"allTimeZones.Europe/Amsterdam",defaultMessage:"Europe/Amsterdam"}),"Europe/Andorra":e.formatMessage({id:"allTimeZones.Europe/Andorra",defaultMessage:"Europe/Andorra"}),"Europe/Astrakhan":e.formatMessage({id:"allTimeZones.Europe/Astrakhan",defaultMessage:"Europe/Astrakhan"}),"Europe/Athens":e.formatMessage({id:"allTimeZones.Europe/Athens",defaultMessage:"Europe/Athens"}),"Europe/Belfast":e.formatMessage({id:"allTimeZones.Europe/Belfast",defaultMessage:"Europe/Belfast"}),"Europe/Belgrade":e.formatMessage({id:"allTimeZones.Europe/Belgrade",defaultMessage:"Europe/Belgrade"}),"Europe/Berlin":e.formatMessage({id:"allTimeZones.Europe/Berlin",defaultMessage:"Europe/Berlin"}),"Europe/Bratislava":e.formatMessage({id:"allTimeZones.Europe/Bratislava",defaultMessage:"Europe/Bratislava"}),"Europe/Brussels":e.formatMessage({id:"allTimeZones.Europe/Brussels",defaultMessage:"Europe/Brussels"}),"Europe/Bucharest":e.formatMessage({id:"allTimeZones.Europe/Bucharest",defaultMessage:"Europe/Bucharest"}),"Europe/Budapest":e.formatMessage({id:"allTimeZones.Europe/Budapest",defaultMessage:"Europe/Budapest"}),"Europe/Busingen":e.formatMessage({id:"allTimeZones.Europe/Busingen",defaultMessage:"Europe/Busingen"}),"Europe/Chisinau":e.formatMessage({id:"allTimeZones.Europe/Chisinau",defaultMessage:"Europe/Chisinau"}),"Europe/Copenhagen":e.formatMessage({id:"allTimeZones.Europe/Copenhagen",defaultMessage:"Europe/Copenhagen"}),"Europe/Dublin":e.formatMessage({id:"allTimeZones.Europe/Dublin",defaultMessage:"Europe/Dublin"}),"Europe/Gibraltar":e.formatMessage({id:"allTimeZones.Europe/Gibraltar",defaultMessage:"Europe/Gibraltar"}),"Europe/Guernsey":e.formatMessage({id:"allTimeZones.Europe/Guernsey",defaultMessage:"Europe/Guernsey"}),"Europe/Helsinki":e.formatMessage({id:"allTimeZones.Europe/Helsinki",defaultMessage:"Europe/Helsinki"}),"Europe/Isle_of_Man":e.formatMessage({id:"allTimeZones.Europe/Isle_of_Man",defaultMessage:"Europe/Isle_of_Man"}),"Europe/Istanbul":e.formatMessage({id:"allTimeZones.Europe/Istanbul",defaultMessage:"Europe/Istanbul"}),"Europe/Jersey":e.formatMessage({id:"allTimeZones.Europe/Jersey",defaultMessage:"Europe/Jersey"}),"Europe/Kaliningrad":e.formatMessage({id:"allTimeZones.Europe/Kaliningrad",defaultMessage:"Europe/Kaliningrad"}),"Europe/Kiev":e.formatMessage({id:"allTimeZones.Europe/Kiev",defaultMessage:"Europe/Kiev"}),"Europe/Kirov":e.formatMessage({id:"allTimeZones.Europe/Kirov",defaultMessage:"Europe/Kirov"}),"Europe/Lisbon":e.formatMessage({id:"allTimeZones.Europe/Lisbon",defaultMessage:"Europe/Lisbon"}),"Europe/Ljubljana":e.formatMessage({id:"allTimeZones.Europe/Ljubljana",defaultMessage:"Europe/Ljubljana"}),"Europe/London":e.formatMessage({id:"allTimeZones.Europe/London",defaultMessage:"Europe/London"}),"Europe/Luxembourg":e.formatMessage({id:"allTimeZones.Europe/Luxembourg",defaultMessage:"Europe/Luxembourg"}),"Europe/Madrid":e.formatMessage({id:"allTimeZones.Europe/Madrid",defaultMessage:"Europe/Madrid"}),"Europe/Malta":e.formatMessage({id:"allTimeZones.Europe/Malta",defaultMessage:"Europe/Malta"}),"Europe/Mariehamn":e.formatMessage({id:"allTimeZones.Europe/Mariehamn",defaultMessage:"Europe/Mariehamn"}),"Europe/Minsk":e.formatMessage({id:"allTimeZones.Europe/Minsk",defaultMessage:"Europe/Minsk"}),"Europe/Monaco":e.formatMessage({id:"allTimeZones.Europe/Monaco",defaultMessage:"Europe/Monaco"}),"Europe/Moscow":e.formatMessage({id:"allTimeZones.Europe/Moscow",defaultMessage:"Europe/Moscow"}),"Europe/Nicosia":e.formatMessage({id:"allTimeZones.Europe/Nicosia",defaultMessage:"Europe/Nicosia"}),"Europe/Oslo":e.formatMessage({id:"allTimeZones.Europe/Oslo",defaultMessage:"Europe/Oslo"}),"Europe/Paris":e.formatMessage({id:"allTimeZones.Europe/Paris",defaultMessage:"Europe/Paris"}),"Europe/Podgorica":e.formatMessage({id:"allTimeZones.Europe/Podgorica",defaultMessage:"Europe/Podgorica"}),"Europe/Prague":e.formatMessage({id:"allTimeZones.Europe/Prague",defaultMessage:"Europe/Prague"}),"Europe/Riga":e.formatMessage({id:"allTimeZones.Europe/Riga",defaultMessage:"Europe/Riga"}),"Europe/Rome":e.formatMessage({id:"allTimeZones.Europe/Rome",defaultMessage:"Europe/Rome"}),"Europe/Samara":e.formatMessage({id:"allTimeZones.Europe/Samara",defaultMessage:"Europe/Samara"}),"Europe/San_Marino":e.formatMessage({id:"allTimeZones.Europe/San_Marino",defaultMessage:"Europe/San_Marino"}),"Europe/Sarajevo":e.formatMessage({id:"allTimeZones.Europe/Sarajevo",defaultMessage:"Europe/Sarajevo"}),"Europe/Saratov":e.formatMessage({id:"allTimeZones.Europe/Saratov",defaultMessage:"Europe/Saratov"}),"Europe/Simferopol":e.formatMessage({id:"allTimeZones.Europe/Simferopol",defaultMessage:"Europe/Simferopol"}),"Europe/Skopje":e.formatMessage({id:"allTimeZones.Europe/Skopje",defaultMessage:"Europe/Skopje"}),"Europe/Sofia":e.formatMessage({id:"allTimeZones.Europe/Sofia",defaultMessage:"Europe/Sofia"}),"Europe/Stockholm":e.formatMessage({id:"allTimeZones.Europe/Stockholm",defaultMessage:"Europe/Stockholm"}),"Europe/Tallinn":e.formatMessage({id:"allTimeZones.Europe/Tallinn",defaultMessage:"Europe/Tallinn"}),"Europe/Tirane":e.formatMessage({id:"allTimeZones.Europe/Tirane",defaultMessage:"Europe/Tirane"}),"Europe/Tiraspol":e.formatMessage({id:"allTimeZones.Europe/Tiraspol",defaultMessage:"Europe/Tiraspol"}),"Europe/Ulyanovsk":e.formatMessage({id:"allTimeZones.Europe/Ulyanovsk",defaultMessage:"Europe/Ulyanovsk"}),"Europe/Uzhgorod":e.formatMessage({id:"allTimeZones.Europe/Uzhgorod",defaultMessage:"Europe/Uzhgorod"}),"Europe/Vaduz":e.formatMessage({id:"allTimeZones.Europe/Vaduz",defaultMessage:"Europe/Vaduz"}),"Europe/Vatican":e.formatMessage({id:"allTimeZones.Europe/Vatican",defaultMessage:"Europe/Vatican"}),"Europe/Vienna":e.formatMessage({id:"allTimeZones.Europe/Vienna",defaultMessage:"Europe/Vienna"}),"Europe/Vilnius":e.formatMessage({id:"allTimeZones.Europe/Vilnius",defaultMessage:"Europe/Vilnius"}),"Europe/Volgograd":e.formatMessage({id:"allTimeZones.Europe/Volgograd",defaultMessage:"Europe/Volgograd"}),"Europe/Warsaw":e.formatMessage({id:"allTimeZones.Europe/Warsaw",defaultMessage:"Europe/Warsaw"}),"Europe/Zagreb":e.formatMessage({id:"allTimeZones.Europe/Zagreb",defaultMessage:"Europe/Zagreb"}),"Europe/Zaporozhye":e.formatMessage({id:"allTimeZones.Europe/Zaporozhye",defaultMessage:"Europe/Zaporozhye"}),"Europe/Zurich":e.formatMessage({id:"allTimeZones.Europe/Zurich",defaultMessage:"Europe/Zurich"}),GB:e.formatMessage({id:"allTimeZones.GB",defaultMessage:"GB"}),"GB-Eire":e.formatMessage({id:"allTimeZones.GB-Eire",defaultMessage:"GB-Eire"}),GMT:e.formatMessage({id:"allTimeZones.GMT",defaultMessage:"GMT"}),"GMT+0":e.formatMessage({id:"allTimeZones.GMT+0",defaultMessage:"GMT+0"}),"GMT-0":e.formatMessage({id:"allTimeZones.GMT-0",defaultMessage:"GMT-0"}),GMT0:e.formatMessage({id:"allTimeZones.GMT0",defaultMessage:"GMT0"}),Greenwich:e.formatMessage({id:"allTimeZones.Greenwich",defaultMessage:"Greenwich"}),HST:e.formatMessage({id:"allTimeZones.HST",defaultMessage:"HST"}),Hongkong:e.formatMessage({id:"allTimeZones.Hongkong",defaultMessage:"Hongkong"}),Iceland:e.formatMessage({id:"allTimeZones.Iceland",defaultMessage:"Iceland"}),"Indian/Antananarivo":e.formatMessage({id:"allTimeZones.Indian/Antananarivo",defaultMessage:"Indian/Antananarivo"}),"Indian/Chagos":e.formatMessage({id:"allTimeZones.Indian/Chagos",defaultMessage:"Indian/Chagos"}),"Indian/Christmas":e.formatMessage({id:"allTimeZones.Indian/Christmas",defaultMessage:"Indian/Christmas"}),"Indian/Cocos":e.formatMessage({id:"allTimeZones.Indian/Cocos",defaultMessage:"Indian/Cocos"}),"Indian/Comoro":e.formatMessage({id:"allTimeZones.Indian/Comoro",defaultMessage:"Indian/Comoro"}),"Indian/Kerguelen":e.formatMessage({id:"allTimeZones.Indian/Kerguelen",defaultMessage:"Indian/Kerguelen"}),"Indian/Mahe":e.formatMessage({id:"allTimeZones.Indian/Mahe",defaultMessage:"Indian/Mahe"}),"Indian/Maldives":e.formatMessage({id:"allTimeZones.Indian/Maldives",defaultMessage:"Indian/Maldives"}),"Indian/Mauritius":e.formatMessage({id:"allTimeZones.Indian/Mauritius",defaultMessage:"Indian/Mauritius"}),"Indian/Mayotte":e.formatMessage({id:"allTimeZones.Indian/Mayotte",defaultMessage:"Indian/Mayotte"}),"Indian/Reunion":e.formatMessage({id:"allTimeZones.Indian/Reunion",defaultMessage:"Indian/Reunion"}),Iran:e.formatMessage({id:"allTimeZones.Iran",defaultMessage:"Iran"}),Israel:e.formatMessage({id:"allTimeZones.Israel",defaultMessage:"Israel"}),Jamaica:e.formatMessage({id:"allTimeZones.Jamaica",defaultMessage:"Jamaica"}),Japan:e.formatMessage({id:"allTimeZones.Japan",defaultMessage:"Japan"}),Kwajalein:e.formatMessage({id:"allTimeZones.Kwajalein",defaultMessage:"Kwajalein"}),Libya:e.formatMessage({id:"allTimeZones.Libya",defaultMessage:"Libya"}),MET:e.formatMessage({id:"allTimeZones.MET",defaultMessage:"MET"}),MST:e.formatMessage({id:"allTimeZones.MST",defaultMessage:"MST"}),MST7MDT:e.formatMessage({id:"allTimeZones.MST7MDT",defaultMessage:"MST7MDT"}),"Mexico/BajaNorte":e.formatMessage({id:"allTimeZones.Mexico/BajaNorte",defaultMessage:"Mexico/BajaNorte"}),"Mexico/BajaSur":e.formatMessage({id:"allTimeZones.Mexico/BajaSur",defaultMessage:"Mexico/BajaSur"}),"Mexico/General":e.formatMessage({id:"allTimeZones.Mexico/General",defaultMessage:"Mexico/General"}),NZ:e.formatMessage({id:"allTimeZones.NZ",defaultMessage:"NZ"}),"NZ-CHAT":e.formatMessage({id:"allTimeZones.NZ-CHAT",defaultMessage:"NZ-CHAT"}),Navajo:e.formatMessage({id:"allTimeZones.Navajo",defaultMessage:"Navajo"}),PRC:e.formatMessage({id:"allTimeZones.PRC",defaultMessage:"PRC"}),PST8PDT:e.formatMessage({id:"allTimeZones.PST8PDT",defaultMessage:"PST8PDT"}),"Pacific/Apia":e.formatMessage({id:"allTimeZones.Pacific/Apia",defaultMessage:"Pacific/Apia"}),"Pacific/Auckland":e.formatMessage({id:"allTimeZones.Pacific/Auckland",defaultMessage:"Pacific/Auckland"}),"Pacific/Bougainville":e.formatMessage({id:"allTimeZones.Pacific/Bougainville",defaultMessage:"Pacific/Bougainville"}),"Pacific/Chatham":e.formatMessage({id:"allTimeZones.Pacific/Chatham",defaultMessage:"Pacific/Chatham"}),"Pacific/Chuuk":e.formatMessage({id:"allTimeZones.Pacific/Chuuk",defaultMessage:"Pacific/Chuuk"}),"Pacific/Easter":e.formatMessage({id:"allTimeZones.Pacific/Easter",defaultMessage:"Pacific/Easter"}),"Pacific/Efate":e.formatMessage({id:"allTimeZones.Pacific/Efate",defaultMessage:"Pacific/Efate"}),"Pacific/Enderbury":e.formatMessage({id:"allTimeZones.Pacific/Enderbury",defaultMessage:"Pacific/Enderbury"}),"Pacific/Fakaofo":e.formatMessage({id:"allTimeZones.Pacific/Fakaofo",defaultMessage:"Pacific/Fakaofo"}),"Pacific/Fiji":e.formatMessage({id:"allTimeZones.Pacific/Fiji",defaultMessage:"Pacific/Fiji"}),"Pacific/Funafuti":e.formatMessage({id:"allTimeZones.Pacific/Funafuti",defaultMessage:"Pacific/Funafuti"}),"Pacific/Galapagos":e.formatMessage({id:"allTimeZones.Pacific/Galapagos",defaultMessage:"Pacific/Galapagos"}),"Pacific/Gambier":e.formatMessage({id:"allTimeZones.Pacific/Gambier",defaultMessage:"Pacific/Gambier"}),"Pacific/Guadalcanal":e.formatMessage({id:"allTimeZones.Pacific/Guadalcanal",defaultMessage:"Pacific/Guadalcanal"}),"Pacific/Guam":e.formatMessage({id:"allTimeZones.Pacific/Guam",defaultMessage:"Pacific/Guam"}),"Pacific/Honolulu":e.formatMessage({id:"allTimeZones.Pacific/Honolulu",defaultMessage:"Pacific/Honolulu"}),"Pacific/Johnston":e.formatMessage({id:"allTimeZones.Pacific/Johnston",defaultMessage:"Pacific/Johnston"}),"Pacific/Kiritimati":e.formatMessage({id:"allTimeZones.Pacific/Kiritimati",defaultMessage:"Pacific/Kiritimati"}),"Pacific/Kosrae":e.formatMessage({id:"allTimeZones.Pacific/Kosrae",defaultMessage:"Pacific/Kosrae"}),"Pacific/Kwajalein":e.formatMessage({id:"allTimeZones.Pacific/Kwajalein",defaultMessage:"Pacific/Kwajalein"}),"Pacific/Majuro":e.formatMessage({id:"allTimeZones.Pacific/Majuro",defaultMessage:"Pacific/Majuro"}),"Pacific/Marquesas":e.formatMessage({id:"allTimeZones.Pacific/Marquesas",defaultMessage:"Pacific/Marquesas"}),"Pacific/Midway":e.formatMessage({id:"allTimeZones.Pacific/Midway",defaultMessage:"Pacific/Midway"}),"Pacific/Nauru":e.formatMessage({id:"allTimeZones.Pacific/Nauru",defaultMessage:"Pacific/Nauru"}),"Pacific/Niue":e.formatMessage({id:"allTimeZones.Pacific/Niue",defaultMessage:"Pacific/Niue"}),"Pacific/Norfolk":e.formatMessage({id:"allTimeZones.Pacific/Norfolk",defaultMessage:"Pacific/Norfolk"}),"Pacific/Noumea":e.formatMessage({id:"allTimeZones.Pacific/Noumea",defaultMessage:"Pacific/Noumea"}),"Pacific/Pago_Pago":e.formatMessage({id:"allTimeZones.Pacific/Pago_Pago",defaultMessage:"Pacific/Pago_Pago"}),"Pacific/Palau":e.formatMessage({id:"allTimeZones.Pacific/Palau",defaultMessage:"Pacific/Palau"}),"Pacific/Pitcairn":e.formatMessage({id:"allTimeZones.Pacific/Pitcairn",defaultMessage:"Pacific/Pitcairn"}),"Pacific/Pohnpei":e.formatMessage({id:"allTimeZones.Pacific/Pohnpei",defaultMessage:"Pacific/Pohnpei"}),"Pacific/Ponape":e.formatMessage({id:"allTimeZones.Pacific/Ponape",defaultMessage:"Pacific/Ponape"}),"Pacific/Port_Moresby":e.formatMessage({id:"allTimeZones.Pacific/Port_Moresby",defaultMessage:"Pacific/Port_Moresby"}),"Pacific/Rarotonga":e.formatMessage({id:"allTimeZones.Pacific/Rarotonga",defaultMessage:"Pacific/Rarotonga"}),"Pacific/Saipan":e.formatMessage({id:"allTimeZones.Pacific/Saipan",defaultMessage:"Pacific/Saipan"}),"Pacific/Samoa":e.formatMessage({id:"allTimeZones.Pacific/Samoa",defaultMessage:"Pacific/Samoa"}),"Pacific/Tahiti":e.formatMessage({id:"allTimeZones.Pacific/Tahiti",defaultMessage:"Pacific/Tahiti"}),"Pacific/Tarawa":e.formatMessage({id:"allTimeZones.Pacific/Tarawa",defaultMessage:"Pacific/Tarawa"}),"Pacific/Tongatapu":e.formatMessage({id:"allTimeZones.Pacific/Tongatapu",defaultMessage:"Pacific/Tongatapu"}),"Pacific/Truk":e.formatMessage({id:"allTimeZones.Pacific/Truk",defaultMessage:"Pacific/Truk"}),"Pacific/Wake":e.formatMessage({id:"allTimeZones.Pacific/Wake",defaultMessage:"Pacific/Wake"}),"Pacific/Wallis":e.formatMessage({id:"allTimeZones.Pacific/Wallis",defaultMessage:"Pacific/Wallis"}),"Pacific/Yap":e.formatMessage({id:"allTimeZones.Pacific/Yap",defaultMessage:"Pacific/Yap"}),Poland:e.formatMessage({id:"allTimeZones.Poland",defaultMessage:"Poland"}),Portugal:e.formatMessage({id:"allTimeZones.Portugal",defaultMessage:"Portugal"}),ROC:e.formatMessage({id:"allTimeZones.ROC",defaultMessage:"ROC"}),ROK:e.formatMessage({id:"allTimeZones.ROK",defaultMessage:"ROK"}),Singapore:e.formatMessage({id:"allTimeZones.Singapore",defaultMessage:"Singapore"}),Turkey:e.formatMessage({id:"allTimeZones.Turkey",defaultMessage:"Turkey"}),UCT:e.formatMessage({id:"allTimeZones.UCT",defaultMessage:"UCT"}),"US/Alaska":e.formatMessage({id:"allTimeZones.US/Alaska",defaultMessage:"US/Alaska"}),"US/Aleutian":e.formatMessage({id:"allTimeZones.US/Aleutian",defaultMessage:"US/Aleutian"}),"US/Arizona":e.formatMessage({id:"allTimeZones.US/Arizona",defaultMessage:"US/Arizona"}),"US/Central":e.formatMessage({id:"allTimeZones.US/Central",defaultMessage:"US/Central"}),"US/East-Indiana":e.formatMessage({id:"allTimeZones.US/East-Indiana",defaultMessage:"US/East-Indiana"}),"US/Eastern":e.formatMessage({id:"allTimeZones.US/Eastern",defaultMessage:"US/Eastern"}),"US/Hawaii":e.formatMessage({id:"allTimeZones.US/Hawaii",defaultMessage:"US/Hawaii"}),"US/Indiana-Starke":e.formatMessage({id:"allTimeZones.US/Indiana-Starke",defaultMessage:"US/Indiana-Starke"}),"US/Michigan":e.formatMessage({id:"allTimeZones.US/Michigan",defaultMessage:"US/Michigan"}),"US/Mountain":e.formatMessage({id:"allTimeZones.US/Mountain",defaultMessage:"US/Mountain"}),"US/Pacific":e.formatMessage({id:"allTimeZones.US/Pacific",defaultMessage:"US/Pacific"}),"US/Pacific-New":e.formatMessage({id:"allTimeZones.US/Pacific-New",defaultMessage:"US/Pacific-New"}),"US/Samoa":e.formatMessage({id:"allTimeZones.US/Samoa",defaultMessage:"US/Samoa"}),UTC:e.formatMessage({id:"allTimeZones.UTC",defaultMessage:"UTC"}),Universal:e.formatMessage({id:"allTimeZones.Universal",defaultMessage:"Universal"}),"W-SU":e.formatMessage({id:"allTimeZones.W-SU",defaultMessage:"W-SU"}),WET:e.formatMessage({id:"allTimeZones.WET",defaultMessage:"WET"}),Zulu:e.formatMessage({id:"allTimeZones.Zulu",defaultMessage:"Zulu"})}));var C=a("Mht8"),T=a("zb5D");const k=b.default.tz.names().map(e=>({name:e,utcOffset:b.default.tz(e).utcOffset()})).sort((e,t)=>e.utcOffset-t.utcOffset);p.a.memoize(e=>{if(0===e)return b.default.utc("1990-12-28").zoneAbbr();const t=k.find(t=>e===t.utcOffset);return t?t.name:void 0});function A(e,t){const a=b.default.tz(t),i=S(e)[t];return i?"GMT".concat(a.format("Z")," - ").concat(i," (").concat(a.format("z"),")"):(C.log({level:"error",from:"timeZoneHelpers",type:"localizedName",error:Object(T.a)("Missing ".concat(t," from timeZoneToLocalizedTimeZone"))}),"GMT".concat(a.format("Z")))}var w=a("LEzx");let I,P;!function(e){e.StartDate="startDate",e.StartTime="startTime",e.EndDate="endDate",e.EndTime="endTime"}(I||(I={})),function(e){e.InvalidDate="Invalid date",e.InvalidTime="Invalid time",e.InvalidRange="Invalid range"}(P||(P={}));class F extends w.a{getInitialState(){return{focus:I.StartDate,inputIsFocused:!1,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}}}}var x=F,E=a("i3uR"),B=a("yNyh"),D=a("LeVO"),O=a("nFzZ"),R=a("mjq6"),L=a("D8Ld"),_=a("SR/M"),U=a("2Y+N"),j=a("hU3F"),N=a("gbGO"),Z=a("dXb3"),W=a("WgIs"),V=a("zTdN"),z=a("mF3+"),q=a("ikHm"),H=a("MHAS"),G=a("awNq"),K=a("O+wX"),Y=a("rGsA"),Q=a("y6Dp"),J=a("zmp8"),X=a("lCCU"),$=a("KTXS"),ee=a("7KuZ"),te=a("aEEb"),ae=a("J9+s"),ie=a("nPEg"),se=a("0CAA"),ne=a("lpTC"),oe=a("T8dS"),re=a("QgQJ");class le extends m.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:x,timezoneQuery:j.a.of("")}),l()(this,"renderNavbarElement",({onPreviousClick:e,onNextClick:t})=>{const{device:a}=this.environment;return o()("div",{style:a.isMobile?le.mobileNavStyle:le.desktopNavStyle},void 0,o()(X.a,{mobileFeedback:a.isMobile,icon:z.a.chevronLeft,onClick:()=>e()}),o()(X.a,{mobileFeedback:a.isMobile,icon:z.a.chevronRight,onClick:()=>t()}))}),l()(this,"handleDateFormatChange",e=>{this.props.onChangeDateFormat(e)}),l()(this,"handleTimeFormatChange",e=>{const t=this.getTimeFormatOptions()[e];this.props.onChangeTimeFormat(t)}),l()(this,"handleChangeReminder",e=>{const t=this.getDateValue();e?g.ab(e)?this.props.onChangeValue({...t,reminder:e}):"datetime"!==t.type&&"datetimerange"!==t.type||this.props.onChangeValue({...t,reminder:e}):this.props.onChangeValue({...t,reminder:e}),Q.ze(this.environment,{date:t,reminder:e})}),l()(this,"handleInputChange",e=>{const{device:t}=this.environment,{store:a}=this.stores;a.setState({...a.state,inputTemporaryValue:{...a.state.inputTemporaryValue,[a.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()}),l()(this,"handleStartDateInputChange",()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const a=this.parseInputDateValue(t);if(!a)return P.InvalidDate;const i=this.getDateValue();if(g.Z(i)||g.bb(i)){const{newDate:e,currentMonth:t}=g.O({previous:i,updatedStartDate:a});this.applyValidDateState({newDate:e,currentMonth:t,resetField:I.StartDate})}else{const e={...i,start_date:a},t=g.L(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:I.StartDate})}}),l()(this,"handleStartTimeInputChange",()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const a=this.parseInputTimeValue(t);if(!a)return P.InvalidTime;const i=this.getDateValue();if(g.bb(i)){const{newDate:e,currentMonth:t}=g.P({previous:i,updatedStartTime:a});this.applyValidDateState({newDate:e,currentMonth:t,resetField:I.StartTime}),this.resetInputState(I.EndDate),this.resetInputState(I.EndTime)}else{const e={...i,start_time:a},t=g.L(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:I.StartTime})}}),l()(this,"handleEndDateInputChange",()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const a=this.parseInputDateValue(t);if(!a)return P.InvalidDate;const i={...this.getDateValue(),end_date:a},s=g.L(i);if(!s)return P.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:s.end,resetField:I.EndDate})}),l()(this,"handleEndTimeInputChange",()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const a=this.parseInputTimeValue(t);if(!a)return P.InvalidTime;const i={...this.getDateValue(),end_time:a},s=g.L(i);if(!s)return P.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:s.end,resetField:I.EndTime})}),l()(this,"handleInputBlur",e=>{const{focus:t}=this.stores.store.state;let a=void 0;t===I.StartDate?a=this.handleStartDateInputChange():t===I.StartTime?a=this.handleStartTimeInputChange():t===I.EndDate?a=this.handleEndDateInputChange():t===I.EndTime&&(a=this.handleEndTimeInputChange()),a?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:a}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),l()(this,"handleInputSubmit",()=>{const{focus:e}=this.stores.store.state;let t=void 0;e===I.StartDate?t=this.handleStartDateInputChange():e===I.StartTime?t=this.handleStartTimeInputChange():e===I.EndDate?t=this.handleEndDateInputChange():e===I.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),l()(this,"handleDayPickerDayClick",e=>{if(this.props.disabled)return;const t=p.a.cloneDeep(this.getDateValue()),{focus:a}=this.stores.store.state,i=Object(M.a)(e).locale(g.mb).format(g.lb);if("daterange"===t.type||"datetimerange"===t.type){const e=a===I.StartDate||a===I.StartTime?I.EndDate:I.StartDate;if(i===t[e===I.StartDate?"start_date":"end_date"])return void this.stores.store.setState({...this.stores.store.state,focus:e});a===I.StartDate||a===I.StartTime?t.start_date=i:a!==I.EndDate&&a!==I.EndTime||(t.end_date=i);const s=g.K(t,g.m);if(s.end&&s.end.isBefore(s.start)){if("datetimerange"===t.type){const{start_date:e,start_time:a,end_date:i,end_time:s}=t;t.start_date=i,t.start_time=s,t.end_date=e,t.end_time=a}else{const{start_date:e,end_date:a}=t;t.start_date=a,t.end_date=e}this.stores.store.setState({...this.stores.store.state,focus:a===I.StartDate||a===I.StartTime?I.EndDate:I.StartDate})}this.props.onChangeValue(t),this.resetInputState(a)}else t.start_date=i,this.props.onChangeValue(t),this.resetInputState(a)}),l()(this,"handleDayPickerMonthChange",e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:Object(M.a)(e)})}),l()(this,"handleEndDateControlChange",()=>{const e=this.getDateValue();if("datetimerange"===e.type){const t={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};this.props.onChangeValue(t)}else if("daterange"===e.type){const t={type:"date",start_date:e.start_date,reminder:e.reminder};this.props.onChangeValue(t)}else if("datetime"===e.type){const t={type:"datetimerange",start_date:e.start_date,start_time:e.start_time,end_date:e.start_date,end_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};this.props.onChangeValue(t),this.stores.store.setState({...this.stores.store.state,focus:I.EndDate})}else{const t={type:"daterange",start_date:e.start_date,end_date:e.start_date,reminder:e.reminder};this.props.onChangeValue(t),this.stores.store.setState({...this.stores.store.state,focus:I.EndDate})}}),l()(this,"handleAllDayChange",()=>{const e=this.getDateValue();if("date"===e.type){const t={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:g.m,reminder:e.reminder&&g.k(e.reminder)};this.props.onChangeValue(t)}else if("daterange"===e.type){const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:g.m,reminder:e.reminder&&g.k(e.reminder)};this.props.onChangeValue(t)}else if("datetime"===e.type){const t={type:"date",start_date:e.start_date,reminder:e.reminder&&g.j(e.reminder)};this.props.onChangeValue(t)}else{const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&g.j(e.reminder)};this.props.onChangeValue(t)}}),l()(this,"handleTimeZoneChange",e=>{const t=k.find(t=>t.name===e);if(!t)return;const a=t.name,i=this.getDateValue();if("datetime"===i.type||"datetimerange"===i.type){const e={...i,time_zone:a};this.props.onChangeValue(e)}}),l()(this,"handleStartInputDateFocus",()=>{const e=this.getDateValue(),t=g.K(e,g.m);this.stores.store.setState({...this.stores.store.state,focus:I.StartDate,inputIsFocused:!0,currentMonth:t.start})}),l()(this,"handleStartInputTimeFocus",()=>{const e=this.getDateValue(),t=g.K(e,g.m);this.stores.store.setState({...this.stores.store.state,focus:I.StartTime,inputIsFocused:!0,currentMonth:t.start})}),l()(this,"handleEndInputDateFocus",()=>{const e=this.getDateValue(),t=g.K(e,g.m);t.end&&this.stores.store.setState({...this.stores.store.state,focus:I.EndDate,inputIsFocused:!0,currentMonth:t.end})}),l()(this,"handleEndInputTimeFocus",()=>{const e=this.getDateValue(),t=g.K(e,g.m);t.end&&this.stores.store.setState({...this.stores.store.state,focus:I.EndTime,inputIsFocused:!0,currentMonth:t.end})}),l()(this,"handleClearClick",()=>{this.props.onChangeValue(void 0)}),l()(this,"getTimeFormatOptions",()=>Object(ne.a)(oe.a).time),l()(this,"getSelectedTimeFormatType",()=>{const e=this.getTimeFormat(),t=this.getTimeFormatOptions();for(const a in t)if(t[a]===e)return a;return"12h"}),l()(this,"getTimeZoneItemsSync",e=>Object(R.b)(e,k,e=>p.a.compact([e.name,A(this.props.intl,e.name)]).join(" ")).map((e,t)=>({key:e.name,render:t=>c.a.createElement(_.a,s()({},t,{title:A(this.props.intl,e.name)})),action:()=>{this.handleTimeZoneChange(e.name)}}))),l()(this,"tooltipOriginGap",12)}willMount(e){super.willMount(e),this.openTimeFormat=g.qb(g.m)}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:a,locked:i,shouldShowReminder:s}=this.props,{inputIsFocused:n}=this.stores.store.state,r=this.getDateValue(),l="datetime"===r.type||"datetimerange"===r.type,d="daterange"===r.type||"datetimerange"===r.type,u=o()("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:l?"block":"flex",...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t\t0 1px 0 ".concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t"),position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,this.renderStartInput(),d&&o()("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone());let p;return p=e.isMobile?{menuType:N.b.MenuType.Modal,title:o()(ae.FormattedMessage,{defaultMessage:"Date",id:"datePropertyMenu.mobileDate.title"}),right:o()(ae.FormattedMessage,{defaultMessage:"Done",id:"datePropertyMenu.mobileDoneButton.label"}),left:s?this.renderRemindersHelp():void 0,onClickRight:this.props.onDismiss,header:u}:{menuType:N.b.MenuType.Popup,maxHeight:"none",width:270},o()(L.a,{capture:n,allowEsc:!0,allowTabUntab:!1},void 0,o()(L.a,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1},void 0,c.a.createElement(N.b,p,o()(Y.a,{show:n}),o()(U.a,{},void 0,!e.isMobile&&u,o()("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:"1px solid ".concat(this.theme.regularDividerColor),background:this.theme.popoverBackground}}},void 0,this.renderCalendar())),!a&&this.renderControls(),!a&&!i&&o()(U.a,{topBorder:!0},void 0,this.renderFormatPopup()),!a&&o()(U.a,{topBorder:!0},void 0,this.renderClearButton()),!a&&!e.isMobile&&s&&o()(U.a,{topBorder:!0},void 0,this.renderRemindersHelp()))))}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:a,inputTemporaryValue:i,error:s}=this.stores.store.state,n=this.getDateValue(),r=g.K(n,g.m),l=Boolean(s.startDate||s.startTime),d="datetime"===n.type||"datetimerange"===n.type,c="daterange"===n.type||"datetimerange"===n.type,u=a===I.StartDate||a===I.StartTime,p=Object(O.h)(i.startDate)?r.start.locale(!1).format(this.getDateDisplayFormat()):i.startDate,m=Object(O.h)(i.startTime)?r.start.locale(!1).format(this.getTimeFormat()):i.startTime,h=Object(O.h)(i.startDate)?r.start.format(g.lb):i.startDate,f=Object(O.h)(i.startTime)?r.start.format(g.nb):i.startTime;return o()("div",{style:{...l?this.getInputWrapErrorStyle():u&&c?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,o()(D.a,{renderTooltip:()=>this.getInputErrorMessage(s.startDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(s.startDate),placement:D.a.Placement.Left,render:()=>e.isMobile?o()(B.b,{type:"date",format:B.a.Transparent,value:h,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):o()(B.b,{format:B.a.Transparent,value:p,focusInitial:a===I.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),d&&this.getInputSeparator(),d&&o()(D.a,{renderTooltip:()=>this.getInputErrorMessage(s.startTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(s.startTime),placement:D.a.Placement.Right,render:()=>e.isMobile?o()(B.b,{type:"time",format:B.a.Transparent,value:f,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):o()(B.b,{format:B.a.Transparent,value:m,focusInitial:a===I.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,a=this.getDateValue(),i=g.K(a,g.m),s="datetime"===a.type||"datetimerange"===a.type;if(i.end){const{focus:a,error:n,inputTemporaryValue:r}=this.stores.store.state,l=Boolean(n.endDate||n.endTime),d=a===I.EndDate||a===I.EndTime,c=Object(O.h)(r.endDate)?i.end.locale(!1).format(this.getDateDisplayFormat()):r.endDate,u=Object(O.h)(r.endTime)?i.end.locale(!1).format(this.getTimeFormat()):r.endTime,p=Object(O.h)(r.endDate)?i.end.format(g.lb):r.endDate,m=Object(O.h)(r.endTime)?i.end.format(g.nb):r.endTime,h=this.getDateRangeBounds(),f=h&&h.earliestValidEnd;return o()("div",{style:{...l?this.getInputWrapErrorStyle():d?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,o()(D.a,{renderTooltip:()=>this.getInputErrorMessage(n.endDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.endDate),placement:D.a.Placement.Left,render:()=>e.isMobile?o()(B.b,{type:"date",format:B.a.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:f}}):o()(B.b,{format:B.a.Transparent,value:c,focusInitial:a===I.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),s&&this.getInputSeparator(),s&&o()(D.a,{renderTooltip:()=>this.getInputErrorMessage(n.endTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.endTime),placement:D.a.Placement.Right,render:()=>e.isMobile?o()(B.b,{type:"time",format:B.a.Transparent,value:m,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):o()(B.b,{format:B.a.Transparent,value:u,focusInitial:a===I.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}}renderTimeZone(){const{device:e}=this.environment,t=this.getDateValue(),a=g.K(t,g.m),i=M.a.tz(a.start,g.m);if(("datetime"===t.type||"datetimerange"===t.type)&&i.utcOffset()!==a.start.utcOffset()){const a=k.find(e=>e.name===t.time_zone);if(a)return o()(te.a,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8}},void 0,A(this.props.intl,a.name))}}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),a=g.K(t,g.m),i=this.stores.store.state.currentMonth||a.start,{focus:s}=this.stores.store.state;if(a.end){const t=a.start.toDate(),n=a.end.toDate(),r=s===I.StartDate||s===I.StartTime;return o()(f.a,{className:"notion-calendar-picker notranslate",firstDayOfWeek:e,numberOfMonths:1,initialMonth:i.toDate(),month:i.toDate(),locale:oe.a,localeUtils:re.a,modifiers:{range:{from:t,to:n},...r?{end:n,start:t}:{start:t,end:n}},modifiersStyles:{range:le.dayPickerRangeDayStyle,start:r?this.getDayPickerActiveDayStyle():this.getDayPickerInactiveDayStyle(),end:r?this.getDayPickerInactiveDayStyle():this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,navbarElement:this.renderNavbarElement,onMonthChange:this.handleDayPickerMonthChange})}{const t=a.start.toDate();return o()(f.a,{className:"notion-calendar-picker notranslate",numberOfMonths:1,firstDayOfWeek:e,initialMonth:i.toDate(),month:i.toDate(),locale:oe.a,localeUtils:re.a,selectedDays:[t],modifiers:{start:t},modifiersStyles:{start:this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,navbarElement:this.renderNavbarElement,onDayClick:this.handleDayPickerDayClick,onMonthChange:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?o()(U.a,{topBorder:!0},void 0,t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()):o()(d.Fragment,{},void 0,t&&o()(U.a,{topBorder:!0},void 0,this.renderReminderControl()),o()(U.a,{topBorder:!0},void 0,this.renderEndDateControl(),this.renderAllDayControl()))}renderEndDateControl(){const{device:e}=this.environment,t=this.getDateValue();return o()(_.a,{focused:!1,onClick:this.handleEndDateControlChange,title:o()(ae.FormattedMessage,{defaultMessage:"End date",id:"datePropertyMenu.menuItem.endDate.label"}),right:o()(v.a,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:this.handleEndDateControlChange,isAndroid:e.isAndroid})})}renderAllDayControl(){const{device:e}=this.environment,t=this.getDateValue();return o()(_.a,{focused:!1,onClick:this.handleAllDayChange,title:o()(ae.FormattedMessage,{defaultMessage:"Include time",id:"datePropertyMenu.menuItem.includeTime.label",description:"Shown in the date property menu as an option for whether this date includes a time."}),right:o()(v.a,{on:"date"!==t.type&&"daterange"!==t.type,onClick:this.handleAllDayChange,isAndroid:e.isAndroid})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,a=this.getDateValue();return o()(E.a,{popupType:e.isMobile?E.a.PopupType.SlideUp:E.a.PopupType.Popup,placementToOrigin:E.a.Placement.Right,renderOrigin:i=>c.a.createElement(H.a,s()({},i,{icon:z.a.alarmClock({width:14}),title:o()(ae.FormattedMessage,{defaultMessage:"Remind",id:"datePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:Object(K.d)({reminder:a.reminder,intl:t})})),render:i=>{let n;n=e.isMobile?{menuType:N.b.MenuType.Modal,title:o()(ae.FormattedMessage,{defaultMessage:"Remind",id:"datePropertyMenu.mobileRemindModal.title"}),right:o()(ae.FormattedMessage,{defaultMessage:"Done",id:"datePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:i.close}:{menuType:N.b.MenuType.Popup,width:250};const r=("date"===a.type||"daterange"===a.type?g.q:g.t).map(e=>{const a=Object(K.d)({reminder:e,shouldShowTime:!0,intl:t});return{key:a,action:t=>{this.handleChangeReminder(e),i.close()},render:(e,t)=>c.a.createElement(_.a,s()({},e,{title:a}))}});return c.a.createElement(N.b,n,o()(W.a,{type:W.a.Type.Vertical,sections:[{key:"reminder section",render:e=>c.a.createElement(U.a,e),items:r}],initialFocus:void 0}))}})}renderFormatPopup(){const{device:e}=this.environment;return o()(E.a,{popupType:e.isMobile?E.a.PopupType.SlideUp:E.a.PopupType.Popup,placementToOrigin:E.a.Placement.Right,renderOrigin:t=>c.a.createElement(_.a,s()({},t,{icon:z.a.sidebarSettings({width:14}),title:o()(ae.FormattedMessage,{defaultMessage:"Date format & timezone",id:"datePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile})),render:t=>{let a;return a=e.isMobile?{menuType:N.b.MenuType.Modal,title:o()(ae.FormattedMessage,{defaultMessage:"Date format",id:"datePropertyMenu.mobileDateFormatModal.title"}),right:o()(ae.FormattedMessage,{defaultMessage:"Done",id:"datePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:N.b.MenuType.Popup,width:250},c.a.createElement(N.b,a,o()(U.a,{},void 0,this.renderDateFormatControl(),this.renderTimeFormatControl(),this.renderTimeZoneControl()))}})}renderDateFormatControl(){const e=this.props.dateFormat||g.v,{intl:t}=this.props,a={menuTitle:t.formatMessage({defaultMessage:"Date format",id:"datePropertyMenu.dateFormatDropdownButton.label"}),items:g.c,getKey:e=>e,selectedItem:e,onSelect:this.handleDateFormatChange,renderItem:e=>c.a.createElement(_.a,s()({},e,{title:t.formatMessage(g.b[e.value])})),renderOrigin:a=>c.a.createElement(H.a,s()({focused:!1,title:o()(ae.FormattedMessage,{defaultMessage:"Date format",id:"datePropertyMenu.menuItem.format.label"}),right:e?t.formatMessage(g.b[e]):o()(ae.FormattedMessage,{defaultMessage:"Empty",id:"datePropertyMenu.formatMenu.emptyButton.label"})},a))};return c.a.createElement(y.a,a)}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,a=this.getTimeFormat(),{intl:i}=this.props,n=this.getSelectedTimeFormatType(),r={menuTitle:i.formatMessage({defaultMessage:"Time format",id:"datePropertyMenu.timeFormatMenu.title"}),items:g.e,getKey:e=>e,selectedItem:n,onSelect:this.handleTimeFormatChange,renderItem:e=>c.a.createElement(_.a,s()({},e,{title:i.formatMessage(g.a[e.value])})),disabled:t,renderOrigin:e=>c.a.createElement(H.a,s()({focused:!1,title:o()(ae.FormattedMessage,{defaultMessage:"Time format",id:"datePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(a?i.formatMessage(g.a[n]):o()(ae.FormattedMessage,{defaultMessage:"Empty",id:"datePropertyMenu.timeFormatMenu.emptyButton.label"}))},e))};return c.a.createElement(y.a,r)}renderTimeZoneControl(){const{device:e}=this.environment,t=this.getDateValue(),a="date"===t.type||"daterange"===t.type,i=this.getCurrentTimeZone(),n=k.find(e=>e.name===i),{intl:r}=this.props;if(n)return o()(E.a,{popupType:e.isMobile?E.a.PopupType.SlideUp:E.a.PopupType.Popup,disabled:a,onClick:()=>this.stores.timezoneQuery.set(""),renderOrigin:e=>c.a.createElement(H.a,s()({focused:!1,title:o()(ae.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:a,right:!a&&M.a.tz.zone(n.name).abbr(Date.now())},e)),render:t=>{const a=this.stores.timezoneQuery.get(),i=this.getTimeZoneItemsSync(a),n=o()(U.a,{isInput:!0},void 0,o()(Z.a,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,value:this.stores.timezoneQuery.get(),onChange:e=>this.stores.timezoneQuery.set(e.target.value),placeholder:r.formatMessage({defaultMessage:"Search for a timezone…",id:"datePropertyMenu.timeSearch.placeholder"})}));let l;return l=e.isMobile?{menuType:N.b.MenuType.Modal,title:o()(ae.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.mobileTimezoneMenu.title"}),right:o()(ie.CancelMenuText,{}),onClickRight:t.close,header:n}:{menuType:N.b.MenuType.Popup,header:n},c.a.createElement(N.b,l,0===i.length?o()(U.a,{title:o()(ae.FormattedMessage,{defaultMessage:"Select a timezone",id:"datePropertyMenu.timezoneMenu.select.placeholder"})},void 0,o()(V.a,{title:o()(ae.FormattedMessage,{defaultMessage:"No results",id:"datePropertyMenu.timezoneMenu.noResults"})})):o()(W.a,{type:W.a.Type.Vertical,initialFocus:0,sections:[{key:"timezone section",render:e=>c.a.createElement(U.a,s()({},e,{title:o()(ae.FormattedMessage,{defaultMessage:"Select a timezone",id:"datePropertyMenu.menuItem.select.title"})})),items:i}],onAccept:t.close}))}})}renderClearButton(){return o()(_.a,{focused:!1,onClick:this.handleClearClick,title:o()(ae.FormattedMessage,{defaultMessage:"Clear",id:"datePropertyMenu.clearButton.label"})})}renderRemindersHelp(){const{device:e}=this.environment;return e.isMobile?o()(ee.a,{href:Object(se.a)("guides.reminders"),analyticsFrom:"date_selector"}):o()($.a,{title:o()(ae.FormattedMessage,{defaultMessage:"Learn about reminders",id:"datePropertyMenu.learnMore.helpButton.label"}),href:Object(se.a)("guides.reminders"),analyticsFrom:"date_selector"})}getDateValue(){const{value:e}=this.props;return e&&!p.a.isNaN(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(g.Z(e)||g.bb(e)){const t=g.K(e,g.m);return{earliestValidEnd:t.start.format(g.lb),latestValidStart:t.end.format(g.lb)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!p.a.isNaN(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:g.m}:e:this.openTimeFormat}getDateDisplayFormat(){const e=this.props.dateFormat||g.v;return"relative"===e?g.v:e}getTimeFormat(){return this.props.timeFormat||g.x}getCurrentTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:g.m}parseInputDateValue(e){const{intl:t}=this.props;return this.environment.device.isMobile?Object(G.b)(e,g.lb,t):Object(G.b)(e,this.getDateDisplayFormat(),t)}parseInputTimeValue(e){const t=Object(M.a)(e,this.getTimeFormat(),!0);return t.isValid()?t.locale(g.mb).format(g.nb):Object(G.f)(e,this.props.intl)}applyValidDateState(e){const{newDate:t,currentMonth:a,resetField:i}=e;this.props.onChangeValue(t),this.stores.store.setState({...this.stores.store.state,currentMonth:a}),this.resetInputState(i)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}getInputErrorMessage(e){const{intl:t}=this.props;switch(e){case P.InvalidDate:return t.formatMessage({id:"datePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case P.InvalidRange:return t.formatMessage({id:"datePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case P.InvalidTime:return t.formatMessage({id:"datePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}getInputSeparator(){return o()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",borderRadius:3,height:28,lineHeight:1.2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}getInputWrapInactiveStyle(){return{...this.getInputWrapStyle(),boxShadow:this.theme.inputBoxShadow,flexGrow:1}}getInputWrapErrorStyle(){return{...this.getInputWrapStyle(),boxShadow:"inset 0 0 0 2px ".concat(J.g.red),background:J.g.redWithAlpha(.15),flexGrow:1}}getInputWrapActiveStyle(){return{...this.getInputWrapStyle(),boxShadow:"inset 0 0 0 2px ".concat(J.g.blue),background:J.g.blueWithAlpha(.15),flexGrow:1}}getDayPickerActiveDayStyle(){return{backgroundColor:J.g.blue,color:J.g.white}}getDayPickerInactiveDayStyle(){return{backgroundColor:J.g.blueWithAlpha(.5)}}}l()(le,"dayPickerRangeDayStyle",{backgroundColor:J.g.blueWithAlpha(.15)}),l()(le,"desktopNavStyle",{display:"flex",position:"absolute",top:0,right:4,zIndex:q.m}),l()(le,"mobileNavStyle",{display:"flex",position:"absolute",top:-2,right:4,zIndex:q.m});t.default=Object(ae.injectIntl)(le)},Q2G9:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("q1tI")),c=a.n(d),u=a("wldR"),p=a("/6eU"),m=a("naZa"),g=a("Rd/G"),h=a("Ma8p"),f=a("Na01"),M=a("8fuX"),y=a("Sb6f"),v=a("30UQ"),b=a("MBf9"),S=a("wlCD"),C=a("y6Dp"),T=a("nPEg"),k=a("wXH4"),A=a("Cm2F"),w=a("VBxf"),I=a("QcDD"),P=a("vJXr"),F=a("cy36"),x=a("Ng05"),E=a("MeYt"),B=a("7M94"),D=a("mF3+"),O=a("bFnu");class R extends u.a{constructor(...e){super(...e),l()(this,"storeTypes",{mouseStore:O.a,labelMouseStore:O.a}),l()(this,"handleToggleClick",()=>{const{section:e}=this.props;this.isOpen()?v.e(e.sectionName):v.h(e.sectionName)}),l()(this,"handleMouseMove",()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})),l()(this,"handleMouseLeave",()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})),l()(this,"handleLabelMouseMove",()=>{const{labelMouseStore:e}=this.stores;e.setState({...e.state,mouseEntered:!0})}),l()(this,"handleLabelMouseLeave",()=>{const{labelMouseStore:e}=this.stores;e.setState({...e.state,mouseEntered:!1})})}renderComponent(){const{renderSection:e}=this.props,t=!this.isOpen();return o()("div",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,style:this.getButtonContainerStyle()},void 0,this.renderLabel(),!t&&e())}renderLabel(){const e=!this.isOpen();return o()(f.a,{isMobile:this.props.isMobile,disableMobileBorder:e,shouldShowMobileMarginBotton:e,style:this.getSectionSidebarItemStyle(),childrenStyle:{overflow:"visible"}},void 0,o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(E.a,{onClick:this.handleToggleClick,onMouseMove:this.handleLabelMouseMove,onMouseLeave:this.handleLabelMouseLeave,style:this.getLabelButtonStyle()},void 0,!Boolean(this.props.forceOpen)&&D.a.triangle(this.getArrowStyle()),o()("span",{style:this.getToggleButtonStyle()},void 0,this.props.icon&&o()("span",{style:{paddingRight:4,display:"inline-block"}},void 0,this.props.icon),this.props.section.name))))}isOpen(){const{section:e,expandedSections:t}=this.props;return!!t&&-1!==t.indexOf(e.sectionName)}getSectionSidebarItemStyle(){return{minHeight:24,padding:0}}getSectionLabelStyle(){return{lineHeight:1,marginBottom:1,color:this.theme.sidebarTextColor,fontWeight:y.a.fontWeight.semibold,marginLeft:9}}getMobileSectionLabelStyle(){return{lineHeight:1,color:this.theme.sidebarTextColor,fontWeight:y.a.fontWeight.semibold,marginLeft:9}}getLabelButtonStyle(){return{display:"flex",alignItems:"center",paddingBottom:12,paddingTop:12,paddingLeft:25,...this.props.isMobile&&{marginBottom:8},width:"100%"}}getToggleButtonStyle(){const{labelMouseStore:e}=this.stores,{mouseEntered:t}=e.state;return{...this.props.isMobile?this.getMobileSectionLabelStyle():this.getSectionLabelStyle(),color:t?this.theme.regularTextColor:this.theme.mediumTextColor,transition:"color 100ms ease-out"}}getButtonContainerStyle(){const e=!this.isOpen(),{first:t}=this.props;return{...t?{borderTop:"1px solid ".concat(this.theme.regularDividerColor)}:{},borderBottom:"1px solid ".concat(this.theme.regularDividerColor),width:"100%",paddingBottom:e?0:10}}getArrowStyle(){return{width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:"rotateZ(".concat(this.isOpen()?180:90,"deg)"),fill:this.theme.regularIconColor}}}var L=R,_=a("H4VD"),U=a("qqdV"),j=a("J9+s"),N=a("2ZkR"),Z=a("szb2"),W=a("pIip");class V extends u.a{constructor(...e){super(...e),l()(this,"storeTypes",{templateRecordCacheStore:W.a}),l()(this,"renderMobilePopup",()=>{const e=F.a.state;if(e.open)return o()(T.default,{title:o()(j.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:o()(T.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?o()(S.a,{}):o()(j.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label",description:"'Use' is utilized as a verb for a button label on the top right of a mobile menu, indicating to the user to click on the button to use the template they are previewing."}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0},void 0,this.renderPreview(e))}),l()(this,"renderModal",()=>{const e=F.a.state;if(e.open)return o()("div",{style:V.modalStyle,className:B.ob},void 0,this.renderPreview(e),this.renderSidebar(e))}),l()(this,"handleDismiss",async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.close()}else this.close()}),l()(this,"handleUseTemplateClick",async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.accept(!1)}else this.accept(!1)}),l()(this,"handleItemClick",async e=>{const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state;if(t.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.setCurrentItem(e)}else this.setCurrentItem(e);C.Re(this.environment,{name:e.name})})}willMountOrUpdate(){const e=F.a.state,{currentSpaceViewStore:t}=I.default.state;e.open&&t&&b.createAndCommit(this.environment,a=>{v.k({item:e.item,spaceViewStore:t,transaction:a})})}renderComponent(){const{device:e}=this.environment,t=F.a.state;return e.isMobile?o()(k.a,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:e.isMobile?k.a.PopupType.SlideUp:k.a.PopupType.Popup}):o()(p.a,{open:t.open,render:this.renderModal,onDismiss:this.handleDismiss})}renderSidebar(e){const{currentSpaceViewStore:t,currentSpaceStore:a}=I.default.state;if(!t||!a)return;const i=v.d(),n=Object(g.a)(this.props.intl),r="on"===N.default.getGroup(this.environment,"suggested-templates");return o()("div",{style:this.getSidebarStyle()},void 0,o()(x.a,{isLarge:!0,onClick:this.handleUseTemplateClick,style:V.useTemplateButtonStyle,disabled:e.isLoading||!P.a.state.online},void 0,e.isLoading&&o()(S.a,{isWhite:!0,style:{marginRight:6}}),o()(j.FormattedMessage,{defaultMessage:"Use this template",id:"pageTemplateModal.useTemplateButton.label"})),o()(M.b,{style:V.scrollerStyle,type:M.a.Y},void 0,r&&o()(L,{isMobile:!1,section:n,expandedSections:[...i||[],"suggested"],spaceStore:a,spaceViewStore:t,showAddPageButton:!1,first:!0,forceOpen:!0,icon:D.a.sparkles({width:12}),renderSection:()=>o()(d.Fragment,{},void 0,n.items.map((t,a)=>{const i=e.item.rootId===t.rootId,n=i?this.hoveredButtonStyle():{};return c.a.createElement(E.a,s()({hovered:i,style:n,key:a},this.props,{onClick:()=>this.handleItemClick(t)}),this.renderSidebarItem(t))}))},"suggested"),e.sections.map((n,l)=>o()(L,{isMobile:!1,section:n,expandedSections:i,spaceStore:a,spaceViewStore:t,showAddPageButton:!1,first:!r&&0===l,renderSection:()=>o()(d.Fragment,{},void 0,n.items.map((t,a)=>{const i=e.item.rootId===t.rootId,n=i?this.hoveredButtonStyle():{};return c.a.createElement(E.a,s()({hovered:i,style:n,key:a},this.props,{onClick:()=>this.handleItemClick(t)}),this.renderSidebarItem(t))}))},n.sectionName)),o()(E.a,{onClick:()=>Object(_.navigateToExternalURL)({environment:this.environment,url:U.d.templates}),style:this.fixedLinkStyle(),hoveredStyle:{background:this.theme.sidebarHideButtonHoveredBackground},pressedStyle:{background:this.theme.sidebarHideButtonPressedBackground}},void 0,D.a.typesRelation(this.fixedLinkIconStyle()),o()(j.FormattedMessage,{defaultMessage:"Browse more templates",id:"pageTemplateModal.goToFullTemplateGalleryButton.label"}))))}renderSidebarItem(e){return o()(f.a,{style:{paddingLeft:30,fontWeight:y.a.fontWeight.semibold},isMobile:!1,icon:o()("div",{style:this.getIconWrapStyle()},void 0,o()(h.a,{size:20,emoji:e.emoji}))},void 0,e.name)}renderPreview(e){const{device:t}=this.environment;return o()(m.a,{previewRootId:e.item.previewRootId,isFrontPage:!1,style:t.isMobile?V.previewMobileStyle:V.previewStyle,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!1},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,a=F.a.state,{currentSpaceViewStore:i,currentSpaceStore:s,currentBlockStore:n}=I.default.state;if(a.open&&i&&s){const o=n&&n.isEmptyPage()?n:void 0,r=Z.c.state.open&&Z.c.state.target&&Z.c.state.target.isEmptyPage()?Z.c.state.target:void 0;v.a({environment:this.environment,item:a.item,spaceStore:s,spaceViewStore:i,useRecordCache:e?t:void 0,initializeStore:a.createNewPage?void 0:o||r,isPrivate:a.isPrivate})}}close(){v.b(this.environment),A.a()}setCurrentItem(e){F.a.state.open&&v.j({templateItem:e,currentUserId:this.environment.currentUser.id})}showEditConfirmDialog(){return new Promise((e,t)=>{w.showDialog({message:o()(j.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:o()(j.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:o()(j.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})})}getSidebarStyle(){return{width:V.sidebarWidth,color:this.theme.mediumTextColor,background:this.theme.sidebarBackground,display:"flex",flexDirection:"column",borderTopRightRadius:V.borderRadius,borderBottomRightRadius:V.borderRadius}}getIconWrapStyle(){return{color:this.theme.regularTextColor,position:"relative"}}hoveredButtonStyle(){return{color:this.theme.regularTextColor,fontWeight:y.a.fontWeight.medium}}fixedLinkStyle(){return{padding:12,color:this.theme.mediumTextColor,background:this.theme.sidebarBackground,fontSize:13,fontWeight:y.a.fontWeight.medium,display:"flex",alignItems:"center",position:"absolute",bottom:0,right:0,height:45,width:V.sidebarWidth,borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}fixedLinkIconStyle(){return{width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:this.theme.regularIconColor,fontWeight:y.a.fontWeight.medium}}}l()(V,"sidebarWidth",240),l()(V,"borderRadius",3),l()(V,"modalStyle",{display:"flex",width:"85vw",height:"85vh",borderRadius:V.borderRadius}),l()(V,"useTemplateButtonStyle",{position:"relative",marginTop:16,marginLeft:20,marginRight:20,marginBottom:16,whiteSpace:"nowrap"}),l()(V,"previewStyle",{width:"calc(100% - ".concat(V.sidebarWidth,"px)"),flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"}),l()(V,"previewMobileStyle",{width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"}),l()(V,"scrollerStyle",{flexGrow:1,flexShrink:1,paddingBottom:44});t.default=Object(j.injectIntl)(V)},QgQJ:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a("mKX5"),s=a("lpTC"),n=a("T8dS");const o={getMonths:function(){for(var e=[],t=0;t<12;)e.push(Object(i.a)().month(t).format("MMMM")),t+=1;return e},formatDay:function(e){return Object(i.a)(e).format("ddd ll")},formatMonthTitle:function(e){const t=Object(s.a)(n.a).month;return Object(i.a)(e).format(t)},formatWeekdayShort:function(e){return i.a.weekdaysMin()[e]},formatWeekdayLong:function(e){return i.a.weekdays()[e]},getFirstDayOfWeek:function(){return i.a.localeData().firstDayOfWeek()}}},QmC8:function(e,t,a){"use strict";var i=a("LEzx");class s extends i.a{getInitialState(){return{open:!1}}}t.a=new s},"VcB+":function(e,t,a){"use strict";var i=a("g4rC");t.a=new i.a},Wyaw:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("wldR"),c=a("/6eU"),u=a("+U1l"),p=a("J9+s"),m=a("pVnL"),g=a.n(m),h=a("mF3+"),f=a("Sb6f"),M=a("LeVO"),y=a("Ggib"),v=a("toub"),b=a("7Vnh"),S=a("Cycz"),C=a("zmp8"),T=a("A9TN");class k extends d.a{renderComponent(){return l.a.createElement(l.a.Fragment,null,h.a.notionLogoStroked({width:34,height:34,marginBottom:18}),s()("div",{style:{...this.getPrimaryTextStyle(),marginBottom:6}},void 0,this.getPlanTitle()),s()("div",{style:this.getSecondaryTextStyle()},void 0,this.getOneLiner()),this.renderPriceAndTerms(),this.renderBlockLimit(),this.renderPlanFeatures(),this.renderLearnMore())}renderBlockLimit(){const{planInfo:e}=this.props;if("team_free"===e.subscriptionTier)return l.a.createElement(l.a.Fragment,null,s()("div",{style:{fontWeight:f.a.fontWeight.semibold,fontSize:24}},void 0,s()(p.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.title",defaultMessage:"Free"})),s()("div",{style:this.getSecondaryTextStyle()},void 0,s()(p.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.description",defaultMessage:"For the first 1,000 blocks"}),s()(M.a,{renderTooltip:()=>s()(p.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.tooltip",defaultMessage:"Blocks are pieces of content you add to a page, like a paragraph or to-do item.{br}Some features on the Team Plan are not available on the Team Trial.",values:{br:s()("br",{})}}),placement:M.a.Placement.Top,render:e=>l.a.createElement("span",e,h.a.help({marginLeft:6,width:14,fill:C.g.mediumIconColor,verticalAlign:"middle",display:"inline-block"}))})))}renderPriceAndTerms(){const{planInfo:e,intl:t}=this.props;if("team_free"!==e.subscriptionTier)return l.a.createElement(l.a.Fragment,null,s()("div",{style:this.getPrimaryTextStyle()},void 0,s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.price",defaultMessage:"{price}",description:"Price is already formatted, e.g. $10",values:{price:Object(S.i)({subscriptionTier:e.subscriptionTier,billingInterval:e.billingInterval,intl:t})}})),s()("div",{style:this.getSecondaryTextStyle()},void 0,this.getFormattedTerm()))}getFormattedTerm(){const{planInfo:e,intl:t}=this.props,a=Object(b.d)(T.default,t),i={personal:a.terms.pro,team:a.terms.team,enterprise:a.terms.enterprise}[e.subscriptionTier];return{per_month:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.perMonthPricing.label",defaultMessage:"per month",description:"Appears after the price per month for a given plan, e.g. $10 per month"}),per_member_per_month:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.perUserPerMonthPricing.label",defaultMessage:"per member, per month",description:"Appears after the price per member, per month for a given plan, e.g. $10 per member, per month"})}[i]}renderPlanFeatures(){const{planInfo:e}=this.props;return l.a.createElement(l.a.Fragment,null,s()(M.a,{delayThreshold:0,placement:M.a.Placement.Left,renderTooltip:()=>this.renderPreviousPlanTierFeatures(),render:e=>l.a.createElement("span",g()({},e,{style:{cursor:"help",fontSize:14}}),s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.features",defaultMessage:"<span>Everything in {planName},</span> plus:",description:"Shown when comparing plan tier features in upgrade modal; 'planName' will be Personal, Team Trial, or Team",values:{span:(...e)=>s()("span",{style:{paddingBottom:1,borderBottom:"1px dotted ".concat(this.theme.lightTextColor)}},void 0,e),planName:this.getPreviousPlanName()}}))}),this.getFeaturesByPlanKey(e.subscriptionTier).map((t,a)=>s()("div",{style:{display:"flex",alignItems:"center",padding:"4px 0px",fontSize:14}},"".concat(e.subscriptionTier,"-feature-").concat(a),h.a.thinCheck({width:14,height:14,marginRight:5,color:this.theme.lightTextColor}),t.label,t.isComingSoon&&s()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap"}},void 0,b.a))))}renderPreviousPlanTierFeatures(){const e=this.getTierBelowKey();return this.getFeaturesByPlanKey(e).map((t,a)=>s()("div",{style:{display:"flex",alignItems:"center",padding:"4px 0px",fontSize:14}},"".concat(e,"-feature-").concat(a),h.a.thinCheck({width:14,height:14,marginRight:5,color:this.theme.regularInvertedTextColor}),t.label))}renderLearnMore(){return s()("div",{style:{fontWeight:f.a.fontWeight.regular,fontSize:14,marginBottom:16,color:this.theme.mediumTextColor,textDecoration:"underline",marginTop:8,cursor:"pointer"},onClick:()=>{y.a.reset(),u.a.reset(),v.a.setState({open:!0,currentTab:"plans"})}},void 0,s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.learnMore",defaultMessage:"Learn more"}))}getPlanTitle(){const{planInfo:e}=this.props;return{personal:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.title.personal",defaultMessage:"Upgrade to Personal Pro"}),team:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.title.team",defaultMessage:"Upgrade to Team"}),enterprise:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.title.enterprise",defaultMessage:"Upgrade to Enterprise"}),team_free:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.title.teamFree",defaultMessage:"Upgrade to Team Trial"})}[e.subscriptionTier]}getOneLiner(){const{planInfo:e}=this.props;switch(e.subscriptionTier){case"personal":return s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.personal",defaultMessage:"For power users who want to do even more."});case"team":case"team_free":return s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.team",defaultMessage:"For teams to write, plan, and work together in one spot."});case"enterprise":return s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.enterprise",defaultMessage:"Controls and support to run your company."})}}getPreviousPlanName(){return{personal:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.personal",defaultMessage:"Pro"}),personal_free:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.free",defaultMessage:"Personal"}),team_free:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.teamTrial",defaultMessage:"Team Trial"}),team:s()(p.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.team",defaultMessage:"Team"})}[this.getTierBelowKey()]}getTierBelowKey(){const{planInfo:e}=this.props;return{personal:"personal_free",team:"team_free",team_free:"personal",enterprise:"team"}[e.subscriptionTier]}getFeaturesByPlanKey(e){const t=Object(b.b)();return{personal_free:[t.unlimitedBlocks,t.shareWithLimitedGuests,t.syncAcrossDevices],personal:[t.unlimitedFileUploads,t.unlimitedGuests,t.versionHistory,t.contentApi],team_free:[t.unlimitedTeamMembers,t.collaborativeWorkspace,t.adminTools],team:[t.unlimitedBlocks,t.unlimitedFileUploads,t.versionHistory,t.advancedPermissions],enterprise:[t.sso,t.scimApi,t.advancedSecurity,t.dedicatedManager,t.customContract]}[e]}getPrimaryTextStyle(){return{fontWeight:f.a.fontWeight.bold,fontSize:22,lineHeight:1.1,marginBottom:2}}getSecondaryTextStyle(){return{fontWeight:f.a.fontWeight.regular,fontSize:14,lineHeight:1.4,marginBottom:22,color:this.theme.mediumTextColor}}}var A=Object(p.injectIntl)(k),w=a("Ng05"),I=a("IULH"),P=a("nM47"),F=a("QcDD");class x extends d.a{constructor(...e){super(...e),o()(this,"storeTypes",{}),o()(this,"renderModal",()=>s()("div",{style:this.getModalStyle()},void 0,s()(A,{planInfo:{subscriptionTier:"team_free"}}),s()("div",{style:this.getButtonContainerStyle()},void 0,s()(I.a,{isLarge:!0,style:{marginLeft:"auto",marginRight:12},onClick:this.handleModalClose},void 0,s()(p.FormattedMessage,{id:"spacePermissionSettingsTrialModal.cancel.label",defaultMessage:"Cancel"})),s()(w.a,{onClick:this.handleTrialAccept,isLarge:!0},void 0,s()(p.FormattedMessage,{id:"spacePermissionSettingsTrialModal.tryItFree.label",defaultMessage:"Try it free"}))))),o()(this,"handleTrialAccept",async()=>{const{currentSpaceStore:e}=F.default.state;e&&(await P.a({environment:this.environment,spaceStore:e,planType:"team"}),this.handleModalClose())}),o()(this,"handleModalClose",()=>{u.a.setState({...u.a.state,open:!1})})}renderComponent(){return s()(c.a,{open:u.a.state.open,render:this.renderModal,onDismiss:this.handleModalClose})}getButtonContainerStyle(){return{display:"flex",marginTop:40}}getModalStyle(){return{background:this.theme.popoverBackground,borderRadius:3,width:349,padding:24}}}t.default=x},XOx9:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI"),a("G414")),l=a("wldR"),d=a("wXH4"),c=a("MBf9"),u=a("ov3o"),p=a("J9+s"),m=a("wFTq");class g extends l.a{constructor(...e){super(...e),o()(this,"renderModal",()=>{const e=u.a.state;if(e.isOpen)return s()(m.a,{captureSelection:!0,restoreSelection:!this.environment.device.isMobile,autocompleteQuery:e.autocompleteQuery,targets:e.targets,onAutocompleteQueryChange:this.handleAutocompleteQueryChange,onAccept:this.handleAccept,onCancel:this.handleCancel,desktopWidth:220,isAddTo:e.isAddTo,isCreateIn:!1})}),o()(this,"handleAccept",async e=>{const t=c.create(this.environment);await r.a({environment:this.environment,value:e,transaction:t}),c.commit({environment:this.environment,transaction:t})}),o()(this,"handleCancel",()=>{r.c(this.environment)}),o()(this,"handleAutocompleteQueryChange",e=>{u.a.state.isOpen&&u.a.setState({...u.a.state,autocompleteQuery:e})})}renderComponent(){const{device:e}=this.environment,t=u.a.state;return s()(d.c,{popupType:e.isMobile?d.c.PopupType.SlideUp:d.c.PopupType.Popup,alignmentToOrigin:d.c.Alignment.Start,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>r.c(this.environment)})}}t.default=Object(p.injectIntl)(g)},YqZh:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("LvDl")),c=a.n(d),u=a("q1tI"),p=a.n(u),m=a("wldR"),g=a("0/0S"),h=a("vJXr"),f=a("d9nj"),M=a("2Y+N"),y=a("T4gQ"),v=a("gbGO"),b=a("WgIs"),S=a("SR/M"),C=a("lEhh"),T=a("VPSe"),k=a("622O"),A=a("g4rC"),w=a("Ng05"),I=a("lODM"),P=a("FUUC"),F=a("DbeH"),x=a("PEWV"),E=a("J9+s"),B=a("uSCg"),D=a("LeVO"),O=a("Pqcg"),R=a("5Nka"),L=a("aEEb"),_=a("6BTz"),U=a("yNyh"),j=a("D8Ld"),N=a("ttM1"),Z=a("64mo");const W=["pdf","html","markdown"],V=e=>e>.1&&e<2,z=["everything","no_files"];class q extends m.a{constructor(...e){super(...e),l()(this,"storeTypes",{includeContentsPopupStore:A.a,exportTypePopupStore:A.a,pdfFormatPopupStore:A.a}),l()(this,"renderMenu",()=>{const{device:e}=this.environment;if(!h.a.state.online)return this.renderOffline();const t=g.a.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0}),l()(this,"handleSelectExportType",(e,t)=>{const a=g.a.state;if(!a.open)return;const{exportOptions:i}=a;if(e===i.exportType)return;let s;s="pdf"===e?{...i,exportType:"pdf",pdfFormat:I.g(t)}:{...i,exportType:e},I.b(this.environment,{...a,exportOptions:s})}),l()(this,"handleSelectPaperFormat",e=>{const t=g.a.state;t.open&&g.c(t)&&I.b(this.environment,{...t,exportOptions:{...t.exportOptions,pdfFormat:e}})}),l()(this,"handleSelectIncludeContents",e=>{const t=g.a.state;t.open&&I.b(this.environment,{...t,exportOptions:{...t.exportOptions,includeContents:e}})}),l()(this,"handleToggleRecursive",()=>{const e=g.a.state;if(e.open){if(g.c(e)&&!I.a(this.environment))return F.a(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();I.b(this.environment,{...e,recursive:!e.recursive})}}),l()(this,"handleSetScalePercent",e=>{const t=g.a.state;t.open&&g.c(t)&&I.b(this.environment,{...t,exportOptions:{...t.exportOptions,scale:e}})}),l()(this,"handleCancel",()=>{I.c()}),l()(this,"handleSubmit",()=>{if(!this.canSubmit())return;const e=g.a.state;e.open&&(I.c(),e.root.table===P.a?I.f(this.environment,{spaceId:e.root.id,exportOptions:e.exportOptions}):I.d(this.environment,{blockId:e.root.id,recursive:e.recursive,exportOptions:e.exportOptions}))}),l()(this,"handleUpgrade",()=>{I.c()})}renderComponent(){return o()(Z.a,{onDismiss:this.handleCancel,render:this.renderMenu,requireOnline:!0,modalStore:g.a})}renderOffline(){return o()("div",{style:this.getOfflineStyle()},void 0,o()(E.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"}))}renderMobileModal(e){const t={menuType:v.a.Modal,title:o()(E.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:o()(E.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return p.a.createElement(v.b,t,o()(b.a,{type:b.a.Type.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>p.a.createElement(M.a,e),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:({children:e,...t})=>p.a.createElement(M.a,s()({isSubmitButton:!0},t),e),items:[{key:"submit",render:e=>{const{onClick:t,...a}=e;return p.a.createElement(y.a,s()({},a,{onClick:t||this.handleSubmit,disabled:!this.canSubmit(),title:o()(E.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})}))},action:this.handleSubmit}]}]}))}renderDesktopModal(e){const{device:t,currentUser:a}=this.environment,i=g.c(e)&&!I.a(this.environment);return o()("div",{style:this.getModalWrapStyle()},void 0,o()(T.a,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:o()(E.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>p.a.createElement(M.a,e),items:W.map(t=>this.getBlockExportTypeMenuListItem(t,e,a.id))}]}),o()(T.a,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:o()(E.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:this.getBlockIncludeContentsTitle(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>p.a.createElement(M.a,e),items:z.map(t=>this.getIncludeContentsMenuListItem(t,e))}]}),g.c(e)&&p.a.createElement(p.a.Fragment,null,o()(T.a,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:o()(E.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>p.a.createElement(M.a,e),items:k.a.map(t=>this.getPaperFormatMenuListItem(t,e))},{key:"otherPaperFormats",render:e=>p.a.createElement(M.a,s()({topBorder:!0},e)),items:k.b.map(t=>this.getPaperFormatMenuListItem(t,e))}]}),this.renderScalePercent()),"space"!==e.root.table&&o()(x.a,{requireUpgradeToTier:i&&"enterprise",analyticsName:"export_modal",onClick:this.handleToggleRecursive,render:(a,n)=>p.a.createElement("div",s()({},a,{style:{display:"flex",alignItems:"center",height:32}}),o()("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14}},void 0,o()(E.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",n&&o()("div",{style:{marginLeft:8}},void 0,n)),o()(C.a,{on:e.recursive,isAndroid:t.isAndroid,disabled:i})),renderUpgradeTooltip:()=>o()(O.a,{imageURL:R.a.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:o()(E.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:o()(E.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:D.a.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade}),o()("div",{style:{display:"flex",alignItems:"center",marginTop:16}},void 0,o()(f.a,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleCancel},void 0,o()(E.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})),o()(w.a,{onClick:this.handleSubmit,disabled:!this.canSubmit()},void 0,o()(E.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"}))))}renderScalePercent(){const e=this.getScalePercent();return p.a.createElement(p.a.Fragment,null,o()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32}},void 0,o()(L.a,{style:{color:this.theme.lightTextColor}},void 0,o()(E.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})),o()(H,{value:e,onChange:this.handleSetScalePercent})),!V(e)&&o()(N.a,{show:!0,showDelay:500,showHold:100,render:e=>e&&o()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"}},void 0,o()(L.a,{isSmall:!0,isMultiline:!0,style:{color:this.theme.errorText}},void 0,o()(E.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200",description:"Shown if the scale percent for pdf export is outside of range."})))}))}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:a}=this.environment;return c.a.compact([{key:"export type",render:i=>p.a.createElement(T.a,s()({},i,{isMenuItem:a.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:o()(E.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>p.a.createElement(M.a,e),items:W.map(a=>this.getBlockExportTypeMenuListItem(a,e,t.id))}]})),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},g.c(e)&&{key:"pdf format",render:t=>p.a.createElement(T.a,s()({},t,{isMenuItem:a.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:o()(E.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>p.a.createElement(M.a,e),items:k.a.map(t=>this.getPaperFormatMenuListItem(t,e))},{key:"otherPaperFormats",render:e=>p.a.createElement(M.a,s()({topBorder:!0},e)),items:k.b.map(t=>this.getPaperFormatMenuListItem(t,e))}]})),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:({onClick:t,key:i,...n})=>{const r=g.c(e)&&!I.a(this.environment);return o()(x.a,{requireUpgradeToTier:r&&"enterprise",analyticsName:"export_modal",onClick:t,render:(t,i)=>{const l=Object(B.a)(n,t);return p.a.createElement(S.a,s()({},l,{title:o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(E.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",i&&o()("div",{style:{marginLeft:8}},void 0,i)),right:p.a.createElement(C.a,s()({},l,{on:e.recursive,isAndroid:a.isAndroid,disabled:r}))}))},renderUpgradeTooltip:()=>o()(O.a,{imageURL:R.a.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:o()(E.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:o()(E.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:D.a.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade},i)},action:this.handleToggleRecursive}])}getBlockExportTypeTitle(e){switch(e){case"pdf":return o()(E.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return o()(E.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return o()(E.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}getBlockIncludeContentsTitle(e){switch(e){case"everything":return o()(E.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return o()(E.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No Files or Images"})}}getPDFFormatTitle(e){switch(e){case"Letter":return o()(E.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return o()(E.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return o()(E.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return o()(E.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return o()(E.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}getBlockExportTypeMenuListItem(e,t,a){const i=g.a.state,n=i.open&&"pdf"===e&&"space"===i.root.table&&!I.a(this.environment);return{key:e,action:()=>{if(t.close(),n)return F.a(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();this.handleSelectExportType(e,a)},render:({onClick:a,key:i,...r})=>o()(x.a,{requireUpgradeToTier:n&&"enterprise",analyticsName:"export_modal",onClick:a,onUpgradeClick:()=>{t.close(),this.handleUpgrade()},render:(t,a)=>p.a.createElement(S.a,s()({},Object(B.a)(r,t),{title:this.getBlockExportTypeTitle(e),right:a})),renderUpgradeTooltip:()=>o()(O.a,{imageURL:R.a.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:o()(E.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:o()(E.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:D.a.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2}},i)}}getIncludeContentsMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectIncludeContents(e)},render:t=>p.a.createElement(S.a,s()({},t,{title:this.getBlockIncludeContentsTitle(e)}))}}getPaperFormatMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectPaperFormat(e)},render:t=>p.a.createElement(S.a,s()({},t,{title:this.getPDFFormatTitle(e)}))}}getScalePercent(){const e=g.a.state;return e.open&&g.c(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}canSubmit(){return V(this.getScalePercent())}getModalWrapStyle(){return{width:320,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}}function H({value:e,onChange:t}){const a=Object(E.useIntl)(),i=p.a.useCallback(e=>{const a=e.target.value,i=Object(_.f)(a)||Object(_.e)(a);let s=void 0;"object"==typeof i?s="percent"===i.format?i.value:i.value/100:"number"==typeof i&&(s=i/100),void 0!==s&&t(s)},[t]),[s,n]=p.a.useState(!1),r=p.a.useMemo(()=>Object(_.c)(Math.round(100*e),"number",a),[e,a]);return o()(j.a,{capture:s},void 0,o()(U.b,{value:r,onChange:i,onFocus:()=>n(!0),onBlur:()=>n(!1),style:{width:60},inputStyle:{textAlign:"right"}}))}t.default=q},b1fY:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a("wldR"),d=a("Vq6f"),c=a("/6eU"),u=a("Sb6f"),p=a("Ng05"),m=a("5Nka"),g=a("WPWl"),h=a("iqZH"),f=a("bxQm"),M=a("J9+s");class y extends l.a{constructor(...e){super(...e),o()(this,"handleModalDismiss",()=>{d.a.state.open&&d.a.state.onDecline&&d.a.state.onDecline(),d.a.setState({open:!1})}),o()(this,"handleConnectClick",()=>{d.a.state.open&&d.a.state.onConfirm(),d.a.setState({open:!1})}),o()(this,"handleConnectedAppsClick",()=>{this.handleModalDismiss(),h.a({currentTab:"connected_apps"})})}renderComponent(){const{device:e}=this.environment,t=d.a.state;return s()(c.a,{open:t.open,innerStyle:y.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>s()(r.Fragment,{},void 0,s()("div",{style:y.modalHeaderWrapStyle},void 0,s()("img",{src:m.a.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),s()("div",{style:this.getModalMessageStyle()},void 0,s()(M.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})),e.isMobileNative?s()("div",{style:this.getModalMessageStyle()},void 0,s()(M.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})):s()(p.a,{isLarge:!0,onClick:this.handleConnectClick},void 0,s()(M.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})),!e.isMobile&&this.renderConnectedAccountsLink())),onDismiss:this.handleModalDismiss})}renderConnectedAccountsLink(){return s()("div",{style:{display:"block",marginTop:g.a.vertical.tiny}},void 0,s()(f.a,{underlined:!0,onClick:this.handleConnectedAppsClick},void 0,s()(M.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})))}getModalMessageStyle(){return{fontSize:16,lineHeight:1.5,fontWeight:u.a.fontWeight.medium,marginTop:15,marginBottom:20,color:this.theme.mediumTextColor}}}o()(y,"wrapStyle",{padding:"24px 36px 24px",minWidth:300,maxWidth:400}),o()(y,"modalHeaderWrapStyle",{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"}),t.default=y},cw0H:function(e,t,a){"use strict";var i=a("g4rC");t.a=new i.a},e3h8:function(e,t,a){"use strict";a.r(t);var i=a("gcR/"),s=a.n(i),n=a("lSNA"),o=a.n(n),r=(a("3bBZ"),a("q1tI")),l=a.n(r),d=a("bkwR"),c=a("zmp8"),u=a("Sb6f"),p=a("toub"),m=a("re9x"),g=a("G4GV"),h=a("hU3F"),f=a("wldR"),M=a("/6eU"),y=a("yNyh"),v=a("Ng05"),b=a("IYZQ"),S=a("mF3+"),C=a("HTHG"),T=a("J9+s"),k=a("qqdV");class A extends f.a{constructor(...e){super(...e),o()(this,"storeTypes",{promoCodeStore:g.a,promoError:h.a.of(void 0)}),o()(this,"handleModalDismiss",()=>{m.a.setState({open:!1})}),o()(this,"handleChangeEmail",()=>{this.handleModalDismiss(),p.a.setState({...p.a.state,open:!0,currentTab:"profile"})}),o()(this,"handleInputChange",e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.set(void 0)}),o()(this,"handleSubmitPromoCode",async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await d.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?m.a.state.open&&(await m.a.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),this.handleModalDismiss()):this.stores.promoError.set(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}})}renderComponent(){const{open:e}=m.a.state;return s()(M.a,{open:e,innerStyle:A.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:this.handleModalDismiss})}renderModalContents(){return s()("div",{style:{fontSize:14}},void 0,s()("div",{},void 0,s()(T.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Personal Pro plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Personal Pro Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Personal Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:s()("br",{}),p:(...e)=>s()("p",{style:{marginTop:0,marginBottom:8}},void 0,1===e.length?e[0]:l.a.Children.toArray(e)),pricinglink:(...e)=>s()(b.a,{external:!0,href:k.c.pricing},void 0,e)}})),this.renderSchoolEmailCodePrompt(),this.renderPromoCode(),this.renderContactUs())}renderSchoolEmailCodePrompt(){const e=Object(C.h)(this.environment);return s()("div",{style:{display:"flex",marginTop:16}},void 0,s()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,s()(T.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})),s()("div",{style:{flexGrow:1}},void 0,s()("div",{style:{color:this.theme.mediumTextColor}},void 0,s()(T.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})),s()("div",{style:{fontWeight:u.a.fontWeight.medium,marginTop:0}},void 0,e&&e.email),s()("div",{style:{color:this.theme.mediumTextColor,marginTop:4}},void 0,s()(T.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})),s()(v.a,{style:{marginTop:12},onClick:this.handleChangeEmail,isLarge:!0},void 0,s()(T.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"}))))}renderPromoCode(){const e=this.stores.promoError.get(),t=this.props.intl.formatMessage({defaultMessage:"Enter student promo code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return s()("div",{style:{display:"flex",marginTop:16}},void 0,s()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,s()(T.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})),s()("div",{style:{flexGrow:1}},void 0,s()("div",{style:{color:this.theme.mediumTextColor}},void 0,s()(T.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})),s()("div",{style:{display:"flex",marginTop:12}},void 0,s()(y.b,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),s()(v.a,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0},void 0,s()(T.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"}))),s()("div",{style:{color:c.g.red,fontSize:12,marginTop:4,marginLeft:8,height:20}},void 0,e)))}renderContactUs(){return s()("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,borderTop:"1px solid ".concat(this.theme.regularDividerColor),paddingTop:14}},void 0,S.a.help({width:14,marginTop:1,marginRight:6,fill:this.theme.lightIconColor})," ",s()("div",{},void 0,s()(T.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:(...e)=>s()(b.a,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0},void 0,e)}})))}}o()(A,"wrapStyle",{padding:"24px 36px 24px",minWidth:300,maxWidth:400}),t.default=Object(T.injectIntl)(A)},fw5W:function(e,t,a){"use strict";var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("q1tI")),c=a.n(d),u=a("wldR"),p=a("yNyh"),m=a("uSCg");class g extends u.a{constructor(...e){super(...e),l()(this,"handleKeyDown",e=>{"Backspace"===e.key&&0===this.props.value.length&&this.props.onRemoveLastToken()})}renderComponent(){const{device:e}=this.environment;return o()("div",{onClick:this.props.onClick,style:e.isMobile?this.getMobileWrapStyle():this.getDesktopWrapStyle()},void 0,this.props.tokens,this.renderInput())}renderInput(){const{device:e}=this.environment,t=0===this.props.tokens.length;return c.a.createElement(p.b,s()({format:p.b.Format.Transparent},Object(m.a)({onKeyDown:this.handleKeyDown},{onChange:this.props.onChange}),{value:this.props.value,onSubmit:this.props.onSubmit,onBlur:this.props.onBlur,focus:this.props.focus,style:{...g.inputStyle,margin:e.isMobile?"0 8px 8px 0":"0 6px 6px 0"},readOnly:this.props.readOnly,inputStyle:{height:18},size:1,type:this.props.type,placeholder:t?this.props.placeholder:"",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}))}getDesktopWrapStyle(){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",minHeight:32,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,borderRadius:3,fontSize:14,cursor:"text",overflow:"hidden",padding:"7px 9px 0px",...this.props.style}}getMobileWrapStyle(){return{...this.getDesktopWrapStyle(),fontSize:14,padding:"7px 10px 0"}}}l()(g,"inputStyle",{flexGrow:1,flexShrink:1,flexBasis:60,minWidth:60,width:"auto",lineHeight:"20px"}),t.a=g},gbUl:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("SYor"),a("LvDl")),c=a.n(d),u=a("q1tI"),p=a.n(u),m=a("y6Dp"),g=a("4HCU"),h=a("QcDD"),f=a("wpmu"),M=a("HRSx"),y=a("7M94"),v=a("mF3+"),b=a("Z1H8"),S=a("2HDO"),C=a("zTdN"),T=a("gbGO"),k=a("WgIs"),A=a("RQ1t"),w=a("xRf7"),I=a("hbKx"),P=a("AXh+"),F=a("4aFz"),x=a("SR/M"),E=a("RgmA"),B=a("OxuQ"),D=a("24Pt"),O=a("wldR"),R=a("Sb6f"),L=a("tvfY"),_=a("5/h/"),U=a("J9+s");class j extends O.a{constructor(...e){super(...e),l()(this,"createBlockStore",e=>{const{parentStore:t}=this.props;return f.a.createChildStore(t,{table:M.a,id:e})}),l()(this,"createUserStore",e=>{const{parentStore:t}=this.props;return L.a.createChildStore(t,{table:_.a,id:e})}),l()(this,"getUserValue",e=>this.createUserStore(e).getValue()),l()(this,"getCreatedTimeDetail",e=>{const{intl:t}=this.props,{starting:a,ending:i}=e;return a&&i?o()(U.FormattedMessage,{defaultMessage:"Created {startDate} to {endDate}",id:"search.recentMenuItem.createdDateWithRange.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content created in a specific date range. {startDate} and {endDate} are dates including the month, day, and year.",values:{startDate:D.c(a,t),endDate:D.c(i,t)}}):a?o()(U.FormattedMessage,{defaultMessage:"Created after {startDate}",id:"search.recentMenuItem.createdDateAfter.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content created after a specific date. {startDate} is a date including the month, day, and year.",values:{startDate:D.c(a,t)}}):i?o()(U.FormattedMessage,{defaultMessage:"Created before {endDate}",description:"Shown as part of the subtitle if the recent search involved searching for content created before a specific date. {endDate} is a date including the month, day, and year.",id:"search.recentMenuItem.createdDateBefore.subtitle",values:{endDate:D.c(i,t)}}):void 0}),l()(this,"getLastEditedTimeDetail",e=>{const{intl:t}=this.props,{starting:a,ending:i}=e;return a&&i?o()(U.FormattedMessage,{defaultMessage:"Last edited {startDate} to {endDate}",id:"search.recentMenuItem.lastEditedDateWithRange.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content last edited in a specific date range. {startDate} and {endDate} are dates including the month, day, and year.",values:{startDate:D.c(a,t),endDate:D.c(i,t)}}):a?o()(U.FormattedMessage,{defaultMessage:"Last edited after {startDate}",id:"search.recentMenuItem.lastEditedDateAfter.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content last edited after a specific date. {startDate} is a date including the month, day, and year.",values:{startDate:D.c(a,t)}}):i?o()(U.FormattedMessage,{defaultMessage:"Last edited before {endDate}",description:"Shown as part of the subtitle if the recent search involved searching for content last edited before a specific date. {endDate} is a date including the month, day, and year.",id:"search.recentMenuItem.lastEditedDateBefore.subtitle",values:{endDate:D.c(i,t)}}):void 0}),l()(this,"styles",{recentSearchItem:()=>{const{device:e}=this.environment;return{minHeight:void 0,paddingTop:e.isMobile?12:8,paddingBottom:e.isMobile?12:8}},inlineCaption:{display:"block",marginTop:1},queryText:{flexShrink:0},detailEmphasis:{fontWeight:R.a.fontWeight.medium},enterIcon:{height:14,width:14},textWrapper:{marginLeft:8},iconWrapper:{height:19,width:19,display:"flex",alignItems:"center"}})}renderComponent(){const{device:e}=this.environment,{query:t,...a}=this.props,i=this.styles,n=this.getThemeColors(),r=o()("div",{style:i.queryText},void 0,t.text.trim()),l={...i.recentSearchItem(),...this.environment.device.isMobile&&n.menuItemMobile},d=!e.isMobile;return p.a.createElement(x.a,s()({},a,{style:l,inline:d,icon:this.renderIcon(),title:r,caption:this.renderRecentSearchCaption(),captionStyle:d?i.inlineCaption:void 0,right:this.renderEnterIcon(),disableTransition:!0,dontShrinkRight:!0,textWrapperStyle:i.textWrapper,className:"notranslate"}))}renderRecentSearchCaption(){const{query:e}=this.props,{isNavigableOnly:t,ancestors:a,createdBy:i,editedBy:s,lastEditedTime:n,createdTime:r}=e.filters,l=[];if(t&&l.push(o()(U.FormattedMessage,{defaultMessage:"Only match titles",id:"search.recentMenuItem.onlyMatchTitles.subtitle"})),a.length>0){const e=this.renderRecentSearchAncestors(a);l.push(o()(U.FormattedMessage,{defaultMessage:"In {pages}",id:"search.recentMenuItemDetail.inPage.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content in specific pages. {pages} is the title of the first page that the search was conducted in, with something like '+ 1' or '+ 2' following it, depending on the number of additional pages that were searched.",values:{pages:this.renderListItems(e)}}))}if(i.length>0){const e=this.renderRecentSearchUsers(i);l.push(o()(U.FormattedMessage,{defaultMessage:"Created by {people}",id:"search.recentMenuItemDetail.createdBy.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content created by specific people. {people} is the name of the first person, with something like '+ 1' or '+ 2' following it, depending on the number of additional people in the search.",values:{people:this.renderListItems(e)}}))}if(s.length>0){const e=this.renderRecentSearchUsers(s);l.push(o()(U.FormattedMessage,{defaultMessage:"Edited by {people}",id:"search.recentMenuItemDetail.editedBy.subtitle",description:"Shown as part of the subtitle if the recent search involved searching for content edited by specific people. {people} is the name of the first person, with something like '+ 1' or '+ 2' following it, depending on the number of additional people in the search.",values:{people:this.renderListItems(e)}}))}if(r.starting||r.ending){const e=this.getCreatedTimeDetail(r);l.push(e)}if(n.starting||n.ending){const e=this.getLastEditedTimeDetail(n);l.push(e)}if(l.length>0)return Object(E.a)(l,()=>" · ")}renderListItems(e){if(0===e.length)return;if(1===e.length)return e;const[t,...a]=e,i=a.length;return o()(U.FormattedMessage,{defaultMessage:"{firstPageOrPerson} + {numberRemaining}",id:"search.recentMenuItem.listOfPeopleOrPages.label",values:{firstPageOrPerson:t,numberRemaining:i},description:"This shows the people or pages the recent search item was conducted against. The '+' symbol means 'and'."})}renderRecentSearchAncestors(e){const t=this.styles;return e.map(e=>o()(p.a.Fragment,{},e," ",o()(B.a,{store:this.createBlockStore(e),style:t.detailEmphasis,shouldWrap:!0},e)))}renderRecentSearchUsers(e){const t=this.styles;return e.map(e=>{const a=this.getUserValue(e);return o()(p.a.Fragment,{},e," ",o()("span",{style:t.detailEmphasis},void 0,Object(_.e)(this.props.intl,a)))})}renderEnterIcon(){const{device:e}=this.environment,{focused:t}=this.props,a=this.styles,i=this.getThemeColors();if(e.isMobile)return;const s={...a.enterIcon,...i.enterIcon};return t?v.a.enter(s):void 0}renderIcon(){const{icon:e}=this.props;return o()("div",{style:this.styles.iconWrapper},void 0,e)}getThemeColors(){return{menuItemMobile:{boxShadow:"0 1px 0 ".concat(this.theme.lightDividerColor)},enterIcon:{fill:this.theme.mediumIconColor}}}}l()(j,"contextTypes",T.c);var N=Object(U.injectIntl)(j),Z=a("Pl3d"),W=a("CSYU"),V=a("H4VD"),z=a("cYwG"),q=a("ZQ9l"),H=a("VhAz");const G={listStyleType:"none",padding:0,margin:0};R.a.fontWeight.regular;function K(e,t){const a="UIRegular"===t?R.a.fontSize.UIRegular:"UISmall"===t?R.a.fontSize.UISmall:Object(H.f)(t);return e.device.isMobile?a.mobile:a.desktop}function Y(e,t){const a="UIRegular"===t?R.a.lineHeight.UIRegular:"UISmall"===t?R.a.lineHeight.UISmall:Object(H.f)(t);return e.device.isMobile?a.mobile:a.desktop}class Q extends O.a{constructor(...e){super(...e),l()(this,"styles",{menuItem:{minHeight:void 0,...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:R.a.fontWeight.medium,fontSize:K(this.environment,"UIRegular"),lineHeight:Y(this.environment,"UIRegular")},caption:{fontSize:K(this.environment,"UIRegular")}})}renderComponent(){const{style:e,...t}=this.props,a=e?{...this.styles.menuItem,...e}:this.styles.menuItem;return p.a.createElement(q.a,s()({},t,{title:this.renderTitle(),caption:this.renderCaption(),textWrapperStyle:this.styles.text,style:a}))}renderTitle(){const{title:e}=this.props;if(!e)return;const t=this.styles,a=this.getThemeColors(),i={...t.title,...a.title};return o()("h4",{role:"alert",style:i},void 0,e)}renderCaption(){const{caption:e}=this.props;if(!e)return;const t=this.styles,a=this.getThemeColors(),i={...t.caption,...a.caption};return o()("div",{style:i},void 0,e)}getThemeColors(){return{title:{color:this.theme.mediumTextColor},caption:{color:this.theme.lightTextColor}}}}l()(Q,"contextTypes",{...T.c});var J=Q,X=a("prF1"),$=a("/ssM"),ee=a("sZEU");class te extends O.a{constructor(...e){super(...e),l()(this,"handleSendMessageClick",()=>{ee.a({environment:this.environment,from:"quick_find"})}),l()(this,"styles",{menuItem:{marginTop:"auto",marginBottom:"auto"},reportProblemButton:{display:"inline"}})}renderComponent(){return p.a.createElement(J,s()({},this.getErrorMessage(),{style:this.styles.menuItem}))}renderNoResults(){const{searchStore:e}=this.props,t=D.l(e.state.query.filters);return{title:te.noResultsTitle,caption:o()(U.FormattedMessage,t?{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}:{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}}renderOffline(){return{title:te.noResultsTitle,caption:o()(U.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"})}}renderRequestFailed(){const e=this.styles,t=this.getThemeColors(),a={...e.reportProblemButton,...t.reportProblemButton};return{title:o()(U.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:o()(U.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:(...e)=>o()(X.a,{onClick:this.handleSendMessageClick,style:a},void 0,e)}})}}getErrorMessage(){const{error:e}=this.props;switch(e.type){case $.d.NoResults.type:return this.renderNoResults();case $.d.Offline.type:return this.renderOffline();case $.d.RequestFailed.type:return this.renderRequestFailed();default:Object(H.f)(e)}}getThemeColors(){return{reportProblemButton:{color:this.theme.blueColor}}}}l()(te,"contextTypes",{...T.c}),l()(te,"noResultsTitle",o()(U.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"}));var ae=te,ie=a("PQqx"),se=a("wlCD"),ne=a("G8iD"),oe=a("2Y+N"),re=a("ttM1");class le extends O.a{constructor(...e){super(...e),l()(this,"renderKeyboardShortcut",(e,t)=>{const a=this.styles,i=this.getThemeColors(),s={...a.keyboardShortcut,...i.keyboardShortcut,...t};return o()("span",{style:s},void 0,e)}),l()(this,"styles",{footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?R.a.fontSize.UIRegular.mobile:R.a.fontSize.UIRegular.desktop}},footerText:{fontSize:K(this.environment,"UISmall"),...R.a.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...R.a.textOverflowStyle},resultCount:{fontWeight:R.a.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*K(this.environment,"UISmall")},commandGlyph:{fontSize:.75*K(this.environment,"UIRegular")}})}renderComponent(){return this.props.mode===ne.c.Mode.Results?this.renderResultState(this.props.results):this.renderSection(this.renderHelpText())}renderResultState(e){const t=this.styles,a=this.getThemeColors(),i={...t.resultCount,...a.resultCount},{count:s,isLowerBound:n}=this.getResultCount(e),r=o()("span",{style:t.resultText},void 0,n?this.props.intl.formatMessage({id:"searchFooter.helpText.resultCountApproximate",description:"Approximate number of results displayed in footer of search modal.",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:s,resultwrapper:(...e)=>o()("span",{style:i},void 0,e)}):this.props.intl.formatMessage({id:"searchFooter.helpText.resultCount",description:"Exact number of results displayed in footer of search modal.",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:s,resultwrapper:(...e)=>o()("span",{style:i},void 0,e)})),l=o()("div",{style:t.resultCountWrapper},void 0,r,this.props.mode===ne.a.Results&&this.renderSpinner(this.props.showSpinner));return this.renderSection(l)}renderSpinner(e){const t=this.styles;return o()(re.a,{show:e,showDelay:500,showHold:200,render:e=>e&&o()(se.a,{style:t.spinner})})}renderSection(e){const t=this.styles,a=this.getThemeColors(),i={...t.footerText,...a.footerText};return o()(oe.a,{topBorder:!0,style:t.footer(),disableDesktopPadding:!0},void 0,o()(q.a,{title:e,style:i}))}renderHelpText(){const e=this.styles,t=this.getThemeColors(),a={...G,...e.footerText,...t.footerText},i={...e.commandGlyph,...t.keyboardShortcut},{command:s}=ie.a(this.environment),{device:n}=this.environment;return o()("ul",{style:a},void 0,o()("li",{style:e.inlineHint},void 0,this.renderKeyboardShortcut("↑↓"),this.props.intl.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})),o()("li",{style:e.inlineHint},void 0,this.renderKeyboardShortcut("↵"),this.props.intl.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})),o()("li",{style:e.inlineHint},void 0,o()("span",{style:i},void 0,s),this.renderKeyboardShortcut("+↵"),n.isElectron?this.props.intl.formatMessage({id:"searchFooter.helpText.openNewWindow",defaultMessage:"Open in a new window"}):this.props.intl.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})))}getResultCount(e){const t=e.server?e.server.total:e.local.total;return{count:t,isLowerBound:Boolean(e.server&&e.local&&t<ne.b)}}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}var de=Object(U.injectIntl)(le),ce=a("d9nj"),ue=a("i3uR"),pe=a("g4rC"),me=a("D2XV"),ge=a("zmp8"),he=a("LEzx");const fe="Invalid date",Me="Invalid range";class ye extends he.a{getInitialState(){return{edited:!1,temporary:"",error:void 0}}}var ve=ye,be=a("yNyh"),Se=a("dXb3"),Ce=a("awNq"),Te=a("LeVO");class ke extends O.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:ve}),l()(this,"renderInput",()=>{const{device:e}=this.environment,{store:t,hideClearButton:a,focused:i,...n}=this.props,o=e.isMobile?"date":"text",r="date"===o?be.b.Format.Transparent:be.b.Format.Large,l=e.isMobile?void 0:i;return p.a.createElement(Se.a,s()({},n,{type:o,format:r,left:this.renderMobilePlaceholder(o),showClearButton:this.showClearButton(),focus:l,onFocus:this.handleFocus,onClearButtonClick:this.handleClear,onChange:this.handleChange,onSubmit:this.handleSubmit,onBlur:this.handleBlur,value:this.getInputValue()},this.getInputStyles()))}),l()(this,"handleFocus",e=>{const{onFocus:t}=this.props,{store:a}=this.stores;a.setState({...a.state,edited:!1}),t&&t(e)}),l()(this,"handleClear",()=>{const{onClear:e,onUpdate:t}=this.props,{store:a}=this.stores;a.setState({...a.state,edited:!0,temporary:"",error:void 0});const i=this.validateCurrent();i&&t(i),a.setState({...a.state,edited:!1}),e&&e()}),l()(this,"handleChange",e=>{const{device:t}=this.environment,{store:a}=this.stores;a.setState({...a.state,edited:!0,temporary:e.target.value||""}),t.isAndroid&&this.handleBlur()}),l()(this,"handleSubmit",e=>{const{onUpdate:t,onSubmit:a}=this.props,{store:i}=this.stores,s=this.validateCurrent();s&&(t(s),s.error?i.setState({...i.state,edited:!1,error:s.error}):i.reset()),a&&a(e,s)}),l()(this,"handleBlur",e=>{const{onUpdate:t,onBlur:a}=this.props,{store:i}=this.stores,s=this.validateCurrent();s?(t(s),s.error?i.setState({...i.state,edited:!1,error:s.error}):i.reset()):i.setState({...i.state,edited:!1}),e&&a&&a(e)}),l()(this,"styles",{menuItem:{marginBottom:this.environment.device.isMobile?1:12},inputWrapper:{borderRadius:3,height:28,paddingRight:this.showClearButton()?6:0,position:"relative"},inputEditRegion:{width:this.showClearButton()?"calc(100% - 14px)":"100%"},inputEditRegionMobile:{padding:"2px 6px",position:"relative"},placeholder:{position:"absolute",left:6,top:"50%",transform:"translateY(-50%)"},tooltipOriginGap:-8})}didUpdate(e){const{store:t}=this.stores;c.a.isEqual(e.value,this.props.value)||t.reset()}renderComponent(){const e=this.styles,t=this.getError();return t?o()(Te.a,{renderTooltip:()=>t,forceVisibleState:!0,placement:Te.a.Placement.Left,render:this.renderInput,originGap:e.tooltipOriginGap}):this.renderInput()}renderMobilePlaceholder(e){const{placeholder:t,value:a}=this.props,i=this.styles,s=this.getThemeColors();if("date"===e&&!a)return o()("div",{style:{...i.placeholder,...s.placeholder}},void 0,t)}getInputValue(){const{device:e}=this.environment,{value:t,dateFormat:a,intl:i}=this.props,{store:s}=this.stores;return e.isMobile?t?D.c(t,i,"YYYY-MM-DD"):"":s.state.temporary||s.state.edited?s.state.temporary:t?D.c(t,i,a):""}getError(){const{store:e}=this.stores,{intl:t}=this.props;if(e.state.error)switch(e.state.error){case fe:return t.formatMessage({id:"dateInputError.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Me:return t.formatMessage({id:"dateInputError.invalidDateRangeError.tooltip",defaultMessage:"Invalid range"});default:Object(H.f)(e.state.error)}}validateCurrent(){const{validate:e}=this.props,t=this.parseCurrentValue();if(t)return e?e(t):t}parseCurrentValue(){const{store:e}=this.stores;if(!e.state.edited)return;if(!e.state.temporary)return{value:void 0};const t=Object(Ce.a)(e.state.temporary,this.props.intl);return t?{value:{type:"date",start_date:t}}:{error:fe}}showClearButton(){const{device:e}=this.environment,{hideClearButton:t}=this.props;return!!e.isMobile||!t}getInputStyles(){const{device:e}=this.environment,{inputStyle:t,inputOuterStyle:a,style:i}=this.props,s=this.styles;return{style:{...s.menuItem,...i},inputOuterStyle:{...this.getInputBorders(),...s.inputWrapper,...a},inputStyle:{...s.inputEditRegion,...e.isMobile&&s.inputEditRegionMobile,...t}}}getInputBorders(){const{disabled:e,focused:t}=this.props,a=this.getThemeColors(),i=this.getError();if(!e)return i?a.inputError:t?a.inputFocused:a.inputDefault}getThemeColors(){return{inputDefault:{background:this.theme.inputBackground,boxShadow:this.theme.inputBoxShadow},inputFocused:{background:ge.g.blueWithAlpha(.15),boxShadow:"inset 0 0 0 2px ".concat(ge.g.blue)},inputError:{background:ge.g.redWithAlpha(.15),boxShadow:"inset 0 0 0 2px ".concat(ge.g.red)},placeholder:{color:this.theme.lightTextColor}}}}var Ae=Object(U.injectIntl)(ke),we=a("BFWj"),Ie=a.n(we),Pe=a("lCCU"),Fe=a("mKX5"),xe=a("HTHG"),Ee=a("T8dS"),Be=a("QgQJ");class De extends O.a{constructor(...e){super(...e),l()(this,"currentDate",void 0),l()(this,"renderMonthControl",e=>{const{device:t}=this.environment,a=this.styles;return o()("div",{style:a.monthControl},void 0,o()(Pe.a,{mobileFeedback:t.isMobile,icon:v.a.chevronLeft,onClick:()=>e.onPreviousClick()}),o()(Pe.a,{mobileFeedback:t.isMobile,icon:v.a.chevronRight,onClick:()=>e.onNextClick()}))}),l()(this,"handleDayClick",e=>{const{disabled:t,store:a,value:i,validate:s,onUpdate:n}=this.props,o=a.getFocus(),r=me.i.toPersistedDate(e);if(t)return;const l="starting"===o?"ending":"starting",d=i[l];if(d&&r.start_date===d.start_date)a.setState({...a.state,focus:l});else{const e=s(o,{value:r});if(n(e.error?e:{value:{[o]:e.value[o]}}),a.setState({...a.state,hovered:void 0}),e.error)return;"starting"!==o||i.ending||a.setState({...a.state,focus:"ending"})}}),l()(this,"handleDayMouseEnter",e=>{const{disabled:t,store:a,value:i}=this.props,s=a.getFocus(),n=me.i.toMoment(e);if(!t)if("starting"===s&&i.ending&&!i.starting){me.i.toMoment(i.ending).isSameOrAfter(n)&&a.setState({...a.state,hovered:e})}else if("ending"===s&&i.starting&&!i.ending){me.i.toMoment(i.starting).isSameOrBefore(n)&&a.setState({...a.state,hovered:e})}}),l()(this,"handleMonthChange",e=>{const{store:t}=this.props;t.setState({...t.state,displayMonth:Object(Fe.a)(e)})}),l()(this,"styles",{dayPickerWrapper:{display:"block"},monthControl:{position:"absolute",top:0,right:0,display:"flex"},selectedRange:{backgroundColor:ge.g.blueWithAlpha(.15)},active:{backgroundColor:ge.g.blue,color:ge.g.white},inactive:{backgroundColor:ge.g.blueWithAlpha(.5)},disabled:{pointerEvents:"none"},today:{fontWeight:R.a.fontWeight.regular}})}renderComponent(){const e=this.styles,t=this.getDisplayMonth();return o()(Ie.a,{className:"notion-calendar-picker",containerProps:{style:e.dayPickerWrapper},initialMonth:t,month:t,numberOfMonths:1,firstDayOfWeek:this.getFirstDayOfWeek(),locale:Ee.a,localeUtils:Be.a,showOutsideDays:!0,fixedWeeks:!0,navbarElement:this.renderMonthControl,onDayClick:this.handleDayClick,onDayMouseEnter:this.handleDayMouseEnter,onMonthChange:this.handleMonthChange,modifiers:this.getModifiers(),modifiersStyles:this.getModifiersStyles()})}getCurrentDate(){if(!this.currentDate){const e=me.qb(me.m);this.currentDate=me.i.toNative(e)}return this.currentDate}getDisplayMonth(){const{value:e,store:t}=this.props;if(t.state.displayMonth)return t.state.displayMonth.toDate();if("starting"===t.getFocus()){if(e.starting)return me.i.toNative(e.starting);if(e.ending)return me.i.toNative(e.ending)}if("ending"===t.getFocus()){if(e.ending)return me.i.toNative(e.ending);if(e.starting)return me.i.toNative(e.starting)}return this.getCurrentDate()}getFirstDayOfWeek(){return xe.r.state}getModifiers(){const{store:e,disabled:t,value:a}=this.props,i=this.getDisabledModifier(),{hovered:s}=e.state;if(t)return{disabled:i};if(a.starting&&a.ending){const e=me.i.toNative(a.starting),t=me.i.toNative(a.ending);return{range:{from:e,to:t},start:e,end:t,disabled:i}}if(a.starting){const e=me.i.toNative(a.starting);return{range:s&&{from:e,to:s},start:e,end:s,disabled:i,selected:[e,s]}}if(a.ending){const e=me.i.toNative(a.ending);return{range:s&&{from:s,to:e},start:s,end:e,disabled:i,selected:[e,s]}}}getDisabledModifier(){const{value:e,disabled:t,store:a}=this.props;if(t)return e=>!0;const i=e=>"ending"===a.getFocus()?{before:e}:void 0,s=e=>"starting"===a.getFocus()?{after:e}:void 0;if(e.starting&&e.ending){const t=me.i.toNative(e.starting),a=me.i.toNative(e.ending);return i(t)||s(a)}if(e.starting){return i(me.i.toNative(e.starting))}if(e.ending){return s(me.i.toNative(e.ending))}}getModifiersStyles(){const{store:e}=this.props,t=this.styles,a=this.getThemeColors(),i=e.getFocus(),s=t.selectedRange,n={...t.disabled,...a.disabled},o={...t.today,...a.today};return{range:s,start:"starting"===i?t.active:t.inactive,end:"ending"===i?t.active:t.inactive,disabled:n,today:o}}getThemeColors(){return{disabled:{color:this.theme.lightTextColor},today:{color:ge.g.white}}}}var Oe=De,Re=a("vl8/"),Le=a("nPEg");const _e=Object(U.defineMessages)({startingMessage:{defaultMessage:"Starting",id:"search.dateRangeMenu.startingMessage"},endingMessage:{defaultMessage:"Ending",id:"search.dateRangeMenu.endingMessage"}});class Ue extends O.a{constructor(...e){super(...e),l()(this,"renderInputs",()=>{const{value:e,store:t,disabled:a}=this.props,i=t.getFocus(),s=this.getRangeBounds();return o()(p.a.Fragment,{},void 0,o()(Ae,{disabled:a,placeholder:Re.default.formatMessage(_e.startingMessage),focused:"starting"===i,value:e.starting,validate:this.validateStart,onUpdate:this.handleUpdateStart,onFocus:()=>this.handleFocus("starting"),onSubmit:this.handleStartSubmit,inputElementAttributes:{max:s.latestValidStarting},inputOuterStyle:this.styles.firstDateInput}),o()(Ae,{disabled:a,placeholder:Re.default.formatMessage(_e.endingMessage),focused:"ending"===i,value:e.ending,validate:this.validateEnd,onUpdate:this.handleUpdateEnd,onFocus:()=>this.handleFocus("ending"),onSubmit:this.handleEndSubmit,inputElementAttributes:{min:s.earliestValidEnding}}))}),l()(this,"renderCalendar",()=>{const{device:e}=this.environment,{value:t,store:a,onUpdate:i}=this.props,s=this.styles,n=this.getThemeColors(),r={...s.pickerSection,...e.isMobile&&s.pickerSectionMobile,...e.isMobile&&n.pickerSectionMobile};return o()(oe.a,{},void 0,o()("div",{style:r},void 0,o()(Oe,{value:t,store:a,onUpdate:i,validate:this.validateField})))}),l()(this,"handleFocus",e=>{const{store:t}=this.props;t.setState({...t.state,focus:e})}),l()(this,"handleUpdateStart",e=>{const{onUpdate:t}=this.props;e.error||t({value:{starting:e.value}})}),l()(this,"handleUpdateEnd",e=>{const{onUpdate:t}=this.props;e.error||t({value:{ending:e.value}})}),l()(this,"handleStartSubmit",(e,t)=>{const{store:a}=this.props;t&&t.error||a.setState({...a.state,focus:"ending"})}),l()(this,"handleEndSubmit",(e,t)=>{const{onDismiss:a}=this.props;t&&t.error||a&&a(e)}),l()(this,"validateStart",e=>{const t=this.validateField("starting",e);return t.error?t:{value:t.value.starting}}),l()(this,"validateEnd",e=>{const t=this.validateField("ending",e);return t.error?t:{value:t.value.ending}}),l()(this,"validateField",(e,t)=>{const{value:a}=this.props;return t.error?t:this.validateRange({...a,[e]:t.value})}),l()(this,"validateRange",e=>{if(e.starting&&e.ending){const t=me.i.toMoment(e.starting);return me.i.toMoment(e.ending).isSameOrAfter(t)?{value:e}:{error:Me}}return{value:e}}),l()(this,"getMenuProps",()=>{const{device:e}=this.environment,{onDismiss:t,title:a}=this.props;if(e.isMobile){return{menuType:T.b.MenuType.Modal,title:a,right:o()(Le.DoneMenuText,{}),onClickRight:t,header:this.renderInputs()}}return{menuType:T.b.MenuType.Popup,onClickOutside:t}}),l()(this,"styles",{pickerSection:{paddingLeft:16,paddingRight:16},pickerSectionMobile:{paddingTop:16,paddingBottom:8},firstDateInput:{marginTop:2}})}renderComponent(){const{device:e}=this.environment;return p.a.createElement(T.b,this.getMenuProps(),!e.isMobile&&this.renderInputs(),this.renderCalendar())}getRangeBounds(){const{value:e,intl:t}=this.props;return{earliestValidEnding:e.starting&&D.c(e.starting,t,me.lb),latestValidStarting:e.ending&&D.c(e.ending,t,me.lb)}}getThemeColors(){return{pickerSectionMobile:{background:this.theme.popoverBackground,boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),marginBottom:1}}}}var je=Object(U.injectIntl)(Ue),Ne=a("VyA+");class Ze extends O.a{constructor(...e){super(...e),l()(this,"styles",{removeFilterButton:{height:void 0,width:void 0},removeFilterButtonMobile:{marginRight:-12,marginTop:-12,marginBottom:-12,paddingRight:12,paddingTop:12,paddingBottom:12}})}renderComponent(){const{onClick:e,disabled:t}=this.props,a=this.styles,{device:i}=this.environment,s=i.isMobile?{...a.removeFilterButton,...a.removeFilterButtonMobile}:a.removeFilterButton;return o()(Pe.a,{icon:v.a.clearInput,onClick:e,disabled:t,disableBackground:!0,style:s})}}var We=Ze,Ve=a("wXH4");class ze extends he.a{getInitialState(){return{isOpen:!1,focus:"starting",temporary:{},displayMonth:void 0,hovered:void 0}}getFocus(){return this.state.focus}}var qe=ze,He=a("lEhh");class Ge extends O.a{constructor(...e){super(...e),l()(this,"styles",{menuItem:{background:void 0,minHeight:void 0,fontSize:this.environment.device.isMobile?R.a.fontSize.UISmall.mobile:R.a.fontSize.UIRegular.desktop,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginTop:0},rightWrapper:{display:"flex",alignItems:"center",marginTop:"-50%",marginBottom:"-50%",height:44}})}renderComponent(){const{disabled:e,label:t,title:a,onClick:i,isToggle:n,...r}=this.props,l=this.getThemeColors(),d=this.styles,c=o()("span",{style:l.menuItemLabel},void 0,t);return p.a.createElement(x.a,s()({focused:!1},r,{inline:n,disabled:e,icon:c,title:a,right:this.renderRight(),onClick:i,dontShrinkIcon:!0,dontShrinkRight:!0,shouldWrapTitle:!0,style:d.menuItem,desktopIconStyle:d.menuItemLabel}))}renderRight(){const{disabled:e}=this.props,t=this.styles.rightWrapper;return this.props.isToggle?o()("div",{style:t},void 0,o()(He.a,{on:this.props.isToggleActive,onClick:this.props.onClick})):o()(We,{disabled:e,onClick:this.props.onClickClear})}getThemeColors(){return{menuItemLabel:{color:this.theme.lightTextColor}}}}var Ke=Ge,Ye=a("kIZi"),Qe=a("Mht8"),Je=a("W3at"),Xe=a("zb5D");let $e;!function(e){e.Token="token",e.Text="text"}($e||($e={}));class et extends O.a{constructor(...e){super(...e),l()(this,"storeTypes",{requestStore:W.a,menuListStore:A.a}),l()(this,"renderRequest",(e,t,a)=>{const{labelText:i,value:n}=this.props,{menuListStore:r}=this.stores,l=e=>p.a.createElement(oe.a,s()({},e,{title:i.resultSectionTitle,loading:!a}));if(e)return Qe.log({level:"error",from:i.componentDebugName,type:"requestFailed",error:Object(Xe.a)(e),data:{miscDataToConvertToString:{query:n}}}),o()(l,{},void 0,o()(C.a,{title:o()(U.FormattedMessage,{defaultMessage:"Something went wrong.",id:"search.inputMenu.errorMessage"})}));if(!t)return o()(l,{},void 0,o()(C.a,{title:o()(U.FormattedMessage,{defaultMessage:"Loading…",id:"search.inputMenu.loading.message"})}));if(t&&0===t.length)return o()(l,{},void 0,o()(C.a,{title:o()(U.FormattedMessage,{defaultMessage:"No results found.",id:"search.inputMenu.noResults.message"})}));const d={key:"results",items:t.map(this.getResultMenuItem),render:l};return o()(k.a,{type:k.a.Type.Vertical,store:r,initialFocus:0,sections:[d]})}),l()(this,"handleMenuInputRemoveLast",()=>{if(this.props.inputType!==$e.Token)return;const{items:e,onRemove:t}=this.props,a=c.a.last(e);a&&t(a)}),l()(this,"getResultMenuItem",e=>{const{renderResultMenuItem:t,onConfirm:a}=this.props;return{key:e,action:()=>a(e),render:a=>t(e,a)}}),l()(this,"styles",{input:{borderBottomLeftRadius:0,borderBottomRightRadius:0,boxShadow:this.theme.borderBoxShadow},menu:{width:250,maxHeight:"40vh"}})}renderComponent(){const{value:e,items:t,performRequest:a}=this.props,{requestStore:i}=this.stores,s={query:e,current:t};return p.a.createElement(T.b,this.getMenuProps(),o()(Z.a,{debounce:100,requestStore:i,request:s,performRequest:a,render:this.renderRequest}))}renderSearchInput(){return this.props.inputType===$e.Token?this.renderTokenInput(this.props):this.props.inputType===$e.Text?this.renderTextInput(this.props):void Object(H.f)(this.props)}renderTokenInput(e){const{labelText:t,value:a,items:i,disabled:s,onChange:n,renderToken:r,onRemove:l}=e,d=i.map(e=>r(e,{onRemove:()=>l(e)}));return o()(Je.a,{format:Je.a.Format.Group,focus:!this.isMobile()||void 0,focusInitial:this.isMobile(),focusAfterAnimation:!0,placeholder:t.tokenInputPlaceholder,value:a,tokens:d,disabled:Boolean(s),onChange:n,onRemoveLastToken:this.handleMenuInputRemoveLast})}renderTextInput(e){const{labelText:t,value:a,disabled:i,onChange:s,onClear:n}=e,r=this.styles,l=this.isMobile()?Se.a:be.b;return o()(l,{format:be.b.Format.Large,disabled:i,showClearButton:!0,placeholder:t.tokenInputPlaceholder,value:a,onChange:s,onClearButtonClick:n,focus:!this.isMobile()||void 0,focusInitial:this.isMobile(),focusAfterAnimation:!0,style:this.isMobile()?void 0:r.input})}getMenuProps(){const{onDismiss:e,labelText:t}=this.props,a=this.styles;if(this.isMobile()){return{menuType:T.b.MenuType.Modal,title:t.title,right:o()(Le.DoneMenuText,{}),onClickRight:e,header:this.renderSearchInput()}}return{menuType:T.b.MenuType.Popup,onClickOutside:e,header:this.renderSearchInput(),...a.menu}}isMobile(){const{device:e}=this.environment;return e.isMobile}}l()(et,"InputType",$e);var tt=et;class at extends he.a{getInitialState(){return{isMenuOpen:!1,inputTemporaryValue:"",indexToReplace:void 0,popupOriginRect:void 0}}}var it=at;let st;!function(e){e.Button="Button",e.Section="Section"}(st||(st={}));class nt extends O.a{constructor(...e){super(...e),l()(this,"animationFrame",void 0),l()(this,"origin",p.a.createRef()),l()(this,"storeTypes",{componentStore:it}),l()(this,"renderMobileFilterSummary",e=>{const{title:t,items:a,renderItemForSummary:i}=this.props,{disableFilters:s}=e,n=this.styles,r={...G,...n.summary},l=a.length-1,d=o()("ul",{style:r},void 0,a.map((e,t)=>o()("li",{style:n.summaryItem},e,o()(p.a.Fragment,{},void 0,i(e),t!==l&&","," "))));return o()(Ke,{disabled:s,onClick:this.handleMenuOpenMobile,onClickClear:this.clearItems,label:t,title:d})}),l()(this,"renderMenu",()=>{const{renderToken:e}=this.props,{componentStore:{state:t}}=this.stores,a={inputType:tt.InputType.Token,onRemove:this.handleFilterRemove,renderToken:e},i={inputType:tt.InputType.Text},n=this.getMenuType()===tt.InputType.Token?a:i;return p.a.createElement(tt,s()({},this.props,{value:t.inputTemporaryValue,onChange:this.handleMenuInputChange,onDismiss:this.handleMenuClose,onConfirm:this.handleItemConfirm,onClear:this.handleClearTemporary},n))}),l()(this,"handleMenuOpen",e=>{this.scheduleMeasurement(void 0,t=>({...t,isMenuOpen:!0,indexToReplace:e}))}),l()(this,"handleMenuOpenMobile",()=>{const{componentStore:e}=this.stores;e.setState({...e.state,isMenuOpen:!0})}),l()(this,"handleMenuClose",()=>{const{onMenuDismiss:e}=this.props,{componentStore:t}=this.stores;t.setState({...t.state,isMenuOpen:!1,indexToReplace:void 0}),e&&e()}),l()(this,"handleClearTemporary",()=>{const{componentStore:e}=this.stores;e.setState({...e.state,inputTemporaryValue:""})}),l()(this,"handleItemConfirm",e=>{const{items:t}=this.props,{componentStore:a}=this.stores,{indexToReplace:i}=a.state;"number"==typeof i&&i<t.length?this.replaceItem(i,e):this.addItem(e),this.clearInput(),this.getMenuType()===tt.InputType.Text&&this.handleMenuClose()}),l()(this,"handleFilterRemove",e=>{this.removeItem(e)}),l()(this,"handleMenuInputChange",e=>{const{componentStore:t}=this.stores,{target:a}=e;t.setState({...t.state,inputTemporaryValue:String(a.value)})}),l()(this,"scheduleMeasurement",(e,t)=>{this.animationFrame=requestAnimationFrame(this.measureOriginRect(t))}),l()(this,"measureOriginRect",e=>t=>{const{componentStore:a}=this.stores;if(!this.origin)return;if(!this.origin.current)return;const i=e?e(a.state):a.state;a.setState({...i,popupOriginRect:this.origin.current.getBoundingClientRect()})}),l()(this,"isMenuOpen",()=>{const{componentStore:{state:e}}=this.stores;return e.isMenuOpen}),l()(this,"removeItem",e=>{const{items:t,onChange:a}=this.props;a(t.filter(t=>t!==e))}),l()(this,"clearItems",()=>{const{onChange:e}=this.props;e([])}),l()(this,"replaceItem",(e,t)=>{const{items:a,onChange:i}=this.props;i(a.slice(0,e).concat(t,a.slice(e+1)))}),l()(this,"clearInput",()=>{const{componentStore:e}=this.stores;e.setState({...e.state,inputTemporaryValue:"",indexToReplace:void 0})}),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},appendListItemButton:{minHeight:void 0,paddingTop:4,paddingBottom:4,fontSize:K(this.environment,"UIRegular")},icon:{height:14,width:14,fill:"currentColor"},iconSmall:{height:12,width:12},summary:{display:"inline"},summaryItem:{display:"inline"}})}didMount(){window.addEventListener("resize",this.scheduleMeasurement)}willUnmount(){window.removeEventListener("resize",this.scheduleMeasurement),this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0)}didUpdate(e){(e.items.length!==this.props.items.length||e.mode!==this.props.mode)&&this.scheduleMeasurement()}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,disabled:a}=this.props,{componentStore:{state:i}}=this.stores,s=a||i.isMenuOpen,n=e===nt.Mode.Section,r=n?t:void 0,l=n?this.renderSectionOrigin():this.renderButtonOrigin();return o()(Ye.a,{title:r,marginAfter:n},void 0,this.renderFilters({disableFilters:s,showLabel:!1}),l,o()(Ve.c,{popupType:Ve.c.PopupType.Popup,placementToOrigin:Ve.c.Placement.Bottom,alignmentToOrigin:Ve.c.Alignment.Start,open:this.isMenuOpen(),originRect:i.popupOriginRect,render:this.renderMenu,onDismiss:this.handleMenuClose,keepFocus:!0,preventScaleTransition:!0}))}renderButtonOrigin(){const{icon:e,title:t,disabled:a,focused:i}=this.props,s=this.styles,n=this.getThemeColors(),r={...s.menuItem,...n.buttonMenuItem};return p.a.createElement("div",{ref:this.origin},o()(x.a,{disabled:a||this.isMenuOpen(),icon:e(s.icon),title:t,focused:i,onClick:e=>this.handleMenuOpen(),style:r}))}renderSectionOrigin(){const{addItemLabel:e,disabled:t}=this.props,a=this.styles,i=this.getThemeColors();return o()(p.a.Fragment,{},void 0,p.a.createElement("div",{ref:this.origin}),o()(x.a,{disabled:t||this.isMenuOpen(),icon:v.a.plus(a.iconSmall),title:e,focused:!1,onClick:e=>this.handleMenuOpen(),style:{...a.appendListItemButton,...i.appendListItemButton}}))}renderMobile(e){const{disabled:t}=this.props,a=t||this.isMenuOpen(),i=e===nt.Mode.Section?this.renderMobileFilterSummary({disableFilters:a}):this.renderMobileButtonOrigin({disableFilters:a});return o()(Ve.c,{popupType:Ve.c.PopupType.SlideUp,open:this.isMenuOpen(),origin:i,render:this.renderMenu,onDismiss:this.handleMenuClose,keepFocus:!0})}renderMobileButtonOrigin(e){const{icon:t,title:a}=this.props,i=this.styles;return o()(x.a,{disabled:e.disableFilters,focused:!1,icon:t(i.icon),title:a,onClick:e=>this.handleMenuOpenMobile()})}renderFilters(e){const{items:t,renderFilter:a}=this.props,{device:i}=this.environment,s=t.map((t,s)=>o()("li",{},"".concat(t,"_").concat(s),a(t,{disabled:e.disableFilters,onRemove:()=>this.handleFilterRemove(t),onClick:()=>i.isMobile?this.handleMenuOpenMobile():this.handleMenuOpen(s)})));return o()("ul",{style:G},void 0,s)}getMenuType(){const{device:e}=this.environment;return e.isMobile?tt.InputType.Token:tt.InputType.Text}addItem(e){const{items:t,onChange:a}=this.props,i=t.concat(e);a(c.a.uniq(i))}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},appendListItemButton:{color:this.theme.lightTextColor}}}}l()(nt,"Mode",st);var ot=nt;class rt extends O.a{constructor(...e){super(...e),l()(this,"storeTypes",{store:qe}),l()(this,"renderActiveButtonOrigin",()=>{const{value:e,dateFormat:t,disabled:a,focused:i,intl:s}=this.props,n=this.styles,r=this.getThemeColors(),l={...n.menuItem,...r.activeMenuItem},d=D.d(e,s,t),c=o()(We,{onClick:this.handleClear,disabled:a});return o()(x.a,{focused:i,disabled:a,icon:v.a.calendar(n.iconActiveDesktop),title:d,right:c,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:n.menuItemTitleDesktop,desktopIconStyle:n.iconActiveDesktopWrapper,style:l})}),l()(this,"renderInactiveButtonOrigin",()=>{const{title:e,icon:t,disabled:a,focused:i}=this.props,s=this.styles,n=this.getThemeColors(),r={...s.menuItem,...n.buttonMenuItem};return o()(x.a,{focused:i,disabled:a,icon:t(s.icon),title:e,onClick:this.handleOriginActivate,style:r})}),l()(this,"renderPopupContents",()=>{const{title:e}=this.props,{store:t}=this.stores;return o()(je,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:t,onDismiss:this.handleMenuClose})}),l()(this,"handleOriginActivate",()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})}),l()(this,"handleMenuClose",e=>{const{onChange:t,onMenuDismiss:a}=this.props,{store:i}=this.stores,{temporary:s}=i.state;D.a(e)||(t(s),i.setState({...i.state,isOpen:!1,temporary:{}}),a&&a())}),l()(this,"handleClear",()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})}),l()(this,"handleMenuListKey",e=>{e.preventDefault&&e.preventDefault()}),l()(this,"updateTemporary",e=>{const{store:t}=this.stores;if(!e.error)return t.setState({...t.state,temporary:{...t.state.temporary,...e.value}})}),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"}})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t}=this.props,{store:a}=this.stores,i=this.styles,s=e===st.Section,n=s?t:void 0,r=s?this.renderActiveButtonOrigin():this.renderInactiveButtonOrigin();return o()(Ye.a,{title:n,marginAfter:s},void 0,o()(Ne.a,{capture:a.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,o()(Ve.c,{popupType:this.getPopupType(),open:a.state.isOpen,origin:r,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:Ve.c.Placement.Bottom,alignmentToOrigin:Ve.c.Alignment.Start,keepFocus:!0,style:i.popup})))}renderMobile(e){const{store:t}=this.stores,a=e===st.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return o()(Ve.c,{popupType:Ve.c.PopupType.SlideUp,open:t.state.isOpen,origin:a,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:a}=this.props,i=this.styles;return o()(x.a,{disabled:a,focused:!1,icon:e(i.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:a,disabled:i,intl:s}=this.props,n=this.styles,r=o()("div",{style:n.summary},void 0,v.a.calendar(n.iconActiveMobile),D.d(t,s,a));return o()(Ke,{disabled:i,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:r})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporary:a}=t.state;return{...e,...a}}getPopupType(){const{device:e}=this.environment;return e.isMobile?ue.a.PopupType.SlideUp:ue.a.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}var lt=Object(U.injectIntl)(rt),dt=a("MeYt");let ct;!function(e){e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem"}(ct||(ct={}));class ut extends O.a{constructor(...e){super(...e),l()(this,"handleFilterClick",e=>{const{onMenuDismiss:t}=this.props;this.applyFilter(e),this.openSidebar(),t&&t()}),l()(this,"applyFilter",e=>{const{searchStore:t}=this.props;t.updateFilters(e)}),l()(this,"openSidebar",()=>{const{searchStore:e}=this.props;e.isSidebarOpen()||e.setState({...e.state,isSidebarOpen:!0})}),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...R.a.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}})}renderComponent(){const{mode:e}=this.props;return e===ct.Button?this.renderAsButton():e===ct.MenuItem?this.renderAsMenuItem():void Object(H.f)(e)}renderAsButton(){const{icon:e,title:t,filter:a}=this.props,i=this.styles,s=this.getThemeColors();return o()(dt.a,{style:{...i.buttonFilter,...s.buttonFilter},onClick:()=>this.handleFilterClick(a)},void 0,e&&e({...i.icon,...i.buttonIcon}),o()("span",{style:i.buttonText},void 0,t))}renderAsMenuItem(){const{icon:e,title:t,filter:a,focused:i}=this.props,s=this.styles,n=this.getThemeColors(),r={...s.menuItem,...n.menuItem};return o()(x.a,{icon:e&&e(s.icon),focused:i,title:t,onClick:()=>this.handleFilterClick(a),style:r})}getThemeColors(){const{device:e}=this.environment;return{menuItem:{color:e.isDesktop?this.theme.mediumTextColor:void 0,...this.props.isLastInSection&&{boxShadow:void 0}},buttonFilter:{color:this.theme.mediumTextColor}}}}l()(ut,"Mode",ct);class pt extends O.a{renderComponent(){const e=pt.getCurrentPageFilter();if(e)return p.a.createElement(ut,s()({icon:v.a.searchInPage,title:o()(U.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:e},this.props))}static isActive(e){const t=pt.getCurrentPageFilter();if(!t)return!1;if(!t.ancestors)return!1;const a=t.ancestors[0];return-1!==e.ancestors.indexOf(a)}}l()(pt,"getCurrentPageFilter",()=>{const{currentBlockStore:e}=h.default.state;if(e&&e.id)return{ancestors:[e.id]}});class mt extends O.a{renderComponent(){const e=mt.getCurrentUserFilter(this.environment);if(e)return p.a.createElement(ut,s()({icon:v.a.person,title:o()(U.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:e},this.props))}static isActive(e,t){const a=mt.getCurrentUserFilter(e);if(!a)return!1;if(!a.createdBy)return!1;const i=a.createdBy[0];return-1!==t.createdBy.indexOf(i)}}l()(mt,"getCurrentUserFilter",e=>{const{id:t}=e.currentUser;if(t)return{createdBy:[t]}});class gt extends O.a{renderComponent(){const e=gt.getPastWeekFilter();if(e)return p.a.createElement(ut,s()({icon:v.a.calendar,title:o()(U.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:e},this.props))}static isActive(e){const{lastEditedTime:t}=gt.getPastWeekFilter();return c.a.isEqual(t,e.lastEditedTime)}}l()(gt,"getPastWeekFilter",()=>({lastEditedTime:{starting:me.eb(me.m),ending:me.qb(me.m)}}));var ht=a("sbdd"),ft=a("7Q97"),Mt=a("Oy36");const yt=Object(U.defineMessages)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});class vt extends O.a{constructor(...e){super(...e),l()(this,"renderFilterListItem",(e,{disabled:t,onRemove:a,onClick:i})=>{const s=this.styles,n=this.createBlockStore(e),r=o()(We,{disabled:t,onClick:a});return o()(ht.a,{disabled:t,focused:!1,store:n,right:r,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:i})}),l()(this,"renderItemForSummary",e=>o()(B.a,{store:this.createBlockStore(e),shouldWrap:!0,maxLength:50})),l()(this,"renderToken",(e,t)=>{const{blockIds:a}=this.props,i=this.tokenStyles,s=1===a.length,n=this.createBlockStore(e),r=o()("div",{style:i.token},void 0,o()(Mt.a,{disabled:!0,icon:n.getIcon(),isEmptyPage:!1,size:20,style:i.icon}),o()(B.a,{store:n}));return o()(ft.b,{format:ft.b.Format.Large,value:r,showRemoveButton:!0,onClickRemove:t.onRemove,isSingle:s,shouldShrink:!0},e)}),l()(this,"renderResultMenuItem",(e,t)=>{const a=this.createBlockStore(e);return p.a.createElement(ht.a,s()({},t,{key:e,store:a}))}),l()(this,"performRequest",async({query:e,current:t})=>{const{currentSpaceStore:a}=h.default.state;if(!a)return[];const{results:i}=await g.f({environment:this.environment,query:e,limit:20,spaceId:a.id,requireEditPermissions:!1,excludeTemplates:!1,source:"quick_find_ancestor_filter"}),s=new Set(t);return i.filter(e=>!s.has(e))}),l()(this,"createBlockStore",e=>{const{parentStore:t}=this.props;return f.a.createChildStore(t,{table:M.a,id:e})}),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:4}}),l()(this,"tokenStyles",{token:{display:"flex",alignItems:"center"},icon:{marginRight:4}})}renderComponent(){const{mode:e,title:t,blockIds:a,onChange:i,disabled:s,focused:n,onMenuDismiss:r}=this.props;return o()(ot,{mode:e,title:t,icon:v.a.searchInPage,items:a,onChange:i,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:o()(U.FormattedMessage,{defaultMessage:"Add a page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:t,tokenInputPlaceholder:Re.default.formatMessage(yt.searchPages),resultSectionTitle:Re.default.formatMessage(yt.selectAPage),componentDebugName:"SearchPageFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,disabled:s,onMenuDismiss:r})}}var bt=vt,St=a("JMnu"),Ct=a("f0kS"),Tt=a("V1wX");class kt extends O.a{constructor(...e){super(...e),l()(this,"renderFilterListItem",(e,{disabled:t,onRemove:a,onClick:i})=>{const s=this.styles,n=this.getUserValue(e),r=o()(We,{disabled:t,onClick:a});return o()(Ct.a,{disabled:t,focused:!1,user:n,right:r,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:i},e)}),l()(this,"renderItemForSummary",e=>Object(_.e)(this.props.intl,this.getUserValue(e))),l()(this,"renderToken",(e,t)=>{const{userIds:a}=this.props,i=1===a.length,s=this.getUserValue(e);if(s)return o()(St.c,{format:St.c.Format.Large,showRemoveButton:!0,isSingle:i,onClickRemove:t.onRemove,actor:Object(Tt.i)(s)},e)}),l()(this,"renderResultMenuItem",(e,t)=>{const a=this.getUserValue(e);return p.a.createElement(Ct.a,s()({},t,{key:e,user:a}))}),l()(this,"performRequest",async({query:e,current:t})=>{const a=new Set(t);return(await g.m({environment:this.environment,query:e,membersOnly:!1})).filter(e=>!a.has(e.id)).slice(0,20).map(e=>e.id)}),l()(this,"getUserValue",e=>this.createUserStore(e).getValue()),l()(this,"createUserStore",e=>{const{parentStore:t}=this.props;return L.a.createChildStore(t,{table:_.a,id:e})}),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:4}})}renderComponent(){const{mode:e,title:t,userIds:a,onChange:i,disabled:s,focused:n,onMenuDismiss:r,intl:l}=this.props;return o()(ot,{mode:e,title:t,icon:v.a.person,items:a,onChange:i,disabled:s,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:o()(U.FormattedMessage,{defaultMessage:"Add a person",id:"search.filterMenu.addAPersonButton.label"}),labelText:{title:t,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search people",id:"search.filterMenu.searchPeople.placeholder"}),resultSectionTitle:l.formatMessage({defaultMessage:"Select a person",id:"search.filterMenu.searchPeople.resultsTitle"}),componentDebugName:"SearchPersonFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:r})}}var At=Object(U.injectIntl)(kt);class wt extends O.a{renderComponent(){return p.a.createElement(q.a,s()({},this.props,{right:p.a.createElement(He.a,this.props),dontShrinkRight:!0}))}}l()(wt,"contextTypes",{...T.c});var It=wt;class Pt extends O.a{constructor(...e){super(...e),l()(this,"handleToggle",()=>{const{value:e,onChange:t}=this.props;t(!e)}),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"}})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const t=e===st.Section;return o()(Ye.a,{marginAfter:t},void 0,this.renderSwitcherMenuItem())}renderMobile(e){const{title:t,value:a,disabled:i}=this.props;return e===st.Button?this.renderSwitcherMenuItem():o()(Ke,{disabled:i,onClick:this.handleToggle,label:t,isToggle:!0,isToggleActive:a})}renderSwitcherMenuItem(){const{title:e,icon:t,value:a,style:i,...n}=this.props,o=this.styles,r=this.getThemeColors(),l={...o.menuItem,...r.menuItem,...i};return p.a.createElement(It,s()({title:e,icon:t(o.icon),on:a,onClick:this.handleToggle,style:l},n))}getThemeColors(){return{menuItem:{color:this.theme.mediumTextColor}}}}l()(Pt,"Mode",st);var Ft=Pt;let xt;!function(e){e.Button="Button",e.Section="Section"}(xt||(xt={}));class Et extends O.a{constructor(...e){super(...e),l()(this,"storeTypes",{buttonPopupStore:pe.a}),l()(this,"renderAddFilterOrigin",e=>{const t=this.styles;return p.a.createElement(ce.a,s()({},e,{style:t.addFilterButtonMobile,icon:v.a.filterCircled,isBlue:!0}),o()(U.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"}))}),l()(this,"renderAddFilterMenu",()=>o()(T.b,{menuType:T.b.MenuType.ActionSheet},void 0,this.renderSuggestedFilters(),o()(Ye.a,{title:this.renderMoreFiltersTitle()},void 0,this.renderCreatedByFilter(ot.Mode.Button),this.renderCreatedTimeFilter(ot.Mode.Button),this.renderLastEditedTimeFilter(ot.Mode.Button),this.renderAncestorFilter(ot.Mode.Button)))),l()(this,"closeAddFilterMenu",()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})}),l()(this,"styles",{sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 220px",minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:this.props.isMobile?R.a.fontSize.UISmall.mobile:R.a.fontSize.UISmall.desktop,fontWeight:R.a.fontWeight.medium,marginRight:-8}})}renderComponent(){return this.props.isMobile?this.props.mode===xt.Button?this.renderAddButtonMobile():this.props.mode===xt.Section?this.renderActiveFiltersMobile():void Object(H.f)(this.props.mode):this.renderSidebar()}renderActiveFiltersMobile(){const{searchStore:{state:e}}=this.props,t=D.e(e.query.filters);return o()(oe.a,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,this.renderTitlesOnlyFilter(st.Section),this.renderActiveFilters(t,ot.Mode.Section))}renderAddButtonMobile(){const{buttonPopupStore:e}=this.stores;return o()(ue.a,{popupType:ue.a.PopupType.SlideUp,buttonPopupStore:e,renderOrigin:this.renderAddFilterOrigin,render:this.renderAddFilterMenu})}renderSidebar(){const{searchStore:e,searchStore:{state:t}}=this.props,a=this.styles,i=this.getThemeColors(),s=D.e(t.query.filters),n={...a.sidebar,...i.sidebar,...!e.isSidebarOpen()&&a.sidebarHidden};return o()("aside",{style:n},void 0,this.renderTitlesOnlyFilter(st.Section),this.renderActiveFilters(s,ot.Mode.Section),this.renderSuggestedFilters(),this.renderInactiveFilters(s))}renderActiveFilters(e,t){return o()(p.a.Fragment,{},void 0,e.createdBy&&this.renderCreatedByFilter(t),e.createdTime&&this.renderCreatedTimeFilter(t),e.lastEditedTime&&this.renderLastEditedTimeFilter(t),e.ancestors&&this.renderAncestorFilter(t))}renderInactiveFilters(e){if(!(e.ancestors&&e.createdBy&&e.createdTime&&e.lastEditedTime))return o()(Ye.a,{title:this.renderMoreFiltersTitle(),marginAfter:!0},void 0,!e.ancestors&&this.renderAncestorFilter(ot.Mode.Button),!e.createdBy&&this.renderCreatedByFilter(ot.Mode.Button),!e.createdTime&&this.renderCreatedTimeFilter(st.Button),!e.lastEditedTime&&this.renderLastEditedTimeFilter(st.Button))}renderSuggestedFilters(){const{searchStore:e}=this.props,{filters:t}=e.state.query,a=mt.isActive(this.environment,t),i=gt.isActive(t),s=pt.isActive(t);if(!(a&&i&&s))return o()(Ye.a,{title:o()(U.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0},void 0,!a&&o()(mt,{mode:ct.MenuItem,searchStore:e,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!i&&o()(gt,{mode:ct.MenuItem,searchStore:e,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!s&&o()(pt,{mode:ct.MenuItem,searchStore:e,focused:!1,onMenuDismiss:this.closeAddFilterMenu,isLastInSection:!0}))}renderTitlesOnlyFilter(e){const{searchStore:t}=this.props,{filters:a}=t.state.query;return o()(Ft,{mode:e,focused:!1,title:o()(U.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Only match titles",description:"Label for only match titles toggle in search modal"}),icon:v.a.typesTitle,value:a.isNavigableOnly,onChange:this.createUpdateFunction("isNavigableOnly")})}renderMoreFiltersTitle(){return o()(U.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}renderAncestorFilter(e){const{searchStore:t,parentStore:a}=this.props,{filters:i}=t.state.query;return o()(bt,{mode:e,focused:!1,title:o()(U.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In page"}),parentStore:a,blockIds:i.ancestors,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("ancestors")})}renderCreatedByFilter(e){const{searchStore:t,parentStore:a}=this.props,{filters:i}=t.state.query;return o()(At,{mode:e,focused:!1,title:o()(U.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:a,userIds:i.createdBy,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdBy")})}renderCreatedTimeFilter(e){const{searchStore:t}=this.props,{filters:a}=t.state.query;return o()(lt,{mode:e,focused:!1,title:o()(U.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:v.a.calendar,value:a.createdTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdTime")})}renderLastEditedTimeFilter(e){const{searchStore:t}=this.props,{filters:a}=t.state.query;return o()(lt,{mode:e,focused:!1,title:o()(U.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:v.a.calendar,value:a.lastEditedTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("lastEditedTime")})}createUpdateFunction(e){const{searchStore:t}=this.props;return a=>t.updateFilters({[e]:a})}getThemeColors(){return{sidebar:{backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:"1px solid ".concat(this.theme.regularDividerColor)}}}}var Bt=Et,Dt=a("Ytfc");class Ot extends O.a{constructor(...e){super(...e),l()(this,"openSidebar",()=>{const{searchStore:e}=this.props;e.setState({...e.state,isSidebarOpen:!0})}),l()(this,"styles",{menuItem:{minHeight:0},menuItemMobile:{paddingBottom:8},titleWrapper:{flex:void 0},showSidebarButton:()=>{const{device:e}=this.environment;return{padding:"0 4px",fontSize:e.isMobile?R.a.fontSize.UISmall.mobile:R.a.fontSize.UISmall.desktop,fontWeight:R.a.fontWeight.medium,borderRadius:3,height:20,lineHeight:"20px"}}})}renderComponent(){const{device:e}=this.environment,t=this.styles,a={...t.menuItem,...e.isMobile&&t.menuItemMobile},i=this.shouldAllowFilters()&&this.renderAddFilterButton();return o()(q.a,{title:this.renderSortMenu(),right:i,textWrapperStyle:t.titleWrapper,style:a})}renderSortMenu(){const{searchStore:e}=this.props;return o()(Dt.a,{currentSortBy:e.state.query.sort,setSortBy:t=>{(e.state.mode===ne.c.Mode.Default||e.state.mode===ne.c.Mode.Results)&&e.setState({...e.state,query:{...e.state.query,sort:t}})},sortOptions:this.sortOptions})}renderAddFilterButton(){const{device:e}=this.environment,{parentStore:t,searchStore:a}=this.props,i=this.styles;return e.isMobile?o()(Bt,{parentStore:t,searchStore:a,isMobile:!0,mode:xt.Button}):a.isSidebarOpen()?void 0:o()(ce.a,{icon:v.a.filterCircled,onClick:this.openSidebar,style:i.showSidebarButton(),isBlue:!0},void 0,o()(U.FormattedMessage,{defaultMessage:"Add filter",id:"search.header.addFilter.button.label"}))}shouldAllowFilters(){const{isPublicPageSearch:e}=this.props;return!e}get sortOptions(){return[{key:$.e.Relevance,formattedName:o()(U.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"})},{key:$.e.LastEditedNewest,formattedName:o()(U.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"})},{key:$.e.LastEditedOldest,formattedName:o()(U.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"})},{key:$.e.CreatedNewest,formattedName:o()(U.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"})},{key:$.e.CreatedOldest,formattedName:o()(U.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"})}]}}var Rt=Ot,Lt=a("heK1"),_t=a("cBa6"),Ut=a("qX+M");class jt extends O.a{constructor(...e){super(...e),l()(this,"typingTimer",void 0),l()(this,"renderSpinner",()=>{const{showSpinner:e}=this.props,t=this.styles,a={...this.getThemeColors().searchIcon,...t.searchIcon()};return o()(re.a,{show:e,showDelay:500,showHold:200,render:e=>e?o()(se.a,{style:a}):v.a.searchThick(a)})}),l()(this,"handleQueryChange",e=>{const{searchStore:t,resultListStore:a}=this.props;this.handleTyping();const i=String(e.target.value);""===i?t.resetQuery({resetFilters:!1}):t.setState({...t.state,mode:ne.c.Mode.Results,query:{...t.state.query,text:i},limit:ne.b,allResultsLoaded:!1}),a.setState({...a.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),l()(this,"handleClearButtonClick",()=>{const{searchStore:e}=this.props;e.resetQuery({resetFilters:!0}),e.setState({...e.state,isSidebarOpen:!1})}),l()(this,"handleFocus",()=>{const{isFocusedStore:e}=this.props;e.get()||e.set(!0)}),l()(this,"handleBlur",()=>{const{isFocusedStore:e}=this.props,{device:t}=this.environment;e.get()&&(e.set(!1),t.isMobileNative&&Lt.b.updateKeyboardPhase(Lt.a.willHide))}),l()(this,"setTypingStart",()=>{const{isTypingStore:e}=this.props;e.get()||e.set(!0)}),l()(this,"setTypingEnd",()=>{const{isTypingStore:e}=this.props;e.set(!1)}),l()(this,"styles",{inputDesktop:{fontSize:18,height:jt.DESKTOP_INPUT_HEIGHT,paddingLeft:16,paddingRight:16,flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:()=>{const{device:e}=this.environment;return{width:e.isMobile?16:18,height:e.isMobile?16:18,marginRight:e.isMobile?12:10,flexGrow:0,flexShrink:0}},input:{minWidth:0,...R.a.textOverflowStyle},clearButton:{marginLeft:8}})}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){const{device:e}=this.environment,{isOpen:t,searchStore:{state:a}}=this.props,i=this.styles,s=this.getThemeColors(),n=e.isMobile?be.b.Format.ExtraLarge:be.b.Format.Transparent,r=e.isMobile?{...i.inputMobile,...s.inputMobile}:{...i.inputDesktop,...s.inputDesktop};return o()(be.b,{format:n,placeholder:this.getPlaceholderText(),left:this.renderSpinner(),value:a.query.text,focus:e.isMobile?void 0:t,focusInitial:e.isMobile,focusAfterAnimation:!0,showClearButton:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,onFocus:this.handleFocus,onBlur:this.handleBlur,style:r,inputStyle:i.input,clearButtonStyle:i.clearButton})}handleTyping(){this.typingTimer&&window.clearTimeout(this.typingTimer),this.setTypingStart(),this.typingTimer=window.setTimeout(this.setTypingEnd,jt.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e,currentBlockStore:t}=h.default.state,a=e&&Object(Ut.getSpaceName)(this.environment,e);if(a)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:a});if(t){const e=_t.eb(t.getTitleValue()).slice(0,jt.MAX_PLACEHOLDER_TITLE_LENGTH);return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:e})}return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}getThemeColors(){return{inputDesktop:{boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor)},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}l()(jt,"TYPING_DEBOUNCE_MS",300),l()(jt,"DESKTOP_INPUT_HEIGHT",52),l()(jt,"MAX_PLACEHOLDER_TITLE_LENGTH",100);var Nt=Object(U.injectIntl)(jt),Zt=a("dNiu"),Wt=a("aw/t"),Vt=a("LFt7");class zt extends O.a{constructor(...e){super(...e),l()(this,"styles",{title:{fontWeight:R.a.fontWeight.medium,lineHeight:"20px"},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},textWrapper:{marginLeft:8,alignItems:void 0,flex:void 0},inlineTextWrapper:{alignItems:"baseline"},highlight:{fontWeight:R.a.fontWeight.medium},enterIcon:{height:14,width:14},caption:{marginTop:1}})}renderComponent(){const{focused:e,isLastInSection:t,isBeforeFocused:a,inline:i}=this.props,n=this.styles,o=this.getThemeColors(),r={...n.menuItem,...!i&&!t&&!a&&!e&&o.menuItemBorder},l={...n.caption,...o.caption},d={...n.textWrapper,...this.props.inline&&n.inlineTextWrapper};return p.a.createElement(x.a,s()({},this.props,{title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderEnterIcon(),disableTransition:!0,dontShrinkRight:!0,ignoreLocalHoverState:!0,captionStyle:l,style:r,textWrapperStyle:d,className:"notranslate"}))}renderTitle(){const{store:e,result:t,placeholder:a}=this.props,i=this.styles,s=this.getThemeColors(),n={...i.title,...this.hasAnyHighlight()&&s.highlightedTitle},r=this.getHighlightedWordsFromText(t&&t.highlight&&t.highlight.pathText);t&&t.isNavigable&&r.push(...this.getHighlightedWordsFromText(t&&t.highlight&&t.highlight.text));const l=this.getWordHighlighter(r);return o()(B.a,{style:n,store:e,placeholder:a,highlighter:l})}renderIcon(){const{store:e}=this.props;return o()(Mt.a,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:19})}renderCaption(){const{store:e,result:t,inline:a}=this.props;if(!this.hasPath())return;const i=this.getWordHighlighter(this.getHighlightedWordsFromText(t&&t.highlight&&t.highlight.pathText)),{device:s}=this.environment,n=a||s.isMobile?0:2;return o()(Wt.a,{store:e,extraLength:n,showFullPathInTooltip:!0,highlighter:i})}renderPreview(){const{result:e}=this.props;if(!e)return;if(!e.highlight)return;if(e.isNavigable)return;if(!e.highlight.text)return;const t=this.styles,a=this.getThemeColors(),i=e.highlight.text;return o()(Vt.a,{text:i,highlighter:{tokenize:e=>Object(Zt.a)(Object(Zt.b)(e)),style:{...t.highlight,...a.highlight}}})}getHighlightedWordsFromText(e){if(!e)return[];let t=Object(Zt.b)(e);return t.some(e=>Object(Zt.e)(e)&&1===Object(Zt.c)(e).length)&&(t=Object(Zt.a)(t)),c()(t).filter(Zt.e).map(Zt.c).uniq().value()}getWordHighlighter(e){if(0===e.length)return;const t=this.styles,a=this.getThemeColors();return{tokenize:t=>Object(Zt.d)(t,e),style:{...t.highlight,...a.highlight}}}renderEnterIcon(){const{device:e}=this.environment,{focused:t}=this.props,a=this.styles,i=this.getThemeColors();if(e.isMobile)return;const s={...a.enterIcon,...i.enterIcon,opacity:t?1:0};return v.a.enter(s)}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&Object(Wt.b)(t)}hasAnyHighlight(){const{result:e}=this.props;if(!e)return!1;const{highlight:t}=e;return!!t&&Boolean(t.text||t.pathText)}getThemeColors(){return{highlightedTitle:{color:this.theme.mediumTextColor},menuItemBorder:{boxShadow:"0 1px 0 ".concat(this.theme.lightDividerColor)},highlight:{color:this.theme.regularTextColor},enterIcon:{fill:this.theme.mediumIconColor},caption:{color:this.theme.mediumTextColor}}}}l()(zt,"contextTypes",T.c);var qt=zt,Ht=a("5qTp"),Gt=a("FcJC"),Kt=a("HSWF"),Yt=a("nFzZ"),Qt=a("hU3F"),Jt=a("vJXr"),Xt=a("+NSf");class $t extends O.a{constructor(...e){super(...e),l()(this,"inactiveTimer",void 0),l()(this,"spaceId",void 0),l()(this,"isOpen",!1),l()(this,"storeTypes",{searchStore:ne.c,resultListStore:A.a,serverRequestStore:W.a,localRequestStore:W.a,localCacheRequestStore:W.a,isTypingStore:Qt.a.of(!1),isInputFocusedStore:Qt.a.of(!1),numQueriesIssued:Qt.a.of(0),selectedQueryResult:Qt.a.of(!1)}),l()(this,"renderBody",e=>{const{device:t}=this.environment,{searchStore:{state:a}}=this.stores,i=this.layoutStyles,{currentSpaceStore:n}=h.default.state;return p.a.createElement(T.b,s()({},this.getMenuProps(e),{className:y.sb}),o()("div",{style:i.body},void 0,!t.isMobile&&this.renderInput(),o()(Z.a,{requestStore:this.stores.localCacheRequestStore,request:n&&n.id,performRequest:this.performLocalCacheRequest,render:a.mode===ne.c.Mode.Results?this.renderResults:this.renderDefaultBody})),this.shouldShowSidebar()&&this.renderFilterMenu())}),l()(this,"renderDefaultBody",()=>{const{device:e}=this.environment,{resultListStore:t}=this.stores,a=this.defaultViewStyles;if(!this.recentPageStores.state)return;const i=this.getInitialFocus(),s={mode:ne.c.Mode.Default,isMobile:e.isMobile,recentSearches:this.recentSearches.state,recentPages:this.recentPageStores.state};return o()(p.a.Fragment,{},void 0,o()("main",{style:a.wrapper},void 0,o()(k.a,{type:k.a.Type.Vertical,store:t,initialFocus:i,disableKeyboardArrowWrap:!0,sections:c.a.compact([this.getRecentPagesSection(),this.getRecentSearchesSection()])})),this.shouldShowFooter(s)&&this.renderFooter())}),l()(this,"renderResults",()=>{const{device:e}=this.environment,{searchStore:t,serverRequestStore:a,localRequestStore:i}=this.stores,s={query:t.state.query,limit:t.state.limit};return o()(Z.a,{debounce:g.b,requestStore:a,request:s,performRequest:this.performServerRequest,render:(t,a)=>o()(Z.a,{debounce:g.a,requestStore:i,request:s,performRequest:(...e)=>Promise.resolve(this.performLocalRequest(...e)),render:(t,i)=>o()(p.a.Fragment,{},void 0,e.isMobile&&this.renderFilterMenu(),this.renderRequestResults({localResponse:i,serverResponse:a}))})})}),l()(this,"renderRequestResults",e=>{const{device:t}=this.environment,{serverResponse:a,localResponse:i}=e,{serverRequestStore:s}=this.stores;if(!a&&!i)return;const n=D.f({localResponse:i,serverResponse:a,serverRequestStore:s});this.incrementNumQueriesIssued();const r={mode:ne.c.Mode.Results,isMobile:t.isMobile,errorState:n};return o()(p.a.Fragment,{},void 0,this.shouldShowHeaderDesktop(r)&&this.renderHeader(),this.renderResultsSection({errorState:n,localResponse:i,serverResponse:a}),this.shouldShowFooter(r)&&this.renderFooter({localResponse:i,serverResponse:a}))}),l()(this,"renderSearchResult",(e,t)=>{const{store:a}=e,i=a.isNavigableBlock()?a:a.getNavigableBlockStore();if(i)return{key:"".concat(a.id,":").concat(t),action:e=>this.handleSelectResult(a,e,"query_results"),render:a=>p.a.createElement(qt,s()({},a,{isFirstInSection:0===t,store:i,hidePath:!1,result:e}))}}),l()(this,"handleComponentOpenClose",()=>{this.isOpen!==Ht.default.state.open&&(this.isOpen=Ht.default.state.open,Ht.default.state.open?clearTimeout(this.inactiveTimer):this.addRecentSearch())}),l()(this,"handleComponentClose",()=>{const{device:e}=this.environment,{searchStore:t,numQueriesIssued:a,selectedQueryResult:i}=this.stores,s=i.get(),n=a.get(),{query:o}=t.state;F.a(),n>0&&!s&&m.d(this.environment,{numQueriesIssued:n}),""===o.text.trim()?t.reset():D.l(o.filters)||t.setState({...t.state,isSidebarOpen:!1}),this.inactiveTimer=window.setTimeout(this.resetState,2*Yt.d),e.isMobile&&Gt.close()}),l()(this,"handleRecentSearch",(e,t)=>{const{searchStore:a}=this.stores;a.setState({...a.state,query:e,mode:ne.c.Mode.Results,isSidebarOpen:!0})}),l()(this,"handleSelectResult",(e,t,a)=>{const{searchStore:i,numQueriesIssued:s,selectedQueryResult:n}=this.stores,{event:o}=t,r=o.metaKey||o.ctrlKey;"query_results"===a&&n.set(!0);const{query:l}=i.state;m.te(this.environment,{context:a,queryStringLength:l.text.trim().length,hasFilters:D.l(l.filters),selectedItemIndex:t.index,isNavigable:e.isNavigableBlock(),numQueriesIssued:s.get()}),V.navigateToPage(e,r,this.environment),r||this.handleComponentClose()}),l()(this,"handleScrollOffsetChange",e=>{const{searchStore:t,searchStore:{state:a},serverRequestStore:{state:i}}=this.stores;!(e<=$t.LOAD_MORE_RESULTS_SCROLL_OFFSET_PX)||i.loading||a.allResultsLoaded||t.setState({...a,limit:a.limit+ne.b})}),l()(this,"handleScrollResults",()=>{this.stores.isInputFocusedStore.get()&&this.blurInputDebounced()}),l()(this,"handleSpaceChange",()=>{const e=h.default.state.currentSpaceStore&&h.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetState())}),l()(this,"performLocalCacheRequest",async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=h.default.state;if(!this.getPublicAccessPermissionForPage()&&e)return D.h({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})}),l()(this,"performLocalRequest",e=>{const{query:t}=e,{localCacheRequestStore:a}=this.stores,i=a.state.result;if(!i)return;if(!t.text.trim())return;if(this.getPublicAccessPermissionForPage())return;const s=Xt.default.createMetric("rum.local_quick_search_query"),n=D.g({input:e,cache:i});if(!n)return;if(0===n.results.length)return{error:$.d.NoResults};const o=D.n({sort:t.sort,unsorted:n.results,batchSize:ne.b,currentUserId:this.environment.currentUser.id}).results.map(e=>({...e,store:this.createBlockStore(e.id)})),r=this.isOnline()?D.m(this.environment,o):o,l=this.isOnline()?r.length:n.total;if(0===l)return{error:$.d.NoResults};const d={value:{total:l,results:r}};return Xt.default.emit(this.environment,s),d}),l()(this,"performServerRequest",async e=>{const{searchStore:t}=this.stores,{currentSpaceStore:a}=h.default.state,{query:i,limit:s}=e;if(!i.text.trim()&&!D.l(i.filters))return;if(!this.isOnline())return{error:$.d.Offline};const n=Xt.default.createMetric("rum.server_quick_search_query"),o=await D.k({environment:this.environment,input:e,currentSpaceStore:a,publicAccessPermission:this.getPublicAccessPermissionForPage()});if(!o)return;if("failed"===o.type)return o.offline?{error:$.d.Offline}:{error:$.d.RequestFailed};if(0===o.data.results.length)return{error:$.d.NoResults};const{results:r,total:l}=D.n({sort:i.sort,unsorted:o.data.results,batchSize:ne.b,currentUserId:this.environment.currentUser.id});return t.setState({...t.state,allResultsLoaded:l<s}),Xt.default.emit(this.environment,n),{value:{results:r.map(e=>({...e,store:this.createBlockStore(e.id)})),total:o.data.total}}}),l()(this,"recentPageStores",this.createComputedStore(()=>{const{currentSpaceStore:e}=h.default.state,t=(e?Kt.s({currentUserId:this.environment.currentUser.id,spaceId:e.id}).slice(0,this.getMaxRecentPages()):[]).map(this.createBlockStore),a=t.map(I.m);return c.a.every(a)&&t.filter(e=>e.pathIsAlive())})),l()(this,"clearRecentlyVisitedPages",()=>{const{currentSpaceStore:e}=h.default.state;e&&(Kt.i({currentUserId:this.environment.currentUser.id,spaceId:e.id}),this.recentPageStores.recompute())}),l()(this,"recentSearches",this.createComputedStore(()=>{const{currentSpaceStore:e}=h.default.state;return e?Kt.r({currentUserId:this.environment.currentUser.id,spaceId:e.id}).slice(0,$t.MAX_RECENT_SEARCHES):[]})),l()(this,"clearRecentSearches",()=>{const{currentSpaceStore:e}=h.default.state;e&&(Kt.h({currentUserId:this.environment.currentUser.id,spaceId:e.id}),this.recentSearches.recompute())}),l()(this,"addRecentSearch",()=>{const{searchStore:e,serverRequestStore:t,localRequestStore:a}=this.stores,{currentSpaceStore:i}=h.default.state;if(!i)return;const{query:s}=e.state;if(!s.text.trim())return;const n=this.getCurrentResults(),o=n.local&&!a.state.loading,r=n.server&&!t.state.loading;(o||r)&&Kt.c({currentUserId:this.environment.currentUser.id,spaceId:i.id,query:s})}),l()(this,"createBlockStore",e=>{const{parentStore:t}=this.props;return f.a.createChildStore(t,{table:M.a,id:e})}),l()(this,"shouldDismissKeyboardOnScroll",()=>{const{device:e}=this.environment;return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}),l()(this,"blurInput",()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),l()(this,"blurInputDebounced",c.a.debounce(this.blurInput,500,{leading:!0})),l()(this,"resetState",()=>{const{searchStore:e,resultListStore:t,serverRequestStore:a,localRequestStore:i,localCacheRequestStore:s}=this.stores;e.reset(),t.reset(),a.reset(),i.reset(),s.reset(),Ht.default.reset()}),l()(this,"incrementNumQueriesIssued",c.a.debounce(()=>this.stores.numQueriesIssued.update(e=>e+1),500)),l()(this,"searchIcon",()=>v.a.searchThick({height:14,width:14,marginLeft:2,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor})),l()(this,"layoutStyles",{modal:{width:"75%",maxWidth:600,minHeight:$t.MIN_MENU_HEIGHT,maxHeight:$t.MAX_MENU_HEIGHT},modalWithSidebar:{maxWidth:820},body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:$t.MAX_MENU_HEIGHT},footer:{flexShrink:0}}),l()(this,"modalMenuStyles",{topbar:{height:void 0},topbarLeftInput:{marginLeft:10,marginTop:10,marginBottom:10},topbarRightButtonWrapper:{flex:void 0},topbarButton:{fontWeight:void 0}}),l()(this,"defaultViewStyles",{wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},recentSection:{paddingTop:0,paddingBottom:8},recentTitle:{margin:0,padding:"0 14px",height:32,alignItems:"center",paddingTop:2},clearButton:{fontWeight:R.a.fontWeight.medium,padding:0,background:"none",fontSize:12,height:void 0},clearButtonDesktop:{textTransform:"none",letterSpacing:"normal",padding:"0 4px",fontSize:R.a.fontSize.UISmall.desktop,height:20,lineHeight:"20px",borderRadius:3}}),l()(this,"resultStyles",{results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0}}})}getMaxRecentPages(){const{device:e}=this.environment;return e.isMobile?5:7}didMount(){Ht.default.addListener(this.handleComponentOpenClose),h.default.addListener(this.handleSpaceChange),this.recentPageStores.addListener(c.a.noop)}willUnmount(){Ht.default.removeListener(this.handleComponentOpenClose),h.default.removeListener(this.handleSpaceChange),this.recentPageStores.removeListener(c.a.noop),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){const{device:e}=this.environment,t=this.layoutStyles,a=Boolean(Ht.default.state.open),i={...t.modal,...this.shouldShowSidebar()&&t.modalWithSidebar};return o()(w.a,{open:a,onDismiss:this.handleComponentClose,modalStyle:i,disableAnimation:!e.isMobile,renderContent:()=>o()(S.a,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!e.isMobile,render:()=>o()(b.a,{capture:!0,allowMenuList:!0,render:this.renderBody})})})}getMenuProps(e){const{device:t}=this.environment,{searchStore:a}=this.stores,i=this.modalMenuStyles,s=this.getThemeColors();if(t.isMobile){const{mode:t}=a.state,n={...i.topbarButton,...s.topbarButton};return{menuType:T.a.Modal,left:this.renderInput(),shouldRenderLeftDirectly:!0,leftOuterStyle:i.topbarLeftInput,right:o()(Le.CancelMenuText,{}),onClickRight:this.handleComponentClose,rightOuterStyle:i.topbarRightButtonWrapper,header:this.shouldShowHeaderMobile({mode:t})&&this.renderHeader(),disableHeaderShadow:!0,topbarStyle:i.topbar,leftRightButtonStyle:n,onScroll:this.shouldDismissKeyboardOnScroll()?this.handleScrollResults:void 0,...e}}return{menuType:T.a.Popup,maxHeight:$t.MAX_MENU_HEIGHT,minHeight:$t.MIN_MENU_HEIGHT,disableScroller:!0,scrollerStyle:this.layoutStyles.scroller,...e}}renderHeader(){const{parentStore:e}=this.props,{searchStore:t}=this.stores,a=Boolean(this.getPublicAccessPermissionForPage());return o()(Rt,{parentStore:e,searchStore:t,isPublicPageSearch:a})}renderInput(){const{searchStore:e,resultListStore:t,isTypingStore:a,isInputFocusedStore:i}=this.stores;return o()(Nt,{isOpen:Boolean(Ht.default.state.open),searchStore:e,resultListStore:t,isTypingStore:a,isFocusedStore:i,showSpinner:this.showSpinner()})}getRecentPagesSection(){const{device:e}=this.environment,t=this.defaultViewStyles,a=this.recentPageStores.state;if(!a||0===a.length)return;return{key:"recentlyVisitedPages",items:a.map((t,a)=>({key:"".concat(t.id,":").concat(a),action:e=>this.handleSelectResult(t,e,"recent_pages"),render:i=>p.a.createElement(qt,s()({},i,{isFirstInSection:0===a,inline:!e.isMobile,store:t,hidePath:!1}))})),render:a=>o()(Ye.a,{title:o()(U.FormattedMessage,{id:"search.recentlyVisitedPages.title",defaultMessage:"Recent pages",description:"Title text for recently visited pages"}),desktopTitleStyle:t.recentTitle,desktopStyle:t.recentSection,right:(void 0!==a.focusedIndex||e.isMobile)&&this.renderClearRecentsButton(this.clearRecentlyVisitedPages)},a.key,o()("ul",{style:G},void 0,a.children))}}getRecentSearchesSection(){const{device:e}=this.environment,{parentStore:t}=this.props,a=this.defaultViewStyles,i=this.recentSearches.state;if(0===i.length)return;return{key:"recentSearches",items:i.slice(0,$t.MAX_RECENT_SEARCHES).map((e,a)=>({key:a,action:t=>this.handleRecentSearch(e,t),render:i=>o()("li",{},i.key,p.a.createElement(N,s()({},i,{isFirstInSection:0===a,parentStore:t,query:e,icon:this.searchIcon()})))})),render:t=>o()(Ye.a,{title:o()(U.FormattedMessage,{id:"search.recentSearches.title",defaultMessage:"Recent searches",description:"Title text for recent searches"}),desktopTitleStyle:a.recentTitle,desktopStyle:a.recentSection,right:(void 0!==t.focusedIndex||e.isMobile)&&this.renderClearRecentsButton(this.clearRecentSearches)},t.key,o()("ul",{style:G},void 0,t.children))}}getInitialFocus(){if(this.stores.searchStore.state.query.text.trim())return;const e=this.recentPageStores.state;return e&&e.length>0?1:0}renderFooter(e){const{searchStore:t}=this.stores,a=this.layoutStyles,{mode:i}=t.state;if(i===ne.c.Mode.Default)return o()("footer",{style:a.footer},void 0,o()(de,{mode:i}));const s=this.getCurrentResultsWithCount(e);return s?o()("footer",{style:a.footer},void 0,o()(de,{mode:i,results:s,showSpinner:this.showSpinner()})):void 0}renderClearRecentsButton(e){const{device:t}=this.environment,a=this.defaultViewStyles,i=this.getThemeColors(),s={...a.clearButton,...i.clearButton,...!t.isMobile&&a.clearButtonDesktop};return o()(ce.a,{onClick:e,style:s},void 0,o()(U.FormattedMessage,{id:"search.clearRecentsButton.text",defaultMessage:"Clear",description:"Button text for clearing recent searches and pages"}))}renderResultsSection(e){const{localResponse:t,serverResponse:a,errorState:i}=e,{resultListStore:n}=this.stores,r=this.resultStyles,l=D.b({environment:this.environment,results:this.getCurrentResults({localResponse:t,serverResponse:a}),isOnline:this.isOnline()}),d=l&&{key:"results",render:e=>p.a.createElement(oe.a,s()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0})),items:c.a.compact(l.map(this.renderSearchResult))};return o()("section",{style:r.results},void 0,d&&o()(k.a,{type:k.a.Type.Vertical,initialFocus:0,store:n,disableKeyboardArrowWrap:!0,sections:[d]}),this.renderError(i)||o()(z.a,{onChange:this.handleScrollOffsetChange}))}renderError(e){const{searchStore:t}=this.stores;if(!e.isLoading)return e.showMajorError?o()(ae,{error:e.serverError,searchStore:t}):e.serverError&&e.serverError!==$.d.NoResults?this.renderMessage(e.serverError.message):void 0}renderFilterMenu(){const{device:e}=this.environment,{parentStore:t}=this.props,{searchStore:a}=this.stores,i=e.isMobile?{isMobile:!0,mode:xt.Section}:{};return p.a.createElement(Bt,s()({parentStore:t,searchStore:a},i))}renderMessage(e){const t=this.resultStyles;return o()(oe.a,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,o()(C.a,{title:e,style:t.messageMenuItem}))}getCurrentResults(e){const{serverRequestStore:t,localRequestStore:a}=this.stores,i=e&&e.localResponse||a.state.result,s=e&&e.serverResponse||t.state.result;return{local:D.i(i),server:D.i(s)}}getCurrentResultsWithCount(e){const{serverRequestStore:t,localRequestStore:a}=this.stores,i=e&&e.localResponse||a.state.result,s=e&&e.serverResponse||t.state.result,n=D.j(i),o=D.j(s);return o&&n?{server:o,local:n}:o?{server:o,local:void 0}:n?{server:void 0,local:n}:void 0}getPublicAccessPermissionForPage(){const{currentBlockStore:e}=h.default.state;return e&&P.g(this.environment,e)}isOnline(){return Boolean(Jt.a.state.online)}shouldShowSidebar(){const{device:e}=this.environment,{searchStore:t}=this.stores;if(!this.getPublicAccessPermissionForPage()&&!e.isMobile)return t.isSidebarOpen()}shouldShowHeaderDesktop(e){const{errorState:t,mode:a,isMobile:i}=e;if(i)return!1;if(a===ne.c.Mode.Default)return!1;if(t.isLoading){const e=this.getCurrentResults();return Boolean(e.local||e.server)}return!t.showMajorError}shouldShowHeaderMobile(e){const{mode:t}=e;return t===ne.c.Mode.Results}shouldShowFooter(e){const{isMobile:t}=e;if(t)return!1;if(e.mode===ne.c.Mode.Default){const t=e.recentSearches.length>0,a=e.recentPages.length>0;return Boolean(t||a)}if(e.errorState.isLoading){const e=this.getCurrentResults();return Boolean(e.local||e.server)}return!e.errorState.showMajorError}showSpinner(){const{searchStore:e,serverRequestStore:t,isTypingStore:a}=this.stores;return this.isOnline()&&e.state.mode===ne.c.Mode.Results&&!t.state.ready&&!a.get()}getThemeColors(){return{topbarButton:{color:this.theme.mediumTextColor},clearButton:{color:this.theme.lightTextColor}}}}l()($t,"MAX_RECENT_SEARCHES",5),l()($t,"LOAD_MORE_RESULTS_SCROLL_OFFSET_PX",200),l()($t,"MIN_MENU_HEIGHT",50),l()($t,"MAX_MENU_HEIGHT","80vh");t.default=$t},miBo:function(e,t,a){"use strict";var i=a("g4rC");t.a=new i.a},smsn:function(e,t,a){"use strict";a.r(t);var i=a("pVnL"),s=a.n(i),n=a("gcR/"),o=a.n(n),r=a("lSNA"),l=a.n(r),d=(a("3bBZ"),a("LvDl")),c=a.n(d),u=a("q1tI"),p=a.n(u),m=a("z22Z"),g=a("aZ00"),h=a("mF3+"),f=a("Mr7a"),M=a("hbKx"),y=a("wpmu"),v=a("/YYm"),b=a("tvfY"),S=a("wldR"),C=a("g4rC"),T=a("IdSf"),k=a("yisX"),A=a("OxuQ"),w=a("y6Dp"),I=a("lEhh"),P=a("LeVO"),F=a("MeYt"),x=a("5Nka"),E=a("Pqcg"),B=a("aEEb"),D=a("J9+s"),O=a("IULH"),R=a("yNyh"),L=a("hU3F"),_=a("d9nj"),U=a("Cycz"),j=a("PEWV"),N=a("HRSx"),Z=a("2ZkR");let W;!function(e){e[e.Web=0]="Web",e[e.Workspace=1]="Workspace",e[e.User=2]="User"}(W||(W={}));class V extends S.a{constructor(...e){super(...e),l()(this,"copiedLinkTimeout",void 0),l()(this,"copiedLink",new L.a(!1)),l()(this,"showLinkOptions",new L.a(!1)),l()(this,"storeTypes",{buttonPopupStore:C.a}),l()(this,"renderLinkOptionsButton",()=>o()(_.a,{onClick:this.handleShowLinkOptionsClick,style:{...this.getPublicAccessOptionStyle()}},void 0,o()(B.a,{isSmall:!0},void 0,o()(D.FormattedMessage,{defaultMessage:"Show link options",id:"pagePermissionItem.showLinkOptions.label"}),h.a.chevronDown({width:9,height:9,marginLeft:4,display:"inline"})))),l()(this,"renderAllowEditsTooltip",()=>o()(E.a,{caption:o()(D.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:x.a.images.tooltips.share.allowEditingPng})),l()(this,"renderAllowCommentsTooltip",()=>o()(E.a,{caption:o()(D.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:x.a.images.tooltips.share.allowCommentsPng})),l()(this,"renderAllowSearchEngineTooltip",()=>o()(E.a,{caption:o()(D.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:x.a.images.tooltips.share.allowSearchEnginesPng})),l()(this,"renderAllowSearchEngineUpgradeTooltip",()=>o()(E.a,{imageURL:x.a.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:o()(D.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:o()(D.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})),l()(this,"renderAllowDuplicateTooltip",()=>o()(E.a,{caption:o()(D.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:x.a.images.tooltips.share.allowDuplicatePng})),l()(this,"handleCopy",()=>{const e=Object(v.a)({store:this.props.currentBlockStore,preferPublicLink:"on"===Z.default.getGroup(this.environment,"paul-mockapetris")});g.c({environment:this.environment,stringValue:e}),clearTimeout(this.copiedLinkTimeout),this.copiedLink.set(!0),this.copiedLinkTimeout=window.setTimeout(()=>{this.copiedLink.set(!1)},1e3)}),l()(this,"handleShowLinkOptionsClick",()=>{this.showLinkOptions.set(!0)}),l()(this,"handleToggleAllowEdits",()=>{const{permissionItem:e}=this.props;"public_permission"===e.type&&this.props.onChange({...e,role:"read_and_write"===e.role?"comment_only":"read_and_write"})}),l()(this,"handleToggleAllowComments",()=>{const{permissionItem:e}=this.props;"public_permission"===e.type&&this.props.onChange({...e,role:"comment_only"===e.role||"read_and_write"===e.role?"reader":"comment_only"})}),l()(this,"handleToggleSearchEngine",()=>{const{permissionItem:e}=this.props;if("public_permission"===e.type){const t=e,a=Boolean(t.allow_search_engine_indexing),i=c.a.clone(t),s=!a;i.allow_search_engine_indexing=s,this.props.onChange(i),w.ff(this.environment,{allow_search_engine_indexing:s})}}),l()(this,"handleToggleDuplicate",()=>{const{permissionItem:e}=this.props;if("public_permission"===e.type){const t=e,a=void 0===t.allow_duplicate||!0===t.allow_duplicate,i=c.a.clone(t),s=!a;i.allow_duplicate=s,this.props.onChange(i),w.ef(this.environment,{allow_duplicate:s})}}),l()(this,"handleRoleSelect",e=>{const t=c.a.clone(this.props.permissionItem);t.role=e,this.props.onChange(t)}),l()(this,"handleSwitcherButtonClick",()=>{"none"===this.role?this.handleRoleSelect(this.props.switcherRole||"editor"):this.handleRoleSelect("none")}),l()(this,"handleUserItemClick",()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})})}willMount(e){super.willMount(e),m.n(e.permissionItem)&&"none"===e.permissionItem.role&&this.showLinkOptions.set(!0)}renderComponent(){const{device:e}=this.environment,{tooltip:t}=this.props,a=this.isUserItem()||!this.isPublicPermissionItem?this.handleUserItemClick:this.handleSwitcherButtonClick;return o()(u.Fragment,{},void 0,t?o()(P.a,{delayThreshold:0,renderTooltip:()=>t,render:t=>p.a.createElement(F.a,s()({disabled:this.props.disabled,mobileFeedback:e.isMobile,style:{...this.props.disabled?{cursor:"not-allowed"}:{}},onClick:a},t),this.renderMenuItem()),placement:P.a.Placement.Left}):o()(F.a,{disabled:this.props.disabled,style:{...this.props.disabled?{cursor:"not-allowed"}:{}},onClick:a},void 0,this.renderMenuItem()),this.renderPublicPermissionSettings())}renderMenuItem(){const{device:e}=this.environment,{isInherited:t,permissionItem:a}=this.props,i=this.isUserItem(),s=this.isBotPermissionItem(),n=!i&&!s,r=m.p(a)||m.i(a),l=!(this.isPublicPermissionItem||r&&"none"===this.role);return o()("div",{className:"notranslate",style:this.getMenuItemStyle(i)},void 0,o()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10}},void 0,this.props.icon),o()("div",{style:{marginRight:"auto",minWidth:0}},void 0,o()(B.a,{style:{...!i&&{fontWeight:400}}},void 0,this.props.title),this.props.subtitle&&o()(B.a,{isSmall:!0},void 0,this.props.subtitle),t&&this.renderInheritedRecordTitle()),o()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8}},void 0,this.isPublicPermissionItem?p.a.createElement(p.a.Fragment,null,l&&!r&&o()(k.a,{role:this.role,table:N.a,type:a.type,disabled:this.props.disabled,isSubscribed:this.props.isSubscribed,isUserPermission:this.permissionItemIsUserItem(a),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:e.isMobile||i||s?-6:8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12}}),n&&o()(I.a,{on:"none"!==this.role,onClick:this.handleSwitcherButtonClick,disabled:this.props.disabled,isAndroid:e.isAndroid})):o()(k.a,{role:this.role,table:N.a,type:a.type,disabled:this.props.disabled,isSubscribed:this.props.isSubscribed,isUserPermission:this.permissionItemIsUserItem(a),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-6,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:this.props.isInherited})))}getPublicPermissionSettingsHeight(e){const{device:t}=this.environment;return e?0:t.isMobile?this.showLinkOptions.get()?214:94:this.showLinkOptions.get()?184:88}renderPublicPermissionSettings(){const{device:e}=this.environment,{permissionItem:t}=this.props;if(m.n(t)){const a="none"===this.role;return o()("div",{style:{maxHeight:this.getPublicPermissionSettingsHeight(a),transition:"max-height ease 200ms, padding-bottom ease 200ms",overflow:"hidden",paddingBottom:a?0:this.showLinkOptions.get()?12:8}},void 0,!e.isMobile&&this.renderPageLinkButton(),this.showLinkOptions.get()?p.a.createElement(p.a.Fragment,null,p.a.createElement(p.a.Fragment,null,o()(P.a,{placement:P.a.Placement.Left,renderTooltip:this.renderAllowEditsTooltip,render:a=>p.a.createElement(F.a,s()({onClick:this.handleToggleAllowEdits,style:this.getPublicAccessOptionStyle(),disabled:this.props.disabled},a),o()(B.a,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(D.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})),o()(I.a,{on:"read_and_write"===t.role,onClick:this.handleToggleAllowEdits,disabled:this.props.disabled,isAndroid:e.isAndroid}))}),o()(P.a,{placement:P.a.Placement.Left,renderTooltip:this.renderAllowCommentsTooltip,render:t=>p.a.createElement(F.a,s()({onClick:this.handleToggleAllowComments,style:this.getPublicAccessOptionStyle(),disabled:this.props.disabled},t),o()(B.a,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(D.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})),o()(I.a,{on:"comment_only"===this.role||"read_and_write"===this.role,onClick:this.handleToggleAllowComments,disabled:this.props.disabled,isAndroid:e.isAndroid}))})),o()(P.a,{placement:P.a.Placement.Left,renderTooltip:this.renderAllowDuplicateTooltip,render:a=>p.a.createElement(F.a,s()({onClick:this.handleToggleDuplicate,disabled:this.props.disabled,style:this.getPublicAccessOptionStyle()},a),o()(B.a,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(D.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})),o()(I.a,{on:!1!==t.allow_duplicate,onClick:this.handleToggleDuplicate,disabled:this.props.disabled,isAndroid:e.isAndroid}))}),o()(j.a,{requireUpgradeToTier:!Object(U.K)(this.environment)&&Object(U.j)(this.environment),alwaysAllowClick:t.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:this.handleToggleSearchEngine,onUpgradeClick:this.props.onUpgradeButtonClick,tooltipPlacement:P.a.Placement.Left,renderTooltip:this.renderAllowSearchEngineTooltip,renderUpgradeTooltip:this.renderAllowSearchEngineUpgradeTooltip,render:(a,i)=>p.a.createElement(F.a,s()({style:this.getPublicAccessOptionStyle(),disabled:this.props.disabled},a),o()(B.a,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(D.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",i),o()(I.a,{on:Boolean(t.allow_search_engine_indexing),onClick:this.handleToggleSearchEngine,disabled:this.props.disabled||Boolean(i),isAndroid:e.isAndroid}))})):this.renderLinkOptionsButton())}}renderPageLinkButton(){const e=Object(v.a)({store:this.props.currentBlockStore,preferPublicLink:"on"===Z.default.getGroup(this.environment,"paul-mockapetris")});return o()("div",{style:{...this.getPublicAccessOptionStyle(),height:"auto"}},void 0,o()("div",{style:{flex:1}},void 0,o()("div",{style:{display:"flex",padding:"1px 0"}},void 0,o()(R.b,{value:e,disabled:!0,style:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0}}),o()(O.a,{onClick:()=>this.handleCopy(),style:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}},void 0,this.copiedLink.get()?o()(D.FormattedMessage,{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}):o()(D.FormattedMessage,{id:"pageShareMenu.copyMaybePublicLinkButton.label",defaultMessage:"Copy"})))))}renderInheritedRecordTitle(){const e=this.props.store,t=Object(v.a)({store:e,fullyQualified:!1});return o()(B.a,{isSmall:!0,style:{lineHeight:1.4}},void 0,o()(D.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",description:"This text tells the user that this permission setting for the page is inherited from the parent page. ",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:o()(T.a,{underline:!0,inline:!0,href:t},void 0,o()(A.a,{store:e,style:{display:"inline"}}))}}))}permissionItemIsUserItem(e){const t=this.environment.currentUser.id;return"user_permission"===e.type&&e.user_id===t}isUserItem(){return this.props.format===W.User}get role(){return this.props.permissionItem.role}get isPublicPermissionItem(){return m.n(this.props.permissionItem)}isBotPermissionItem(){return m.g(this.props.permissionItem)}getMenuItemStyle(e){const{WindowSizeStore:t}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:8,paddingBottom:8,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}getPublicAccessOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;let a;return a=e.isMobile?36:30,{display:"flex",alignItems:"center",width:"100%",height:a,paddingTop:5,paddingBottom:5,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}getPublicAccessOptionLabelStyle(e){return{marginRight:"auto",opacity:e?.6:1}}}l()(V,"Format",W),l()(V,"iconSize",32);var z=V,q=a("8fuX"),H=a("gbGO"),G=a("2HDO"),K=a("MBf9"),Y=a("Oy36"),Q=a("Sb6f"),J=a("5/h/"),X=a("D8Ld"),$=a("8f5p"),ee=a("Fv2F"),te=a("QcDD"),ae=a("vJXr"),ie=a("r8MX"),se=a("A9TN"),ne=a("7M94"),oe=a("AXh+"),re=a("xL2i"),le=a("bPtJ"),de=a("G+Ai"),ce=a("58VE"),ue=a("VBxf"),pe=a("HTHG"),me=a("nPEg"),ge=a("7KuZ"),he=a("0CAA"),fe=a("qX+M"),Me=a("i8hZ"),ye=a("prF1");class ve extends S.a{renderComponent(){const{device:e,WindowSizeStore:t}=this.environment;return o()(ye.a,{href:Object(he.a)("guides.sharing"),onClick:()=>w.C(this.environment,{from:"sharing"}),style:{width:e.isMobile?"100%":void 0},external:!0},void 0,o()(_.a,{mobileFeedback:e.isMobile,isSmall:!0,style:{display:"flex",alignItems:"center",width:e.isMobile?"100%":void 0,height:e.isMobile?44:24,paddingTop:e.isMobile?12:4,paddingBottom:e.isMobile?12:4,paddingLeft:t.getSafePaddingLeftCSS(8),paddingRight:t.getSafePaddingRightCSS(12)}},void 0,o()("div",{style:{marginLeft:e.isMobile?2:0,marginRight:e.isMobile?8:6}},void 0,h.a.help({width:e.isMobile?16:14,height:e.isMobile?16:14,fill:e.isMobile?this.theme.mediumIconColor:this.theme.lightIconColor})),o()(B.a,{isSmall:!0,isMobile:e.isMobile,isSecondaryColor:!e.isMobile},void 0,o()(D.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnMore.prompt"}))))}}var be=ve,Se=a("GojS"),Ce=a("XfKI"),Te=a("pqiZ"),ke=a("kdGy"),Ae=a("gHFd"),we=a("FkPB"),Ie=a("+fkW"),Pe=a("iqZH"),Fe=a("zmp8"),xe=a("PHZn"),Ee=a("Zo/l");function Be(e){const{permissionItemWrapStyle:t,safePaddingRightCSS:a,safePaddingLeftCSS:i}=e,[{currentSpaceStore:s}]=Object(we.b)(te.default),[{publicSpaceDataMap:n}]=Object(we.b)(Ie.a),r=Object(xe.b)(),{isMobile:l}=Object(Ee.a)(),d=null==s?void 0:s.id;if(!d)return null;const c=n[d];if(!c)return null;const u=Boolean(null==s?void 0:s.canAdmin()),p=c.domainIsAutogenerated&&u,m="on"===Z.default.getGroup(e.environment,"paul-mockapetris-cta");return m||p?o()("span",{style:{...t,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",...l&&{flexDirection:"column",paddingLeft:i,paddingRight:a},color:r.mediumTextColor,backgroundColor:r.inputBackground}},void 0,m&&function(e){return o()("div",{style:{display:"flex"}},void 0,o()(B.a,{isSmall:!0,isMobile:e,isSecondaryColor:!e,style:{paddingRight:"4px"}},void 0,o()(D.FormattedMessage,{defaultMessage:"Public links are changing.",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.changingLinks"})),o()(ye.a,{href:Object(he.a)("guides.autogeneratedDomains"),external:!0},void 0,o()(B.a,{isSmall:!0,isMobile:e,isSecondaryColor:!e,style:{textDecoration:"underline"}},void 0,o()(D.FormattedMessage,{defaultMessage:"Learn more about the transition",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.transition"}))))}(l),p&&function(e){return o()("div",{style:{display:"flex"}},void 0,o()(B.a,{isSmall:!0,isMobile:e,isSecondaryColor:!e,style:{paddingRight:"4px"}},void 0,o()(D.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})),o()("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:Fe.g.inherit},onClick:()=>{Pe.a({currentTab:"settings"})}},void 0,o()(B.a,{isSmall:!0,isMobile:e,isSecondaryColor:!e,style:{textDecoration:"underline"}},void 0,o()(D.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"}))))}(l)):null}class De extends S.a{constructor(...e){super(...e),l()(this,"sidebarState",this.createComputedStore(()=>Object(pe.j)(this.environment))),l()(this,"storeTypes",{restrictConfirmationModalStore:L.a.of({open:!1,onClose:void 0})}),l()(this,"renderBotPermissionTooltip",()=>o()(E.a,{imageWidth:240,caption:o()(D.FormattedMessage,{defaultMessage:"This is an integration in your workspace.",id:"blockPermissionsSettings.botPermission.tooltip"})})),l()(this,"renderPublicPermissionTooltip",()=>o()(E.a,{imageURL:x.a.images.tooltips.share.publicPagePng,imageWidth:240,imageHeight:120,caption:o()(D.FormattedMessage,{defaultMessage:"Anybody with the link can access the page.",id:"blockPermissionsSettings.publicPermission.tooltip"})})),l()(this,"renderSpacePermissionTooltip",()=>o()(E.a,{imageURL:x.a.images.tooltips.share.workspacePng,imageWidth:240,imageHeight:180,caption:o()(D.FormattedMessage,{defaultMessage:"For all members in your workspace, this page will show up in the <boldtext>Workspace</boldtext> section in their sidebar.",values:{boldtext:(...e)=>o()("span",{style:{fontWeight:Q.a.fontWeight.bold}},void 0,e)},id:"blockPermissionsSettings.spacePermission.tooltip"})})),l()(this,"renderGroupPermissionTooltip",e=>{const{currentSpaceStore:t}=te.default.state,{countRemainingUsers:a,limitedUserValues:i}=$.b({group:e,spaceStore:t,limit:15});if(i.length>0)return o()("div",{style:{marginBottom:4}},void 0,i.map(e=>o()("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4}},e.id,o()(Se.a,{style:{flexGrow:1},userValue:e,avatarSize:18}))),a>0&&o()("div",{style:{marginLeft:2,marginTop:2,color:this.theme.mediumInvertedTextColor}},void 0,o()(D.FormattedMessage,{id:"blockPermissionsSettings.groupPermissionUsers.tooltip",defaultMessage:"{countRemainingUsers} more…",values:{countRemainingUsers:a}})));const s=Object($.a)({intl:this.props.intl,group:e});return o()(E.a,{imageURL:x.a.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:o()(D.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:(...e)=>o()("span",{style:{fontWeight:Q.a.fontWeight.bold}},void 0,e),groupName:s},id:"blockPermissionsSettings.groupPermission.tooltip"})})}),l()(this,"renderUserPermissionItem",e=>{const{store:t}=this.props,a=y.a.createChildStore(t,{table:N.a,id:e.blockId}),i=b.a.createChildStore(t,{table:J.a,id:e.permissionItem.user_id}).getValue(),s=a.id!==t.id,n=e=>o()("div",{style:{...e.style,background:this.theme.lightDividerColor}}),r=i?o()(ce.a,{userValue:i,size:z.iconSize}):o()(n,{style:{height:z.iconSize,width:z.iconSize,borderRadius:20}}),{data:l}=ie.default.state,d=(l?U.v(l):[]).find(t=>t.userId===e.permissionItem.user_id),c=Boolean(d&&!m.a(d.role)&&!m.c(d.role)),u=i&&i.email?c?o()("div",{style:Q.a.textOverflowStyle},void 0,h.a.globe2({width:14,fill:"#CF8807",display:"inline",verticalAlign:"middle"})," ",o()("span",{style:{color:"#CF8807",fontWeight:500}},void 0,o()(D.FormattedMessage,{defaultMessage:"Guest",id:"blockPermissionsSettings.permissionsForUserGuest.label"}))," • ",i.email):i.email:void 0;return o()("div",{},e.permissionItem.user_id,o()(z,{format:z.Format.User,currentBlockStore:t,store:a,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:r,title:i?Object(J.e)(this.props.intl,i)||o()(D.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"}):o()(n,{style:{height:8,width:81,borderRadius:3}}),subtitle:i?u:o()(n,{style:{height:8,width:139,borderRadius:3,marginTop:10}}),isSubscribed:this.isSubscribed(),isInherited:s,tooltip:s?this.renderInheritedPermissionTooltip(a):void 0,upgradeButtonName:"user_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:s,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}),l()(this,"renderBotPermissionItem",e=>{const{store:t}=this.props,a=y.a.createChildStore(t,{table:N.a,id:e.blockId}),i=Object(le.c)(t,{table:de.a,id:e.permissionItem.bot_id}),s=i.getValue(),n=a.id!==t.id,r=e=>o()("div",{style:{...e.style,background:this.theme.lightDividerColor}}),l=s&&s.name||o()(r,{style:{height:8,width:81,borderRadius:3}}),d=o()("div",{style:Q.a.textOverflowStyle},void 0,h.a.bot({width:12,display:"inline",verticalAlign:"middle",fill:this.theme.mediumIconColor})," ",o()(D.FormattedMessage,{defaultMessage:"Integration",id:"blockPermissionsSettings.permissionsForBot.label",description:"Inform user that this page is shared with a bot."})),c=o()(ke.a,{botValue:s,size:z.iconSize});return o()("div",{},i.id,o()(z,{format:z.Format.Workspace,currentBlockStore:t,store:a,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:c,title:l,tooltip:n?this.renderInheritedPermissionTooltip(a):this.renderBotPermissionTooltip(),subtitle:s?d:o()(r,{style:{height:8,width:139,borderRadius:3,marginTop:10}}),isSubscribed:this.isSubscribed(),isInherited:n,upgradeButtonName:"bot_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:n,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}),l()(this,"handleCopy",()=>{const e=Object(v.a)({store:this.props.store});g.c({environment:this.environment,stringValue:e}),this.props.buttonPopupStore.setState({open:!1})}),l()(this,"handleMobileNativeShareClick",()=>{const{mobileNative:e}=this.environment,t=ee.b({schemeUrl:window.location.href,baseUrl:se.default.domainBaseUrl});e&&e.share(t)}),l()(this,"handleCloseRestrictConfirmationModal",()=>{this.stores.restrictConfirmationModalStore.setState({open:!1,onClose:void 0})}),l()(this,"handlePermissionItemChange",async e=>{const{isInherited:t,oldPermissionItem:a,newPermissionItem:i}=e;if(!Object(re.n)(a,i))throw new Error("Permission type mismatch.");const s=Object(re.e)(a.role,i.role);if(t&&s!==i.role)return void this.handleRestrictPermission(i);const n=this.props.store.isTopLevel();if(n&&m.p(i)){const{data:e}=ie.default.state,t=e?U.u(e):1;if(m.d(a.role)&&!m.d(i.role)&&t>1){if(!(await ue.confirmUserAction({message:o()("span",{},void 0,o()(D.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:(...e)=>o()("span",{style:{fontWeight:Q.a.fontWeight.semibold}},void 0,e)},id:"blockPermissionsSettings.confirmationDialog.private.message"})),acceptLabel:o()(D.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(n&&!m.d(a.role)&&m.d(i.role)){if(!(await ue.confirmUserAction({message:o()("span",{},void 0,o()(D.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:(...e)=>o()("span",{style:{fontWeight:Q.a.fontWeight.semibold}},void 0,e),memberCount:t}})),acceptLabel:o()(D.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}!n&&a.role!==i.role&&s!==a.role&&w.wf(this.environment),K.createAndCommit(this.environment,e=>{f.f({environment:this.environment,store:this.props.store,permissionItems:[i],transaction:e})})}),l()(this,"handleRestrictPermission",e=>{const t=()=>{K.createAndCommit(this.environment,async t=>{await f.e({environment:this.environment,store:this.props.store,permissionItem:e,transaction:t})})};"none"===e.role?this.stores.restrictConfirmationModalStore.setState({open:!0,onClose:this.handleCloseRestrictConfirmationModal,type:"remove",permissionItem:e,onAccept:t}):this.stores.restrictConfirmationModalStore.setState({open:!0,onClose:this.handleCloseRestrictConfirmationModal,type:"restrict",onAccept:t})})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:H.b.MenuType.Modal,title:o()(D.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"}),left:this.renderMobileHelpButton(),right:o()(me.DoneMenuText,{}),onClickRight:this.props.onClose}:{menuType:H.b.MenuType.Popup},p.a.createElement(p.a.Fragment,null,p.a.createElement(Me.a,this.stores.restrictConfirmationModalStore.state),p.a.createElement(H.b,s()({},t,{className:ne.zb}),o()(X.a,{capture:!0,allowEsc:!0},void 0,o()(G.a,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>ae.a.state.online?this.renderPermissions():this.renderOfflineMessage()}))))}renderMobileHelpButton(){return o()(ge.a,{href:Object(he.a)("guides.sharing"),analyticsFrom:"sharing"})}renderOfflineMessage(){const{device:e}=this.environment;return o()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:160}},void 0,o()(B.a,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,o()(D.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})))}renderPermissions(){const{device:e,WindowSizeStore:t}=this.environment,{currentSpaceStore:a}=te.default.state,{store:i}=this.props,n=Object(oe.b)(i);let r=[];if(a){const e=a.getValue();e&&e.permission_groups&&(r=e.permission_groups)}let l={permissionItem:{type:"public_permission",role:"none"},blockId:i.id},d={permissionItem:{type:"space_permission",role:"none"},blockId:i.id};for(const s of n)if(m.n(s.permissionItem)){l=s}else if(m.p(s.permissionItem)){d=s}let g=n.filter(({permissionItem:e})=>m.i(e));g=c.a.sortBy(g,e=>{if(a){const t=a.getValue();if(t&&t.permission_groups)return t.permission_groups.findIndex(t=>t.id===e.permissionItem.group_id)}return e.permissionItem.group_id});const f=n.filter(({permissionItem:e})=>m.q(e)),M=n.filter(({permissionItem:e})=>m.g(e)),y={};let v=q.a.Y;e.isMobile?(y.backgroundColor=this.theme.contentBackground,v=q.a.None):y.maxHeight="calc(70vh - 80px)";const b=a&&!a.getDisablePublicAccess(),S=this.sidebarState.state,C=S&&S.showWorkspaceSection||a&&"team"===a.getPlanType(),T=C||f.length>1||f.length&&!m.a(f[0].permissionItem.role)||g.length||m.d(d.permissionItem.role),k=n.some(e=>m.o(e.permissionItem)&&e.blockId===i.id),A=(T?f.length:0)+M.length+(C?1:0);return o()("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column"}},void 0,e.isMobile&&o()(u.Fragment,{},void 0,k&&this.renderRestrictedPermissionBanner(),o()("div",{style:{display:"flex",paddingTop:8,paddingBottom:8,paddingRight:t.getSafePaddingRightCSS(14),background:this.theme.sidebarBackground}},void 0,this.renderPageLinkButton()),o()("div",{style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}})),o()(q.b,{style:y,type:v},void 0,!e.isMobile&&k&&this.renderRestrictedPermissionBanner(),"none"!==l.permissionItem.role&&o()(Be,{environment:this.environment,permissionItemWrapStyle:this.getPermissionItemWrapStyle(),safePaddingLeftCSS:t.getSafePaddingLeftCSS(8),safePaddingRightCSS:t.getSafePaddingRightCSS(8)}),b&&this.renderPublicPermissionItem(l),this.renderAddGuests(),C&&this.renderSpacePermissionItem(d),o()("div",{style:{...this.getPermissionItemWrapStyle(),paddingBottom:A>0?8:void 0}},void 0,this.renderGroupPermissions({spacePermissionGroups:r,mostPermissiveGroupPermissions:g}),T&&o()("div",{},void 0,f.map(this.renderUserPermissionItem)),M.map(this.renderBotPermissionItem))),o()("div",{style:{display:"flex",alignItems:e.isMobile?"flex-start":"center",boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor),paddingLeft:t.getSafePaddingRightCSS(8),paddingRight:t.getSafePaddingRightCSS(8),flexDirection:"column-reverse",...!e.isMobile&&{flexDirection:"row",justifyContent:"space-between",padding:"4px 4px"}}},void 0,!e.isMobile&&o()(u.Fragment,{},void 0,o()(be,{}),o()(P.a,{delayThreshold:0,placement:P.a.Placement.Bottom,renderTooltip:()=>this.getPageLinkInfoTooltip(),render:t=>p.a.createElement(_.a,s()({isSmall:!0,onClick:e.isMobileNative?this.handleMobileNativeShareClick:this.handleCopy,mobileFeedback:e.isMobile,style:{height:e.isMobile?44:24,width:e.isMobile?"100%":void 0,paddingLeft:8,paddingRight:8,color:this.theme.regularTextColor}},t),h.a.link({width:e.isMobile?16:14,height:e.isMobile?16:14,fill:this.theme.regularIconColor,marginLeft:e.isMobile?2:0,marginRight:e.isMobile?8:6}),o()(B.a,{isSmall:!0,isMobile:e.isMobile,style:{color:this.theme.regularTextColor}},void 0,o()(D.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})))}))))}renderInviteButton(){const{currentSpaceStore:e}=te.default.state,{device:t}=this.environment,{store:a}=this.props;return o()(Ae.LazyPermissionsInvite,{store:a,disabled:!this.canEdit(),membersOnly:Boolean(e&&e.getDisableGuests()),isSubscribed:this.isSubscribed(),onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:t.isMobile?36:28}})}renderPageLinkButton(){const{device:e}=this.environment;return o()(P.a,{delayThreshold:0,placement:P.a.Placement.Bottom,renderTooltip:()=>this.getPageLinkInfoTooltip(),render:t=>p.a.createElement(O.a,s()({isLarge:!0,onClick:e.isMobileNative?this.handleMobileNativeShareClick:this.handleCopy,style:{marginLeft:12,flex:1,height:this.environment.device.isMobile?36:void 0,background:this.theme.contentBackground}},t),e.isMobileNative?o()(D.FormattedMessage,{id:"pageShareMenu.sharePageLinkButton.label",defaultMessage:"Share page link"}):o()(D.FormattedMessage,{id:"pageShareMenu.copyPageLinkButton.label",defaultMessage:"Copy page link"}))})}renderRestrictedPermissionBanner(){const{device:e}=this.environment,{store:t}=this.props,a=M.c(t,1),i=Ce.Gb([Ce.m,Ce.b([Ce.Bb,Ce.Fb(Ce.m)])])({environment:this.environment,blocks:[t]});if(a&&a.canRead())return o()("div",{},void 0,o()("div",{style:{...this.getPermissionItemWrapStyle(),...this.getMenuItemStyle(),backgroundColor:e.isMobile?this.theme.darkBannerBackground:this.theme.sidebarSecondaryBackground,flexDirection:e.isMobile?"column":"row",alignItems:e.isMobile?"flex-start":"center",paddingTop:e.isMobile?14:10}},void 0,o()("div",{style:{display:"flex",alignItems:"flex-start",marginRight:e.isMobile?void 0:6}},void 0,h.a.eyeHide({width:e.isMobile?20:16,marginTop:e.isMobile?3:2,marginRight:e.isMobile?10:8,marginLeft:e.isMobile?2:0,fill:this.theme.regularIconColor}),o()(B.a,{isMultiline:!0,isMobile:e.isMobile,isSmall:!0,style:{color:this.theme.regularTextColor}},void 0,o()(D.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",description:"This text tells the user that this permission setting for the page is NOT inherited from the parent page.",values:{linkBoxWithPageTitle:o()(T.a,{style:{color:this.theme.mediumTextColor},underline:!0,inline:!0,href:Object(v.a)({store:a,fullyQualified:!1})},void 0,o()(A.a,{shouldWrap:!0,maxLength:30,store:a,style:{display:"inline"}}))}}))),i&&o()(_.a,{isSmall:!e.isMobile||void 0,style:{fontSize:e.isMobile?14:12,marginTop:e.isMobile?2:void 0,marginLeft:e.isMobile?24:void 0,fontWeight:e.isMobile?Q.a.fontWeight.medium:void 0},onClick:()=>{const e=t.getPermissionItems(),a=M.f(t),i=a?Object(re.c)(M.h(a)):[],s=Object(re.h)(e,i);this.stores.restrictConfirmationModalStore.setState({open:!0,onClose:this.handleCloseRestrictConfirmationModal,type:"restore",permissionChanges:s,onAccept:()=>{t.getPermissionsStore().canAdmin()?K.createAndCommit(this.environment,async e=>{await f.d({environment:this.environment,store:t,transaction:e})}):f.a({environment:this.environment,store:t})}})}},void 0,o()(D.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.restore",defaultMessage:"Restore",description:"Action for when user wants to remove restricted access to a page."}))),e.isMobile?o()(Te.a,{size:1,style:{opacity:"75%"}}):void 0)}renderPublicPermissionItem(e){const{store:t}=this.props,a=y.a.createChildStore(t,{table:N.a,id:e.blockId}),i=a.id!==t.id;return o()("div",{style:this.getPermissionItemWrapStyle(),className:ne.g},void 0,o()(z,{format:z.Format.Web,currentBlockStore:t,store:a,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:h.a.globe({width:26,height:26,fill:this.theme.lightIconColor}),title:o()(D.FormattedMessage,{defaultMessage:"Share to web",id:"blockPermissionsSettings.permissionItem.linkSharing"}),subtitle:m.c(e.permissionItem.role)?o()(D.FormattedMessage,{defaultMessage:"Anyone with the link can edit and comment",id:"blockPermissionsSettings.publicPermission.canEdit"}):m.b(e.permissionItem.role)?o()(D.FormattedMessage,{defaultMessage:"Anyone with the link can comment",id:"blockPermissionsSettings.publicPermission.canComment"}):m.d(e.permissionItem.role)?o()(D.FormattedMessage,{defaultMessage:"Anyone with the link can view",id:"blockPermissionsSettings.publicPermission.canRead"}):o()(D.FormattedMessage,{defaultMessage:"Publish and share link with anyone",id:"blockPermissionsSettings.publicPermission.none"}),tooltip:i?this.renderInheritedPermissionTooltip(a):this.renderPublicPermissionTooltip(),isSubscribed:this.isSubscribed(),isInherited:i,upgradeButtonName:"public_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,switcherRole:"reader",onChange:async t=>{await this.handlePermissionItemChange({isInherited:i,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderSpacePermissionItem(e){const{store:t}=this.props,a=y.a.createChildStore(t,{table:N.a,id:e.blockId}),i=M.i(t)||te.default.state.currentSpaceStore;if(!i||!i.getValue())return;const s=Object(fe.getSpacePermissionItems)(i).filter(e=>m.c(m.f(e))),n=a.id!==t.id;return o()("div",{style:{width:"100%"},className:ne.h},void 0,o()(z,{format:z.Format.Workspace,currentBlockStore:t,store:a,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:this.renderSpaceIcon(),title:o()(D.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:Object(fe.getSpaceName)(this.environment,i)}}),tooltip:n?this.renderInheritedPermissionTooltip(a):this.renderSpacePermissionTooltip(),subtitle:o()(D.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} workspace member} other {{numberOfWorkspaceMembers} workspace members}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:s.length}}),isSubscribed:this.isSubscribed(),isInherited:n,upgradeButtonName:"space_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:n,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderInheritedPermissionTooltip(e){const t=e.getIcon();return o()("div",{style:{whiteSpace:"normal",width:180}},void 0,o()(D.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:o()("span",{style:{whiteSpace:"nowrap",fontWeight:Q.a.fontWeight.bold}},void 0,t&&o()(Y.a,{disabled:!0,icon:t,isEmptyPage:!1,size:12,style:{marginRight:4,display:"inline-block"}}),o()(A.a,{store:e,style:{display:"inline"}}))}}))}renderSpaceIcon(){const{currentSpaceStore:e}=te.default.state;return e?o()(Y.a,{disabled:!0,title:Object(fe.getSpaceName)(this.environment,e),icon:Object(fe.getSpaceIcon)(this.environment,e),isEmptyPage:!1,size:z.iconSize}):h.a.team()}renderGroupPermissions(e){const{currentSpaceStore:t}=te.default.state,{spacePermissionGroups:a,mostPermissiveGroupPermissions:i}=e;return i.map(e=>{const i=e.permissionItem.group_id,s=a.find(e=>e.id===i);if(s&&t)return this.renderGroupPermissionItem(e,s,t.id)})}renderGroupPermissionItem(e,t,a){const{store:i,intl:s}=this.props,n=y.a.createChildStore(i,{table:N.a,id:e.blockId}),r=t.user_ids||[],l=Object($.a)({intl:s,group:t}),d=n.id!==i.id,c=o()(Y.a,{disabled:!0,title:l,icon:t.icon?{pointer:{table:"space",id:a},icon:t.icon}:void 0,isEmptyPage:!1,size:z.iconSize});return o()("div",{style:{fontWeight:400},className:ne.f},t.id,o()(z,{format:z.Format.Workspace,currentBlockStore:i,store:n,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:c,title:l,tooltip:d?this.renderInheritedPermissionTooltip(n):this.renderGroupPermissionTooltip(t),subtitle:o()(D.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} group member} other {{numberOfGroupMembers} group members}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:r.length}}),isSubscribed:this.isSubscribed(),isInherited:d,upgradeButtonName:"group_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:d,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderAddGuests(){const{device:e}=this.environment,{WindowSizeStore:t}=this.environment;return o()(F.a,{mobileFeedback:e.isMobile,disabled:!0},void 0,o()("div",{style:{...this.getMenuItemStyle(),paddingTop:e.isMobile?12:10,paddingBottom:e.isMobile?12:10,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}},void 0,o()("div",{style:{width:"100%"}},void 0,this.renderInviteButton())))}getPermissionItemWrapStyle(){return{boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),width:"100%"}}getMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:8,paddingBottom:8,paddingLeft:e.getSafePaddingLeftCSS(16),paddingRight:e.getSafePaddingRightCSS(12)}}isSubscribed(){const{data:e}=ie.default.state;return Boolean(e&&U.D(e))}canEdit(){return m.a(this.props.store.getRole()||"editor")}getPageLinkInfoTooltip(){const e=Object(oe.b)(this.props.store).map(({permissionItem:e})=>e),t=e.find(e=>"public_permission"===e.type),a=e.find(e=>"space_permission"===e.type),i=e.filter(e=>"user_permission"===e.type);return t?o()("div",{},void 0,o()(D.FormattedMessage,{defaultMessage:"This page has public link access, so anyone{br}with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip",values:{br:o()("br",{})}})):a?o()("div",{},void 0,o()(D.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone{br}in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip",values:{br:o()("br",{})}})):i.length>1?o()("div",{},void 0,o()(D.FormattedMessage,{defaultMessage:"Only you and other invited members{br}and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip",values:{br:o()("br",{})}})):o()("div",{},void 0,o()(D.FormattedMessage,{defaultMessage:"Only you can access this page,{br}so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip",values:{br:o()("br",{})}}))}}t.default=Object(D.injectIntl)(De)},xRf7:function(e,t,a){"use strict";var i=a("gcR/"),s=a.n(i),n=(a("q1tI"),a("wldR")),o=a("/6eU"),r=a("wXH4"),l=a("AjLL");class d extends n.a{renderComponent(){const{device:e}=this.environment;return e.isMobile?s()(r.c,{popupType:e.isMobile?r.c.PopupType.SlideUp:r.c.PopupType.Popup,open:this.props.open,render:this.props.renderContent,onDismiss:this.props.onDismiss,origin:this.props.origin}):s()(o.a,{open:this.props.open,preventHideChildrenWhileOpening:!0,style:{alignItems:"flex-start"},innerStyle:this.getModalStyle(),onDismiss:this.props.onDismiss,render:this.props.renderContent,origin:this.props.origin,disableAnimation:this.props.disableAnimation})}getTopbarHeight(){const{device:e}=this.environment;return e.isElectronMac?l.a.desktopMacHeight:l.a.defaultHeight}getModalStyle(){const{modalStyle:e}=this.props;return{top:2*this.getTopbarHeight(),borderRadius:3,overflow:"hidden",boxShadow:this.theme.largeBoxShadow,background:this.theme.contentBackground,...e}}}t.a=d},yQT7:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r}));var i=a("gcR/"),s=a.n(i),n=(a("q1tI"),a("PHZn"));function o(e){return{backgroundColor:e.groupedFormBackground,borderWidth:1,borderStyle:"solid",borderColor:e.groupedFormBorder,borderRadius:3,borderBottomWidth:0}}function r(e){const t=Object(n.a)(t=>({group:{display:"flex",borderBottomColor:t.groupedFormBorder,borderBottomWidth:1,borderBottomStyle:"solid",alignItems:"center",flex:1,...e.style}}),[e.style]);return s()("div",{style:t.group},void 0,e.children)}},zqZm:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));a("LvDl");function i(e){return e.country&&!s(e.country)?"skip":e.addressLine1&&e.zipCode||e.addressLine1&&e.city&&e.state||e.zipCode?"should_resolve":"insufficient_data"}function s(e){return["US","CA"].includes(e)}}}]);